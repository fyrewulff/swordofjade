## Sword of Jade 2 Master Script file

include,plotscr.hsd
include,TimeSys.hsi
include,globvars.hsi
include,jade.hsi
include,BattleIconSys.hsi
include,battles.hsi
include,quest.hsi
include,shop.hsi

define script (1,theend,none) #Finished!!
define script (2,newgame,none)
define script (3,overgame,none)
define script (4,zelda scroll,none)
define script (5,gen footprints,2,0,0)
define script (6,fralindoor,0)
define script (autonumber,fralindoor1,0)
define script (autonumber,fralindoor2,0)
define script (autonumber,fralindoor3,0)
define script (autonumber,fralindoor4,0)
define script (autonumber,fralindoor5,0)
define script (7,fralinindoordoor,0)
define script (autonumber,fralinindoordoor1,0)
define script (autonumber,fralinindoordoor2,0)
define script (8,aletter,0)
define script (9,heroesoffralin,0)
define script (10,loadgame,0)
define script (11,forestpassdoor,0)
define script (12,heroesoffralinagain,0)
define script (13,enteringforestdungeonabc,0)
define script (14,waterdungeondoor,0)
############# define script (15,battlewater,1,0)
define script (16,waterdoornorth,0)
define script (17,newgame2,0)
define script (18,newgame3,0)
define script (19,newgame4,0)
define script (20,newgame5,0)
define script (21,fireflyhide,0)
define script (22,fireflyback,0)
define script (23,newgame6,0)
define script (24,newgame7,0)
define script (25,grininterior,0)
define script (26,grinzenith,0)
define script (27,grin1,0)
define script (28,grin2,0)
define script (29,grin3,0)
define script (30,grin4,0)
define script (31,grin5,0)
define script (32,grin6,0)
############# define script (33,bgrin1,0)
############# define script (34,bgrin2,0)
############# define script (35,bgrin3,1,0)
############# define script (36,bgrin4,1,0)
define script (37,grin7,0)
define script (38,grin8,0)
define script (39,grin9,0)
define script (40,grin10,0)
define script (41,grincookietrick,0)
define script (42,grinzen1,0)
define script (43,grinzen2,0)
define script (44,aftergahnfight,0)
define script (45,aftergrinbattle,0)
define script (46,endgrin7madness,0)
define script (47,waterdungeonauto,1,0)
define script (48,fralincyportdoorlink,0)
define script (49,forestpasspillar,0)
define script (50,waterdungeon1,0)
define script (51,waterdungeonchest,1,0)
define script (52,waterdungeonjump,0)
define script (53,waterminiboss,0)
define script (54,waterboss,0)
define script (55,adlezdoor,0)
define script (56,adlezindoordoor,0)
define script (57,johandoor,0)
define script (58,undergroundquarrydoor,0)
define script (59,gitlehtombdoor,0)
define script (autonumber,gitlehtombdoor11,0)
define script (autonumber,gitlehtombdoor111,0)
define script (autonumber,gitlehtombdoor1111,0)
define script (60,gitlehtombdoor2,0)
define script (autonumber,gitlehtombdoor22,0)
define script (autonumber,gitlehtombdoor222,0)
define script (autonumber,gitlehtombdoor2222,0)
define script (61,troubleinadlez,0)
define script (62,meetjohan,0)
define script (autonumber,meetjohan1,0)
define script (autonumber,meetjohan2,0)
define script (autonumber,meetjohan3,0)
define script (autonumber,meetjohan4,0)
define script (63,somethingsneaky,0)
define script (autonumber,somethingsneaky1,0)
define script (autonumber,somethingsneaky2,0)
define script (autonumber,somethingsneaky3,0)
define script (autonumber,somethingsneaky4,0)
define script (64,loadadlez,0)
define script (65,loadquarry,0)
define script (66,dangle3,0)
define script (67,desertdoor,0)
define script (68,keltandoor,0)
define script (69,keltanindoordoor,0)
define script (70,restingbythefire,0)
define script (71,flashbackdoor,1,91)
define script (72,cabindoor,1,95)
define script (73,flashbackload,0)
define script (74,flashbackraceone,1,0)
define script (75,flashbackracetwo,0)
define script (76,rtsgo,1,0)
define script (77,grinslime,0)
define script (78,grinharmtile,0)
define script (79,fralinintrodoor,0)
define script (80,fralinindoorintrodoor,0)
define script (81,loadadlez2,0)
define script (82,keltanshopkeeper,0)
define script (83,threepointfive,0)
define script (84,talktopyrus,0)
define script (85,endmanxflashback,0)
define script (86,wakeupjohan,0)
define script (87,wakeupmila,0)
define script (88,raiderconfrontation,0)
define script (89,fedoratombdoor,0)
define script (90,opensaysme,0)
define script (91,fedoratombload,1,0)
define script (92,scarfsleep,0)
define script (93,begincyport,0)
define script (94,cyportwestdoor,0)
define script (95,cyportcomdoor,0)
define script (96,cyportcentraldoor,0)
define script (97,cyportrezdoor,0)
define script (98,cyportnorthdoor,0)
define script (99,rtsspecial,0)
define script (100,snowtraildoor,0)
define script (101,snowmountdoor,0)
define script (102,rorc,0)
define script (103,snowcabindoor,0)
define script (104,shodatombdoor,1,0)
define script (105,unknowntombdoor,0)
define script (106,scarf1door,0)
define script (107,scarf2door,0)
define script (108,scarf3door,0)
define script (109,scarf4door,0)
define script (110,ruinsdoor,0)
define script (111,scenefourpointtwo,0)
define script (112,stapler,0)
define script (113,gruff,0)
define script (114,jack,0)
define script (115,leukocyte,0)
define script (116,katinafight,0)
define script (117,dockworkers,1,0)
define script (118,plugschool,0)
define script (119,gruff2,0)
define script (120,keeltalk,0)
define script (121,jack2,0)
define script (122,cyportrezload,0)
define script (123,cyclothes1,0)
define script (124,cyclothes2,0)
define script (125,prebigscene1,0)
define script (126,prebigscene2,0)
define script (127,lovestone,0)
define script (128,beforedun4,0)
define script (129,humbleprotector,0)
define script (130,preenterdun4,0)
define script (131,shodatombload,1,0)
define script (132,shodabirds,1,0)
define script (133,finalbird,0)
define script (134,shodafinalloader,1,0)
define script (135,dartconfrontation,0)
define script (136,setkidkatina,0)
define script (137,finalflashback,0)
define script (138,beforegrinlowfinal,0)
define script (139,gahntaunts,0)
define script (140,grinlowexteriordoor,0)
define script (141,grinfinaldoor,0)
define script (142,riftfinalfight,0)
define script (143,lycantnonsense,0)
define script (144,talvasillusion,0)
define script (145,talvashaha,0)
define script (146,omegasave,0)
define script (147,grinlowkatina1,0)
define script (148,grinlowdart,0)
define script (149,hugemonsterhype,0)
define script (150,gahnovergame,0)
define script (151,hugemonster,0)
define script (152,skeletoncrumble,1,0)
define script (153,valoriandefeat,0)
define script (154,horribleending,0)
define script (155,gahnbattle,0)
define script (156,grinlowkatina2,0)
define script (157,grinlowreadtile,0)
define script (158,grinchainfight5,0)
define script (159,grinzenithfinal,0)
#scripts 160 and up are in quest.hsi

#The End Scripts:
define script (autonumber,nojadesword,0)
define script (autonumber,nojadecredits,0)
define script (autonumber,finalbattle,0)
define script (autonumber,aftermath,0)
define script (autonumber,credits,0)
define script (autonumber,thelastscene,0)
#---------------

define script (autonumber,humbleprotectorA,0)
define script (autonumber,humbleprotectorB,0)
define script (autonumber,humbleprotectorC,0)
define script (autonumber,fedoratombloadA,0)
define script (autonumber,fedoratombloadB,0)
define script (autonumber,raiderconfrontationA,0)
define script (autonumber,raiderconfrontationB,0)
define script (autonumber,raiderconfrontationC,0)
define script (autonumber,undergroundquarrydoor1,0)
define script (autonumber,undergroundquarrydoor2,0)
define script (autonumber,undergroundquarrydoor3,0)
define script (autonumber,settp,6,0,0,0,0,0,0) #used to adjust palette in dungeons
define script (autonumber,tp,0) #used to adjust palette in dungeons
define script (autonumber,ftb,7,0,0,0,0,0,0,0) #used in credits
define script (autonumber,bd,1,0)
define script (autonumber,cyportcomdoorA,0)
define script (autonumber,cyportcomdoorB,0)
define script (autonumber,cyportcomdoorC,0)
define script (autonumber,dartjadefirstscene1,0)
define script (autonumber,dartjadefirstscene2,0)
define script (autonumber,scarf2door1,0)
define script (autonumber,scarf2door2,0)
define script (autonumber,scarf2door3,0)
define script (autonumber,goup,2,0,0)
define script (autonumber,godown,2,0,0)
define script (autonumber,goupdown,2,0,0)
define script (autonumber,godownup,2,0,0)
define script (autonumber,unknowntombdoor1,0)
define script (autonumber,unknowntombdoor2,0)
define script (autonumber,unknowntombdoor3,0)
define script (autonumber,unknowntombdoor4,0)
define script (autonumber,icedoor,2,0,0)
define script (autonumber,loadgameload,0)
define script (autonumber,fpassdoor1,0)
define script (autonumber,fpassdoor2,0)
define script (autonumber,fpassdoor3,0)
define script (autonumber,fpassdoor4,0)
define script (autonumber,fpassdoor5,0)
define script (autonumber,watdundoor1,0)
define script (autonumber,watdundoor2,0)
define script (autonumber,watdundoor3,0)
define script (autonumber,watdundoor4,0)
define script (autonumber,watdundoor5,0)
define script (autonumber,grininterior1,0)
define script (autonumber,grininterior2,0)
define script (autonumber,ftextin,1,0)
define script (autonumber,ftextout,1,0)
define script (autonumber,aftermath1,0)
define script (autonumber,aftermath2,0)
define script (autonumber,aftermath3,0)
define script (autonumber,aftermath4,0)
define script (autonumber,aftermath5,0)
define script (autonumber,valoriandefeat1,0)
define script (autonumber,valoriandefeat2,0)
define script (autonumber,talvashaha1,0)
define script (autonumber,talvasillusion1,3,0,0,0)
define script (autonumber,talvasillusion2,4,0,0,0,0)
define script (autonumber,talvasillusion3,1,0)
define script (autonumber,riftfinalfight1,0)
define script (autonumber,riftfinalfight2,0)
define script (autonumber,gahnsaysgoodbye2,0)
define script (autonumber,gahnsaysgoodbye,0)
define script (autonumber,relocatenpc,1,1)
define script (autonumber,jiggahn2,1,1)
define script (autonumber,beforegrinlowfinal1,0)
define script (autonumber,beforegrinlowfinal2,0)
define script (autonumber,beforegrinlowfinal3,0)
define script (autonumber,farewellskyler,0)
define script (autonumber,meetskyler,0)
define script (autonumber,preactfive5,0)
define script (autonumber,preactfive4,0)
define script (autonumber,preactfive3,0)
define script (autonumber,preactfive2,0)
define script (autonumber,preactfive1,0)
define script (autonumber,dreamsequencefinal,0)
define script (autonumber,endactfour,0)
define script (autonumber,dcnonjaded4,0)
define script (autonumber,dcnonjaded3,0)
define script (autonumber,dcnonjaded2,0)
define script (autonumber,dcnonjaded1,0)
define script (autonumber,dcnonjaded,0)
define script (autonumber,dcjaded3,0)
define script (autonumber,dcjaded2,0)
define script (autonumber,dcjaded2A,0)
define script (autonumber,dcjaded2B,0)
define script (autonumber,dcjaded1,0)
define script (autonumber,dcjaded,0)
define script (autonumber,finalbirdgo,0)
define script (autonumber,darttoolate,0)
define script (autonumber,dartintime,0)
define script (autonumber,dartjade1,0)
define script (autonumber,dartjade1A,0)
define script (autonumber,dartjade1B,0)
define script (autonumber,dartjade2,0)
define script (autonumber,dartjade2A,0)
define script (autonumber,dartjade2B,0)
define script (autonumber,dartjade3,0)
define script (autonumber,dartjade3A,0)
define script (autonumber,dartjade3B,0)
define script (autonumber,dartjade4,0)
define script (autonumber,dartjade4A,0)
define script (autonumber,dartjade4B,0)
define script (autonumber,dartjade5,0)
define script (autonumber,dartjade5A,0)
define script (autonumber,dartjade5B,0)
define script (autonumber,dartjadefirstscene,0)
define script (autonumber,mrstairup,4,0,0,0,0)
define script (autonumber,mrstairdown,4,0,0,0,0)
define script (autonumber,flyhigh3,6,0,0,0,0,0,0)
define script (autonumber,flyhigh2,8,0,0,0,0,0,0,0,0)
define script (autonumber,flyhigh1,10,0,0,0,0,0,0,0,0,0,0)
define script (autonumber,flyhigh,11,0,0,0,0,0,0,0,0,0,0,0)
define script (autonumber,flyhighalpha1,5,0,0,0,0,0)
define script (autonumber,flyhighalpha2,6,0,0,0,0,0,0)
define script (autonumber,flyhighalpha3,7,0,0,0,0,0,0,0)
define script (autonumber,flyhighbeta1,1,0)
define script (autonumber,flyhighbeta2,3,0,0,0)
define script (autonumber,flyhighbeta3,5,0,0,0,0,0)
define script (autonumber,flyhighbeta4,5,0,0,0,0,0)
define script (autonumber,snowfire,0)
define script (autonumber,mastermila,0)
define script (autonumber,endfourpointfour,0)
define script (autonumber,dodgeball,0)
define script (autonumber,dreamsequenceprefinal,0)
define script (autonumber,onceaminion,0)
define script (autonumber,scenefourpointfour,0)
define script (autonumber,clothescheck,3,0,0,0)
define script (autonumber,clothescheck1,2,0,0)
define script (autonumber,clothescheck2,0)
define script (autonumber,clothescheck3,3,0,0,0)
define script (autonumber,snowout,1,0)
define script (autonumber,katinafightA,0)
define script (autonumber,katinafightAA,0)
define script (autonumber,katinafightAAA,0)
define script (autonumber,katinafightAAAA,0)
define script (autonumber,katinafightB,0)
define script (autonumber,katinafightBB,0)
define script (autonumber,katinafightC,0)
define script (autonumber,katinafightCC,0)
define script (autonumber,katinafightD,0)
define script (autonumber,katinafightDD,0)
define script (autonumber,ppup,0)
define script (autonumber,ppdown,0)
define script (autonumber,ppright,0)
define script (autonumber,ppleft,0)
define script (autonumber,pup,0)
define script (autonumber,pdown,0)
define script (autonumber,pright,0)
define script (autonumber,pleft,0)
define script (autonumber,katinatalkend,0)
define script (autonumber,katinatalkend1,0)
define script (autonumber,katinatalkend2,0)
define script (autonumber,katinatalkend3,0)
define script (autonumber,dogerobrick,0)
define script (autonumber,noresponsebrick,0)
define script (autonumber,johanbrick,0)
define script (autonumber,milabrick,0)
define script (autonumber,pyrusbrick,0)
define script (autonumber,katinarage,0)
define script (autonumber,ktalk,9,0,0,0,0,0,0,0,0,0)
define script (autonumber,katinatalk,0)
define script (autonumber,shodatombdoor0,1,0)
define script (autonumber,shodatombdoor0A,0)
define script (autonumber,shodatombdoor0B,1,0)
define script (autonumber,shodatombdoor0B1,1,0)
define script (autonumber,shodatombdoor0B2,1,0)
define script (autonumber,shodatombdoor0B3,1,0)
define script (autonumber,shodatombdoor1,0)
define script (autonumber,shodatombdoor11,0)
define script (autonumber,shodatombdoor2,0)
define script (autonumber,shodatombdoor22,0)
define script (autonumber,shodatombdoor3,0)
define script (autonumber,shodatombdoor33,0)
define script (autonumber,shodatombdoor4,0)
define script (autonumber,shodatombdoor44,0)
define script (autonumber,manxfight2,0)
define script (autonumber,manxfight2boss,0)
define script (autonumber,manxfight3,0)
define script (autonumber,restingbythefire2,0)
define script (autonumber,endfedora1,0)
define script (autonumber,endfedora2,0)
define script (autonumber,endfedora3,0)
define script (autonumber,endfedora4,0)
define script (autonumber,endfedora5,0)
define script (autonumber,flashbackthree,0)
define script (autonumber,mrup,8,0,0,0,0,3,0,0,0)
define script (autonumber,mrdown,8,0,0,0,0,3,0,0,0)
define script (autonumber,mrleft,8,0,0,0,0,3,0,0,0)
define script (autonumber,mrright,8,0,0,0,0,3,0,0,0)
define script (autonumber,fedoratombdoorupright,0)
define script (autonumber,fedoratombdoorupright1,0)
define script (autonumber,fedoratombdoorupright2,0)
define script (autonumber,fedoratombdoorupright3,0)
define script (autonumber,fedoratombdoordownright,0)
define script (autonumber,fedoratombdoorupleft,0)
define script (autonumber,fedoratombdoordownleft,0)
define script (autonumber,enteringdun3,0)
define script (autonumber,endfedora,0)
define script (autonumber,manxfight,0)
define script (autonumber,manxhype,0)
define script (autonumber,mainforcesfallen,0)
define script (autonumber,midnightraiders,0)
define script (autonumber,midnightraiders1,0)
define script (autonumber,midnightraiders2,0)
define script (autonumber,animalscantalk,0)
define script (autonumber,manxmoon,0)
define script (autonumber,flashbackmanx,0)
define script (autonumber,gunfight,0)
define script (autonumber,scenethreepointfour,0)
define script (autonumber,savegame,0)
define script (autonumber,scenethreepointthree,0)
define script (autonumber,scenethreepointone,0)
define script (autonumber,gitlehtomblock,0)
define script (autonumber,gitlehtombmini1,0)
define script (autonumber,gitlehtombmini2,0)
define script (autonumber,gitlehtombmini3,0)
define script (autonumber,gitlehtombintro,0)
define script (autonumber,gitlehtombintro1,0)
define script (autonumber,gitlehtombintro2,0)
define script (autonumber,gitlehtombintro3,0)
define script (autonumber,gitlehtombrift,0)
define script (autonumber,gitlehtombrift1,0)
define script (autonumber,gitlehtombrift2,0)
define script (autonumber,gitlehtombfight,0)
define script (autonumber,gitlehtombfight1,0)
define script (autonumber,gitlehtombfight2,0)
define script (autonumber,gitlehtombfight3,0)
define script (autonumber,gitlehtombgitleh,0)
define script (autonumber,endofactthree0,0)
define script (autonumber,endofactthree1,0)
define script (autonumber,endofactthree2,0)
define script (autonumber,endofactthree3,0)
define script (autonumber,endofactthree4,0)
define script (autonumber,dangle3sub1,0)
define script (autonumber,dangle4,0)
define script (autonumber,dangle4sub1,0)
define script (autonumber,dangle4sub2,0)
define script (autonumber,dangle4sub3,0)
define script (autonumber,dangle1,0)
define script (autonumber,dangle2,0)
define script (autonumber,scene2point4point1,0)
define script (autonumber,scene2point4point2,0)
define script (autonumber,s2p4p2p1,0)
define script (autonumber,s2p4p2p2,0)
define script (autonumber,s2p4p2p3,0)
define script (autonumber,scene2point4p1,0)
define script (autonumber,scene2point4,0)
define script (autonumber,sethp,0)
define script (autonumber,meetanon,0)
define script (autonumber,meetanon1,0)
define script (autonumber,meetanon2,0)
define script (autonumber,meetanon3,0)
define script (autonumber,jigvalorian,1,0)
define script (autonumber,wdj,1,0)
define script (autonumber,wdn1,0)
define script (autonumber,wdn2,0)
define script (autonumber,wdn3,0)
define script (autonumber,wdn4,0)
define script (autonumber,wdn5,0)
define script (autonumber,forestduna,0)
define script (autonumber,forestdunb,0)
define script (autonumber,forestdunc,0)
############# define script (autonumber,grinintrobattle,0)
define script (autonumber,heroesoffralin2,0)
define script (autonumber,heroesoffralin3,0)
define script (autonumber,slimebossfight,0)
define script (autonumber,grinzen3,0)
define script (autonumber,tb,1,0)
define script (autonumber,palout,1,1)
define script (autonumber,palin,1,1)
define script (autonumber,textout,1,1)
define script (autonumber,textin,1,1)
define script (autonumber,jighero,1,0)
define script (autonumber,jignpc,1,0)
define script (autonumber,checkinventory,0)
define script (autonumber,battleflash,1,0)
define script (autonumber,poff,0)
define script (autonumber,jiggahn,0)
define script (autonumber,setpartyout,0)
define script (autonumber,setpartyin,0)
define script (autonumber,neopicout,1,0)
define script (autonumber,neopicin,1,0)
define script (autonumber,setfinalpalette,0)
define script (autonumber,actadvance,1,0)

#save for the end!
script,theend,begin
suspend player
suspend npcs
suspend obstruction
	if(check tag(555)) then(
	finalbattle
	aftermath
	credits
	thelastscene
	)
	else(
	nojadesword
	nojadecredits
	)
resume obstruction
resume npcs
resume player
end

#party move in
##################
script, ppup, begin
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,right,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in
end
###
####################
script, ppdown, begin
walk npc(1,left,1)
walk npc(2,up,1)
walk npc(3,right,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in
end
###
#####################
script, ppright, begin
walk npc(1,down,1)
walk npc(2,left,1)
walk npc(3,up,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in
end
###
####################
script, ppleft, begin
walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,up,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in
end
###

#party move out
##################
script, pup, begin
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,down)
end
###
####################
script, pdown, begin
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,down,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)
end
###
#####################
script, pright, begin
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,right,1)
walk npc(3,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
end
###
####################
script, pleft, begin
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)
end
###

#mr - move room, dungeon screen scrolls
#palette tweak rr gg bb
#set pal number
script,mrup,rr,gg,bb,setp,dis,rr2,gg2,bb2,begin
pan camera (up,6,10)
walk hero (0,up,dis)
settp(rr,gg,bb,rr2,gg2,bb2)
reset palette
tweak palette (rr,gg,bb)
tweak palette (rr2,gg2,bb2)
wait for camera
update palette
set pal(setp)
pan camera (up,6,10)
wait for camera
wait for hero (0)
end
script,mrdown,rr,gg,bb,setp,dis,rr2,gg2,bb2,begin
pan camera (down,6,10)
walk hero (0,down,dis)
settp(rr,gg,bb,rr2,gg2,bb2)
reset palette
tweak palette (rr,gg,bb)
tweak palette (rr2,gg2,bb2)
wait for camera
update palette
set pal(setp)
pan camera (down,6,10)
wait for camera
wait for hero (0)
end
script,mrleft,rr,gg,bb,setp,dis,rr2,gg2,bb2,begin
pan camera (left,9,10)
walk hero (0,left,dis)
settp(rr,gg,bb,rr2,gg2,bb2)
reset palette
tweak palette (rr,gg,bb)
tweak palette (rr2,gg2,bb2)
wait for camera
update palette
set pal(setp)
pan camera (left,9,10)
wait for camera
wait for hero (0)
end
script,mrright,rr,gg,bb,setp,dis,rr2,gg2,bb2,begin
pan camera (right,9,10)
walk hero (0,right,dis)
settp(rr,gg,bb,rr2,gg2,bb2)
reset palette
tweak palette (rr,gg,bb)
tweak palette (rr2,gg2,bb2)
wait for camera
update palette
set pal(setp)
pan camera (right,9,10)
wait for camera
wait for hero (0)
end

#MISTER STAIRS?!
script,mrstairup,cenx,ceny,desx,desy,begin
set hero speed(0,2)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,cenx,ceny)
wait(1)
pan camera(south,0,0)
set hero position(0,desx,desy+2)
write pass block(desx,desy+1,128)
write pass block(desx,desy+2,128)
wait(1)
palin(2)
walk hero(0,up,3)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
write pass block(desx,desy+1,1)
write pass block(desx,desy+2,0)
end
script,mrstairdown,cenx,ceny,desx,desy,begin
variable(pbx)
variable(pby)
set variable(pbx,herox(0))
set variable(pby,heroy(0))
write pass block(pbx,pby+1,128)
write pass block(pbx,pby+2,128)
set hero speed(0,2)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)
set hero position(0,cenx,ceny)
palout(2)
camera follows hero(0)
wait(1)
pan camera(south,0,0)
set hero position(0,cenx--9,ceny--6)
write pass block(pbx,pby+1,1)
write pass block(pbx,pby+2,0)
wait(1)
palin(2)
set hero position(0,desx,desy--1)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
end

script,savegame,begin
set tag(7,0)
tb(33)
if(check tag(7)) then(
variable(slot)
set variable(slot,save menu)
if(slot>=0) then(set variable(saves,saves+1))
)
end


# new version of sethp contributed by Artimus Bena in 2025
# the engine now throws errors if the other heroes are not present in
# extra warning mode, so he wrote this new version.
script, sethp, begin 
    variable (slot, hero, p0, p1, p2, p3, new_palette)
    p0 := 1+poff
	#silver dogero
    if (check tag(724) ) then ( p0 := 73+poff )
    p1 := 29+poff
    p2 := 33+poff
    p3 := 65+poff
    
    for (slot, 0, 3) do (
        hero := hero by slot (slot)
        switch (hero) do (
            case (hero:Dogero) new_palette := p0
            case (hero:Mi'la) new_palette := p1
            case (hero:Johan) new_palette := p2
            case (hero:Pyrus) new_palette := p3
	    case (else) continue(2)
        )
    
        set hero palette (hero, new_palette)
        set hero palette (hero, new_palette, inside battle)
        
    )
end

script,setpartyout,begin
if (findhero(0)<>-1) then(set variable(saveplace1,findhero(0)))
if (findhero(1)<>-1) then(set variable(saveplace2,findhero(1)))
if (findhero(2)<>-1) then(set variable(saveplace3,findhero(2)))
if (findhero(3)<>-1) then(set variable(saveplace4,findhero(3)))
if (findhero(7)<>-1) then(set variable(saveplace2,findhero(7)))
if (findhero(8)<>-1) then(set variable(saveplace3,findhero(8)))
if (findhero(9)<>-1) then(set variable(saveplace4,findhero(9)))
end
script,setpartyin,begin
if (findhero(0)<>-1) then(swap by position(saveplace1,find hero(0)))
if (findhero(1)<>-1) then(swap by position(saveplace2,find hero(1)))
if (findhero(2)<>-1) then(swap by position(saveplace3,find hero(2)))
if (findhero(3)<>-1) then(swap by position(saveplace4,find hero(3)))
if (findhero(7)<>-1) then(swap by position(saveplace2,find hero(7)))
if (findhero(8)<>-1) then(swap by position(saveplace3,find hero(8)))
if (findhero(9)<>-1) then(swap by position(saveplace4,find hero(9)))
end

script, battle flash, boss, begin
#variable(flash)
set variable(flash,1)
if (boss==1) then(
show backdrop(1)
wait(5)
show map
wait(5)
show backdrop(1)
wait(5)
show map
wait(5)
show backdrop(1)
wait(5)
show map
wait(5)
show backdrop(1)
wait(5)
show map
wait(5)
set variable(flash,2)
)

play sound (31,false,true) #battle sound for 2025
variable(iii)
for(iii,1,flash,1) do(
write color (0,0,50)
write color (28,0,50)
write color (44,0,50)
write color (60,0,50)
write color (76,0,50)
write color (188,0,50)
write color (239,0,50)
write color (252,0,50)
write color (240,0,50)
update palette
wait (1)
reset palette
update palette
tweak palette (30,0,0)
update palette
wait (1)
reset palette
update palette
show backdrop (1)
wait (1)
show map
write color (0,0,50)
write color (28,0,50)
write color (44,0,50)
write color (60,0,50)
write color (76,0,50)
write color (188,0,50)
write color (239,0,50)
write color (252,0,50)
write color (240,0,50)
update palette
wait (1)
reset palette
update palette
tweak palette (30,0,0)
update palette
wait (1)
reset palette
update palette
show backdrop (1)
wait (1)
show map
)
end

script, checkinventory, begin
variable (i)
set variable (i,0)
variable (total)
set variable (total,0)
for (i,0,254,1) do(
if (inventory(i)>>0) then(
set variable (total,total+1))
)
return (total)
end

script,palout,time,begin
if (time<>0) then(
tweak palette (-5,-5,-5)
update palette
wait (time)
tweak palette (-10,-10,-10)
update palette
wait (time)
tweak palette (-20,-20,-20)
update palette
wait (time)
tweak palette (-40,-40,-40)
update palette
wait (time)
tweak palette (-111,-111,-111)
update palette
wait (time)
)
end

script,palin,time,begin
if (time<>0) then(
reset palette
tweak palette (-40,-40,-40)
update palette
wait (time)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (time)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (time)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (time)
reset palette
update palette
)
end

script, text out, time, begin
set variable (txtred, read color (175,0))
set variable (txtgreen, read color (175,1))
set variable (txtblue, read color (175,2))

if (time<>0) then(
write color (175,0,txtred--5)
write color (175,1,txtgreen--5)
write color (175,2,txtblue--5)
update palette
wait (time)
write color (175,0,txtred--10)
write color (175,1,txtgreen--10)
write color (175,2,txtblue--10)
update palette
wait (time)
write color (175,0,txtred--20)
write color (175,1,txtgreen--20)
write color (175,2,txtblue--20)
update palette
wait (time)
write color (175,0,txtred--40)
write color (175,1,txtgreen--40)
write color (175,2,txtblue--40)
update palette
wait (time)
write color (175,0,txtred--111)
write color (175,1,txtgreen--111)
write color (175,2,txtblue--111)
update palette
wait (time)
)
end

script, text in, time, begin
if (time<>0) then(
write color (175,0,txtred)
write color (175,1,txtgreen)
write color (175,2,txtblue)
write color (175,0,txtred--40)
write color (175,1,txtgreen--40)
write color (175,2,txtblue--40)
update palette
wait (time)
write color (175,0,txtred)
write color (175,1,txtgreen)
write color (175,2,txtblue)
write color (175,0,txtred--20)
write color (175,1,txtgreen--20)
write color (175,2,txtblue--20)
update palette
wait (time)
write color (175,0,txtred)
write color (175,1,txtgreen)
write color (175,2,txtblue)
write color (175,0,txtred--10)
write color (175,1,txtgreen--10)
write color (175,2,txtblue--10)
update palette
wait (time)
write color (175,0,txtred)
write color (175,1,txtgreen)
write color (175,2,txtblue)
write color (175,0,txtred--5)
write color (175,1,txtgreen--5)
write color (175,2,txtblue--5)
update palette
wait (time)
write color (175,0,txtred)
write color (175,1,txtgreen)
write color (175,2,txtblue)
update palette
)
end


script,jighero,who,begin
wait (2)
set hero frame (who,1)
wait (2)
set hero frame (who,0)
wait (2)
end

script,jignpc,who,begin
wait (2)
set npc frame (who,1)
wait (2)
set npc frame (who,0)
wait (2)
end


script,tb,which,begin
	showtextbox(which)
	waitfortextbox
end


######################
script, new game, begin
suspend player
suspend npcs
suspend box advance

#saving dogero hero stats for rts use
set variable(dohp,get hero stat(find hero(0),0,maximum stat))
set variable(dosp,get hero stat(find hero(0),1,maximum stat))
set variable(dostr,get hero stat(find hero(0),2,maximum stat))
set variable(doacc,get hero stat(find hero(0),3,maximum stat))
set variable(dodef,get hero stat(find hero(0),4,maximum stat))
set variable(doddg,get hero stat(find hero(0),5,maximum stat))
set variable(doskl,get hero stat(find hero(0),6,maximum stat))
set variable(doevd,get hero stat(find hero(0),7,maximum stat))

#this is act 0, but for char's sake...
set variable(actnumber,1)

#ALRIGHT!
#After years and years of work
#I am now finally able to.....
#DUN DUN DUN
#!!!!!!!!!!!
#Add in the option to skip the introduction!

# new for 2025 :(
# there's a really bad bug in the katina battle at the end of the program that causes an infinite loop
# in order to keep complains low on steam and put out the fire, the proem is being temporarily disabled
# after spending a whole day trying to get the battle fixed.

#begin proem choice comment out
# update - fenrir found the bug, so this is fixed now.proem choice is uncommented

fade screen out(0,0,0)
show backdrop(133)
show text box(7325)
wait(1)
fade screen in
wait(1)
wait for key(usekey)
wait(1)
fade screen out
advance text box
show map

# as part of the proem disable, force tag 258 to false just to keep things clean
#set tag (258,false) #now commented out since we're not disabling the proem anymore

#chose to watch the intro
if(check tag(258)) then(

set variable(morningmap,67)
set variable(noonmap,67)
set variable(afternoonmap,67)
set variable(nightmap,67)

tweak palette (-111,-111,-111)
update palette
show text box(82)
wait (33)
palin(3)
wait for key (usekey)
palout(3)
advance text box

show text box (83)
wait (10)
palin(3)
wait for key (usekey)
palout(3)
advance text box

teleport to map (67,45,69)
stop song
pan camera (up,3,20)
wait for camera
#making npc statues appear
alter npc(18,NPCstat:picture,204)
alter npc(18,NPCstat:palette,69)
set npc frame(npc at spot(39,45),1)
set npc frame(npc at spot(41,46),1)
set npc frame(npc at spot(49,46),1)
set npc frame(npc at spot(51,45),1)
set npc frame(npc at spot(39,49),1)
set npc frame(npc at spot(41,50),1)
set npc frame(npc at spot(50,50),1)
set npc frame(npc at spot(52,49),1)
set npc frame(npc at spot(49,56),1)
set npc frame(npc at spot(38,55),1)
set npc frame(npc at spot(52,63),1)
set npc frame(npc at spot(51,66),1)
set npc frame(npc at spot(39,61),1)
set npc frame(npc at spot(37,63),1)

wait(1)
palin(10)

suspend obstruction
set npc position (1,45,69)
set npc position (2,44,69)
set npc position (3,46,69)
set tag (8,1)
wait (10)
walk npc (1,up,9)
wait (10)
walk npc (2,up,9)
wait (10)
walk npc (3,up,9)
wait for npc (3)
set npc position (1,45,42)
set npc direction (1,down)
set npc position (2,44,43)
set npc direction (2,right)
set npc position (3,46,43)
set npc direction (3,left)
set npc frame (1,0)
set npc frame (2,0)
set npc frame (3,0)
wait (10)

set tag (8,0)
resume obstruction

set variable(hspeed,5)
set hero speed(0,hspeed)

walk hero (0,up,3)
wait for hero(0)

#get item(0,1)
#get item(1,1)
#get item(2,1)
#delete item(0,1)
#delete item(1,1)
write spell(findhero(0),0,0,575+1)
write spell(findhero(0),0,3,449+1)
write spell(findhero(0),0,4,450+1)
write spell(findhero(0),0,5,139+1)
set variable(saves,0)

)

#chose not to watch the intro
else(
	set variable(saves,0)
	set variable(hspeed,5)
	#get item(0,1)
	#get item(1,1)
	#get item(2,1)
	#delete item(0,1)
	#delete item(1,1)

	wait(10)
	intropolish

	wait(20)                         #Save for after grinlow interior intro!
	camera follows hero(0)
	teleport to map (83,17,37)
	stop song
	wait(1)
	pan camera (down,6,40)
	wait for camera

	#set hero picture (0,98)
	#set hero palette(0,3)
	add hero(6)
	swap out hero(0)
	lock hero(0)
	swap by position(find hero(6),0)

	set hero speed(0,hspeed)
	wait(1)
	play song(88)
	palin(20)
	wait (10)
	write pass block(17,42,0)
	set tag(8,1)
	walk hero (0,down,6)
	wait for hero
	set hero frame(0,0)
	set tag(8,0)
	camera follows hero(0)
	write pass block(17,42,1)
	set hero stat (find hero(0),0,get hero stat(find hero(0),0,maximum stat),current stat)
	set hero stat (find hero(0),1,get hero stat(find hero(0),1,maximum stat),current stat)
	write spell(find hero(0),0,0,0)
	write spell(find hero(0),0,3,0)
	write spell(find hero(0),0,4,0)
	write spell(find hero(0),0,5,0)
	set default weapon (find hero(0),30)
	resume obstruction
	resume npcs
)

resume box advance
resume player
end

#########################
script, new game 2, begin
suspend player
suspend box advance
set hero frame(0,0)

variable (i)
for (i,0,9,1) do(
set npc position (npc at spot (14+i,46),0,0))
alter npc (32,NPCstat:script,18)

variable(wolf1)
variable(wolf2)
variable(wolf3)
set variable(wolf1,npc at spot(23,48))
set variable(wolf2,npc at spot(16,49))
set variable(wolf3,npc at spot(19,50))

wait(10)
set npc direction (wolf1,down)
wait (4)
walk npc (wolf1,down,4)
set npc direction (wolf2,right)
wait (4)
set npc direction (wolf3,left)
walk npc (wolf2,down,4)
wait (4)
walk npc (wolf3,down,4)
#write color (175,0,txtred--111)
#write color (175,1,txtgreen--111)
#write color (175,2,txtblue--111)
textout(1)
update palette
show text box (50)
wait (10)
textin(3)
wait for npc(wolf3)
set npc position (wolf1,0,0)
set npc position (wolf2,0,0)
set npc position (wolf3,0,0)
wait(30)
textout(3)
advance text box
wait(1)
reset palette
update palette
resume player
end

#########################
script, new game 3, begin
suspend player
set hero frame(0,0)
set npc position (npc at spot(26,52),0,0)
set npc position (npc at spot(26,53),0,0)

alter npc (32,NPCstat:script,19)

variable(wolf1)
variable(wolf2)
variable(wolf3)
set variable(wolf1,npc at spot(33,54))
set variable(wolf2,npc at spot(29,57))
set variable(wolf3,npc at spot(32,53))

textout(1)

wait(10)
set npc direction (wolf1,down)
wait(4)
walk npc (wolf1,right,4)
set npc direction (wolf2,right)
wait(4)
walk npc (wolf2,down,4)
set npc direction (wolf3,down)
wait(4)
walk npc (wolf3,right,4)
show text box (51)
wait (10)
textin(3)
wait(40)
wait for npc (wolf3)
set npc position (wolf1,0,0)
set npc position (wolf2,0,0)
set npc position (wolf3,0,0)
textout(3)
advance text box
show text box (7979)
wait (10)
textin(3)
wait(40)
textout(3)
advance text box
wait(1)
reset palette
update palette
resume player
end

#########################
script, new game 4, begin
suspend player
set hero frame(0,0)
set npc position (npc at spot(48,75),0,0)
set npc position (npc at spot(49,75),0,0)
set npc position (npc at spot(57,67),0,0)
set npc position (npc at spot(57,68),0,0)
alter npc (32,NPCstat:script,20)

variable(wolf1)
variable(wolf2)
variable(wolf3)
variable(wolf4)
set variable(wolf1,npc at spot(48,79))
set variable(wolf2,npc at spot(50,78))
set variable(wolf3,npc at spot(62,66))
set variable(wolf4,npc at spot(63,68))

textout(1)
wait(10)
set npc direction(wolf3,down)
set npc direction(wolf2,left)
wait(4)
walk npc(wolf3,right,4)
set npc direction(wolf4,down)
walk npc(wolf2,down,2)
wait(4)
walk npc(wolf4,right,4)
show text box (52)
wait (10)
textin(3)
wait for npc(wolf2)
walk npc(wolf2,right,4)
wait(4)
walk npc(wolf1,right,5)
#wait(40)
wait for npc(wolf2)
walk npc(wolf2,down,4)
textout(3)
advance text box
wait for npc(wolf1)
walk npc(wolf1,down,4)
show text box(53)
wait(10)
textin(3)
wait(30)
textout(3)
advance text box
wait(1)
reset palette
update palette
wait for npc(wolf1)
set npc position (wolf1,0,0)
set npc position (wolf2,0,0)
set npc position (wolf3,0,0)
set npc position (wolf4,0,0)
resume player
end

########################
script,fireflyhide,begin
set tag(16,1)
alter npc (29,NPCstat:picture,0)
end

########################
script,fireflyback,begin
set tag(16,0)
alter npc (29,NPCstat:picture,103)
end

#########################
script, new game 5, begin
suspend player
suspend obstruction
set hero frame(0,0)
set tag(8,1)
set npc position (npc at spot(68,77),0,0)
set npc position (npc at spot(69,77),0,0)
set npc position (npc at spot(70,77),0,0)
set npc position (npc at spot(65,80),0,0)
set npc position (npc at spot(65,81),0,0)
set npc position (npc at spot(65,82),0,0)

variable(wolf1)
variable(wolf2)
variable(wolf3)
variable(wolf4)
set variable(wolf1,npc at spot(76,79))
set variable(wolf2,npc at spot(78,79))
set variable(wolf3,npc at spot(77,80))
set variable(wolf4,npc at spot(78,80))

if (hero y(0)>>79) then(
walk hero to x(0,70)
wait for hero(0)
walk hero to y(0,80)
wait for hero(0)
)
else(
walk hero to y(0,80)
wait for hero(0)
walk hero to x(0,70)
wait for hero(0)
)
set hero direction (0,right)
set hero frame (0,0)
wait(40)
walk npc (33,left,1)
wait for npc(33)
wait(4)
alter npc(33,NPCstat:move speed,10)
walk npc (33,left,4)
wait for npc (33)

show backdrop(1)
stop song
set hero picture(0,105)
set npc direction(26,down)
alter npc(33,NPCstat:picture,107)
wait(1)
show map
wait(15)

alter npc(33,NPCstat:move speed,2)
walk npc (33,left,1)
walk npc (31,left,1)
wait for npc (33)
alter npc(33,NPCstat:picture,105)
walk npc (33,left,2)
walk npc (31,left,2)
walk npc (30,left,2)
set npc direction(31,down)
wait for npc(33)
set npc position(33,0,0)
set npc position(31,0,0)
set npc position(30,0,0)
wait(40)

set npc direction(wolf1,down)
set npc direction(wolf4,down)
wait(4)
set npc direction(wolf2,down)
set npc direction(wolf3,down)
walk npc (wolf1,right,4)
walk npc (wolf4,right,3)
wait(4)
walk npc (wolf2,right,3)
walk npc (wolf3,right,3)
wait for npc (wolf1)

set hero picture(0,106)
alter npc(26,NPCstat:picture,106)
wait(2)
set hero picture(0,107)
alter npc(26,NPCstat:picture,107)
wait(2)
set hero picture(0,108)
set npc position(26,0,0)
wait(6)
set hero direction(0,up)
wait(2)
set hero picture(0,107)
wait(2)
set hero picture(0,98)
set hero direction(0,right)
wait(15)
pan camera (down,0,0)
walk hero (0,right,9)
#wait for hero(0)

tweak palette(-1,-1,-1)
tweak palette(0,1,0)
update palette
wait(10)
reset palette
tweak palette(-2,-2,-2)
tweak palette(0,3,0)
update palette
wait(10)
reset palette
tweak palette(-3,-3,-3)
tweak palette(0,5,0)
update palette
wait(10)
reset palette
tweak palette(-4,-4,-4)
tweak palette(0,6,0)
update palette
text out(1)
wait(10)
show text box (54)
wait(10)
textin(3)
wait(40)
wait(10)
reset palette
tweak palette(-3,-3,-3)
tweak palette(0,5,0)
update palette
wait(10)
reset palette
tweak palette(-2,-2,-2)
tweak palette(0,3,0)
update palette
wait(10)
reset palette
tweak palette(-1,-1,-1)
tweak palette(0,1,0)
update palette
wait(10)
reset palette
update palette
wait(10)
textout(3)
advance text box
wait(20)
palout(20)
camera follows hero(0)
teleport to map(3,11,17)
stop song
write pass block(51,10,1+2+4+8)
write pass block(53,6,1+2+4+8)
pan camera(right,9,20)
wait for camera
palin(20)
wait(10)
walk hero(0,right,9)
wait for hero(0)
set hero frame (0,0)
camera follows hero(0)
set tag(8,0)
set tag(40,1)
resume obstruction
resume player
end

#####################
script,newgame6,begin
suspend player
walk hero (0,down,1)
wait for hero(0)
walk hero to x(0,94)
wait for hero(0)
set hero direction (0,up)
set hero frame(0,0)
pan camera(up,4,2)
wait for camera
wait(30)
set npc position (npc at spot(94,13),0,0)
walk hero (0,up,3)
wait for hero(0)
set hero position (0,0,0)
wait(20)
palout(20)
teleport to map(93,0,0)
set hero picture(0,0)
camera follows npc(33)
set hero position (0,npcx(33),npcy(33))
wait(1)
pan camera (down,0,0)
greyscale palette
update palette
wait(30)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (20)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (20)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (20)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (20)
reset palette
greyscale palette
update palette

wait(20)
fade screen out(63,63,63)
reset palette
fade screen in
play song(33)
wait(10)
jig npc(33)
#wait(2)
jig npc(33)
resume box advance
show text box(55)
wait for text box

variable(dir)
variable(dis)
set tag (8,1)
wait (1)
set variable (dir,random(10,13))
if (dir==10) then(
set variable(dir,north) set variable(dis,6))
if(dir==11) then(
set variable(dir,south) set variable(dis,6))
if (dir==12) then(
set variable(dir,east) set variable(dis,9))
if (dir==13) then(
set variable(dir,west) set variable(dis,9))

walk npc(33,dir,dis)
show text box(56)
wait for npc(33)

if(dir==north) then(set npc position(33,npcx(33),npcy(33)--6))
if(dir==south) then(set npc position(33,npcx(33),npcy(33)+6))
if(dir==east) then(set npc position(33,npcx(33)+9,npcy(33)))
if(dir==west) then(set npc position(33,npcx(33)--9,npcy(33)))

set npc direction(33,down)
wait for text box
set tag(8,0)
set hero speed(0,20)
resume player
end

#########################
script, new game 7, begin
suspend player
set tag (8,1)

if (herox(0)==10,and,heroy(0)==6) then(
pan camera(right,18,20)
walk hero (0,right,17)
wait for camera
wait for hero (0))
else(
if (herox(0)==9,and,heroy(0)==7) then(
pan camera(down,12,20)
walk hero (0,down,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==26,and,heroy(0)==6) then(
pan camera(left,18,20)
walk hero (0,left,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==27,and,heroy(0)==7) then(
pan camera(down,12,20)
walk hero (0,down,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==28,and,heroy(0)==6) then(
pan camera(right,18,20)
walk hero (0,right,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==44,and,heroy(0)==6) then(
pan camera(left,18,20)
walk hero (0,left,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==45,and,heroy(0)==7) then(
pan camera(down,12,20)
walk hero (0,down,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==9,and,heroy(0)==17) then(
pan camera(up,12,20)
walk hero (0,up,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==10,and,heroy(0)==18) then(
pan camera(right,18,20)
walk hero (0,right,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==9,and,heroy(0)==19) then(
pan camera(down,12,20)
walk hero (0,down,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==27,and,heroy(0)==17) then(
pan camera(up,12,20)
walk hero (0,up,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==28,and,heroy(0)==18) then(
pan camera(right,18,20)
walk hero (0,right,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==27,and,heroy(0)==19) then(
pan camera(down,12,20)
walk hero (0,down,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==26,and,heroy(0)==18) then(
pan camera(left,18,20)
walk hero (0,left,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==45,and,heroy(0)==17) then(
pan camera(up,12,20)
walk hero (0,up,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==44,and,heroy(0)==18) then(
pan camera(left,18,20)
walk hero (0,left,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==45,and,heroy(0)==19) then(
pan camera(down,12,20)
walk hero (0,down,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==9,and,heroy(0)==29) then(
pan camera(up,12,20)
walk hero (0,up,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==10,and,heroy(0)==30) then(
pan camera(right,18,20)
walk hero (0,right,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==26,and,heroy(0)==30) then(
pan camera(left,18,20)
walk hero (0,left,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==27,and,heroy(0)==29) then(
pan camera(up,12,20)
walk hero (0,up,11)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==28,and,heroy(0)==30) then(
pan camera(right,18,20)
walk hero (0,right,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==44,and,heroy(0)==30) then(
pan camera(left,18,20)
walk hero (0,left,17)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==45,and,heroy(0)==29) then(
pan camera(up,12,20)
walk hero (0,up,11)
wait for camera
wait for hero (0))
)

if (herox(0)==npcx(33),and,heroy(0)==npcy(33)) then(
variable(dir)
variable(dis)
set variable (dir,random(10,13))
if (dir==10) then(set variable (dir,up) set variable(dis,6)
 if (npcy(33)<<7) then(set variable (dir,down)))
if (dir==11) then(set variable (dir,down) set variable(dis,6)
 if (npcy(33)>>29) then(set variable (dir,up)))
if (dir==12) then(set variable (dir,left) set variable(dis,9)
 if (npcx(33)<<10) then(set variable (dir,right)))
if (dir==13) then(set variable (dir,right) set variable(dis,9)
 if (npcx(33)>>44) then(set variable (dir,left)))

alter npc (34,npcstat:movespeed,20)
walk npc(34,down,1)
wait for npc(34)

if (npcy(34)==1) then(
walk npc (33,dir,dis)
show text box(57)
wait for npc(33)
if(dir==north) then(set npc position(33,npcx(33),npcy(33)--6))
if(dir==south) then(set npc position(33,npcx(33),npcy(33)+6))
if(dir==east) then(set npc position(33,npcx(33)+9,npcy(33)))
if(dir==west) then(set npc position(33,npcx(33)--9,npcy(33)))
set npc direction(33,down)
wait for text box
)
if (npcy(34)==2) then(
walk npc (33,dir,dis)
show text box(56)
wait for npc(33)
if(dir==north) then(set npc position(33,npcx(33),npcy(33)--6))
if(dir==south) then(set npc position(33,npcx(33),npcy(33)+6))
if(dir==east) then(set npc position(33,npcx(33)+9,npcy(33)))
if(dir==west) then(set npc position(33,npcx(33)--9,npcy(33)))
set npc direction(33,down)
wait for text box
)
if (npcy(34)==3) then(
walk npc (33,dir,dis)
show text box(58)
wait for npc(33)
if(dir==north) then(set npc position(33,npcx(33),npcy(33)--6))
if(dir==south) then(set npc position(33,npcx(33),npcy(33)+6))
if(dir==east) then(set npc position(33,npcx(33)+9,npcy(33)))
if(dir==west) then(set npc position(33,npcx(33)--9,npcy(33)))
set npc direction(33,down)
wait for text box
)
if (npcy(34)==4) then(
walk npc (33,dir,dis)
show text box(59)
wait for npc(33)
if(dir==north) then(set npc position(33,npcx(33),npcy(33)--6))
if(dir==south) then(set npc position(33,npcx(33),npcy(33)+6))
if(dir==east) then(set npc position(33,npcx(33)+9,npcy(33)))
if(dir==west) then(set npc position(33,npcx(33)--9,npcy(33)))
alter npc(33,NPCStat:Picture,0)
set npc direction(33,down)
wait for text box
)
if (npcy(34)==5) then(
tb(60)
alter npc (34,npcstat:movespeed,20)
walk npc(34,down,2)
wait for npc(34)
))

if (herox(0)<>npcx(33),or,heroy(0)<>npcy(33),and,npcy(34)>>5) then(
alter npc(33,NPCStat:Picture,101)

walk npc to x(33,herox(0))
wait for npc(33)
walk npc to y(33,heroy(0))
wait for npc(33)
set npc direction (33,down)
set npc frame(33,0)
jig npc(33)
show text box(61)
wait for text box

variable(i)
for (i,0,2,1) do(
tweak palette(0,0,10)
update palette
wait(6)
reset palette
tweak palette(0,0,30)
update palette
wait(3)
reset palette
tweak palette(0,0,20)
update palette
wait(8)
reset palette
tweak palette(0,0,40)
update palette
wait(4)
)

if (npcx(33)<<10) then(
set npc position (34,npcx(33)+9,npcy(33))
alter npc (34,npcstat:movespeed,4)
walk npc (34,left,7)
wait for npc(34)
set npc direction(34,down)
set npc frame(34,0))

if (npcx(33)>>44) then(
set npc position (34,npcx(33)--9,npcy(33))
alter npc (34,npcstat:movespeed,4)
walk npc (34,right,7)
wait for npc(34)
set npc direction(34,down)
set npc frame(34,0))

if (npcx(33)>>10,and,npcx(33)<<44) then(
set npc position (34,npcx(33)--9,npcy(33))
alter npc (34,npcstat:movespeed,4)
walk npc (34,right,7)
wait for npc(34)
set npc direction(34,down)
set npc frame(34,0))
jig npc(34)
tb(62)

jig npc(33)
tb(63)

if (npcx(33)<<npcx(34)) then(set npc direction(34,left))
else(set npc direction(34,right))
jig npc(34)
tb(64)

if (npcx(33)<<npcx(34)) then(set npc direction(33,right))
else(set npc direction(33,left))
jig npc(33)
tb(65)

set npc direction(33,down)
jig npc(33)
tb(66)

if (check tag(17)) then(
set variable(jadecounter,15)
set variable(jadecounter2,60)
pan camera (up,1,5)
wait for camera
pan camera (down,2,10)
wait for camera
pan camera (up,2,10)
wait for camera
pan camera (down,1,5)
wait for camera
reset palette
tweak palette(0,0,35)
update palette
wait(4)
reset palette
tweak palette(0,0,30)
update palette
wait(4)
reset palette
tweak palette(0,0,25)
update palette
wait(4)
if (npcx(33)<<npcx(34)) then(set npc direction(33,right))
else(set npc direction(33,left))
jig npc(33)
tb(67)
)

else(
set variable(jadecounter,10)
set variable(jadecounter2,40)
pan camera (left,1,5)
wait for camera
pan camera (right,2,10)
wait for camera
pan camera (left,2,10)
wait for camera
pan camera (right,1,5)
wait for camera
reset palette
tweak palette(0,4,30)
update palette
wait(4)
reset palette
tweak palette(0,8,20)
update palette
wait(4)
reset palette
tweak palette(0,12,10)
update palette
wait(4)
reset palette
tweak palette(0,16,0)
update palette
wait(4)
if (npcx(33)<<npcx(34)) then(set npc direction(34,left))
else(set npc direction(34,right))
jig npc(34)
tb(68)
)

if (npcx(33)<<npcx(34)) then(set npc direction(34,left))
else(set npc direction(34,right))
jig npc(34)
tb(69)

if (npcx(33)<<npcx(34)) then(set npc direction(33,right))
else(set npc direction(33,left))
jig npc(33)
tb(70)

jig npc(34)
tb(71)
tb(72)
tb(73)
jig npc(33)
tb(74)
set npc direction(34,down)
jig npc(34)
show text box (75)
set npc direction(33,down)
wait for text box

if (check tag(18)) then(
set variable(jadestep,1)
set variable(jadecounter,jadecounter+5)
set variable(jadecounter2,jadecounter*4)
fade screen out(0,63,0)
reset palette
fade screen in
if (npcy(33)<<7) then(walk npc (33,down,7))
else(walk npc(33,up,7))
wait for npc (33)
jig npc(34)
tb(76)
)

else(
set variable(jadestep,1)
set variable(jadecounter,jadecounter+10)
set variable(jadecounter2,jadecounter*4)
fade screen out(63,63,63)
reset palette
fade screen in
jig npc(33)
tb(77)
alter npc(33,npcstat:movespeed,4)
if (npcy(33)<<7) then(walk npc (33,down,7))
else(walk npc(33,up,7))
wait for npc (33)
)

if (npcx(34)<<npcx(33)) then(walk npc(34,right,2))
else(walk npc(34,left,2))
wait for npc(34)
set npc direction(34,down)
set npc frame(34,0)

jig npc(34)
tb(78)
wait(5)
tb(79)
wait(15)
jig npc(34)
suspend box advance
show text box(80)
wait for key(use key)
palout(20)
advance text box
camera follows hero(0)
wait(1)
teleport to map(0,0,0)
wait(5)
show text box(597)
wait(10)
palin(3)
wait for key(use key)
palout(3)
advance text box
resume box advance
wait(20)
teleport to map(97,0,0)
stop song
set hero position(0,6,40)
write pass block(5,40,128)
wait(1)
pan camera(up,0,0)
wait(1)
set hero picture(0,98)
set hero position(0,5,40)
set hero speed(0,hspeed)
set hero palette(findhero(0),2)
set hero palette(findhero(0),2,inside battle)
set variable(currenttime,afternoontime)
set hero direction(0,down)
wait(10)
palin(20)
set npc position(4,1,39)
suspend npcs
suspend obstruction
walk npc(4,up,3)
wait for npc(4)
walk npc(4,right,3)
wait for npc(4)
walk npc(4,down,2)
wait for npc(4)
wait(20)
walk npc(4,down,2)
wait for npc(4)
tweak palette(63,63,63)
update palette
set hero direction(0,right)
set hero picture(0,105)
set hero position(0,6,40)
alter npc(4,NPCstat:picture,23)
write pass block(5,40,15)
wait(1)
reset palette
update palette
wait(10)
alter npc(4,NPCstat:move speed,10)
alter npc(4,NPCstat:picture,22)
walk npc(4,up,4)
wait(4)
set hero picture(0,98)
set hero frame(0,0)
wait for npc(4)
walk npc(4,left,3)
wait for npc(4)
walk npc(4,down,3)
wait for npc(4)
set npc position(4,0,34)
camera follows hero(0)
resume obstruction
resume npcs
)

set tag (8,0)
resume player
end


######################
script,over game,begin
suspend player
suspend npcs
suspend box advance

play song(8)

#The Valorians are destined to lose!
if(current map==98,and,check tag(560)) then(
alter npc(19,NPCstat:picture,113)
alter npc(19,NPCstat:palette,70)
)

	variable(i)
	for (i,1,5,1) do(
		show backdrop(1)
		wait(1)
		show map
		wait(1)
	)
	fade screen out(63,0,0)
	show backdrop(1)
	show text box(421)
	wait(1)
	fade screen in
	for (i,1,10,1) do(
		write color(15,1,0)
		write color(15,2,0)
		update palette
		wait(1)
		write color(15,1,63)
		write color(15,2,63)
		update palette
		wait(1)
	)
	wait(20)
	#fade screen out

for(i,1,12,1) do(
tweak palette(-1*(i^2),-1*(i^2),-1*(i^2))
write color(15,0,63)
write color(15,1,63)
write color(15,2,63)
update palette
wait(1)
)

	show backdrop(2)
	wait(1)
	#fade screen in

for(i,12,1,1) do(
reset palette
tweak palette(-1*(i^2),-1*(i^2),-1*(i^2))
write color(15,0,63)
write color(15,1,63)
write color(15,2,63)
update palette
wait(1)
)
reset palette
update palette

	game over
end

script, zelda scroll, begin
	suspend player # don't let the player screw this up!

	variable (scrollnpc) # for changing the NPC used

	scrollnpc := 0    # scroll npc is NPC 0, change to suit needs
	if(herodirection(me) == up, or, herodirection(me) == down)
		then, begin
			pancamera(herodirection(me),12,10) # pan camera 12 tiles up or down!
		end

	if(herodirection(me) == left, or, herodirection(me) == right)
		then, begin
			pancamera(herodirection(me),18,10) # pan camera 19 right or left!
		end


	variable (tempx) # Magical NPC Locator Variables (tm)
	variable (tempy)
	
	tempx := herox(me) # MNL Variables are set to the hero's current position
	tempy := heroy(me)

	
	# these IFs set the "npc locator" variables one ahead of the hero
      # so it doesn't "find" the npc the hero is standing on
	
	if(herodirection(me) == up) then ( tempy := tempy -- 1 )
	if(herodirection(me) == down) then ( tempy := tempy + 1 )
	if(herodirection(me) == left) then ( tempx := tempx -- 1 )
	if(herodirection(me) == right) then ( tempx := tempx + 1 )


	while(npcatspot(tempx,tempy) == false) # time to search for that NPC
		do, begin
			# Yes, I used the same ifs again.
			# Re-usable code: Hey, it worked for Windows! (tm)
			
	            if(herodirection(me) == up) then ( tempy := tempy -- 1 )
            	if(herodirection(me) == down) then ( tempy := tempy + 1 )
            	if(herodirection(me) == left) then ( tempx := tempx -- 1 )
            	if(herodirection(me) == right) then ( tempx := tempx + 1 )
		end

	variable (npctodelete)
	npctodelete := npcatspot(tempx,tempy)

	destroynpc(npctodelete) #destroys NPC ahead of Dogero
	

	# I could have even used the above IFs -again- here, but for
	# some reason it looks better this way.
	# The below code walks Dogero (or the hero) in the direction needed,
	# and then walks them one more step in that direction so I
	# can re-create the NPC in it's old spot
	
	if(herodirection(me) == up, or, herodirection(me) == down)
		then, begin
			walkherotoy(me,tempy)
			waitforhero
			if(herodirection(me) == up) then ( walkhero(me,up,1) , waitforhero)
			if(herodirection(me) == down) then ( walkhero(me,down,1) , waitforhero)					
		end

	if(herodirection(me) == left, or, herodirection(me) == right)
		then, begin
			walkherotox(me,tempx)
			waitforhero
			if(herodirection(me) == left) then ( walkhero(me,left,1) , waitforhero)
			if(herodirection(me) == right) then ( walkhero(me,right,1) , waitforhero)					
		end

	walknpc


	createnpc(scrollnpc,tempx,tempy)  # re-creates deleted NPC

	resumeplayer #returns control of game to player after all of this scripting! Phew.
end # end of script

script, gen footprints,tile,length,begin
       showvalue(tile)
	 showvalue(length)
end

script, poff, begin
 variable (paletteoffset)
 if (check tag (3)==true) then(
  set variable (paletteoffset,3))
 else(
 if (check tag (4)==true) then(
  set variable (paletteoffset,0))
 )
do(
 if (check tag (5)==true) then(
  set variable (paletteoffset,1))
 )
do(
 if (check tag (6)==true) then(
  set variable (paletteoffset,2))
 )
return (paletteoffset)
end

script, jig gahn, begin
tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,3,0)
update palette
wait (1)
tweak palette (0,5,0)
update palette
reset palette
wait (1)
tweak palette (0,3,0)
update palette
reset palette
wait (1)
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette
end

##########################
script, fralin door, begin
suspend player
set tag (8,1)

fralindoor1
fralindoor2
fralindoor3
fralindoor4
fralindoor5

set hero frame(0,0)
set tag (8,0)
resume player
end
###
##########################
script, fralindoor1, begin
if (herox(0)==59,and,heroy(0)==10) then(
set hero speed (0,10)
pan camera (right,18,20)
walk hero (0,right,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
else(
if (herox(0)==59,and,heroy(0)==11) then(
set hero speed (0,10)
pan camera (right,18,20)
walk hero (0,right,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==76,and,heroy(0)==10) then(
set hero speed (0,10)
pan camera (left,18,20)
walk hero (0,left,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==76,and,heroy(0)==11) then(
set hero speed (0,10)
pan camera (left,18,20)
walk hero (0,left,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==94,and,heroy(0)==26) then(
set hero speed (0,10)
pan camera (down,9,20)
walk hero (0,down,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==94,and,heroy(0)==34) then(
set hero speed (0,10)
pan camera (up,9,20)
walk hero (0,up,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==92,and,heroy(0)==63) then(

if(check tag(204),and,check tag(277)==false,and,check tag(278)==false) then(dackenmorph)
else(
set hero speed (0,10)
pan camera (down,27,20)
walk hero (0,down,7)
wait for hero(0)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(currentmap+8,54,10)
wait(1)
pan camera(south,0,0)
set hero position(0,54,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))

)
)
do(
if (herox(0)==93,and,heroy(0)==63) then(

if(check tag(204),and,check tag(277)==false,and,check tag(278)==false) then(dackenmorph)
else(
set hero speed (0,10)
pan camera (down,27,20)
walk hero (0,down,7)
wait for hero(0)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(currentmap+8,55,10)
wait(1)
pan camera(south,0,0)
set hero position(0,55,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))

)
)
do(
if (herox(0)==94,and,heroy(0)==63) then(

if(check tag(204),and,check tag(277)==false,and,check tag(278)==false) then(dackenmorph)
else(
set hero speed (0,10)
pan camera (down,27,20)
walk hero (0,down,7)
wait for hero(0)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(currentmap+8,56,10)
wait(1)
pan camera(south,0,0)
set hero position(0,56,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))

)
)
end
###
##########################
script, fralindoor2, begin
if (herox(0)==19,and,heroy(0)==16) then(

if(check tag(296)) then(
pan camera (south,0,0)
walk hero (0,left,5)
wait(3)
palout(3)
wait for hero (0)
camera follows hero(0)
teleport to map (currentmap+80,77,79)
wait(1)
pan camera(south,0,0)
set hero position(0,82,79)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
wait for hero(0)
wait(2)
set hero direction(0,down)
wait(2)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
	if(rank in caterpillar(find hero(0))<>-1) then(
	set party out
	swap by position(find hero(0),0)
	tb(6646)
	set party in)
)

)
else(
if (herox(0)==19,and,heroy(0)==17) then(

if(check tag(296)) then(
pan camera (south,0,0)
walk hero (0,left,5)
wait(3)
palout(3)
wait for hero (0)
camera follows hero(0)
teleport to map (currentmap+80,77,80)
wait(1)
pan camera(south,0,0)
set hero position(0,82,80)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
wait for hero(0)
wait(2)
set hero direction(0,down)
wait(2)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
	if(rank in caterpillar(find hero(0))<>-1) then(
	set party out
	swap by position(find hero(0),0)
	tb(6646)
	set party in)
)

)
)
do(
if (herox(0)==127,and,(heroy(0)==52,or,heroy(0)==53)) then(
set hero speed (0,10)
pan camera (right,17,20)
walk hero (0,right,17)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==143,and,(heroy(0)==52,or,heroy(0)==53)) then(
set hero speed (0,10)
pan camera (left,17,20)
walk hero (0,left,17)
wait for hero (0)
set hero speed(0,hspeed)
camera follows hero)
)
do(
if (herox(0)==43,and,heroy(0)==67) then(
set hero speed (0,10)
pan camera (up,9,20)
walk hero (0,up,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==43,and,heroy(0)==59) then(
set hero speed (0,10)
pan camera (down,9,20)
walk hero (0,down,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==115,and,heroy(0)==36) then(
pan camera(south,0,0)
walk hero(0,up,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
set hero position(0,162,88)
wait(1)
pan camera(south,0,0)
set hero position(0,162,93)
wait(1)
walk hero(0,up,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==162,and,heroy(0)==89) then(
pan camera(south,0,0)
walk hero(0,down,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
set hero position(0,115,37)
wait(1)
pan camera(south,0,0)
set hero position(0,115,32)
wait(1)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
end
###
##########################
script, fralindoor3, begin
if (herox(0)==137,and,heroy(0)==8) then(
pan camera(south,0,0)
walk hero(0,left,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map (currentmap+8,141,34)
wait(1)
pan camera(south,0,0)
set hero position(0,146,34)
wait(1)
walk hero(0,left,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if (herox(0)==137,and,heroy(0)==9) then(
pan camera(south,0,0)
walk hero(0,left,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map (currentmap+8,141,35)
wait(1)
pan camera(south,0,0)
set hero position(0,146,35)
wait(1)
walk hero(0,left,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==125,and,heroy(0)==80) then(

if(check tag(244),and,check tag(245)==false) then(forestpasswobbler)
else(
pan camera(south,0,0)
walk hero(0,left,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map (currentmap+8,156,98)
wait(1)
pan camera(south,0,0)
set hero position(0,161,98)
wait(1)
walk hero(0,left,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0)
)

)
)
do(
if (herox(0)==125,and,heroy(0)==81) then(

if(check tag(244),and,check tag(245)==false) then(forestpasswobbler)
else(
pan camera(south,0,0)
walk hero(0,left,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map (currentmap+8,156,99)
wait(1)
pan camera(south,0,0)
set hero position(0,161,99)
wait(1)
walk hero(0,left,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0)
)

)
)
do(
if (herox(0)==61,and,heroy(0)==80) then(
pan camera(south,0,0)
walk hero(0,right,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map (currentmap+8,17,123)
wait(1)
pan camera(south,0,0)
set hero position(0,12,123)
wait(1)
walk hero(0,right,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==61,and,heroy(0)==81) then(
pan camera(south,0,0)
walk hero(0,right,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map (currentmap+8,17,124)
wait(1)
pan camera(south,0,0)
set hero position(0,12,124)
wait(1)
walk hero(0,right,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
end
###
##########################
script, fralindoor4, begin
if (herox(0)==12,and,heroy(0)==80) then(

if(check tag(205)==false) then(
pan camera(south,0,0)
walk hero(0,left,5)
wait(5)
palout(5)
wait for hero(0)
camera follows hero(0)
teleport to map (66,86,211)
set pal(night)
wait(1)
pan camera(right,10,20)
wait for camera
pan camera(left,15,10)
wait(5)
walk hero(0,left,5)
palin(5)
wait for camera
if(check tag(207)) then(set npc position(4,0,0))
wait for hero(0)
camera follows hero)
else(meetskyler)

)
else(
if (herox(0)==12,and,heroy(0)==81) then(

if(check tag(205)==false) then(
pan camera(south,0,0)
walk hero(0,left,5)
wait(5)
palout(5)
wait for hero(0)
camera follows hero(0)
teleport to map (66,86,212)
set pal(night)
wait(1)
pan camera(right,10,20)
wait for camera
pan camera(left,15,10)
wait(5)
walk hero(0,left,5)
palin(5)
wait for camera
if(check tag(207)) then(set npc position(4,0,0))
wait for hero(0)
camera follows hero)
else(meetskyler)

)
)
do(
if (herox(0)==162,and,heroy(0)==77) then(
	if(check tag(204)) then(
	palout(1)
	teleport to map(currentmap+4,5,239)
	wait(1)
	palin(1)
	)
	else(
	walk hero(0,down,1)
	set hero direction(0,up)
	show text box(84)
	wait for hero(0)
	wait for text box
	)
)
)
do(
if (herox(0)==107,and,heroy(0)==40,and,check tag(285)==false) then(
fralinmanx)
)
do(
if(herox(0)==57,and,heroy(0)==36,and,check tag(294)==false,and,check tag(246)==false) then(
badadvice2)
)
do(
if(herox(0)==162,and,heroy(0)==56) then(
palout(2)
teleport to map(69,3,6)
wait(1)
pan camera(south,0,0)
set hero position(0,3,8)
set pal(noon)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0)
)
)
do(
if(herox(0)==99,and,heroy(0)==6,and,check tag(651)==false) then(
	set tag(651,1)
	get item(3,1)
	tb(7828)
)
)
end
###
##########################
script, fralindoor5, begin
if (herox(0)==51,and,heroy(0)==10) then(
palout(1)
teleport to map (currentmap+4,6,7)
palin(1))
else(
if (herox(0)==94,and,heroy(0)==13) then(
palout(1)
teleport to map (currentmap+4,5,25)
palin(1))
)
do(
if (herox(0)==87,and,heroy(0)==42) then(
palout(1)
teleport to map (currentmap+4,7,60)
palin(1))
)
do(
if (herox(0)==85,and,heroy(0)==56) then(
palout(1)
teleport to map (currentmap+4,11,80)
palin(1))
)
do(
if (herox(0)==104,and,heroy(0)==54) then(
palout(1)
teleport to map (currentmap+4,9,101)
palin(1))
)
do(
if (herox(0)==105,and,heroy(0)==54) then(
palout(1)
teleport to map (currentmap+4,10,101)
palin(1))
)
do(
if (herox(0)==107,and,heroy(0)==40) then(
palout(1)
teleport to map (currentmap+4,3,118)
palin(1))
)
do(
if (herox(0)==122,and,heroy(0)==58) then(
palout(1)
teleport to map (currentmap+4,3,135)
palin(1))
)
do(
if (herox(0)==112,and,heroy(0)==64) then(
palout(1)
teleport to map (currentmap+4,3,153)
palin(1))
)
do(
if (herox(0)==159,and,heroy(0)==21) then(
palout(1)
teleport to map (currentmap+4,3,170)
palin(1))
)
do(
if (herox(0)==133,and,heroy(0)==79) then(
palout(1)
teleport to map (currentmap+4,4,187)
palin(1))
)
do(
if (herox(0)==57,and,heroy(0)==36) then(
palout(1)
teleport to map (currentmap+4,3,204)
palin(1))
)
do(
if (herox(0)==25,and,heroy(0)==79) then(
palout(1)
teleport to map (currentmap+4,3,221)
palin(1))
)
do(
#farmer's house, 6 gold
if(herox(0)==53,and,heroy(0)==6,and,check tag(718)==false) then(
	set tag(718,1)
	get money(6)
	tb(8272)
)
)
do(
#grin house, 1 Up+
if(herox(0)==27,and,heroy(0)==74,and,check tag(719)==false) then(
	set tag(719,1)
	get item(56,1)
	tb(8273)
)
)
do(
#butter house, 2 HP
if(herox(0)==82,and,heroy(0)==35,and,check tag(720)==false) then(
	set tag(720,1)
	get item(50,2)
	tb(8274)
)
)
do(
#bar, 9 gold
if(herox(0)==81,and,heroy(0)==49,and,check tag(721)==false) then(
	set tag(721,1)
	get money(9)
	tb(8275)
)
)
do(
#manx's house, 1 HP+
if(herox(0)==109,and,heroy(0)==35,and,check tag(722)==false) then(
	set tag(722,1)
	get item(51,1)
	tb(8276)
)
)
do(
#graveyard, 3 HP
if(herox(0)==164,and,heroy(0)==16,and,check tag(723)==false) then(
	set tag(723,1)
	get item(50,3)
	tb(8277)
)
)

end
###

#################################
script, fralin indoor door, begin
suspend player
set tag (8,1)

fralinindoordoor1
fralinindoordoor2

set hero frame(0,0)
set tag (8,0)
resume player
end
###
################################
script, fralinindoordoor1, begin
if (herox(0)==6,and,heroy(0)==20) then(
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,1,36)
wait(1)
pan camera(south,0,0)
set hero position(0,1,39)
wait(1)
palin(2)
walk hero(0,up,3)
wait for hero(0)
camera follows hero(0))
else(
if (herox(0)==1,and,heroy(0)==37) then(
pan camera(south,0,0)
walk hero(0,down,2)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,6,21)
wait(1)
pan camera(south,0,0)
set hero position(0,6,17)
wait(1)
palin(2)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0))
)
do(
if(check tag(267),and,check tag(270)==false,and,check tag(6)==false,and,herox(0)==3,and,heroy(0)==154) then(
)
)
do(
if (herox(0)==1,and,heroy(0)==234) then(
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,1,252)
wait(1)
pan camera(south,0,0)
set hero position(0,1,254)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==1,and,heroy(0)==253) then(

if(check tag(278),and,check tag(279)==false) then(dackenmorph)
else(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,1,235)
wait(1)
pan camera(south,0,0)
set hero position(0,1,231)
wait(1)
palin(2)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0))

)
)
do(
if (herox(0)==3,and,heroy(0)==119,and,check tag(45),and,check tag(285)==false) then(fralinmanx)
)
end
###
################################
script, fralinindoordoor2, begin
if (herox(0)==6,and,heroy(0)==8) then(
palout(1)
teleport to map (currentmap--4,51,11)
palin(1))
else(
if (herox(0)==5,and,heroy(0)==26) then(
palout(1)
teleport to map (currentmap--4,94,14)
palin(1))
)
do(
if (herox(0)==7,and,heroy(0)==61) then(
palout(1)
teleport to map (currentmap--4,87,43)
palin(1))
)
do(
if (herox(0)==11,and,heroy(0)==81) then(
palout(1)
teleport to map (currentmap--4,85,57)
palin(1))
)
do(
if (herox(0)==9,and,heroy(0)==102) then(
palout(1)
teleport to map (currentmap--4,104,55)
palin(1))
)
do(
if (herox(0)==10,and,heroy(0)==102) then(
palout(1)
teleport to map (currentmap--4,105,55)
palin(1))
)
do(
if (herox(0)==3,and,heroy(0)==119) then(
palout(1)
camera follows hero(0)
teleport to map (currentmap--4,107,41)
palin(1))
)
do(
if (herox(0)==3,and,heroy(0)==136) then(
palout(1)
teleport to map (currentmap--4,122,59)
palin(1))
)
do(
if (herox(0)==3,and,heroy(0)==154) then(
	if(check tag(267),and,check tag(270)==false,and,check tag(6)==false,and,check tag(297)==false) then( thiefgetaway )
	else(
		palout(1)
		teleport to map (currentmap--4,112,65)
		palin(1)
	)
)
)
do(
if (herox(0)==3,and,heroy(0)==171) then(
palout(1)
teleport to map (currentmap--4,159,22)
palin(1))
)
do(
if (herox(0)==4,and,heroy(0)==188) then(
palout(1)
teleport to map (currentmap--4,133,80)
palin(1))
)
do(
if (herox(0)==3,and,heroy(0)==205) then(
palout(1)
teleport to map (currentmap--4,57,37)
palin(1))
)
do(
if (herox(0)==3,and,heroy(0)==222) then(
palout(1)
teleport to map (currentmap--4,25,80)
palin(1))
)
do(
if (herox(0)==5,and,heroy(0)==240) then(
palout(1)
teleport to map (currentmap--4,162,78)
palin(1))
)
end
###

#######################
script, a letter, begin
suspend player
set tag(8,1)

pan camera(up,0,0)
set hero speed(0,4)
walk hero(0,down,3)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map (currentmap,3,21)
stop song
wait(1)
write map block (3,19,86)
write map block (3,20,102)
pan camera (down,0,0)
set hero position(0,6,21)
wait(1)
play song(84)
palin(2)

walk hero(0,left,3)
wait for hero (0)
set hero direction (0,up)
jig hero
tb(2)
wait (5)
show text box (3)
write map block (3,19,120)
write map block (3,20,136)
wait (2)
write map block (3,19,86)
write map block (3,20,102)
wait (2)
write map block (3,19,120)
write map block (3,20,136)
wait (2)
write map block (3,19,86)
write map block (3,20,102)
wait for text box
jig hero
tb(4)
write map block (3,19,113)
write map block (3,20,129)
wait (5)
tb(5)
write map block (3,19,87)
write map block (3,20,103)
wait (5)
tb(6)
jig hero
tb(7)
write map block (3,19,120)
write map block (3,20,136)
wait (5)
tb(8)
jig hero
tb(9)
wait (5)
tb(10)
jig hero
tb(11)
wait (5)
tb(12)
jig hero
tb(13)
write map block (3,19,87)
write map block (3,20,103)
wait (5)
tb(14)
jig hero
tb(15)
wait (5)
show text box (16)
write map block (3,19,120)
write map block (3,20,136)
wait (1)
write map block (3,19,87)
write map block (3,20,103)
wait (2)
write map block (3,19,120)
write map block (3,20,136)
wait (1)
write map block (3,19,87)
write map block (3,20,103)
wait (2)
write map block (3,19,120)
write map block (3,20,136)
wait (1)
write map block (3,19,87)
write map block (3,20,103)
wait (2)
write map block (3,19,120)
write map block (3,20,136)
wait (1)
write map block (3,19,87)
write map block (3,20,103)
wait (2)
write map block (3,19,120)
write map block (3,20,136)
wait (1)
write map block (3,19,87)
write map block (3,20,103)
wait for text box
wait (5)
tb(17)
write map block (3,19,120)
write map block (3,20,136)
wait (5)
tb(18)
wait (5)
tb(19)
jig hero
tb(20)
wait (5)
tb(21)
set hero direction (0,left)
wait (2)
walk hero (0,down,1)
wait for hero (0)
show text box (22)
walk hero (0,down,1)
wait for text box
wait for hero (0)
set hero direction (0,right)
wait (2)
set hero direction (0,up)
jig hero
tb(23)
wait (5)
tb(24)
wait (5)
tb(432)
wait (5)
tb(25)
stop song
walk hero (0,up,2)
wait for hero (0)
jig hero
tb(26)
wait (5)
tb(27)
write map block (3,19,86)
write map block (3,20,102)
wait (10)
tb(28)
jig hero
tb(29)
write map block (3,19,120)
write map block (3,20,136)
wait (5)
tb(30)
jig hero
tb(31)
show text box (32)
set hero direction (0,left)
wait (2)
walk hero (0,down,2)
wait for hero (0)
walk hero (0,right,2)
wait for hero (0)
walk hero (0,down,2)
wait for hero (0)
set hero position (0,0,0)
wait for text box

palout(1)
set tag(8,1)
camera follows hero (0)
teleport to map (96,94,17)
stop song
pan camera(down,0,0)
set hero position(0,0,0)
palin(1)

wait(20)
set hero position(0,94,13)
walk hero(0,down,4)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)

suspend npcs
suspend obstruction
jig npc(33)
show text box(440)
wait(4)
set hero direction(0,right)
play song(91)
wait for text box
wait(4)
set npc frame(33,1)
wait(10)
set npc frame(33,0)
wait(2)
alter npc(33,NPCstat:Picture,140)
wait(2)
jig npc(33)
tb(441)
jig hero(0)
tb(442)
set npc direction(33,left)
wait(10)
jig npc(33)
tb(443)
set npc direction(33,down)
wait(2)
alter npc(33,NPCstat:Picture,141)
jig npc(33)
tb(444)
set npc frame(33,1)
tb(445)
wait(25)
tb(17)
wait(4)
set npc frame(33,0)
wait(2)
alter npc(33,NPCstat:Picture,140)
wait(2)
set npc direction(33,left)
wait(2)
jig npc(33)
tb(446)
jig hero(0)
tb(447)
wait(15)
jig npc(33)
tb(448)
tb(449)
wait(10)
set npc direction(33,down)
jig npc(33)
tb(450)
tb(451)
set npc frame(33,1)
alter npc(33,NPCstat:Picture,141)
tb(452)
set npc frame(33,0)
alter npc(33,NPCstat:Picture,140)
set npc direction(33,left)
wait(2)
jig npc(33)
tb(453)
walk npc(33,down,1)
wait for npc(33)
wait(4)
set npc position(28,0,0)
wait(4)
walk npc(33,down,1)
wait for npc(33)
set hero direction(0,down)
walk npc(33,down,1)
wait(2)
jig hero(0)
tb(454)
wait for npc(33)
set npc frame(33,0)
wait(2)
set npc direction(33,left)
wait(2)
set npc direction(33,up)
wait(10)
jig hero(0)
tb(455)
wait(4)
jig npc(33)
tb(456)
tb(457)
wait(6)
jig npc(33)
tb(458)
walk npc(33,down,1)
wait for npc(33)
walk npc(33,left,1)
wait for npc(33)
walk npc(33,down,2)
wait for npc(33)
wait(20)
stop song
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)

tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,4,0)
update palette
wait (1)
tweak palette (0,8,0)
update palette
reset palette
wait (1)
tweak palette (0,16,0)
update palette
reset palette
wait (1)
tweak palette (0,63,0)
update palette

teleport to map(0,0,0)
wait (1)

reset palette
tweak palette (0,16,0)
update palette
wait (1)
reset palette
tweak palette (0,8,0)
update palette
wait (1)
reset palette
tweak palette (0,4,0)
update palette
wait (1)
reset palette
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette

wait(15)
play song(15)
jig gahn
tb(459)
jig gahn
tb(460)

if (check tag(42)) then(
jig gahn
tb(463)
jig gahn
tb(464)
jig gahn
tb(465)
jig gahn
tb(466)
jig gahn
tb(467)
jig gahn
tb(468)
jig gahn
tb(469)
jig gahn
tb(470)
jig gahn
tb(471)
)
else(
jig gahn
tb(461)
jig gahn
tb(462)
)

tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,4,0)
update palette
wait (1)
tweak palette (0,8,0)
update palette
reset palette
wait (1)
tweak palette (0,16,0)
update palette
reset palette
wait (1)
tweak palette (0,63,0)
update palette

set tag(42,1)
teleport to map(96,94,17)
stop song
wait (1)

reset palette
tweak palette (0,16,0)
update palette
wait (1)
reset palette
tweak palette (0,8,0)
update palette
wait (1)
reset palette
tweak palette (0,4,0)
update palette
wait (1)
reset palette
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette

set hero speed(0,hspeed)
get item(70,1)
get item(71,1)
get item(73,1)
get item(5,1)
resume obstruction
resume npcs
set tag(8,0)

#turning rest/hunt off
set tag(433,1)

save game

#changed, rts begins after dogero lycant/mi'la scene in forest pass
#run real time system(true)
resume player
wait(1)
play song(36)
end
###

###############################
script, heroes of fralin, begin
suspend player
suspend npcs
suspend obstruction

tb(472)
set hero frame(0,0)
set npc position(32,91,56)
set npc position(29,92,56)
set npc position(31,94,56)
set npc position(30,95,56)
walk npc(30,down,1)
wait for npc(30)
walk npc(30,down,2)
walk npc(29,down,1)
wait for npc(29)
walk npc(29,down,2)
walk npc(32,down,3)
walk npc(31,down,3)
wait for npc(29)
set npc frame(29,0)
set npc frame(30,0)
wait for npc(32)
set npc frame(32,0)
wait for npc(31)
set npc frame(31,0)
wait for npc(30)
show text box(473)
variable(i)
 for (i,0,3,1) do(
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1170)
 wait (1)
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1180)
 wait (1))
wait for text box
jig npc(29)
tb(474)
jig npc(31)
tb(475)
jig npc(29)
tb(476)
jig npc(31)
tb(477)
set npc direction(30,left)
jig npc(30)
show text box(478)
wait(2)
set npc direction(31,right)
wait for text box
jig npc(31)
tb(479)
show text box(480)
set npc direction(30,down)
 for (i,0,3,1) do(
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1170)
 wait (1)
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1180)
 wait (1))
wait for text box
set npc direction(32,right)
jig npc(32)
tb(481)
set npc direction(31,down)
wait(2)
set npc direction(31,left)
jig npc(31)
tb(482)
set npc direction(29,right)
jig npc(29)
tb(483)
set npc direction(31,down)
jig npc(31)
tb(484)
set npc direction(32,down)
jig npc(32)
show text box(485)
wait(2)
set npc direction(29,down)
wait(2)
set npc direction(29,left)
wait for text box
set npc direction(31,left)
jig npc(31)
show text box(486)
wait(2)
set npc direction(29,down)
wait(2)
set npc direction(29,right)
wait for text box
set npc direction(30,left)
show text box(487)
set npc direction(31,down)
wait(2)
set npc direction(31,right)
 for (i,0,3,1) do(
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1170)
 wait (1)
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1180)
 wait (1))
wait for text box
jig hero(0)
stop song
tb(488)
set npc direction(29,down)
set npc direction(30,down)
set npc direction(31,down)
jig npc(32)
tb(489)
walk npc(29,down,1)
wait for npc(29)
set npc frame(29,0)
jig npc(29)
tb(490)
jig hero(0)
tb(491)
 for (i,0,3,1) do(
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1170)
 wait (1)
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1180)
 wait (1))
tb(492)
tb(1050)
if (check tag(9)) then(
play song(91)
wait(4)
set hero direction(0,right)
wait(4)
set hero direction(0,up)
wait(4)
jig npc(29)
tb(493)
jig npc(32)
tb(494)
show text box(495)
 for (i,0,3,1) do(
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1170)
 wait (1)
 put npc (30,1900,1175)
 wait (1)
 put npc (30,1900,1180)
 wait (1))
wait for text box
jig npc(31)
tb(496)
tb(497)
jig hero(0)
tb(498)
jig npc(29)
tb(499)
jig npc(32)
tb(500)
jig npc(30)
tb(501)
walk npc(31,down,2)
wait for npc(31)
walk npc to x(31,herox(0))
wait for npc(31)
set npc direction(31,down)
set npc frame(31,0)
jig npc(31)
tb(502)
wait(20)
tb(17)
jig npc(31)
tb(503)
wait(4)
put npc(31,herox(0)*20,(heroy(0)*20)--15)
wait(1)
put npc(31,herox(0)*20,(heroy(0)*20)--10)
wait(1)
put npc(31,herox(0)*20,(heroy(0)*20)--5)
wait(1)
tweak palette(63,63,63)
update palette
stop song
put npc(31,herox(0)*20,(heroy(0)*20)--20)
set hero direction(0,right)
wait(1)
reset palette
update palette
wait(15)
set npc direction(32,left)
wait(2)
set npc direction(32,up)
jig npc(32)
tb(504)
set npc direction(31,left)
wait(2)
set npc direction(31,up)
jig npc(31)
tb(505)
wait(2)
set npc direction(32,left)
wait(2)
set npc direction(32,down)
jig npc(32)
tb(506)
wait(2)
set npc direction(29,right)
jig npc(29)
tb(507)
set npc direction(32,right)
wait(2)
walk npc(32,up,4)
wait(2)
set npc direction(30,left)
wait(2)
walk npc(30,up,4)
wait(2)
walk npc(29,up,5)
wait(6)
walk npc to x(31,92)
wait for npc(31)
walk npc(31,up,6)
wait for npc(31)
set npc position(32,0,0)
set npc position(29,0,0)
set npc position(31,0,0)
set npc position(30,0,0)
)
else(
pan camera(up,0,0)
wait(1)
walk hero(0,down,7)
wait(7)
walk npc(31,down,1)
wait(2)
tb(508)
wait(3)
palout(3)
camera follows hero(0)
teleport to map(10,55,10)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,55,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0)
)

resume obstruction
resume npcs
resume player
end
###

###################
script, loadgame, begin
show map
suspend player
loadgameload
wait (1)

if(currentmap==10,and,herox(0)==87,and,heroy(0)==36) then(
run real time system(true))

else(run real time system)
end
###
###########################
script, loadgameload, begin
if(musicsave<>0) then(play song(musicsave))
set hero frame(0,0)
set hero speed(0,hspeed)

#if(currentmap==13,and,herox(0)==84,and,heroy(0)==42) then(
#reset palette
#tweak palette (-3,-3,-3)
#update palette
#)

#making npc statues appear
if(currentmap==98,and,herox(0)==45,and,heroy(0)==67) then(
set npc frame(npc at spot(39,45),1)
set npc frame(npc at spot(41,46),1)
set npc frame(npc at spot(49,46),1)
set npc frame(npc at spot(51,45),1)
set npc frame(npc at spot(39,49),1)
set npc frame(npc at spot(41,50),1)
set npc frame(npc at spot(50,50),1)
set npc frame(npc at spot(52,49),1)
set npc frame(npc at spot(49,56),1)
set npc frame(npc at spot(38,55),1)
set npc frame(npc at spot(52,63),1)
set npc frame(npc at spot(51,66),1)
set npc frame(npc at spot(39,61),1)
set npc frame(npc at spot(37,63),1)
)

#title music is victory music if non-jaded
if(check tag(188)) then(set victory music(34+1))

#anon tomb door appear if saved in the room and have not opened it
#if(check tag(711),and,current map==13) then(
#	create npc(30,75,41,up)
#	create npc(30,75,42,down)
#	create npc(30,75,43,down)
#	write pass block(75,42,0)
#	write pass block(75,44,128)
#	tp
#)

#underground quarry
#gitleh's tomb
#fedora's tomb
#if(currentmap==22,or,currentmap==23,or,currentmap==36) then(
#wait(1)
#show backdrop(0)
#tweak palette(-111,-111,-111)
#update palette
#show map
#	reset palette
#	tweak palette (-40,-40,-40)
#	update palette
#	wait (1)
#	reset palette
#	tweak palette (-20,-20,-20)
#	update palette
#	wait (1)
#	reset palette
#	tweak palette (-10,-10,-10)
#	update palette
#	wait (1)
#	tp
#)

resume player
resume box advance
resume obstruction
resume npcs
end
###

###############################
script, forest pass door, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)


fpassdoor1
fpassdoor2
fpassdoor3
fpassdoor4
fpassdoor5


set hero frame(0,0)
set tag (8,0)
resume obstruction
resume npcs
resume player
end
###
#########################
script, fpassdoor1, begin
suspend player
if (herox(0)==54,and,heroy(0)==9) then(
pan camera(south,0,0)
walk hero(0,up,4)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)

if(check tag(41)) then(teleport to map(currentmap--8,92,71))
else(teleport to map(96,92,71))

wait(1)
pan camera(south,0,0)
set hero position(0,92,67)
wait(1)
pan camera(up,9,10)
walk hero(0,up,5)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if (herox(0)==55,and,heroy(0)==9) then(
pan camera(south,0,0)
walk hero(0,up,4)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)

if(check tag(41)) then(teleport to map(currentmap--8,93,71))
else(teleport to map(96,93,71))

wait(1)
pan camera(south,0,0)
set hero position(0,93,67)
wait(1)
pan camera(up,9,10)
walk hero(0,up,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==56,and,heroy(0)==9) then(
pan camera(south,0,0)
walk hero(0,up,4)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)

if(check tag(41)) then(teleport to map(currentmap--8,94,71))
else(teleport to map(96,94,71))

wait(1)
pan camera(south,0,0)
set hero position(0,94,67)
wait(1)
pan camera(up,9,10)
walk hero(0,up,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==69,and,(heroy(0)==22,or,heroy(0)==23)) then(
pan camera(right,17,20)
set hero speed(0,10)
walk hero(0,right,17)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==85,and,(heroy(0)==22,or,heroy(0)==23)) then(
pan camera(left,17,20)
set hero speed(0,10)
walk hero(0,left,17)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
end
###
#########################
script, fpassdoor2, begin
suspend player
if ((herox(0)==94,or,herox(0)==95),and,heroy(0)==44) then(

if(check tag(229),and,check tag(230)==false) then(
bandithuntbandits
)
else(
pan camera(down,9,20)
set hero speed(0,10)
walk hero(0,down,9)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0)
)

)
end
###
#########################
script, fpassdoor3, begin
suspend player
if ((herox(0)==94,or,herox(0)==95),and,heroy(0)==52) then(
pan camera(up,9,20)
set hero speed(0,10)
walk hero(0,up,9)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
else(
if ((herox(0)==63,or,herox(0)==64),and,heroy(0)==61) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==63,or,herox(0)==64),and,heroy(0)==68) then(
pan camera(up,8,20)
set hero speed(0,10)
walk hero(0,up,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==79,or,herox(0)==80),and,heroy(0)==77) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==79,or,herox(0)==80),and,heroy(0)==84) then(
pan camera(up,8,20)
set hero speed(0,10)
walk hero(0,up,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==49,or,herox(0)==50),and,heroy(0)==84) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==49,or,herox(0)==50),and,heroy(0)==91) then(
pan camera(up,8,20)
set hero speed(0,10)
walk hero(0,up,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==74,or,herox(0)==75),and,heroy(0)==112) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==74,or,herox(0)==75),and,heroy(0)==119) then(
pan camera(up,8,20)
set hero speed(0,10)
walk hero(0,up,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==58,and,heroy(0)==49) then(
palout(2)
teleport to map(69,4,69)
wait(1)
pan camera(south,0,0)
set hero position(0,4,71)
set pal(afternoon)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
if(check tag(273)==false) then(
	write pass block(4,69,4)
	#turn rest item off
	set tag(433,1)
)
)
)

end
###
#########################
script, fpassdoor4, begin
suspend player
if (herox(0)==42,and,(heroy(0)==127,or,heroy(0)==128)) then(
pan camera(right,16,20)
set hero speed(0,10)
walk hero(0,right,16)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
else(
if (herox(0)==57,and,(heroy(0)==127,or,heroy(0)==128)) then(
pan camera(left,16,20)
set hero speed(0,10)
walk hero(0,left,16)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==100,and,(heroy(0)==107,or,heroy(0)==108)) then(
pan camera(right,16,20)
set hero speed(0,10)
walk hero(0,right,16)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==115,and,(heroy(0)==107,or,heroy(0)==108)) then(
pan camera(left,16,20)
set hero speed(0,10)
walk hero(0,left,16)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==139,or,herox(0)==140),and,heroy(0)==105) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==139,or,herox(0)==140),and,heroy(0)==112) then(
pan camera(up,8,20)
set hero speed(0,10)
walk hero(0,up,8)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==172,or,herox(0)==173),and,heroy(0)==62) then(
focus camera(herox(0),69,20)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==172,or,herox(0)==173),and,heroy(0)==68) then(
pan camera(up,11,20)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero speed(0,hspeed)
pan camera(south,0,0))
)
do(
if ((herox(0)==142,or,herox(0)==143),and,heroy(0)==61) then(
pan camera(down,9,20)
set hero speed(0,10)
walk hero(0,down,9)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if ((herox(0)==142,or,herox(0)==143),and,heroy(0)==69) then(
pan camera(up,9,20)
set hero speed(0,10)
walk hero(0,up,9)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==101,and,(heroy(0)==59,or,heroy(0)==60)) then(
pan camera(right,18,20)
set hero speed(0,10)
walk hero(0,right,18)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==118,and,(heroy(0)==59,or,heroy(0)==60)) then(
pan camera(left,18,20)
set hero speed(0,10)
walk hero(0,left,18)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==107,and,(heroy(0)==39,or,heroy(0)==40)) then(
pan camera(right,16,20)
set hero speed(0,10)
walk hero(0,right,16)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==122,and,(heroy(0)==39,or,heroy(0)==40)) then(
pan camera(left,16,20)
set hero speed(0,10)
walk hero(0,left,16)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if (herox(0)==142,and,heroy(0)==34) then(
pan camera(south,0,0)
walk hero(0,right,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--8,138,8)
wait(1)
pan camera(south,0,0)
set hero position(0,133,8)
wait(1)
walk hero(0,right,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==142,and,heroy(0)==35) then(
pan camera(south,0,0)
walk hero(0,right,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--8,138,9)
wait(1)
pan camera(south,0,0)
set hero position(0,133,9)
wait(1)
walk hero(0,right,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
end
###
#########################
script, fpassdoor5, begin
suspend player
if (herox(0)==157,and,heroy(0)==98) then(
pan camera(south,0,0)
walk hero(0,right,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--8,126,80)
wait(1)
pan camera(south,0,0)
set hero position(0,121,80)
wait(1)
walk hero(0,right,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if (herox(0)==157,and,heroy(0)==99) then(
pan camera(south,0,0)
walk hero(0,right,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--8,126,81)
wait(1)
pan camera(south,0,0)
set hero position(0,121,81)
wait(1)
walk hero(0,right,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==16,and,heroy(0)==123) then(
pan camera(south,0,0)
walk hero(0,left,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--8,60,80)
wait(1)
pan camera(south,0,0)
set hero position(0,65,80)
wait(1)
walk hero(0,left,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==16,and,heroy(0)==124) then(
pan camera(south,0,0)
walk hero(0,left,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--8,60,81)
wait(1)
pan camera(south,0,0)
set hero position(0,65,81)
wait(1)
walk hero(0,left,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==77,and,heroy(0)==148) then(
suspend player
pan camera(south,0,0)
write pass block(77,149,128)
walk hero(0,down,1)
wait for hero(0)
wait(3)
palout(3)
camera follows hero(0)
teleport to map(13,45,78)
suspend player
wait(1)
suspend player
pan camera(south,0,0)
set hero position(0,39,74)
suspend player
wait(1)
palin(3)
wait(3)
walk hero(0,down,4)
wait for hero(0))
)
do(
if (herox(0)==58,and,heroy(0)==49) then(
camera follows hero(0))
)
do(
	if (herox(0)==129,and,heroy(0)==136) then(

		if(check tag(72),and,check tag(285)) then(
			pan camera(south,0,0)
			walk hero(0,down,5)
			wait(3)
			palout(3)
			wait for hero(0)
			camera follows hero(0)
			teleport to map(14+poff,101,27)
			wait(1)
			pan camera(south,0,0)
			set hero position(0,101,22)
			wait(1)
			walk hero(0,down,5)
			wait(3)
			palin(3)
			wait for hero(0)
			camera follows hero(0))
		else(
			set hero direction(0,right)
			wait(2)
			walk hero(0,up,1)
			wait for hero(0)
			set hero frame(0,0)
			jig hero(0)
			if(check tag(285)) then(tb(6644))
			else(tb(6642))
		)
	)
)
do(
	if (herox(0)==130,and,heroy(0)==136) then(

		if(check tag(72),and,check tag(285)) then(
			pan camera(south,0,0)
			walk hero(0,down,5)
			wait(3)
			palout(3)
			wait for hero(0)
			camera follows hero(0)
			teleport to map(14+poff,102,27)
			wait(1)
			pan camera(south,0,0)
			set hero position(0,102,22)
			wait(1)
			walk hero(0,down,5)
			wait(3)
			palin(3)
			wait for hero(0)
			camera follows hero(0))
		else(
			set hero direction(0,right)
			wait(2)
			walk hero(0,up,1)
			wait for hero(0)
			set hero frame(0,0)
			jig hero(0)
			if(check tag(285)) then(tb(6644))
			else(tb(6642))
		)
	)
)
do(
	if (herox(0)==131,and,heroy(0)==136) then(

		if(check tag(72),and,check tag(285)) then(
			pan camera(south,0,0)
			walk hero(0,down,5)
			wait(3)
			palout(3)
			wait for hero(0)
			camera follows hero(0)
			teleport to map(14+poff,103,27)
			wait(1)
			pan camera(south,0,0)
			set hero position(0,103,22)
			wait(1)
			walk hero(0,down,5)
			wait(3)
			palin(3)
			wait for hero(0)
			camera follows hero(0))
		else(
			set hero direction(0,right)
			wait(2)
			walk hero(0,up,1)
			wait for hero(0)
			set hero frame(0,0)
			jig hero(0)
			if(check tag(285)) then(tb(6644))
			else(tb(6642))
		)
	)
)
end
###

#####################################
script ,heroes of fralin again, begin
suspend player
suspend npcs
suspend obstruction

#set to afternoon
set tag(5,1)
set hero speed(0,4)

#out of beginning area
set tag(527,1)

tb(509)
play song(9)
focus camera(96,33,2)
walk hero to x(0,96)
wait for hero(0)
walk hero to y(0,32)
wait for hero(0)
wait for camera
jig npc(26)
tb(510)
tb(511)
wait(10)
jig npc(26)
tb(512)
jig hero(0)
tb(513)
jig npc(26)
tb(514)
show text box(515)
walk npc(26,left,1)
wait for npc(26)
set npc frame(26,0)
wait for text box

if (check tag(43)) then(
jig hero(0)
tb(516)
set npc direction(26,up)
tb(517)
tb(518)
jig npc(26)
tb(519)
)else(
jig hero(0)
tb(520)
set npc direction(26,up)
tb(521)
tb(522)
jig npc(26)
tb(523)
)
walk npc(26,up,2)
wait for npc(26)
set npc frame(26,0)
wait(2)
set npc direction(26,right)
wait(2)
jig npc(26)
tb(524)
jig hero(0)
tb(491)
show text box(525)
walk npc(26,down,1)
wait for npc(26)
set npc frame(26,0)
wait for text box
wait(5)
heroes of fralin 2 #breaking it up.
heroes of fralin 3
end
script, heroes of fralin 2, begin

set npc position(29,96,25)
set npc position(30,98,25)
set npc position(31,97,25)
set npc position(32,95,25)
stop song
tb(526)
wait(1)
set npc direction(26,left)
wait(1)
set npc direction(26,up)
wait(1)
walk npc(29,down,5)
wait(5)
walk npc(30,down,5)
wait(5)
walk npc(31,down,5)
wait(5)
walk npc(32,down,5)
wait for npc(29)
set npc frame(29,0)
wait for npc(30)
set npc frame(30,0)
wait for npc(31)
set npc frame(31,0)
wait for npc(32)
set npc frame(32,0)
play song(36)
show text box(527)
variable(i)
 for (i,0,3,1) do(
 put npc (30,98*20,(30*20)--5)
 wait (1)
 put npc (30,98*20,(30*20)--10)
 wait (1)
 put npc (30,98*20,(30*20)--5)
 wait (1)
 put npc (30,98*20,30*20)
 wait (1))
wait for text box
set npc direction(32,right)
jig npc(32)
tb(528)
jig npc(29)
show text box(529)
wait(2)
set npc direction(32,down)
wait for text box
jig npc(31)
tb(530)
show text box(531)
 for (i,0,3,1) do(
 put npc (30,98*20,(30*20)--5)
 wait (1)
 put npc (30,98*20,(30*20)--10)
 wait (1)
 put npc (30,98*20,(30*20)--5)
 wait (1)
 put npc (30,98*20,30*20)
 wait (1))
wait for text box
jig npc(26)
tb(532)
walk npc(26,up,1)
wait for npc(26)
set npc frame(26,0)
wait(2)
set npc direction(26,right)
jig npc(26)
tb(533)
tb(534)
wait(7)
jig npc(26)
tb(535)
walk npc(26,down,7)
wait(10)
jig npc(29)
tb(536)
jig npc(31)
tb(537)
jig npc(32)
tb(538)
jig npc(29)
tb(539)
wait(2)
set npc direction(29,left)
jig npc(29)
show text box(540)
wait(2)
set npc direction(32,right)
wait for text box
wait(2)
set npc direction(29,right)
jig npc(29)
show text box(541)
wait(2)
set npc direction(31,left)
set npc direction(30,left)
wait for text box
wait(2)
set npc direction(29,up)
wait(15)
tb(542)
set npc direction(30,down)
jig npc(30)
tb(543)
set npc direction(31,down)
jig npc(31)
tb(544)
set hero direction(0,left)
wait(4)
set hero direction(0,up)
wait(4)
set npc direction(32,down)
jig hero(0)
tb(545)
show text box(546)
stop song
set npc direction(29,right)
wait(1)
set npc direction(29,down)
wait(1)
jig npc(29)
wait for text box
wait(8)
set hero direction(0,right)
wait(4)
set hero direction(0,down)
wait(2)
jig npc(31)
tb(547)
wait(20)
play song(91)
tb(17)
jig npc(29)
tb(548)
jig hero(0)
tb(549)
set hero direction(0,left)
jig hero(0)
tb(550)
alter npc(26,NPCstat:picture,142)
alter npc(26,NPCstat:palette,1+poff)
set npc direction(26,left)
unlock hero(0)
swap in hero(0)
swap by position(find hero(0),0)
swap out hero(6)
lock hero(6)
#giving dogero the bad true jade skill
write spell(find hero(0),0,21,446+1)
set hero picture(find hero(0),142)
set npc position(26,herox(0)+1,heroy(0))
walk npc(26,right,1)
wait for npc(26)
walk npc(26,right,1)
set npc direction(26,down)
wait for npc(26)
set npc position(26,0,0)
wait(4)
set hero picture(find hero(0),1)
set hero direction(0,up)
set hero picture(find hero(0),0,inside battle)
wait(15)
show text box(551)
walk npc(30,down,1)
wait for npc(30)
set npc direction(30,left)
set npc frame(30,0)
wait for text box
wait(10)
jig npc(29)
tb(552)
wait(5)
jig hero(0)
tb(553)
wait(5)
walk npc(29,down,1)
wait for npc(29)
set npc frame(29,0)
wait(4)
walk npc(31,down,2)
wait for npc(31)
set npc frame(31,0)
set npc direction(31,left)
jig npc(31)
set hero direction(0,right)
tb(554)
walk npc(32,down,2)
wait(2)
set hero direction(0,up)
wait for npc(32)
set npc frame(32,0)
set npc direction(32,right)
jig npc(32)
set hero direction(0,left)
tb(555)
jig hero(0)
tb(556)
set hero direction(0,up)
jig hero(0)
tb(557)
set hero direction(0,right)
jig hero(0)
tb(558)
set hero direction(0,down)
set hero picture(0,41)
jig hero(0)
tb(559)
wait(15)
set hero picture(0,38)
wait(2)
set hero picture(0,39)
wait(2)
set hero picture(0,84)
wait(2)
set hero picture(0,39)
wait(5)
tb(560)
jig npc(32)
tb(561)
jig npc(29)
tb(562)
wait(2)
set hero picture(0,38)
wait(2)
set hero picture(0,41)
wait(2)
set hero picture(0,38)
wait(2)
set hero picture(0,41)
tb(563)
wait(2)
set hero picture(0,38)
tb(564)
tb(565)
set hero picture(0,25)
tb(566)
jig npc(32)
tb(567)
jig npc(29)
show text box(568)
wait(5)
walk npc(31,up,6)
wait(5)
walk npc(32,up,6)
set npc direction(30,left)
wait(2)
walk npc(30,up,5)
wait for text box
set npc direction(29,left)
wait(4)
walk npc(29,up,5)
end
script,heroes of fralin 3, begin
     #Mi'la part!

set hero picture (0,64,outsidebattle)
wait for npc(29)
alter NPC (29,NPCstat:palette,77+poff)
alter NPC (30,NPCstat:palette,77+poff)
alter NPC (31,NPCstat:palette,77+poff)
alter NPC (29,NPCstat:picture,67)
alter NPC (30,NPCstat:picture,68)
alter NPC (31,NPCstat:picture,69)
alter NPC (32,NPCstat:picture,71)
set npc direction (29,up)
set npc position (29,85,35)
set hero picture (0,25,outsidebattle)
stop song
focus camera (89,34,2)
wait (8)
set hero picture (0,72,outsidebattle)
walk hero (0,left,4)
wait for hero (0)
walk hero (0,down,4)
wait for hero (0)
walk hero (0,left,3)
wait for hero (0)
set hero frame (0,0)
wait for camera

jig hero
set hero picture (0,40,outsidebattle)
tb(100)
jig npc (29)
jig npc (29)
jig npc (29)
jig npc (29)
tb(101)

play song(32)

set hero picture (0,25,outsidebattle)
alter NPC (1,NPCstat:picture,70)
alter NPC (1,NPCstat:palette,29+poff)
set npc direction (1,down)
set npc position (1,85,35)
set npc direction (29,down)
set npc position (29,85,36)
set npc position (30,84,35)
set npc position (31,86,35)
walk npc (29,down,3)
walk npc (30,down,3)
walk npc (31,down,3)

put npc (1,(85*20)+5,(35*20)--5)
wait (1)
set npc direction (1,left)
put npc (1,(85*20)+10,(35*20)--10)
wait (1)
set npc direction (1,up)
put npc (1,(85*20)+15,(35*20)--14)
wait (1)
set npc direction (1,right)
put npc (1,(85*20)+20,(35*20)--18)
wait (1)

set hero picture (0,49,outsidebattle)

set npc direction (1,down)
put npc (1,(85*20)+25,(35*20)--21)
wait (1)
set npc direction (1,left)
put npc (1,(85*20)+30,(35*20)--24)
wait (1)
set npc direction (1,up)
put npc (1,(85*20)+35,(35*20)--26)
wait (1)
set npc direction (1,right)
put npc (1,(85*20)+40,(35*20)--27)
wait (1)

set npc position (32,45,36)

set npc direction (1,down)
put npc (1,(85*20)+45,(35*20)--27)
put npc (32,(87*20)+5,36*20)
wait (1)
set npc direction (1,left)
put npc (1,(85*20)+50,(35*20)--26)
put npc (32,(87*20)+10,36*20)
wait (1)
set npc direction (1,up)
put npc (1,(85*20)+55,(35*20)--24)
put npc (32,(87*20)+15,36*20)
wait (1)
set npc direction (1,right)
put npc (1,(85*20)+60,(35*20)--21)
put npc (32,(87*20)+20,36*20)
wait (1)

set npc position (29,0,0)
set npc position (30,0,0)
set npc position (31,0,0)

set npc direction (1,down)
put npc (1,(85*20)+65,(35*20)--18)
put npc (32,(87*20)+25,36*20)
wait (1)
set npc direction (1,left)
put npc (1,(85*20)+70,(35*20)--14)
put npc (32,(87*20)+30,36*20)
wait (1)
set npc direction (1,up)
put npc (1,(85*20)+75,(35*20)--10)
put npc (32,(87*20)+35,36*20)
wait (1)
set npc direction (1,right)
put npc (1,(85*20)+80,(35*20)--5)
put npc (32,(87*20)+40,36*20)
wait (1)

set npc direction (1,down)
put npc (1,(85*20)+85,(35*20))
put npc (32,(87*20)+45,36*20)
wait (1)
set npc direction (1,left)
put npc (1,(85*20)+90,(35*20)+5)
put npc (32,(87*20)+50,36*20)
wait (1)
set npc direction (1,up)
put npc (1,(85*20)+95,(35*20)+10)
put npc (32,(87*20)+55,36*20)
wait (1)
set npc direction (1,right)
put npc (1,(85*20)+100,(35*20)+15)
put npc (32,(87*20)+60,36*20)
wait (1)
set npc position (1,90,36)
set npc direction (1,right)
set npc frame (1,0)
alter NPC (1,NPCstat:picture,73)
set npc position (32,0,0)

wait (30)
set hero picture (0,38,outsidebattle)
wait (2)
set hero picture (0,49,outsidebattle)
wait (2)
set hero picture (0,38,outsidebattle)
wait (2)
set hero picture (0,49,outsidebattle)
wait (15)
set hero picture (0,50,outsidebattle)
show text box (102)
wait (15)
set hero picture (0,1,outsidebattle)
set hero direction (0,down)
wait (2)
set hero direction (0,right)
set hero picture (0,1,outsidebattle)
wait for text box
wait
alter NPC (1,NPCstat:picture,12)
set npc direction (1,down)
wait (2)
set npc direction (1,left)
wait (2)
jig npc (1)
alter NPC (1,NPCstat:picture,73)
tb(103)
jig hero
tb(104)
alter NPC (1,NPCstat:picture,12)
walk npc (1,right,1)
wait for npc (1)
set npc frame (1,0)
jig npc (1)
tb(105)
wait (2)
alter NPC (1,NPCstat:picture,74)
tb(106)
jig hero
tb(107)
alter npc (1,NPCstat:picture,12)
wait (2)
set npc direction (12,down)
wait (2)
walk npc (1,left,1)
wait for npc (1)
set npc frame (1,0)
set hero speed (0,2)
walk hero (0,left,1)
set hero picture (0,30,outsidebattle)
jig npc (1)
show text box (108)
wait for hero (0)
set hero frame (0,0)
set hero direction (0,right)
set hero picture (0,1,outsidebattle)
wait for text box
set npc direction (1,down)
alter NPC (1,NPCstat:picture,76)
show text box (109)
wait (4)
set npc frame (1,1)
wait (4)
set npc frame (1,0)
wait (4)
set npc frame (1,1)
wait (4)
set npc frame (1,0)
wait (4)
set npc frame (1,1)
wait (4)
set npc frame (1,0)
wait (4)
set npc direction (1,left)
wait for text box
jig hero
tb(110)
set npc frame (1,0)
alter npc (1,npcstat:picture,12)
jig npc (1)
tb(111)
jig hero
tb(112)
alter npc (1,npcstat:picture,73)
wait (2)
set npc frame (1,1)
wait (2)
set npc frame (1,0)
wait (2)
set npc frame (1,1)
wait (2)
set npc frame (1,0)
tb(113)
jig hero
tb(114)
wait (2)
set hero picture (0,41,outsidebattle)
wait (2)
tb(115)
alter npc (1,npcstat:picture,12)
jig npc (1)
tb(116)
walk npc (1,left,1)
wait (2)
wait for npc (1)
set npc frame (1,0)
jig npc (1)
show text box (117)
set hero picture (0,30,outsidebattle)
walk hero (0,left,1)
wait for hero (0)
set hero direction (0,right)
set hero picture (0,1,outsidebattle)
set hero frame (0,0)
wait for text box
walk npc (1,left,1)
wait for npc (1)
suspend box advance
show text box (118)
walk npc (1,up,3)
wait for npc (1)
walk npc (1,right,2)
wait for npc (1)
walk npc (1,down,3)
wait for npc (1)
walk npc (1,left,1)
wait for npc (1)
set npc frame (1,0)
resume box advance
wait for text box
jig hero
tb(119)
jig npc (1)
tb(120)
wait (2)
alter npc (1,npcstat:picture,73)
wait (2)
stop song
tb(121)

if (check tag (11)==true) then(
jig hero
tb(122)
alter npc (1,npcstat:picture,12)
alter npc (1,npcstat:movespeed,4)
walk npc (1,left,1)
wait for npc (1)
jig npc (1)
play song(82)
tb(123)
jig hero
tb(124)
wait (2)
alter npc (1,npcstat:picture,77)
wait (8)
tb(125)
wait (2)
alter npc (1,npcstat:picture,12)
walk npc (1,left,1)
wait for npc (1)
set npc position (1,0,0)
show text box (126)
add hero (1)
set hero palette (find hero(1),29+poff,outsidebattle)
set hero palette (find hero(1),29+poff,insidebattle)

#saving mila hero stats for rts use
set variable(mihp,get hero stat(find hero(1),0,maximum stat))
set variable(misp,get hero stat(find hero(1),1,maximum stat))
set variable(mistr,get hero stat(find hero(1),2,maximum stat))
set variable(miacc,get hero stat(find hero(1),3,maximum stat))
set variable(midef,get hero stat(find hero(1),4,maximum stat))
set variable(middg,get hero stat(find hero(1),5,maximum stat))
set variable(miskl,get hero stat(find hero(1),6,maximum stat))
set variable(mievd,get hero stat(find hero(1),7,maximum stat))

wait for text box)

else(
jig hero
tb(127)
jig npc (1)
alter npc (1,npcstat:picture,78)
tb(128)
set npc direction (1,down)
wait (2)
alter npc (1,npcstat:picture,79)
wait (2)
show text box (129)
wait (8)
set npc frame (1,1)
wait for text box
jig hero
tb(130)
wait (2)
set npc frame (1,0)
wait (2)
alter npc (1,npcstat:movespeed,2)
alter npc (1,npcstat:picture,80)
walk npc (1,right,1)
wait for npc (1)
set npc frame (1,0)
jig npc (1)
tb(131)
jig hero
alter npc (1,npcstat:picture,74)
tb(132)
wait (2)
alter npc (1,npcstat:movespeed,4)
alter npc (1,npcstat:picture,80)
set npc direction (1,down)
wait (2)
walk npc (1,left,2)
show text box (133)
wait for npc (1)
set npc frame (1,0)
wait (2)
set npc frame (1,1)
wait (2)
set npc frame (1,0)
wait (2)
set npc frame (1,1)
wait (2)
set npc frame (1,0)
wait (2)
set npc frame (1,1)
wait (2)
set npc frame (1,0)
wait for text box
wait (2)
set npc direction (1,down)
alter npc (1,npcstat:picture,78)
wait (2)
alter npc (1,npcstat:picture,79)
wait (2)
tb(134)
wait (2)
alter npc (1,npcstat:picture,78)
wait (2)
alter npc (1,npcstat:picture,80)
set npc direction (1,right)
wait (2)
tb(135)
wait (2)
alter npc (1,npcstat:picture,74)
wait (2)
tb(136)
wait (2)
set npc direction (1,down)
alter npc (1,npcstat:picture,80)
wait (2)
set npc direction (1,left)
wait (2)

alter NPC (1,NPCstat:picture,70)
set npc direction (1,down)
put npc (1,(88*20)--5,(36*20)--5)
wait (1)
set npc direction (1,left)
put npc (1,(88*20)--10,(36*20)--10)
wait (1)
set npc direction (1,up)
put npc (1,(88*20)--15,(36*20)--15)
wait (1)
set npc direction (1,right)
put npc (1,(88*20)--20,(36*20)--20)
wait (1)

put npc (1,(88*20)--25,(36*20)--25)
wait (1)
set npc direction (1,left)
put npc (1,(88*20)--30,(36*20)--30)
wait (1)
set npc direction (1,up)
put npc (1,(88*20)--35,(36*20)--34)
wait (1)
set npc direction (1,right)
put npc (1,(88*20)--40,(36*20)--38)
wait (1)

set hero direction (0,up)

put npc (1,(88*20)--45,(36*20)--41)
wait (1)
set npc direction (1,left)
put npc (1,(88*20)--50,(36*20)--44)
wait (1)
set hero direction (0,left)
set npc direction (1,up)
put npc (1,(88*20)--55,(36*20)--46)
wait (1)
set npc direction (1,right)
put npc (1,(88*20)--60,(36*20)--47)
wait (1)

put npc (1,(88*20)--65,(36*20)--47)
wait (1)
set npc direction (1,left)
put npc (1,(88*20)--70,(36*20)--46)
wait (1)
set npc direction (1,up)
put npc (1,(88*20)--75,(36*20)--44)
wait (1)
set npc direction (1,right)
put npc (1,(88*20)--80,(36*20)--41)
wait (1)

put npc (1,(88*20)--85,(36*20)--38)
wait (1)
set npc direction (1,left)
put npc (1,(88*20)--90,(36*20)--34)
wait (1)
set npc direction (1,up)
put npc (1,(88*20)--95,(36*20)--30)
wait (1)
set npc direction (1,right)
put npc (1,(88*20)--100,(36*20)--25)
wait (1)

set npc position (1,0,0)
alter npc (1,npcstat:picture,0)
set npc position (29,83,35)
set npc position (30,82,34)
set npc position (31,84,34)
walk npc (29,down,2)
walk npc (30,down,2)
walk npc (31,down,2)
)

wait for npc (29)
wait for npc (30)
wait for npc (31)
focus camera (herox(0),heroy(0),2)
set tag (10,1)
set tag (41,1)

#turning on rest/hunt
set tag(433,0)

set npc position (29,0,0)
set npc position (30,0,0)
set npc position (31,0,0)
wait (2)
wait for camera
camera follows hero (0)
set hero speed (0,hspeed)

save game

play song(70)

#rts npc starter
set npc position(3,88,36)

resume obstruction
resume npcs
resume player
resume box advance
end
###

############################################
script, entering forest dungeon a b c, begin
suspend player
suspend npcs
suspend obstruction

set hero speed(0,4)
set tag(132,1)

if (checktag(11)==true) then(forestduna)
if (checktag(11)==false) then(forestdunb)

forestdunc

resume obstruction
resume npcs
resume player
resume box advance
end
###

#########################
script, forestduna, begin
suspend player
suspend npcs
suspend obstruction

play song(32)

#getting around blasted forest pass npc limits
if(check tag(273)) then(
	set tag(563,1)
	set tag(273,0)
	)
else(set tag(563,0))
alter npc(9,NPCstat:script,0)
alter npc(10,NPCstat:script,0)

set tag(10,0)
set party out
swap by position(find hero(0),0)

alter NPC (9,npcstat:picture,12)
alter NPC (9,npcstat:palette,29+poff)
alter NPC (9,npcstat:movespeed,4)
focus camera (77,145,2)
wait (4)
show text box (137)
set NPC position (9,herox(0),heroy(0))
walk NPC to x(9,77)
wait for NPC (9)
wait(2)
walk npc to y(9,146)
wait for text box
wait for camera
wait (4)
walk hero to x(0,77)
wait for hero (0)
walk hero (0,down,2)
wait for npc (9)
set npc frame (9,0)
wait (2)
set npc direction (9,left)
wait (2)
set npc direction (9,up)
show text box (138)
wait for hero (0)
walk hero (0,down,1)
wait for hero (0)
set hero frame (0,0)
wait for text box
jig hero
tb(139)
jig npc (9)
tb(140)
jig hero
tb(141)
jig npc (9)
tb(142)
wait (4)
set hero picture (0,41)
wait (10)
set hero picture (0,65)
wait (25)
tb(775)
jig npc (9)
tb(143)
wait (2)
set hero picture (0,41)
wait (2)
set hero picture (0,81)
jig hero
tb(144)
jig npc (9)
tb(145)
jig hero
tb(146)
jig npc (9)
tb(147)
wait (2)
set hero direction (0,left)
wait (2)
show text box (148)
walk hero (0,up,2)
wait for hero (0)
set hero frame (0,0)
wait for text box
jig npc (9)
tb(149)
wait (2)
show text box (150)
wait for text box
set hero picture (0,72,outsidebattle)
set hero direction (0,right)
wait (2)
set hero direction (0,down)
wait (2)
jig hero
tb(151)
walk npc (9,left,1)
wait for npc (9)
walk npc (9,up,1)
wait for npc (9)
set npc frame (9,0)
wait (2)
set npc direction (9,right)
wait (2)
set npc frame (9,1)
wait (2)
alter npc (9,npcstat:picture,70)
alter npc (10,npcstat:picture,71)
alter npc (10,npcstat:palette,1)

write pass block (79,145,128)
write pass block (79,144,0)
write pass block (79,143,0)
write pass block (80,143,0)
write pass block (81,143,0)
set hero picture (0,1,outsidebattle)

set npc direction (9,down)
put npc (9,(76*20)+5,(145*20)--6)
put npc (10,(76*20)+5,(145*20))
wait (1)
set npc direction (9,left)
put npc (9,(76*20)+10,(145*20)--12)
put npc (10,(76*20)+10,(145*20))
wait (1)
set npc direction (9,up)
put npc (9,(76*20)+15,(145*20)--18)
put npc (10,(76*20)+15,(145*20))
wait (1)
set npc direction (9,right)
put npc (9,(76*20)+20,(145*20)--24)
put npc (10,(76*20)+20,(145*20))
wait (1)

set npc direction (9,down)
put npc (9,(76*20)+25,(145*20)--29)
put npc (10,(76*20)+25,(145*20))
wait (1)
set npc direction (9,left)
put npc (9,(76*20)+30,(145*20)--34)
put npc (10,(76*20)+30,(145*20))
wait (1)
set npc direction (9,up)
put npc (9,(76*20)+35,(145*20)--38)
put npc (10,(76*20)+35,(145*20))
wait (1)
set npc direction (9,right)
put npc (9,(76*20)+40,(145*20)--42)
put npc (10,(76*20)+40,(145*20))
wait (1)

set npc direction (9,down)
put npc (9,(76*20)+45,(145*20)--45)
put npc (10,(76*20)+45,(145*20))
wait (1)
set npc direction (9,left)
put npc (9,(76*20)+50,(145*20)--48)
put npc (10,(76*20)+50,(145*20))
wait (1)
set npc direction (9,up)
put npc (9,(76*20)+55,(145*20)--50)
put npc (10,(76*20)+55,(145*20))
wait (1)
set npc direction (9,right)
put npc (9,(76*20)+60,(145*20)--52)
put npc (10,(76*20)+60,(145*20))
wait (1)

walk hero (0,down,1)
set npc position (10,0,0)

set npc direction (9,down)
put npc (9,(76*20)+65,(145*20)--50)
wait (1)
set npc direction (9,left)
put npc (9,(76*20)+70,(145*20)--47)
wait (1)
set npc direction (9,up)
put npc (9,(76*20)+75,(145*20)--43)
wait (1)
set npc direction (9,right)
put npc (9,(76*20)+80,(145*20)--40)
wait (1)

write pass block (79,145,15)

set npc direction (9,right)
set npc position (9,80,143)
set npc frame (9,0)
alter npc (9,npcstat:picture,12)

wait for hero (0)
set hero direction (0,right)
set hero frame (0,0)

wait (2)
set npc direction (9,down)
wait (2)
alter npc (9,npcstat:picture,82)
wait (2)
tb(152)
wait (2)
alter npc (9,npcstat:picture,78)
wait (2)
set npc direction (9,up)
alter npc (9,npcstat:picture,82)
wait (2)
tb(153)
wait (2)
set npc direction (9,left)
wait (2)
tb(154)
wait (2)
set hero frame (0,1)
wait (2)
set hero frame (0,0)
wait (2)
set hero frame (0,1)
wait (2)
set hero frame (0,0)
wait (2)
tb(155)
wait (2)
set hero picture (0,51,outsidebattle)
wait (2)
set hero picture (0,1,outsidebattle)
walk hero (0,down,2)
wait for hero (0)
set hero frame (0,0)
jig hero
set hero picture (0,50,outsidebattle)
tb(156)

alter npc (9,npcstat:picture,70)
alter npc (10,npcstat:picture,71)
alter npc (10,npcstat:palette,1)
#write pass block (80,143,128)

set npc direction (9,down)
put npc (9,(80*20),(143*20)+1)
put npc (10,(80*20),(146*20)--20)
wait (1)
set npc direction (9,left)
put npc (9,(80*20),(143*20)+2)
put npc (10,(80*20),(146*20)--18)
wait (1)
set npc direction (9,up)
put npc (9,(80*20),(143*20)+4)
put npc (10,(80*20),(146*20)--16)
wait (1)
set npc direction (9,right)
put npc (9,(80*20),(143*20)+8)
put npc (10,(80*20),(146*20)--14)
wait (1)
#write pass block (46,115,0)
set npc direction (9,down)
put npc (9,(80*20),(143*20)+13)
put npc (10,(80*20),(146*20)--12)
wait (1)
set npc direction (9,left)
put npc (9,(80*20),(143*20)+19)
put npc (10,(80*20),(146*20)--10)
wait (1)
set npc direction (9,up)
put npc (9,(80*20),(143*20)+26)
put npc (10,(80*20),(146*20)--8)
wait (1)
set npc direction (9,right)
put npc (9,(80*20),(143*20)+33)
put npc (10,(80*20),(146*20)--6)
wait (1)
set npc direction (9,down)
put npc (9,(80*20),(143*20)+41)
put npc (10,(80*20),(146*20)--4)
wait (1)
set npc direction (9,left)
put npc (9,(80*20),(143*20)+50)
put npc (10,(80*20),(146*20)--2)
wait (1)

set npc position (30,0,0)
set npc position (9,80,146)
alter npc (9,npcstat:picture,12)
set npc direction (9,down)
set npc frame (9,0)
alter npc (10,npcstat:picture,0)
wait (2)
walk npc (9,left,2)
wait for npc (9)
set npc frame (9,0)
jig npc (9)
tb(157)
wait (2)
set hero picture (0,1,outsidebattle)
set hero direction (0,right)
jig hero
tb(158)
jig npc (9)
tb(159)
set hero picture (0,72,outsidebattle)
jig hero
tb(160)
wait (2)
set npc direction (9,down)
alter npc (9,npcstat:picture,83)
variable (i)
for (i,1,8,1) do(
wait (1)
set npc frame (9,1)
wait (1)
set npc frame (9,0))
alter npc (9,npcstat:picture,12)
wait (2)
walk npc (9,left,1)
wait for npc (9)
set npc position (9,0,0)
alter npc (9,npcstat:picture,0)
set hero picture (0,1,outsidebattle)
set hero direction (0,down)
write pass block (45,113,128)
write pass block (46,113,128)
write pass block (47,113,128)

set party in
set tag(10,1)

if(check tag(563)) then(set tag(273,1))

end
###

#########################
script, forestdunb, begin
suspend player
suspend npcs
suspend obstruction

play song(32)

wait (2)
focus camera (77,145,2)
wait (10)
walk hero to x (0,77)
wait for hero (0)
walk hero to y (0,146)
wait for hero (0)
set hero frame (0,0)
wait (2)
set hero direction (0,right)
jig hero
tb (161)
wait (2)
set npc direction (27,left)
tb (162)
set hero picture (0,72,outsidebattle)
jig hero
tb (163)
set npc frame (27,1)
wait (1)
set npc frame (27,0)
wait (1)
set hero picture (0,81,outsidebattle)
set npc frame (27,1)
wait (1)
set npc frame (27,0)
wait (1)
tb (164)
tb (165)
jig hero
tb (166)
set npc direction (27,down)
alter npc (27,npcstat:picture,80)
wait (2)
walk npc (27,left,1)
wait for npc (27)
set npc frame (27,0)
jig npc (27)
tb (167)
set npc direction (27,down)
alter npc (27,npcstat:picture,78)
wait (2)
alter npc (27,npcstat:picture,82)
tb (168)
jig hero
tb (169)
tb (170)
set hero picture (0,1,outsidebattle)
jig hero
tb (171)
wait (2)
set npc direction (27,left)
alter npc (27,npcstat:picture,80)
jig npc (27)
tb (172)
jig hero
tb (173)
jig npc (27)
tb (174)
set hero picture (0,81,outsidebattle)
jig hero
tb (175)
jig npc (27)
tb (176)
wait (15)
set hero picture (0,66,outsidebattle)
wait (25)
tb (775)
jig npc (27)
tb (177)
wait (20)
alter npc (27,npcstat:picture,12)
jig npc (27)
tb (178)
set hero picture (0,81,outsidebattle)
jig hero
tb (179)
jig npc (27)
tb (180)
jig hero
tb (181)
jig npc (27)
tb (182)
wait (10)
jig npc (27)
set hero picture (0,1,outsidebattle)
tb (183)
wait (20)
set hero picture (0,84,outsidebattle)
wait (2)
set hero picture (0,1,outsidebattle)
wait (6)
walk npc (27,left,1)
wait for npc (27)
set tag (12,1)
wait (2)
tb (184)
add hero(1)
set hero palette(find hero(1),29+poff,outside battle)
set hero palette(find hero(1),29+poff,inside battle)

#adjusting mi'la stats
set hero stat(find hero(1),2,dostr--5,current stat)
set hero stat(find hero(1),2,dostr--5,maximum stat)
set hero stat(find hero(1),3,doacc+5,current stat)
set hero stat(find hero(1),3,doacc+5,maximum stat)
set hero stat(find hero(1),4,dodef,current stat)
set hero stat(find hero(1),4,dodef,maximum stat)
set hero stat(find hero(1),5,doddg+5,current stat)
set hero stat(find hero(1),5,doddg+5,maximum stat)
set hero stat(find hero(1),6,doskl+5,current stat)
set hero stat(find hero(1),6,doskl+5,maximum stat)
set hero stat(find hero(1),7,doevd+5,current stat)
set hero stat(find hero(1),7,doevd+5,maximum stat)

#saving mila hero stats for rts use
set variable(mihp,get hero stat(find hero(1),0,maximum stat))
set variable(misp,get hero stat(find hero(1),1,maximum stat))
set variable(mistr,get hero stat(find hero(1),2,maximum stat))
set variable(miacc,get hero stat(find hero(1),3,maximum stat))
set variable(midef,get hero stat(find hero(1),4,maximum stat))
set variable(middg,get hero stat(find hero(1),5,maximum stat))
set variable(miskl,get hero stat(find hero(1),6,maximum stat))
set variable(mievd,get hero stat(find hero(1),7,maximum stat))

variable(milevel)
set variable(milevel,get hero level(find hero(1)))
if ( milevel >> 0 ) then(
	palout(1)
	show backdrop(0)
	palin(1)
	mila hp calculator
	set hero stat(find hero(1),0,get hero stat(find hero(1),0,maximum stat),current stat)
	mila level up(milevel,225)
	wait(4)
	show backdrop(0)
	wait(4)
	palout(1)
	show map
	wait(1)
	palin(1)
)

end
###

#########################
script, forestdunc, begin
suspend player
suspend npcs
suspend obstruction

set npc position (NPC at spot (77,148), 0,0)
write pass block (77,149,128)
wait (2)
walk hero (0,down,3)
wait for hero (0)
wait (2)
palout(5)
wait (50)
teleport to map (66,56,171)
stop song
set hero position (0,0,0)
camera follows npc (34)
wait (1)
focus camera (56,156,2)
set npc position (34,56,157)
set npc direction (34,down)
palin(25)
wait for camera
wait (15)
set npc direction (33,down)
wait (2)
set npc direction (33,left)
wait (2)
walk npc (33,left,2)
wait for npc (33)
set npc frame (33,0)
wait (2)
set npc direction (33,up)
jig npc (33)
tb (185)
jig npc (34)
tb (186)
jig npc (33)
tb (187)
walk npc (33,left,2)
show text box (188)
wait for npc (33)
set npc frame (33,0)
wait for text box
set npc direction (33,down)
wait (2)
set npc direction (33,right)
wait (2)
walk npc (33,right,2)
show text box (189)
wait for npc (33)
set npc frame (33,0)
set npc direction (33,up)
wait for text box
jig npc (34)
tb (190)
jig npc (33)
tb (191)
jig npc (34)
tb (192)
jig npc (33)
show text box (193)
wait (2)
set npc direction (33,right)
wait (2)
wait for text box
jig npc (34)
tb (194)
wait (15)
set npc direction (33,up)
jig npc (33)
tb (195)
wait (2)
tb (196)
jig npc (34)
tb (197)
wait (2)
set npc direction (33,left)
show text box (198)
wait (2)
walk npc (33,down,7)
wait for text box
jig npc (34)
tb (199)
wait for npc (33)
set npc position (33,0,0)
pan camera (up,6,1)
wait (2)
set npc direction (34,right)
wait (2)
walk npc (34,up,6)
wait (20)
wait for npc (34)
wait for camera
wait (2)
show text box (200)
wait for text box
wait (2)
set npc direction (34,left)
wait (2)
set npc direction (34,down)
tb (201)

play song(59)

variable (k)
for (k,0,10,1) do, begin
put camera (970+(random(-10,10)),2910+(random(-10,10)))
wait (1)
end
put camera (970,2910)

set npc direction (34,left)
wait (2)
set npc direction (34,up)
wait (25)

for (k,0,10,1) do, begin
put camera (970+(random(-10,10)),2910+(random(-10,10)))
wait (1)
end
put camera (970,2910)

wait (10)

pan camera (up,17,20)
wait for camera
pan camera (up,1,5)
wait for camera
pan camera (up,1,2)
wait for camera

wait (25)
for (k,0,10,1) do, begin
put camera (970+(random(-10,10)),2530+(random(-10,10)))
wait (1)
end
put camera (970,2530)

load tileset (66)

write map block (55,130,54)
write map block (56,130,55)
write map block (57,130,56)
write map block (55,131,45)
write map block (56,131,46)
write map block (57,131,47)
write map block (55,132,73)
write map block (56,132,74)
write map block (57,132,75)

wait (25)
for (k,0,10,1) do, begin
put camera (970+(random(-10,10)),2530+(random(-10,10)))
wait (1)
end
put camera (970,2530)

write map block (55,130,70)
write map block (56,130,71)
write map block (57,130,72)
write map block (55,131,57)
write map block (56,131,58)
write map block (57,131,59)

wait (25)
for (k,0,30,1) do(
put camera (970+(random(-10,10)),2530+(random(-10,10)))
wait (1)
)
put camera (970,2530)

write map block (55,130,38)
write map block (56,130,39)
write map block (57,130,40)

set npc position (3,56,129)
walk npc (3,down,12)

for (k,1,9,1) do(
create NPC (3,55,130,down)
create NPC (3,57,130,down)
wait (random(1,3))
walk npc (NPC reference (3,k),down,12)
wait (random(1,3))
walk npc (NPC reference (3,k+1),down,12)
wait (random(1,3))
create npc (3,56,129,down)
walk npc (npc reference (3,k+2),down,12)
)
wait for npc (npc reference (3,k+2))

set tag (13,1)

wait (10)
jig gahn
tb (202)
pan camera (down,17,20)
wait for camera
pan camera (down,1,5)
wait for camera
pan camera (down,1,2)
wait for camera
jig npc (34)
tb (203)
pan camera (up,17,20)
wait for camera
pan camera (up,1,5)
wait for camera
pan camera (up,1,2)
wait for camera
jig gahn
tb (204)
wait (2)
jig gahn
tb (205)
wait (2)
write pass block (56,128,128)
set npc position (32,56,129)
wait (8)
walk npc (32,down,4)
wait for npc (32)
set npc frame (32,0)
wait (35)
walk npc (32,left,1)
wait for npc (32)
set npc frame (32,0)
wait (2)
set npc direction (32,up)
jig npc (32)
tb (206)
wait (2)
jig gahn
tb (207)
wait (2)
jig gahn
tb (208)
pan camera (down,17,20)
wait for camera
pan camera (down,1,5)
wait for camera
pan camera (down,1,2)
wait for camera
wait (2)
load tileset (65)
walk npc (34,down,1)
set npc direction (34,up)
wait for npc (34)
wait (10)
set npc direction (34,right)
wait (2)
alter npc (34,npcstat:movespeed,4)
walk npc (34,down,8)
jig gahn
stop song
tb (209)
wait for npc (34)
pan camera (down,20,20)
play song(8)
alter npc (34,npcstat:movespeed,2)
walk npc (34,down,10)
wait for camera
alter npc (34,npcstat:movespeed,5)
alter npc (33,npcstat:picture,88)
alter npc (33,npcstat:palette,66)
alter npc (33,npcstat:movespeed,10)
wait for npc (34)
set npc position (33,56,162)
walk npc (34,down,8)
walk npc (33,down,14)
wait for npc (34)
wait for npc (33)
stop song
show backdrop (1)
wait (2)
show map
wait (35)
set npc position (32,56,162)
walk npc (32,down,8)
wait for npc (32)
set npc frame (32,0)
wait (20)
set npc direction (32,left)
wait (2)
set npc direction (32,up)
jig npc (32)
play song(57)
tb (210)
jig gahn
tb (211)
jig npc (32)
tb (212)
jig gahn
tb (213)
jig gahn
tb (214)
jig gahn
tb (215)
jig npc (32)
tb (216)
jig gahn
tb (217)
jig gahn
tb (218)
jig npc (32)
tb (219)
tb (598)
jig gahn
tb (220)
jig gahn
tb (221)
wait (10)
pan camera (right,12,2)
wait(25)
palout (25)
wait for camera
teleport to map (13,0,0)
stop song
suspend player
wait (1)
camera follows hero (0)
set hero position (0,30,78)
wait (1)
pan camera (up,0,0)
set hero position (0,39,74)
wait (1)
pan camera (right,15,2)
palin (25)
wait for camera
set hero palette(find hero(0),2,outside battle)
set hero palette(find hero(0),2,inside battle)
set hero palette(find hero(1),30,outside battle)
set hero palette(find hero(1),30,inside battle)
wait (6)
walk hero (0,down,4)
wait for hero (0)
set hero frame(0,0)
wait(3)
jadeup(2,1)
wait(3)
set tag(8,0)
set tag(132,0)

#used for manx vanish from Fralin
set tag(285,1)

set hero speed (0,hspeed)
save game

play song(9)

resume obstruction
resume npcs
resume player
resume box advance
end
###

###############################
script, waterdungeondoor, begin
suspend player
set tag (8,1)
#variable (time)
#set variable (time,0)
set hero speed (0,4)

watdundoor1
watdundoor2
watdundoor3
watdundoor4
watdundoor5

set hero speed (0,hspeed)
set hero frame (0,0)

set tag (8,0)
resume player
end
###
##########################
script, watdundoor1, begin
if (herox(0)==45,and,heroy(0)==73) then(mrup(-1,-1,-1))
else(
if (herox(0)==45,and,heroy(0)==71) then(mrdown(0,0,0))
)
do(
if (herox(0)==53,and,heroy(0)==68) then(mrright(-2,-2,-2,night))
)
do(
if (herox(0)==55,and,heroy(0)==68) then(mrleft(-1,-1,-1,afternoon))
)
do(
if (herox(0)==45,and,heroy(0)==61) then(mrup(-1,-1,4,noon))
)
do(
if (herox(0)==45,and,heroy(0)==59) then(mrdown(-1,-1,-1,afternoon))
)
do(
if (herox(0)==45,and,heroy(0)==49) then(mrup(-1,-1,-1,afternoon))
)
do(
if (herox(0)==45,and,heroy(0)==47) then(mrdown(-1,-1,4,noon))
)
end
###
##########################
script, watdundoor2, begin
if (herox(0)==45,and,heroy(0)==37) then(
	mrup(-3,-3,7,noon)
	if(check tag(65)==false) then(
		suspend npcs
		suspend obstruction
		set hero frame(0,0)
		wait(2)
		jig npc(26)
		jig npc(26)
		tb(1054)
		set party out
		swap by position(find hero(0),0)
		alter npc(1,NPCstat:palette,get hero palette(findhero(1)))
		set npc position(1,herox(0),heroy(0))
		walk npc(1,right,1)
		wait(2)
		wait for npc(1)
		set npc frame(1,0)
		set npc direction(1,up)
		wait(6)
		jig hero(0)
		tb(1055)
		set npc direction(1,left)
		jig npc(1)
		set hero direction(0,right)
		tb(1056)
		walk npc(1,left,1)
		wait for npc(1)
		set npc position(1,0,0)
		set hero picture(0,1)
		set party in
		set hero direction(0,up)
		wait(4)
		show backdrop(7)
		wait(2)
		show map
		tb(1057)
		set tag(65,1)
		resume obstruction
		resume npcs
	)
)
else(
if (herox(0)==45,and,heroy(0)==35) then(mrdown(-1,-1,-1,afternoon))
)
do(
if (herox(0)==45,and,heroy(0)==25) then(
	mrup(-1,-6,-6,afternoon)
	if(check tag(66)==false) then(
		suspend npcs
		suspend obstruction
		set hero frame(0,0)
		wait(2)
		stop song
		show backdrop(7)
		wait(2)
		show map
		tb(631)
		set party out
		swap by position(find hero(0),0)
		jig hero(0)
		tb(632)
		alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
		set npc position(1,herox(0),heroy(0))
		walk npc (1,right,1)
		wait(2)
		set hero direction(0,right)
		wait for npc(1)
		set npc frame(1,0)
		wait(2)
		set npc direction(1,down)
		wait(2)
		set npc direction(1,left)
		jig npc(1)
		tb(633)
		jig hero(0)
		tb(634)
		alter npc(1,NPCstat:picture,83)
		set npc direction(1,down)
		jig npc(1)
		jig npc(1)
		tb(635)
		wait(7)
		set hero picture(0,41)
		wait(2)
		set hero picture(0,38)
		wait(2)
		set hero picture(0,41)
		tb(636)
		alter npc(1,NPCstat:picture,12)
		walk npc(1,left,1)
		wait for npc(1)
		set hero picture(0,1)
		set npc position(1,0,0)
		set party in
		set hero direction(0,up)
		set tag(66,1)
		resume obstruction
		resume npcs
	)
)
)
end
###
##########################
script, watdundoor3, begin
if (herox(0)==45,and,heroy(0)==23) then(mrdown(-3,-3,7,noon))
else(
if (herox(0)==45,and,heroy(0)==13) then(mrup(-7,-7,-7,night))
)
do(
if (herox(0)==45,and,heroy(0)==11) then(mrdown(-1,-6,-6,afternoon))
)
do(
if (herox(0)==37,and,heroy(0)==43) then(mrleft(-1,-1,4,noon))
)
do(
if (herox(0)==35,and,heroy(0)==43) then(mrright(-1,-1,-1,afternoon))
)
do(
if (herox(0)==27,and,heroy(0)==37) then(
	if(check tag(214),or,checktag(72)) then(mrup(-3,-3,4))
	else(killbutter)
)
)
do(
if (herox(0)==27,and,heroy(0)==35) then(mrdown(-1,-1,4))
)
do(
if (herox(0)==19,and,heroy(0)==43) then(mrleft(-3,-3,-3,afternoon))
)
do(
if (herox(0)==17,and,heroy(0)==43) then(mrright(-1,-1,4,noon))
)
end
###
##########################
script, watdundoor4, begin
if (herox(0)==12,and,heroy(0)==43) then(
	write pass block (12,43,0)
	write pass block (12,44,128)
	write pass block (12,45,128)
	walk hero (0,down,2)
	wait for hero (0)
	wait (1)
	#set variable (time,3)
	palout(3)
	set hero position(0,12,51)
	focus camera (9,54,20)
	wait for camera
	set pal(afternoon)
	wait (1)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (3)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (3)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (3)
	reset palette
	tweak palette (-5,-5,-5)
	update palette

	settp(-5,-5,-5)

	walk hero (0,down,3)
	wait for hero(0))
else(
if (herox(0)==12,and,heroy(0)==51) then(
#set variable (time,3)
	palout(3)
	set hero position(0,12,45)
	focus camera (9,42,20)
	wait for camera
	write pass block (12,43,0)
	write pass block (12,44,128)
	write pass block (12,45,128)
	set pal(afternoon)
	wait(1)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (3)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (3)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (3)
	reset palette
	tweak palette (-5,-5,-5)
	update palette

	reset palette
	tweak palette (-3,-3,-3)
	update palette

	settp(-3,-3,-3)

	walk hero(0,up,3)
	wait for hero(0)
	wait(1)
	write pass block (12,43,2+8+4)
	write pass block (12,44,0)
	write pass block (12,45,0))
)
do(
if (herox(0)==53,and,heroy(0)==43) then(mrright(-2,-2,1))
)
do(
if (herox(0)==55,and,heroy(0)==43) then(mrleft(-1,-1,-1,afternoon))
)
do(
if (herox(0)==71,and,heroy(0)==43) then(
	mrright(-3,-3,-3,night,5)
	set tag(711,1)
	set hero frame(0,0)
	suspend npcs
	suspend obstruction
	write pass block(75,42,0)
	write pass block(75,44,128)
	variable(d1)
	variable(d2)
	variable(d3)
#	set variable(d1,npc at spot(75,44))
#	set variable(d2,npc at spot(75,45))
#	set variable(d3,npc at spot(75,46))
	set variable(d1,create npc(30,75,44,up))
	set variable(d2,create npc(30,75,45,down))
	set variable(d3,create npc(30,75,46,down))
	walk npc(d3,up,3)
	set npc direction(d3,down)
	walk npc(d2,up,3)
	set npc direction(d2,down)
	walk npc(d1,up,3)
	wait(10)
	set hero direction(0,down)
	wait(2)
	set hero direction(0,left)
	wait for npc(d1)
	resume obstruction
	resume npcs
)
)
end
###
##########################
script, watdundoor5, begin
if (herox(0)==73,and,heroy(0)==43) then(mrleft(-1,-1,4,noon))
else(
if (herox(0)==63,and,heroy(0)==37) then(
	mrup(-4,-1,6,morning)

	if(check tag(68)==false) then(
		suspend npcs
		suspend obstruction
		walk hero(0,up,1)
		wait for hero(0)
		set hero frame(0,0)
		wait(2)
		stop song
		show backdrop(7)
		wait(2)
		show map
		tb(660)
		set party out
		swap by position(findhero(0),0)
		jig hero(0)
		tb(661)
		alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
		set npc position(1,herox(0),heroy(0))
		walk npc(1,right,1)
		wait for npc(1)
		set npc frame(1,0)
		wait(2)
		set npc direction(1,down)
		wait(2)
		set npc direction(1,left)
		jig npc(1)
		tb(662)
		set hero direction(0,right)
		jig hero(0)
		tb(663)
		alter npc(1,NPCstat:picture,80)
		wait(12)
		jig hero(0)
		tb(664)
		jig npc(1)
		tb(665)
		tb(666)
		alter npc(1,NPCstat:picture,12)
		walk npc(1,left,1)
		wait for npc(1)
		set npc position(1,0,0)
		set party in
		set tag(68,1)
		resume obstruction
		resume npcs
		play song(9)
	)
)
)
do(
if (herox(0)==63,and,heroy(0)==35) then(mrdown(-1,-1,4,noon))
)
do(
if (herox(0)==63,and,heroy(0)==25) then(
	if(check tag(69)==false) then(stop song)
	mrup(-1,-1,-1,afternoon)
)
)
do(
if (herox(0)==63,and,heroy(0)==23) then(mrdown(-1,-1,4,morning))
)
do(
if (herox(0)==63,and,heroy(0)==13) then(
	if(check tag(72)) then(mrup(-4,-4,10,noon))
	else(
		set tag(72,1)
		meet anon
	)
)
)
do(
if (herox(0)==63,and,heroy(0)==11) then(mrdown(-1,-1,-1,morning))
)
do(
if (herox(0)==39,and,heroy(0)==74) then(
	wait(3)
	palout(3)
	camera follows hero(0)
	teleport to map(9+poff,77,149)
	wait(1)
	write pass block(77,149,128)
	pan camera(up,3,20)
	wait for camera
	sethp
	settp
	wait(1)
	palin(3)
	walk hero(0,up,3)
	wait for hero(0)
	set hero frame(0,0)
	camera follows hero(0)
	write pass block(77,149,2+4+8))
)
do(
if (herox(0)==63,and,heroy(0)==16) then(
set pal(morning)
set npc position(npc at spot(63,16),63,17)
set npc position(npc at spot(0,2),62,16)
set npc position(npc at spot(1,2),64,16))
)
do(
if ((herox(0)==63,and,heroy(0)==17),or,(herox(0)==62,or,herox(0)==64,and,heroy(0)==16)) then(
set pal(afternoon)
set npc position(npc at spot(63,17),63,16)
set npc position(npc at spot(62,16),0,2)
set npc position(npc at spot(64,16),1,2))
)
end
###

###############################
script, water door north, begin
suspend player
suspend npcs
suspend obstruction
set tag(8,1)
set tag (27,1)
set hero direction (0,north)
set hero frame (0,0)

#anon doors
if (herox(0)==63,and,heroy(0)==40,and,current map==13) then(wdn1)
if (herox(0)==63,and,heroy(0)==28,and,current map==13) then(wdn2)
if (herox(0)==45,and,heroy(0)==40,and,current map==13) then(wdn3)
if (herox(0)==45,and,heroy(0)==64,and,current map==13) then(wdn4)
#grinlow interior intro door
if (herox(0)==9,and,heroy(0)==28,and,current map==67) then(wdn5)

wait (1)
set tag (15,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

###################
script, wdn1, begin

if (check tag(49)==false) then(
set party out
swap by position(findhero(0),0)
jig hero(0)
tb(624)
alter npc(1,NPCstat:palette,get hero palette (findhero(1)))
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
wait(2)
set hero direction(0,right)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(625)
jig hero(0)
tb(626)
jig npc(1)
tb(627)
walk npc(1,left,1)
wait for npc(1)
set npc position(1,0,0)
set party in
set hero direction(0,up)
set tag(49,1)
)

if (check tag(50)) then(
show text box(628)

write pass block (herox(0)--1,heroy(0),128)
write pass block (herox(0)--1,heroy(0)--1,128)
write pass block (herox(0)--1,heroy(0)--2,128)
write pass block (herox(0)--1,heroy(0)--3,128)

variable (xxx)
set variable (xxx,hero pixel X (0))
variable (d1)
variable (d2)
variable (d3)
variable (d4)
set variable (d1,NPC at spot (herox(0),heroy(0)))
set variable (d2,NPC at spot (herox(0),heroy(0)--1))
set variable (d3,NPC at spot (herox(0),heroy(0)--2))
set variable (d4,NPC at spot (herox(0),heroy(0)--3))

variable (i)
for (i,1,20,1) do(
put npc (d1,xxx--i,hero pixel y(0))
put npc (d2,xxx--i,hero pixel y(0)--20)
put npc (d3,xxx--i,hero pixel y(0)--40)
put npc (d4,xxx--i,hero pixel y(0)--60)
wait (1)
)

#set npc position (d1,0,0)
#set npc position (d2,0,0)
#set npc position (d3,0,0)
#set npc position (d4,0,0)
destroy npc(d1)
destroy npc(d2)
destroy npc(d3)
destroy npc(d4)
create npc(35,63,37)

write pass block (herox(0)--1,heroy(0),0)
write pass block (herox(0)--1,heroy(0)--1,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--2,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--3,1+2+4+8)

write pass block (herox(0),heroy(0),0)

wait for text box
set tag(298,1)
)
else(
jig hero(0)
tb(629)
)

end
###

###################
script, wdn2, begin

if (check tag(52)==false) then(
jig hero(0)
tb(667)
set tag(52,1)
wait(10)
)

if (check tag(51)) then(
show text box(1051)
write pass block (herox(0)--1,heroy(0),128)
write pass block (herox(0)--1,heroy(0)--1,128)
write pass block (herox(0)--1,heroy(0)--2,128)
write pass block (herox(0)--1,heroy(0)--3,128)

variable (xxx)
set variable (xxx,hero pixel X (0))
variable (d1)
variable (d2)
variable (d3)
variable (d4)
set variable (d1,NPC at spot (herox(0),heroy(0)))
set variable (d2,NPC at spot (herox(0),heroy(0)--1))
set variable (d3,NPC at spot (herox(0),heroy(0)--2))
set variable (d4,NPC at spot (herox(0),heroy(0)--3))

variable (i)
for (i,1,20,1) do(
put npc (d1,xxx--i,hero pixel y(0))
put npc (d2,xxx--i,hero pixel y(0)--20)
put npc (d3,xxx--i,hero pixel y(0)--40)
put npc (d4,xxx--i,hero pixel y(0)--60)
wait (1)
)

#set npc position (d1,0,0)
#set npc position (d2,0,0)
#set npc position (d3,0,0)
#set npc position (d4,0,0)
destroy npc(d1)
destroy npc(d2)
destroy npc(d3)
destroy npc(d4)
create npc(35,63,25)

write pass block (herox(0)--1,heroy(0),1+2+4+8)
write pass block (herox(0)--1,heroy(0)--1,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--2,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--3,1+2+4+8)

write pass block (herox(0),heroy(0),0)

wait for text box
set tag(299,1)
)
else(
jig hero(0)
tb(629)
)

end
###

###################
script, wdn3, begin
if (inventory (29)>>0) then(
show text box (222)
wait for text box
if (check tag (15)) then(

if(heroy(0)==64,and,current map==13) then(set tag(73,1))
if(heroy(0)==40,and,current map==13) then(set tag(74,1))

delete item (29,1)
write pass block (herox(0)--1,heroy(0),128)
write pass block (herox(0)--1,heroy(0)--1,128)
write pass block (herox(0)--1,heroy(0)--2,128)
write pass block (herox(0)--1,heroy(0)--3,128)

variable (xxx)
set variable (xxx,hero pixel X (0))
variable (d1)
variable (d2)
variable (d3)
variable (d4)
set variable (d1,NPC at spot (herox(0),heroy(0)))
set variable (d2,NPC at spot (herox(0),heroy(0)--1))
set variable (d3,NPC at spot (herox(0),heroy(0)--2))
set variable (d4,NPC at spot (herox(0),heroy(0)--3))

variable (i)
for (i,1,20,1) do(
put npc (d1,xxx--i,hero pixel y(0))
put npc (d2,xxx--i,hero pixel y(0)--20)
put npc (d3,xxx--i,hero pixel y(0)--40)
put npc (d4,xxx--i,hero pixel y(0)--60)
wait (1)
)

#set npc position (d1,0,0)
#set npc position (d2,0,0)
#set npc position (d3,0,0)
#set npc position (d4,0,0)
destroy npc(d1)
destroy npc(d2)
destroy npc(d3)
destroy npc(d4)
create npc(35,45,37)

write pass block (herox(0)--1,heroy(0),0)
write pass block (herox(0)--1,heroy(0)--1,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--2,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--3,1+2+4+8)

write pass block (herox(0),heroy(0),0)

set tag (27,0)

if (herox(0)==45,and,heroy(0)==64) then(
set tag (14,1))

)
)
if (inventory (29)==0,and,check tag(27)) then(tb (84)
if (current map==67) then(tb(86)))
end
###

###################
script, wdn4, begin
if (inventory (29)>>0) then(
show text box (222)
wait for text box
if (check tag (15)) then(

if(heroy(0)==64,and,current map==13) then(set tag(73,1))
if(heroy(0)==40,and,current map==13) then(set tag(74,1))

delete item (29,1)
write pass block (herox(0)--1,heroy(0),128)
write pass block (herox(0)--1,heroy(0)--1,128)
write pass block (herox(0)--1,heroy(0)--2,128)
write pass block (herox(0)--1,heroy(0)--3,128)

variable (xxx)
set variable (xxx,hero pixel X (0))
variable (d1)
variable (d2)
variable (d3)
variable (d4)
set variable (d1,NPC at spot (herox(0),heroy(0)))
set variable (d2,NPC at spot (herox(0),heroy(0)--1))
set variable (d3,NPC at spot (herox(0),heroy(0)--2))
set variable (d4,NPC at spot (herox(0),heroy(0)--3))

variable (i)
for (i,1,20,1) do(
put npc (d1,xxx--i,hero pixel y(0))
put npc (d2,xxx--i,hero pixel y(0)--20)
put npc (d3,xxx--i,hero pixel y(0)--40)
put npc (d4,xxx--i,hero pixel y(0)--60)
wait (1)
)

#set npc position (d1,0,0)
#set npc position (d2,0,0)
#set npc position (d3,0,0)
#set npc position (d4,0,0)
destroy npc(d1)
destroy npc(d2)
destroy npc(d3)
destroy npc(d4)
create npc(35,45,61)

write pass block (herox(0)--1,heroy(0),0)
write pass block (herox(0)--1,heroy(0)--1,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--2,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--3,1+2+4+8)

write pass block (herox(0),heroy(0),0)

set tag (27,0)

if (herox(0)==45,and,heroy(0)==64) then(
set tag (14,1))

)
)
if (inventory (29)==0,and,check tag(27)) then(tb (84)
if (current map==67) then(tb(86)))
end
###

###################
script, wdn5, begin
if (inventory (29)>>0) then(
show text box (222)
wait for text box
if (check tag (15)) then(

if(heroy(0)==64,and,current map==13) then(set tag(73,1))
if(heroy(0)==40,and,current map==13) then(set tag(74,1))

delete item (29,1)
write pass block (herox(0)--1,heroy(0),128)
write pass block (herox(0)--1,heroy(0)--1,128)
write pass block (herox(0)--1,heroy(0)--2,128)
write pass block (herox(0)--1,heroy(0)--3,128)

variable (xxx)
set variable (xxx,hero pixel X (0))
variable (d1)
variable (d2)
variable (d3)
variable (d4)
set variable (d1,NPC at spot (herox(0),heroy(0)))
set variable (d2,NPC at spot (herox(0),heroy(0)--1))
set variable (d3,NPC at spot (herox(0),heroy(0)--2))
set variable (d4,NPC at spot (herox(0),heroy(0)--3))

variable (i)
for (i,1,20,1) do(
put npc (d1,xxx--i,hero pixel y(0))
put npc (d2,xxx--i,hero pixel y(0)--20)
put npc (d3,xxx--i,hero pixel y(0)--40)
put npc (d4,xxx--i,hero pixel y(0)--60)
wait (1)
)

#set npc position (d1,0,0)
#set npc position (d2,0,0)
#set npc position (d3,0,0)
#set npc position (d4,0,0)
destroy npc(d1)
destroy npc(d2)
destroy npc(d3)
destroy npc(d4)
create npc(35,9,25)

write pass block (herox(0)--1,heroy(0),0)
write pass block (herox(0)--1,heroy(0)--1,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--2,1+2+4+8)
write pass block (herox(0)--1,heroy(0)--3,1+2+4+8)

write pass block (herox(0),heroy(0),0)

set tag (27,0)

if (herox(0)==45,and,heroy(0)==64) then(
set tag (14,1))

)
)
if (inventory (29)==0,and,check tag(27)) then(tb (84)
if (current map==67) then(tb(86)))
end
###

############################
script, grin interior, begin
suspend player
set tag (8,1)
set hero speed(0,4)


if(heroy(0) << 75) then(grininterior1)
else(grininterior2)


set hero speed (0,hspeed)
if(current map==68) then(set hero speed(0,2))
set hero frame (0,0)

set tag (8,0)
resume player
end
###
############################
script, grininterior1, begin
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==61) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0)
)else(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==59) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==49) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==47) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==41) then(
variable(hxx)
set variable(hxx,herox(0))
palout(10)
camera follows hero(0)
set hero position(0,9,30)
wait(1)
pan camera(south,0,0)
set hero position (0,(hxx--36),36)
wait(10)
play song(94)
palin(10)
walk hero(0,up,2)
wait for hero(0))
)
do(
if (herox(0)==9,and,heroy(0)==25) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0)
write pass block(9,23,1+2+4+8))
)
do(
if (herox(0)==9,and,heroy(0)==23) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
if (herox(0)==9,and,heroy(0)==15) then(

grinintrobattle

walk hero (0,up,3)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)
wait for camera
wait for hero(0)
set hero position (0,18,7)
wait(1)
walk hero (0,right,2)
wait for hero(0))
)
do(
if (herox(0)==19,and,heroy(0)==7) then(
walk hero (0,right,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(1046)
)
)
do(
if (herox(0)==35,and,heroy(0)==7) then(
walk hero (0,right,1)
pan camera (right,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,45,12)
wait(1)
walk hero (0,down,2)
wait for hero(0)
write pass block(45,13,1))
)
do(
if (herox(0)==45,and,heroy(0)==13) then(
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(426)
#walk hero (0,up,1)
#pan camera (up,12,10)
#wait for camera
#pan camera (left,18,10)
#wait for camera
#set hero position (0,36,7)
#wait(1)
#walk hero (0,left,2)
#wait for hero(0)
)
)
do(
if (herox(0)==27,and,heroy(0)==11) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero(0)
write pass block(27,13,1))
)
do(
if (herox(0)==27,and,heroy(0)==13) then(
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(426)
#pan camera (up,12,10)
#walk hero (0,up,3)
#wait for camera
#wait for hero(0)
)
)
do(
if (herox(0)==27,and,heroy(0)==23) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero(0)
write pass block(27,25,1)
write pass block(35,31,2+128))
)
do(
if (herox(0)==27,and,heroy(0)==25) then(
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(426)
#pan camera (up,12,10)
#walk hero (0,up,3)
#wait for camera
#wait for hero(0)
)
)
do(
if (herox(0)==45,and,heroy(0)==23) then(
walk hero (0,down,2)
pan camera (down,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,31)
wait(1)
walk hero (0,left,2)
wait for hero(0)
write pass block(27,25,1)
write pass block(35,31,2+128))
)
do(
if (herox(0)==35,and,heroy(0)==31) then(
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(426)
#walk hero (0,right,1)
#pan camera (right,18,10)
#wait for camera
#pan camera (up,12,10)
#wait for camera
#set hero position (0,45,24)
#wait(1)
#walk hero (0,up,2)
#wait for hero(0)
)
)
do(
if (herox(0)==21,and,(heroy(0)==30,or,heroy(0)==31,or,heroy(0)==32)) then(
walk hero (0,up,3)
walk hero (0,left,3)
wait for hero(0)
palout(3)
camera follows hero (0)
teleport to map (66,56,96)
wait(1)
pan camera (north,0,0)
wait(1)
set hero position (0,55,102)
wait(10)
palin(3)
set hero speed (0,2)
walk hero (0,up,1)
wait for hero(0)
walk hero (0,right,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,right,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,right,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,2)
wait for hero (0)
walk hero (0,up,1)
walk hero (0,right,1)
wait for hero (0)
set hero speed (0,4)
wait(10)
palout(3)
camera follows hero (0)
wait(1)
teleport to map (67,9,59)
wait(1)
pan camera (up,5,20)
wait for camera
wait (10)
palin(3)
walk hero (0,up,3)
wait for hero(0)

set tag(8,0)
save game
)
)
do(
if (herox(0)==9,and,heroy(0)==49) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)
wait for camera
set hero position (0,18,43)
wait(1)
walk hero (0,right,2)
wait for hero(0)
write pass block(19,43,1+2+4+8))
)
do(
if (herox(0)==19,and,heroy(0)==43) then(
walk hero (0,left,1)
pan camera (left,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,9,48)
wait(1)
walk hero (0,down,2)
wait for hero(0))
)
do(
if ((herox(0)==26,or,herox(0)==27,or,herox(0)==28),and,heroy(0)==47) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==26,or,herox(0)==27,or,herox(0)==28),and,heroy(0)==49) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==26,or,herox(0)==27,or,herox(0)==28),and,heroy(0)==59) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==26,or,herox(0)==27,or,herox(0)==28),and,heroy(0)==61) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==21,and,(heroy(0)==68,or,heroy(0)==69,or,heroy(0)==70)) then(
walk hero (0,up,3)
walk hero (0,left,3)
wait for hero (0)
palout(3)
camera follows hero(0)
teleport to map (66,56,88)
wait(1)
pan camera(north,0,0)
wait(1)
set hero position (0,59,87)
wait (10)
palin(3)
set hero speed (0,2)
walk hero (0,up,1)
walk hero (0,left,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
pan camera (up,12,10)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
walk hero (0,left,1)
wait for hero (0)
set hero speed (0,4)
wait (10)
palout(3)
camera follows hero(0)
teleport to map (67,9,95)
stop song
wait (1)
pan camera (up,5,20)
wait for camera
wait (10)
palin(3)
walk hero (0,up,3)
wait for hero(0)

if (find hero(7)<>-1) then(
suspend npcs
suspend obstruction
set party out
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
set hero frame(0,0)
walk npc(1,left,1)
walk npc(2,left,2)
walk npc(3,right,1)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
wait for npc(3)
set npc direction(3,up)
set npc frame(3,0)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)

play song(61)
jig npc(14)
tb(312)
tb(313)
set npc frame(14,1)
tb(314)
set npc frame(14,0)
wait(25)
jig npc(14)
tb(315)
battle flash
set party in
set variable(battlesfought,battlesfought+1)
if(fight formation(7)) then(set variable(battleswon,battleswon+1))
stop song
swap by position(0,findhero(0))
set npc position(npc at spot(7,89),0,0)
set npc position(npc at spot(11,89),0,0)
set npc position(16,0,0)

jig npc(1)
tb(316)
play song(61)
jig npc(14)
tb(317)
jig npc(3)
tb(318)
tb(319)
wait(1)
set npc frame(14,1)
wait(1)
set npc frame(14,0)
wait(1)
set npc frame(14,1)
wait(1)
set npc frame(14,0)
wait(1)
set npc frame(14,1)
tb(320)
set npc frame(14,0)
jig npc(2)
tb(321)
jig npc(14)
tb(322)

set npc direction(1,left)
set npc direction(3,right)
wait(2)
set npc direction(1,down)
set npc direction(3,down)
set npc direction(2,right)
set hero direction(0,left)
walk npc(14,up,4)
wait(2)
set npc direction(2,down)
set hero direction(0,down)
wait for npc(14)
set npc position(14,21,79)
set hero direction(0,left)
jig hero(0)
tb(323)
set npc direction(1,right)
jig npc(1)
tb(324)
walk npc(1,right,1)
walk npc(2,right,2)
walk npc(3,left,1)
wait for npc(1)
wait for npc(3)
wait for npc(2)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set hero direction(0,up)
set party in
resume obstruction
resume npcs
)
)
)
end
###
############################
script, grininterior2, begin
if (herox(0)==9,and,heroy(0)==85) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)

if (find hero(7)<>-1,and,npcy(14)==79) then(
suspend obstruction
walk npc(14,right,15)
wait for npc(14)
set npc position(14,45,94)
set npc direction(14,up)
set npc frame(14,0)
resume obstruction
)

wait for camera
set hero position (0,18,79)
wait(1)
walk hero (0,right,2)
wait for hero(0)
write pass block(19,79,1+2+4+8))
else(
if (herox(0)==19,and,heroy(0)==79) then(
walk hero (0,left,1)
pan camera (left,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,9,84)
wait(1)
walk hero (0,down,2)
wait for hero(0))
)
do(
if (herox(0)==35,and,heroy(0)==79) then(
walk hero (0,right,1)
pan camera (right,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,45,84)
wait(1)
walk hero (0,down,2)
wait for hero(0)
write pass block(45,85,1+2+4+8))
)
do(
if (herox(0)==45,and,heroy(0)==85) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,79)
wait(1)
walk hero (0,left,2)
wait for hero(0))
)
do(
if (herox(0)==45,and,heroy(0)==95) then(
slime boss fight
)
)
do(
if (herox(0)==35,and,heroy(0)==103) then(
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(426)
#walk hero (0,right,2)
#pan camera (right,18,10)
#wait for camera
#pan camera (up,12,10)
#wait for camera
#set hero position (0,45,97)
#wait(1)
#walk hero (0,up,3)
#wait for hero(0)
)
)
do(
if (herox(0)==21,and,(heroy(0)==102,or,heroy(0)==103,or,heroy(0)==104)) then(
walk hero (0,up,3)
walk hero (0,left,3)
wait for hero(0)
palout(3)
camera follows hero (0)
teleport to map (66,56,60)
wait(1)
pan camera (north,0,0)
wait(1)
set hero position (0,51,64)
wait(10)
palin(3)
set hero speed (0,2)
walk hero (0,up,5)
wait for hero (0)
set hero speed (0,4)
wait (25)
write map block (51,59,79)
wait (15)
palout(3)
camera follows hero (0)
teleport to map (67,9,132)
stop song
wait(1)
pan camera (up,6,20)
wait for camera
wait (5)
play song(68)
palin(3)
walk hero (0,up,3)
wait for hero (0)

set variable(musicsave,68)
set tag(8,0)
save game
)
)
do(
if (herox(0)==9,and,heroy(0)==121) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)
wait for camera
set hero position (0,18,114)
wait(1)
walk hero (0,right,2)
wait for hero(0)
write pass block(19,114,1+2+4+8))
)
do(
if (herox(0)==19,and,heroy(0)==114) then(
walk hero (0,left,1)
pan camera (left,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,9,120)
wait(1)
walk hero (0,down,2)
wait for hero(0))
)
do(
if (herox(0)==35,and,heroy(0)==114) then(
walk hero (0,right,1)
pan camera (right,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,45,120)
wait(1)
walk hero (0,down,2)
wait for hero(0)
write pass block(45,121,1+2+4+8))
)
do(
if (herox(0)==45,and,heroy(0)==121) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,114)
wait(1)
walk hero (0,left,2)
wait for hero(0))
)
do(
if (herox(0)==45,and,heroy(0)==131) then(
walk hero (0,down,2)
pan camera (down,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,140)
wait(1)
walk hero (0,left,2)
wait for hero(0)
write pass block(35,140,1+2+4+8))
)
do(
if (herox(0)==35,and,heroy(0)==140) then(
walk hero (0,right,1)
pan camera (right,18,10)
wait for camera
pan camera (up,12,10)
wait for camera
set hero position (0,45,133)
wait(1)
walk hero (0,up,3)
wait for hero(0))
)
do(
if (herox(0)==27,and,heroy(0)==133) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0)
write pass block(27,131,1+2+4+8))
)
do(
if (herox(0)==27,and,heroy(0)==131) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if (herox(0)==27,and,heroy(0)==121) then(
walk hero (0,up,1)
wait for hero (0)
stop song
set variable(musicsave,0)
palout(20)
camera follows hero(0)
teleport to map (68,21,50)
wait(1)
pan camera (up,1,20)
wait for camera
write pass block (21,50,128)
write pass block (21,49,128)
set hero palette(findhero(0),getheropalette(findhero(0))+3)
set hero palette(findhero(7),getheropalette(findhero(7))+3)
set hero palette(findhero(8),getheropalette(findhero(8))+3)
set hero palette(findhero(9),getheropalette(findhero(9))+3)
set hero palette(findhero(0),120,inside battle)
set hero palette(findhero(7),get hero palette(findhero(7)),inside battle)
set hero palette(findhero(8),get hero palette(findhero(8)),inside battle)
set hero palette(findhero(9),get hero palette(findhero(9)),inside battle)

wait (20)
palin(20)
set hero speed (0,2)
walk hero (0,up,3)
wait for hero (0)
write pass block (21,49,1+4))
)
end
###

#########################
script, grinzenith, begin
suspend player
set tag (8,1)
if (heroy(0)==44) then(
 if (herox(0)==15) then( walk hero (0,right,1) wait for hero (0))
 if (herox(0)==27) then( walk hero (0,left,1) wait for hero (0))

if (read map block(0,0)==1) then(
set npc position(4,21,36)
set npc position(5,21,36)
set npc position(6,21,37)
set npc direction(5,up)
set npc direction(6,up)
put npc(11,(21*20)--10,36*20)
set npc direction(11,down)
)

pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0)

if (read map block(0,0)==1) then( grin zen 3 )

)else(
if (heroy(0)==42) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)

set hero frame (0,0)
set tag (8,0)
resume player
end
###

####################
script, grin1, begin
suspend player

walk hero to x (0,45)
wait for hero (0)
set hero direction (0,up)
set hero frame (0,0)
jig npc (2)
tb (34)
jig npc (3)
tb (35)
jig npc (1)
tb (36)
jig npc (2)
tb (37)
tb (38)
jig npc (3)
tb (39)
jighero(0)
tb (40)
tb (41)
jignpc(1)
tb (42)
jighero(0)
tb (43)
set npc direction (2,down)
jignpc(2)
tb (44)
set npc direction (3,down)
jignpc(3)
tb (45)
jignpc(1)
show text box (46)
wait(2)
set npc direction (2,right)
set npc direction (3,left)
wait(2)
set npc direction (2,up)
set npc direction (3,up)
wait for text box
tb (47)
tb (48)
wait(20)
jignpc(1)
tb (49)
tb (85)
wait (7)
suspend obstruction
walk npc (1,down,1)
walk npc (2,right,1)
walk npc (3,left,1)
walk hero (0,up,1)
wait for npc (1)
wait for npc (2)
wait for npc (3)
wait for hero(0)
set npc position (1,0,0)
set npc position (2,0,0)
set npc position (3,0,0)
add hero (8)
add hero (9)
add hero (7)
swap by position (0,find hero(7))
set hero frame (0,0)

get item (50,9)
get item (55,3)

resume obstruction
resume player
end
###

####################
script, grin2, begin
suspend player
suspend npcs
suspend obstruction

set party out
swap by position(0,findhero(0))
set npc position (1,herox(0),heroy(0))
set npc position (2,herox(0),heroy(0))
set npc position (3,herox(0),heroy(0))
walk hero(0,down,1)
walk npc (1,up,1)
walk npc (2,left,1)
walk npc (3,right,1)
wait for hero(0)
wait for npc(1)
wait for npc(2)
wait for npc(3)
set hero direction(0,up)
set hero frame (0,0)
set npc direction (1,down)
set npc frame (1,0)
set npc direction (2,right)
set npc frame (2,0)
set npc direction (3,left)
set npc frame (3,0)

jig npc(1)
tb(235)
set npc direction(2,up)
jig npc(2)
tb(223)
jig npc(3)
set npc direction(2,right)
tb(224)
jig npc(1)
tb(225)
jig npc(3)
tb(226)
jig hero(0)
tb(227)
set npc direction(2,down)
jig npc(2)
tb(228)
jig npc(1)
tb(229)
jig hero(0)
set npc direction(3,down)
tb(230)
jig npc(3)
tb(231)
tb(232)
jig hero(0)
tb(233)
jig npc(1)
show text box(234)
set npc direction(2,right)
set npc direction(3,left)
wait(2)
set npc direction(2,up)
set npc direction(3,up)
wait for text box

walk npc (1,down,1)
walk npc (2,right,1)
walk npc (3,left,1)
walk hero (0,up,1)
wait for hero(0)
wait for npc(1)
wait for npc(2)
wait for npc(3)
set npc position (1,0,0)
set npc position (2,0,0)
set npc position (3,0,0)
set party in
resume obstruction
resume npcs
resume player
end
###

####################
script, grin3, begin
suspend player
suspend npcs
suspend obstruction

walk hero (0,right,5)
wait for hero(0)

set party out
swap by position(0,find hero(0))
set npc position (1,herox(0),heroy(0))
set npc position (2,herox(0),heroy(0))
set npc position (3,herox(0),heroy(0))
walk hero(0,down,1)
walk npc (1,up,1)
walk npc (2,left,1)
walk npc (3,right,1)
wait for hero(0)
wait for npc(1)
wait for npc(2)
wait for npc(3)
set hero direction(0,up)
set hero frame (0,0)
set npc direction (1,down)
set npc frame (1,0)
set npc direction (2,right)
set npc frame (2,0)
set npc direction (3,left)
set npc frame (3,0)

jig hero(0)
tb(240)
jig npc(1)
tb(241)
jig hero(0)
tb(242)
jig npc(1)
tb(243)
jig hero(0)
tb(244)
jig npc(2)
tb(245)
jig npc(3)
tb(246)
walk npc(3,right,8)
wait for npc(3)

write pass block(22,7,8)
write pass block(27,10,4)
write pass block(32,7,2)

alter npc(2,NPCstat:move speed,2)
set npc direction(1,left)
wait(2)
walk npc(1,up,1)
wait for npc(1)
walk npc(1,up,1)
walk npc(2,down,1)
wait for npc(1)
set npc frame (1,0)
wait for npc(2)
alter npc(2,NPCstat:move type,NPCmovetype:wander)

set tag(28,1)
set tag(29,1)
set tag(39,1)
swap out hero(7)
swap out hero(8)
swap out hero(9)
lock hero (7)
lock hero (8)
lock hero (9)
resume obstruction
resume npcs
resume player
wait(1)
while(check tag(28),or,checktag(29),or,checktag(39)) do(wait(1))
wait for text box
suspend player
wait for npc(2)
suspend npcs
suspend obstruction
alter npc(2,NPCstat:move speed,4)
alter npc(2,NPCstat:move type,NPCmovetype:standstill)
swap in hero(7)
swap in hero(8)
swap in hero(9)
unlock hero (7)
unlock hero (8)
unlock hero (9)

write pass block(22,7,0)
write pass block(27,10,0)
write pass block(32,7,0)

walk npc(3,left,5)
wait(10)
set npc direction(1,right)
wait(2)
set npc direction(2,right)
set npc frame(2,0)
wait(2)
set hero direction(0,right)
set hero frame(0,0)
wait for npc(3)
set npc frame(3,0)
jig npc(1)
tb(278)
jig npc(3)
tb(279)
tb(280)
tb(281)
jig npc(1)
tb(282)
walk hero to x(0,27)
walk npc to y(1,7)
walk npc to y(2,7)
walk npc to x(3,27)
wait for hero(0)
walk hero to y(0,7)
wait for npc(1)
walk npc to x(1,27)
wait for npc(2)
walk npc to x(2,27)
wait for hero(0)
walk hero to x(0,27)
wait for hero(0)
wait for npc(1)
wait for npc(2)
set hero direction(0,down)
set hero frame(0,0)
set npc position (1,0,0)
set npc position (2,0,0)
set npc position (3,0,0)
set party in
resume obstruction
resume npcs
resume player
end
###

####################
script, grin4, begin
if (read map block(herox(0),heroy(0))<>61) then(
suspend player
set hero frame (0,0)
wait(1)
set hero frame (0,1)
wait(1)
write map block (herox(0),heroy(0),60)
set hero frame (0,1)
wait(1)
set hero frame (0,0)
wait(1)
write map block (herox(0),heroy(0),61)

if(check tag(37)) then()
else(
stop song
variable (i)
for (i,1,5,1) do(
wait(1)
set npc frame(11,1)
wait(1)
set npc frame(11,0)
)
tb(293)
jig hero(0)
tb(292)
battle flash
set variable(battlesfought,battlesfought+1)
if(fight formation(2)) then(set variable(battleswon,battleswon+1))
set tag(37,1)
)

resume player
)
end
###

####################
script, grin5, begin
suspend player
suspend npcs
suspend obstruction

play song(6)

set tag (8,1)
set party out
if (find hero(9)==0) then(
swap by position(0,find hero(0))
)
set npc position(3,herox(0),heroy(0))
set npc direction(3,up)
walk hero(0,down,6)
wait for hero(0)
if (find hero(0)<>0) then(swap by position(0,find hero(0)))

variable(i)
for (i,1,6,1) do(
set npc frame (npc at spot(24,40),1)
set npc frame (npc at spot(25,41),1)
set npc frame (npc at spot(26,40),1)
set npc frame (npc at spot(27,41),1)
set npc frame (npc at spot(28,40),1)
set npc frame (npc at spot(29,41),1)
set npc frame (npc at spot(30,40),1)
wait(1)
set npc frame (npc at spot(24,40),0)
set npc frame (npc at spot(25,41),0)
set npc frame (npc at spot(26,40),0)
set npc frame (npc at spot(27,41),0)
set npc frame (npc at spot(28,40),0)
set npc frame (npc at spot(29,41),0)
set npc frame (npc at spot(30,40),0)
wait(1)
)
set npc position(1,27,52)
set npc direction(1,up)
set npc position(2,26,52)
set npc direction(2,up)
set hero position(0,28,52)
set hero direction(0,up)
pan camera (down,12,10)
set npc direction(3,right)
wait(2)
walk npc(3,down,5)
wait for npc(3)
wait for camera

alter npc(12,NPCstat:script,33)
jig npc(3)
tb(300)
jig npc(2)
tb(301)

walk npc (3,down,1)
walk npc (2,right,1)
walk hero (0,left,1)
wait for npc(3)
walk npc to x(3,27)
wait for npc(2)
wait for hero(0)
wait for npc(3)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
set hero direction(0,down)
alter npc(12,NPCstat:picture,118)
alter npc(12,NPCstat:move type,NPCmovetype:chaseyou)
resume obstruction
resume npcs
resume player
end
###

####################
script, grin6, begin
suspend player
suspend npcs
pan camera (down,12,10)
walk hero (0,down,6)
wait for camera
wait for hero (0)
walk hero to x(0,27)
wait for hero(0)
set hero direction(0,down)
set npc frame(0,0)
resume npcs

set party out
swap by position(0,find hero(0))
set npc position (1,herox(0),heroy(0))
set npc position (2,herox(0),heroy(0))
set npc position (3,herox(0),heroy(0))
suspend npcs
suspend obstruction
walk npc(2,left,2)
walk npc(3,right,1)
walk npc(1,left,1)
set hero frame(0,0)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,up)
set npc frame(3,0)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
resume obstruction
resume npcs

jig hero(0)
tb(302)
jig npc(1)
tb(303)
jignpc(2)
tb(304)
jignpc(3)
tb(305)
wait(2)
set npc direction(1,right)
wait(2)
set npc direction(1,down)
wait(4)
jig npc(1)
tb(306)

suspend npcs
suspend obstruction
walk npc(2,right,2)
walk npc(3,left,1)
walk npc(1,right,1)
wait for npc(2)
wait for npc(3)
wait for npc(1)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
set hero direction(0,down)

resume obstruction
resume npcs
resume player
wait (30)
set npc position(npc at spot(26,64),0,0)
set npc position(npc at spot(27,64),0,0)
set npc position(npc at spot(28,64),0,0)
end
###

##################
script,grin7,begin
suspend player
suspend npcs
suspend obstruction
alter npc(2,NPCstat:picture,1)
alter npc(2,NPCstat:palette,1)
set party out
swap by position(0,find hero(8))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
set npc direction(2,down)
set npc frame(2,0)
walk hero(0,left,2)
walk npc(1,left,1)
walk npc(3,right,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(3)
set npc direction(3,down)
set npc frame(3,0)
wait for hero(0)
set hero direction(0,down)
set hero frame(0,0)
resume obstruction
resume npcs

jig npc(14)
tb(325)
jig npc(2)
tb(326)
jig npc(1)
tb(327)
jig hero(0)
tb(328)
jig gahn
tb(430)
wait(1)
set hero picture(findhero(8),126)
alter npc(1,NPCstat:display text,0)
alter npc(2,NPCstat:display text,0)
alter npc(1,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
alter npc(2,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
alter npc(3,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
swap out hero(0)
swap out hero(7)
swap out hero(9)
lock hero(0)
lock hero(7)
lock hero(9)
resume player
set variable(hspeed,0)
alter npc(16,NPCstat:picture,127)
alter npc(15,NPCstat:picture,128)
alter npc(15,NPCstat:palette,1)
alter npc(15,NPCstat:move speed,20)
variable(ii)


while(hspeed<>5) do(
if (key is pressed (28),or,key is pressed (29),or,key is pressed (57)) then(
suspend player
suspend npcs
suspend obstruction
set hero frame(0,1)
wait(2)
set hero frame(0,0)
set npc position(16,herox(0),heroy(0))

for(ii,1,2,1) do(
if ((npcy(16)+1)==91) then(
if (read map block(0,0)<>0) then(
write map block (0,0,0)
walk npc(16,down,1)
wait for npc(16)
set npc position(16,0,0)
set npc frame(npc at spot(herox(0),91),1)
set npc position(15,51,91)
walk npc(15,left,11)
wait for npc(15)
write pass block (51,91,8)
set npc direction(14,left)
wait(1)
jig npc(14)
tb(329)
set tag(8,1)
walk npc(14,down,3)
wait for npc(14)
set npc position(14,27,103)
set npc direction(14,left)
set npc frame(14,0)
set tag(8,0)))
else(if (npcx(16)==44,and,(npcy(16)+1)==93) then(
write map block (44,93,16+(16*4)+1))
)
do(if (npcx(16)==45,and,(npcy(16)+1)==93) then(
write map block (45,93,16+16))
)
do(if (npcx(16)==46,and,(npcy(16)+1)==93) then(
write map block (46,93,16+(16*4)+2))
)

walk npc(16,down,1)
wait for npc(16)
)

set npc position(16,0,0)
resume obstruction
resume npcs
resume player
)
wait(1)
)
end
###

##################
script,grin8,begin
suspend player
suspend npcs
suspend obstruction
set party out
if (heroy(0)==112) then(walk hero(0,down,1) wait for hero(0))
if (heroy(0)==116) then(walk hero(0,up,1) wait for hero(0))
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,right,1)
walk hero(0,down,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,left)
set npc frame(3,0)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)

jig npc(2)
tb(338)
wait(4)
set npc direction(3,up)
wait(10)
set npc direction(3,left)
jig npc(3)
tb(339)
jig npc(1)
tb(340)
jig hero(0)
tb(341)
set npc direction(3,down)
jig npc(3)
tb(342)

walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,left,1)
walk hero(0,up,1)
wait for npc(1)
wait for npc(2)
wait for npc(3)
wait for hero(0)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
set hero direction(0,right)
set hero frame(0,0)
resume obstruction
resume npcs
resume player
end
###

##################
script,grin9,begin
suspend player
suspend npcs
suspend obstruction
set party out
walk hero to x(0,45)
wait for hero(0)
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,right,1)
walk hero(0,down,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,left)
set npc frame(3,0)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)

jig npc(3)
tb(343)
jig hero(0)
tb(344)
jig npc(1)
tb(345)
jig npc(2)
tb(346)
jig hero(0)
tb(424)
set npc direction(3,down)
jig npc(3)
tb(425)

walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,left,1)
walk hero(0,up,1)
wait for npc(1)
wait for npc(2)
wait for npc(3)
wait for hero(0)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
set hero direction(0,down)
set hero frame(0,0)
resume obstruction
resume npcs
resume player
end
###

###################
script,grin10,begin
suspend player
suspend npcs
suspend obstruction
set party out
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,right,1)
walk hero(0,down,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,left)
set npc frame(3,0)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)

jig hero(0)
tb(347)
jig npc(1)
tb(348)
jig hero(0)
tb(349)
set npc direction(2,down)
jig npc(2)
tb(350)
jig npc(3)
show text box(351)
set npc direction(2,right)
wait for text box
jig npc(1)
tb(352)
jig hero(0)
tb(353)
set npc direction(2,down)
jig npc(2)
tb(354)
jig npc(1)
show text box(355)
set npc direction(2,right)
set npc direction(3,up)
wait(2)
set npc direction(2,up)
wait for text box

walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,left,1)
walk hero(0,up,1)
wait for npc(1)
wait for npc(2)
wait for npc(3)
wait for hero(0)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
set hero direction(0,up)
set hero frame(0,0)
resume obstruction
resume npcs
resume player
end
###

############################
script,grincookietrick,begin
suspend player
suspend npcs
suspend obstruction

if (heroy(0)==91,and,read map block(0,0)<>0) then(
set npc frame(npc at spot(herox(0),heroy(0)),1)
set npc position(15,51,91)
walk npc to x(15,herox(0))
wait for npc(15)
over game)
else(if (herox(0)==44,and,heroy(0)==93) then(
write map block (44,93,32)
set hero position(0,3,3)
over game)
)
do(if (herox(0)==45,and,heroy(0)==93) then(
write map block (45,93,32)
set hero position(0,3,3)
over game)
)
do(if (herox(0)==46,and,heroy(0)==93) then(
write map block (46,93,32)
set hero position(0,3,3)
over game)
)

resume obstruction
resume npcs
resume player
end
###

#######################
script, grinzen1, begin
suspend player
suspend npcs
suspend obstruction
walk hero to x(0,21)
wait for hero(0)
set party out
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,right,1)
walk hero(0,down,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,left)
set npc frame(3,0)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)

jig npc(3)
tb(356)
jig hero(0)
tb(357)
jig npc(2)
tb(358)
jig npc(1)
tb(359)
set npc direction(3,up)
jig npc(3)
tb(360)
jig npc(1)
tb(361)
tb(362)
jig npc(2)
tb(363)
set npc direction(3,left)
jig npc(3)
tb(364)
jig npc(1)
tb(365)
jig hero(0)
tb(366)
jig npc(1)
tb(367)
tb(368)
jig npc(3)
tb(369)
jig npc(2)
tb(370)
tb(371)
wait(4)
set npc direction(1,left)
wait(2)
set npc direction(1,up)
wait(10)
walk npc (1,up,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
show text box(372)
set npc direction(2,up)
set npc direction(3,up)
wait for text box
wait(4)
jig npc(1)
tb(373)
wait(15)
jig npc(1)
tb(374)
wait(20)
jig npc(3)
tb(375)
set npc direction(2,right)
jig npc(2)
tb(376)
wait(4)
set npc direction(1,left)
wait(10)
walk npc(1,down,1)
wait for npc(1)
set npc frame(1,0)
wait(2)
jig npc(2)
show text box(2362)
wait(2)
set npc direction(3,left)
wait for text box
set npc direction(2,down)
wait(2)
walk npc(2,left,1)
set npc direction(1,left)
wait(2)
set hero direction(0,left)
wait for npc(2)
set npc frame(2,0)
wait(2)
set npc direction(2,up)
wait(6)
jig npc(2)
wait(2)
jig npc(2)
wait(6)

suspend npc walls

set npc position(11,npcx(2),npcy(2))
walk npc(11,up,1)
wait for npc(11)
walk npc(11,up,1)
set npc direction(11,left)
wait for npc(11)
alter npc(11,NPCstat:move speed,10)
alter npc(11,NPCstat:picture,207)
walk npc(11,left,1)
wait for npc(11)
walk npc(11,down,1)
walk npc(11,left,5)
wait(2)
set npc direction(2,left)
wait for npc(11)
set npc position(11,3,1)
alter npc(11,NPCstat:picture,205)
wait(12)
set npc direction(2,down)
wait(2)
walk npc(2,right,1)
wait for npc(2)

walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,left,1)
walk hero(0,up,1)
wait for npc(1)
wait for npc(2)
wait for npc(3)
wait for hero(0)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
set hero direction(0,down)
set hero frame(0,0)
set npc position(33,21,48)
resume npc walls
resume obstruction
resume npcs
resume player
end
###

#######################
script, grinzen2, begin
suspend player
suspend npcs
suspend obstruction

if(get hero picture(findhero(0))<>136) then(
set npc position(33,0,0)
set hero frame(0,0)

stop song

jig gahn
tb(377)
wait(10)
set hero direction(0,right)
wait(2)
walk hero(0,up,2)
wait for hero(0)

set party out
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,down,1)
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,right,1)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,left)
set npc frame(3,0)

jig npc(3)
tb(378)
jig hero(0)
tb(379)
jig npc(2)
tb(380)
jig npc(1)
tb(381)

walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,left,1)
walk hero(0,up,1)
wait for npc(1)
wait for npc(2)
wait for npc(3)
wait for hero(0)
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
set party in
write map block (0,0,1)
)
else( if (get hero picture(findhero(0))==136) then(
write pass block (21,49,128)
write pass block (21,50,128)
walk hero(0,down,2)
wait for hero(0)
wait(20)
palout(20)
camera follows hero(0)
teleport to map(0,0,0)
suspend box advance
wait(20)
show text box(419)
wait(10)
palin(3)
wait for key(use key)
palout(3)
advance text box
show text box(420)
wait(10)
palin(3)
wait for key(use key)
palout(3)
advance text box
resume box advance

wait(60)
intropolish

wait(20)                         #Save for after grinlow interior intro!
camera follows hero(0)
teleport to map (83,17,37)
stop song
wait(1)
pan camera (down,6,40)
wait for camera

#set hero picture (0,98)
#set hero palette(0,3)
add hero(6)
swap out hero(0)
lock hero(0)
swap by position(find hero(6),0)

set hero speed(0,hspeed)
wait(1)
play song(88)
palin(20)
wait (10)
write pass block(17,42,0)
set tag(8,1)
walk hero (0,down,6)
wait for hero
set tag(8,0)
camera follows hero(0)
write pass block(17,42,1)
set hero stat (find hero(0),0,get hero stat(find hero(0),0,maximum stat),current stat)
set hero stat (find hero(0),1,get hero stat(find hero(0),1,maximum stat),current stat)
write spell(find hero(0),0,0,0)
write spell(find hero(0),0,3,0)
write spell(find hero(0),0,4,0)
write spell(find hero(0),0,5,0)
set default weapon (find hero(0),30)
))
resume obstruction
resume npcs
resume player
end
###

#####################
script,grinzen3,begin
suspend player
suspend npcs
suspend obstruction

walk hero to x(0,21)
walk hero(0,up,1)
wait for hero(0)
set party out
swap by position(0,findhero(0))
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
set hero frame(0,0)
walk npc(1,left,1)
walk npc(2,left,2)
walk npc(3,right,1)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
wait for npc(3)
set npc direction(3,up)
set npc frame(3,0)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)

suspend npc walls
wait(15)
jig npc(11)
wait(2)
alter npc(11,NPCstat:movespeed,2)
alter npc(11,NPCstat:picture,206)
walk npc(11,up,1)
set npc direction(11,down)
wait for npc(11)
set npc position(11,20,35)
alter npc(11,NPCstat:movespeed,10)
alter npc(11,NPCstat:picture,207)
walk npc(11,left,1)
walk npc(11,down,4)
wait for npc(11)
set npc position(11,3,1)
resume npc walls
jig npc(2)
wait(7)

jig npc(1)
tb(382)
jig gahn
tb(383)
wait(2)
set npc direction(5,left)
set npc direction(6,left)
wait(5)
set npc direction(5,down)
set npc direction(6,down)
wait(5)
play song(57)
jig gahn
tb(384)
jig hero(0)
tb(385)
tb(386)
jig gahn
tb(387)
jig gahn
tb(388)
jig npc(2)
tb(389)
jig gahn
tb(390)
jig gahn
tb(391)
jig gahn
tb(392)
jig gahn
tb(393)
jig npc(3)
tb(394)
jig npc(2)
tb(395)
jig npc(1)
tb(396)
jig npc(2)
tb(397)
tweak palette(-63,63,-63)
update palette
wait(1)
reset palette
update palette
tb(398)
tweak palette(-63,63,-63)
update palette
wait(1)
reset palette
update palette
tb(399)
wait(15)
jig hero(0)
tb(400)
jig gahn
tb(401)
jig gahn
tb(402)
wait(5)
jig gahn
tb(403)
wait(10)
jig gahn
tb(404)
jig gahn
tb(405)
jig gahn
tb(406)
jig npc(2)
tb(407)
jig gahn
tb(408)
jig hero(0)
tb(409)
jig gahn
tb(410)
jig gahn
tb(411)
alter npc(5,NPCstat:Picture,95)
alter npc(6,NPCstat:Picture,96)
walk npc(5,right,1)
walk npc(6,right,1)
wait for npc(5)
wait for npc(6)
set npc direction(5,down)
set npc direction(6,down)
alter npc(5,NPCstat:picture,131)
alter npc(6,NPCstat:picture,132)
jig hero(0)
tb(422)
wait(4)
alter npc(4,NPCstat:picture,104)
jig npc(4)
alter npc(4,NPCstat:picture,133)
tb(423)

write spell(findhero(0),0,0,446+1)
set death script(44)
set party in
set variable(battlesfought,battlesfought+1)
if(fight formation(8)) then(set variable(battleswon,battleswon+1))
end
###

###############################
script, after gahn fight, begin
play song(8)
suspend obstruction
set party out
swap by position(0,findhero(0))
alter npc(4,NPCstat:picture,104)
alter npc(1,NPCstat:picture,137)
set npc direction(1,up)
alter npc(2,NPCstat:picture,134)
set npc direction(2,down)
alter npc(3,NPCstat:picture,137)
set npc direction(3,down)
set hero picture(0,97)
set hero direction(0,left)
set npc position(2,19,38)
set npc position(4,20,38)
set npc direction(4,left)

jig npc(2)
tb(412)
set npc frame(4,1)
wait(1)
show backdrop(1)
set npc frame(4,0)
alter npc(2,NPCstat:move speed,5)
wait(1)
show map
walk npc(2,left,1)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
tb(413)
jig npc(2)
tb(414)
walk npc(4,left,1)
wait for npc(4)
set npc frame(4,0)
wait(5)

variable(i)
for(i,1,4,1) do(
set npc frame(4,1)
wait(1)
show backdrop(1)
set npc frame(4,0)
set npc direction(2,left)
wait(1)
show map
wait(1)
set npc direction(2,down)
wait(2)
)

wait(10)
set npc direction(2,up)
wait(2)
alter npc(4,NPCstat:picture,133)
set npc direction(4,down)
wait(20)

set npc direction(3,left)
wait(4)
set npc direction(3,down)
wait(2)
set npc direction(3,left)
wait(5)
set npc direction(3,down)
wait(1)
alter npc(3,NPCstat:picture,110)
set npc direction(3,up)
wait(2)
set npc direction(3,right)
wait(2)
alter npc(3,NPCstat:move speed,4)
walk npc(3,down,5)
alter npc(5,NPCstat:picture,95)
alter npc(6,NPCstat:picture,96)
set npc frame(5,0)
set npc frame(6,0)
wait(2)
set npc frame(5,1)
set npc frame(6,1)
set npc position(7,npcx(6),npcy(6))
alter npc(7,NPCstat:move speed,20)
wait(2)
walk npc(7,down,3)
set npc frame(5,0)
set npc frame(6,0)
wait(2)
alter npc(5,NPCstat:picture,131)
alter npc(6,NPCstat:picture,132)
set hero direction(0,right)
wait for npc(7)
tweak palette(63,63,63)
update palette
set hero picture(0,59)
set npc direction(4,right)
wait(1)
reset palette
update palette
write pass block (25,40,0)
walk npc(7,right,8)
wait(10)
set hero picture(0,1)
wait for npc(7)
set npc direction(8,right)
set npc frame(8,0)
set npc position(8,herox(0),heroy(0))
wait(1)
set hero position(0,3,3)
set npc direction(8,up)
alter npc(5,NPCstat:picture,0)
alter npc(6,NPCstat:picture,135)
set npc position(9,npcx(6),npcy(6))
set npc position(5,npcx(8),npcy(8))
set npc position(6,npcx(8),npcy(8)+1)

for(i,1,5,1) do(
wait(1)
set npc frame(9,1)
set npc frame(6,0)
wait(1)
set npc frame(9,0)
set npc frame(6,1)
)

set npc position(9,0,0)
set npc direction(5,up)
set npc direction(6,up)
set npc frame(5,0)
set npc frame(6,0)
wait(1)
show backdrop(1)
alter npc(5,NPCstat:picture,95)
alter npc(6,NPCstat:picture,96)
set npc position(9,npcx(8),npcy(8)+1)
alter npc(8,NPCstat:picture,47)
alter npc(9,NPCstat:picture,47)
walk npc(8,up,2)
walk npc(9,up,2)
set npc direction(8,right)
set npc direction(9,down)
wait(1)
show map
set npc frame(5,1)
set npc frame(6,1)
wait(1)
set npc frame(5,0)
set npc frame(6,0)
wait(5)
alter npc(5,NPCstat:picture,131)
alter npc(6,NPCstat:picture,132)
wait for npc(8)
wait for npc(9)
alter npc(8,NPCstat:move speed,4)
alter npc(9,NPCstat:move speed,4)
walk npc(8,up,1)
walk npc(9,up,1)
set npc direction(8,right)
set npc direction(9,down)
wait for npc(8)
wait for npc(9)
set npc direction(4,up)
alter npc(8,NPCstat:move speed,2)
alter npc(9,NPCstat:move speed,2)
walk npc(8,up,1)
walk npc(9,up,1)
set npc direction(8,right)
set npc direction(9,down)
wait for npc(8)
wait for npc(9)
set hero picture(0,47)
set hero position(0,npcx(8),npcy(8))
set npc position(8,3,3)
set npc position(10,herox(0),heroy(0))
wait(30)

set npc direction(5,left)
set npc direction(6,left)
jig gahn
show text box(415)
wait(2)
set npc direction(4,right)
wait(2)
set npc direction(4,down)
wait for text box
jig gahn
tb(416)
jig gahn
tb(417)

wait(8)
set npc direction(1,right)
wait(3)
alter npc(1,NPCstat:picture,15)
set npc direction(1,up)
wait(10)
set npc direction(1,right)
wait(2)
alter npc(5,NPCstat:picture,95)
alter npc(6,NPCstat:picture,96)
walk npc(5,down,4)
walk npc(6,down,4)
wait(3)
alter npc(4,NPCstat:picture,104)
walk npc(4,down,8)
wait(10)
walk npc(1,down,1)
wait for npc(1)
wait(20)
set npc direction(1,left)
wait(2)
set npc direction(1,up)
wait(40)
set npc direction(1,right)
wait(2)
walk npc(1,down,3)
wait for npc(1)

play song(17)

variable(funfun)
set variable(funfun,0)
while (funfun<<5) do(
if (key is pressed(72),or,key is pressed(75),or,key is pressed(77),or,key is pressed(80)) then(
put hero (0,random((21*20)--2,(21*20)+2),random((36*20)--2,(36*20)+2))
put npc (9,hero pixel x(0),hero pixel y(0)+20)
wait(1)
put hero (0,random((21*20)--2,(21*20)+2),random((36*20)--2,(36*20)+2))
put npc (9,hero pixel x(0),hero pixel y(0)+20)
wait(1)
put hero (0,(21*20),(36*20))
put npc (9,hero pixel x(0),hero pixel y(0)+20)
set variable(funfun,funfun+1)
)
wait(1)
)

set npc position(9,0,0)
set hero picture(0,97)
set hero direction(0,left)
wait(20)
set hero direction(0,down)
wait(4)
set hero direction(0,right)
wait(4)
set hero direction(0,up)
wait(15)
set hero picture(0,136)
wait(1)
set hero frame(0,0)
set hero direction(0,left)
set hero speed(0,1)
delete hero(7)
delete hero(8)
delete hero(9)
delete item(50,9)
delete item(55,3)
set hero stat (findhero(0),0,1,currentstat)
set hero stat (findhero(0),1,0,currentstat)
set default weapon (find hero(0),0)

set npc position(1,0,0)
set npc position(3,0,0)
set npc position(4,0,0)
set npc position(5,0,0)
set npc position(6,0,0)
set npc position(33,21,48)
write pass block (25,40,2)
set death script(3)
resume obstruction
resume npcs
resume player

end
###

###########################
script, after grin battle, begin
#Set SP to Maximum
set hero stat (findhero(0),1,get hero stat(findhero(0),1,maximumstat),currentstat)
set hero stat (findhero(7),1,get hero stat(findhero(7),1,maximumstat),currentstat)
set hero stat (findhero(8),1,get hero stat(findhero(8),1,maximumstat),currentstat)
set hero stat (findhero(9),1,get hero stat(findhero(9),1,maximumstat),currentstat)

#Revive dead heroes
if(get hero stat(find hero(0),0,currentstat)==0) then(
set hero stat (findhero(0),0,(get hero stat(findhero(0),0,maximumstat)/4),currentstat))
if(get hero stat(find hero(7),0,currentstat)==0) then(
set hero stat (findhero(7),0,(get hero stat(findhero(7),0,maximumstat)/4),currentstat))
if(get hero stat(find hero(8),0,currentstat)==0) then(
set hero stat (findhero(8),0,(get hero stat(findhero(8),0,maximumstat)/4),currentstat))
if(get hero stat(find hero(9),0,currentstat)==0) then(
set hero stat (findhero(9),0,(get hero stat(findhero(9),0,maximumstat)/4),currentstat))
end
###

###############################
script, slime boss fight, begin
walk hero (0,down,2)
pan camera (down,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,103)
#if (find hero(8)<>-1,and,find hero(7)>>3) then(
set hero picture(0,109)
alter npc(2,NPCstat:picture,109)
alter npc(2,NPCstat:palette,106)
unlock hero(0)
unlock hero(7)
unlock hero(9)
swap in hero(0)
swap in hero(7)
swap in hero(9)
set party in
#write map block(1,0,0))
wait(1)
walk hero (0,left,2)
wait for hero(0)
write pass block(35,103,2+128)

#if (find hero(8)<>-1,and,read map block (1,0)==0) then(
write map block(1,0,1)
walk hero(0,left,3)
wait for hero(0)
suspend npcs
suspend obstruction
swap by position(find hero(0),0)
set hero direction(0,left)
set hero frame(0,0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,up,2)
walk npc(3,down,1)
wait for npc(1)
set npc direction(1,left)
set npc frame(1,0)
wait for npc(3)
set npc direction(3,left)
set npc frame(3,0)
wait for npc(2)
set npc direction(2,left)
set npc frame(2,0)
resume obstruction
resume npcs

wait(15)
set npc direction(14,down)
wait(4)
set npc direction(14,right)
wait(10)
set npc direction(14,down)
wait(4)
set npc direction(14,left)
wait(10)
set npc direction(14,down)
jig npc(14)
tb(330)
wait(2)
set npc direction(14,right)
wait(10)
set npc direction(14,down)
wait(1)
suspend npcs
suspend obstruction
walk npc(14,left,5)
wait for npc(14)
stop song
show backdrop(1)
set npc position(14,0,0)
wait(3)
show map
resume obstruction
resume npcs

jig npc(2)
tb(331)
jig npc(3)
tb(332)
jig hero(0)
tb(333)
jig npc(2)
tb(334)
jig npc(1)
tb(335)
set hero direction(0,up)
jig hero(0)
tb(336)
set npc direction(1,down)
jig npc(1)
tb(337)

walk npc(2,left,7)
walk npc(1,left,7)
walk npc(3,left,7)
walk hero(0,left,7)
#wait for npc(2)
#wait for npc(1)
wait for hero(0)
#wait for npc(3)
set npc frame(2,0)
set npc frame(1,0)
set hero frame(0,0)
set npc frame(3,0)
wait(4)
battle flash(1)
set party in
set variable(battlesfought,battlesfought+1)
if(fight formation(9)) then(set variable(battleswon,battleswon+1))
stop song
set npc position(1,0,0)
set npc position(2,0,0)
set npc position(3,0,0)
alter npc(17,NPCstat:picture,129)
set npc position(npc at spot(22,102),0,3)
set npc position(npc at spot(22,103),0,3)
set npc position(npc at spot(22,104),0,3)
set npc position(npc at spot(22,105),0,3)
set npc position(npc at spot(22,106),0,3)
set npc position(npc at spot(20,102),0,3)
set npc position(npc at spot(20,104),0,3)
set npc position(npc at spot(19,101),0,3)
set npc position(npc at spot(19,103),0,3)
#)
end
###

################################
script, end grin 7 madness, begin
write pass block(45,94,1+2+8)
set variable (hspeed,5)
end
###

######################################
script, fralin cyport door link, begin
suspend player
set tag (8,1)

if (herox(0)==78,and,heroy(0)==79) then(
	pan camera(south,0,0)
	walk hero (0,right,5)
	wait(3)
	palout(3)
	wait for hero (0)
	camera follows hero(0)
	teleport to map (currentmap--80,20,16)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,15,16)
	wait(1)
	walk hero(0,right,5)
	palin(3)
	wait for hero(0)
	camera follows hero(0))
else(
if (herox(0)==78,and,heroy(0)==80) then(
	pan camera(south,0,0)
	walk hero (0,right,5)
	wait(3)
	palout(3)
	wait for hero (0)
	camera follows hero(0)
	teleport to map (currentmap--80,20,17)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,15,17)
	wait(1)
	walk hero(0,right,5)
	palin(3)
	wait for hero(0)
	camera follows hero(0))
)
do(
if ((herox(0)==16,or,herox(0)==17,or,herox(0)==18),and,heroy(0)==42) then(
	if(check tag(296)) then(
		variable(ooo)
		set variable(ooo,herox(0)--16)
		pan camera(up,20,10)
		walk hero(0,up,5)
		wait(5)
		palout(5)
		wait for hero(0)
		camera follows hero(0)
		teleport to map(45+poff,32+ooo,91)
		wait(1)
		pan camera(south,0,0)
		set hero position(0,32+ooo,96)
		wait(1)
		walk hero(0,up,5)
		wait(1)
		palin(5)
		wait for hero(0)
		camera follows hero(0)
	)
	else(
		set hero direction(0,left)
		wait(2)
		walk hero(0,down,1)
		wait for hero(0)
	)

)
)

set hero frame(0,0)
set tag (8,0)
resume player
end
###

#################################
script, forestpasspillar, begin
suspend player
suspend npcs
suspend obstruction

walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
wait(1)

suspend player
if (check tag(45)) then(
alter npc(1,NPCstat:picture,12)
alter npc(1,NPCstat:palette,29+poff)
suspend player
wait(1)
set party out
swap by position(findhero(0),0)
#set npc position(1,herox(0),heroy(0))
#if(herox(0)==94) then(put npc(1,94*20,55*20))
#else(put npc(1,95*20,55*20))
suspend player
wait(1)
suspend player

set npc position(1,herox(0),heroy(0))
wait(1)

walk npc(1,down,1)
wait for npc(1)
#walk npc(1,left,npcx(1)--91)
walk npc to x(1,91)
set hero direction(0,left)
wait for npc(1)
set npc frame(1,0)
wait(2)
jig npc(1)
tb(599)
focus camera(90,56,2)
wait(4)
walk hero(0,down,1)
wait for hero(0)
walk hero to x(0,92)
wait for hero(0)
set hero frame(0,0)
wait for camera
jig hero(0)
tb(600)
jig npc(1)
tb(601)
jig hero(0)
tb(602)
wait(2)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait(2)
jig npc(1)
tb(603)
jig hero(0)
tb(604)
jig npc(1)
tb(605)
walk npc(1,right,1)
wait for npc(1)
set npc position(1,0,0)
set party in
focus camera(herox(0),heroy(0),2)
wait for camera
)
else(
focus camera(90,56,4)
wait for camera
jig gahn
show text box(606)
wait(4)
walk hero(0,down,1)
wait for hero(0)
set hero direction(0,left)
set hero frame(0,0)
wait for text box
focus camera(herox(0),heroy(0),4)
wait for camera
)

camera follows hero(0)
resume obstruction
resume npcs
resume player
end
###

##############################
script, water dungeon 1, begin
suspend player
suspend npcs
suspend obstruction

set hero frame(0,0)
set party out
swap by position(find hero(0),0)
stop song
show backdrop(7)
wait(2)
show map
tb(609)
jig hero(0)
tb(610)
alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
set npc position(1,herox(0),heroy(0))
walk npc(1,down,1)
wait for npc(1)
set hero direction(0,right)
set npc frame(1,0)
set npc direction(1,left)
wait(2)
set hero direction(0,down)
set npc direction(1,up)
jig npc(1)
tb(611)
wait(10)
jig hero(0)
tb(612)
wait(6)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0)
set party in

play song(9)

resume obstruction
resume npcs
resume player
end
###

##########################################
script, waterdungeonchest, whichone, begin
suspend player
suspend npcs
suspend obstruction

if (whichone==1) then(
#get item (31,1)
#force equip (find hero(0),1,31)
set tag(50,1)
set default weapon (find hero(0),31)
set hero picture(find hero(0),4,inside battle)
get item(30,1)
wait(1)
tb(613)
set party out
swap by position(find hero(0),0)
set hero direction(0,right)
set hero frame(0,0)
wait(2)
set hero picture(0,39)
wait(2)
alter npc(1,NPCstat:palette,get hero palette (findhero(1)))
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(614)
jig hero(0)
tb(615)
jig npc(1)
tb(616)
tb(617)
wait(2)
set hero picture(0,1)
wait(2)
jig hero(0)
tb(618)
jig npc(1)
tb(619)
jig hero(0)
tb(620)
jig npc(1)
tb(621)
wait(15)
tb(1052)
wait(5)
jig hero(0)
tb(622)
jig npc(1)
tb(623)
walk npc(1,left,1)
wait for npc(1)
set npc position(1,0,0)
set party in
)

if (whichone==2) then(
#get item (36,1)
#force equip (find hero(1),1,36)
set tag(51,1)
set default weapon (find hero(1),36)
set hero picture(find hero(1),15,inside battle)
get item(35,1)
wait(1)
tb(652)
set party out
swap by position(find hero(0),0)
alter npc(1,NPCstat:palette,get hero palette (findhero(1)))
set npc direction(1,up)
set npc position(1,herox(0),heroy(0))
set npc frame(1,0)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,left)

jig npc(1)
tb(653)
tb(654)
jig hero(0)
tb(655)
jig npc(1)
tb(656)
wait(10)
jig hero(0)
tb(657)
jig npc(1)
tb(658)
wait(2)
set hero picture(0,41)
wait(15)
set hero picture(0,65)
wait(15)
set npc direction(1,right)
jig npc(1)
tb(659)
set hero picture(0,1)
walk hero(0,left,1)
wait for hero(0)
set npc position(1,0,0)
set party in
set hero direction(0,down)
)

resume obstruction
resume npcs
resume player
end
###

#################################
script, water dungeon jump, begin
suspend player

if(check tag(72)) then( )
else(

set hero frame(0,0)
wait(1)
set hero frame(0,1)
wait(2)
set hero frame(0,0)
wait(1)


if (herox(0)==45,and,heroy(0)==33) then(
wdj(8)
	if(check tag(70)==false) then(
	battleflash
	set tag(70,1)
	ff(30)
	reset palette
	tweak palette (-3,-3,7)
	update palette
	waterdungeonauto(1)
	)
)
else(
if (herox(0)==44,and,heroy(0)==33) then(
wdj(4)

)else(
if (herox(0)==42,and,heroy(0)==33) then(
wdj(6)

)else(
if (herox(0)==41,and,heroy(0)==32) then(
wdj(4)

)else(
if (herox(0)==39,and,heroy(0)==32) then(
	if(hero direction(0)==right) then(wdj(6))
	else(
	if(hero direction(0)==up) then(wdj(8))
	)

)else(
if (herox(0)==39,and,heroy(0)==30) then(
wdj(2)

)else(
if (herox(0)==40,and,heroy(0)==29) then(
wdj(6)

)else(
if (herox(0)==42,and,heroy(0)==29) then(
	if(hero direction(0)==right) then(wdj(6))
	else(
	if(hero direction(0)==left) then(wdj(4))
	)

)else(
if (herox(0)==44,and,heroy(0)==29) then(
wdj(4)

)else(
if (herox(0)==45,and,heroy(0)==29) then(
wdj(2)
	if(check tag(70)==false) then(
	battleflash
	set tag(70,1)
	ff(30)
	reset palette
	tweak palette (-3,-3,7)
	update palette
	waterdungeonauto(1)
	)

)else(
if (herox(0)==45,and,heroy(0)==31) then(
	if(hero direction(0)==up) then(wdj(8))
	else(
	if(hero direction(0)==down) then(wdj(2))
	)

)else(
if (herox(0)==46,and,heroy(0)==29) then(
wdj(6)

)else(
if (herox(0)==48,and,heroy(0)==29) then(
	if(hero direction(0)==left) then(wdj(4))
	else(
	if(hero direction(0)==right) then(wdj(6))
	)

)else(
if (herox(0)==50,and,heroy(0)==29) then(
wdj(4)

)else(
if (herox(0)==51,and,heroy(0)==30) then(
wdj(2)

)else(
if (herox(0)==51,and,heroy(0)==32) then(
	if(hero direction(0)==left) then(wdj(4))
	else(
	if(hero direction(0)==up) then(wdj(8))
	)

)else(
if (herox(0)==49,and,heroy(0)==32) then(
wdj(6)

)else(
if (herox(0)==48,and,heroy(0)==33) then(
wdj(4)

)else(
if (herox(0)==46,and,heroy(0)==33) then(
wdj(6)

)else(
if (herox(0)==63,and,heroy(0)==33) then(
wdj(8)

)else(
if (herox(0)==63,and,heroy(0)==31) then(
	if(hero direction(0)==down) then(wdj(2))
	else(
	if(hero direction(0)==up) then(wdj(8))
	)

)else(
if (herox(0)==63,and,heroy(0)==29) then(
wdj(2)
)
)))))))))))))))))))))

)
resume player
end
###

##################
script, wdj, dir, begin
variable(hx)
variable(hy)
set variable(hx,herox(0))
set variable(hy,heroy(0))
alter npc(1,NPCstat:picture,71)
set npc position(1,hx,hy)

if (check tag(19)) then(set hero picture(0,33))
if (check tag(20)) then(set hero picture(0,32))

if (dir==8) then(
put hero(0,hx*20,(hy*20)--13)
put npc(1,(hx*20),(hy*20)--5)
wait(2)
put hero(0,hx*20,(hy*20)--23)
put npc(1,(hx*20),(hy*20)--10)
wait(2)
put hero(0,hx*20,(hy*20)--30)
put npc(1,(hx*20),(hy*20)--15)
wait(1)
put hero(0,hx*20,(hy*20)--35)
put npc(1,(hx*20),(hy*20)--20)
wait(1)
put hero(0,hx*20,(hy*20)--40)
put npc(1,(hx*20),(hy*20)--25)
wait(1)
put hero(0,hx*20,(hy*20)--43)
put npc(1,(hx*20),(hy*20)--30)
wait(1)
put hero(0,hx*20,(hy*20)--44)
put npc(1,(hx*20),(hy*20)--35)
wait(2)
put hero(0,hx*20,(hy*20)--40)
put npc(1,(hx*20),(hy*20)--40)
wait(2)
)
if (dir==2) then(
put hero(0,hx*20,(hy*20)--7)
put npc(1,(hx*20),(hy*20)+5)
wait(2)
put hero(0,hx*20,(hy*20)--10)
put npc(1,(hx*20),(hy*20)+10)
wait(2)
put hero(0,hx*20,(hy*20)--7)
put npc(1,(hx*20),(hy*20)+15)
wait(1)
put hero(0,hx*20,(hy*20)--2)
put npc(1,(hx*20),(hy*20)+20)
wait(1)
put hero(0,hx*20,(hy*20)+5)
put npc(1,(hx*20),(hy*20)+25)
wait(1)
put hero(0,hx*20,(hy*20)+10)
put npc(1,(hx*20),(hy*20)+30)
wait(1)
put hero(0,hx*20,(hy*20)+25)
put npc(1,(hx*20),(hy*20)+35)
wait(2)
put hero(0,hx*20,(hy*20)+40)
put npc(1,(hx*20),(hy*20)+40)
wait(2)
)
if (dir==4) then(
put hero(0,(hx*20)--5,(hy*20)--10)
put npc(1,(hx*20)--5,(hy*20))
wait(2)
put hero(0,(hx*20)--10,(hy*20)--15)
put npc(1,(hx*20)--10,(hy*20))
wait(2)
put hero(0,(hx*20)--15,(hy*20)--18)
put npc(1,(hx*20)--15,(hy*20))
wait(1)
put hero(0,(hx*20)--20,(hy*20)--19)
put npc(1,(hx*20)--20,(hy*20))
wait(1)
put hero(0,(hx*20)--25,(hy*20)--18)
put npc(1,(hx*20)--25,(hy*20))
wait(1)
put hero(0,(hx*20)--30,(hy*20)--15)
put npc(1,(hx*20)--30,(hy*20))
wait(1)
put hero(0,(hx*20)--35,(hy*20)--10)
put npc(1,(hx*20)--35,(hy*20))
wait(2)
put hero(0,(hx*20)--40,hy*20)
put npc(1,(hx*20)--40,(hy*20))
wait(2)
)
if (dir==6) then(
put hero(0,(hx*20)+5,(hy*20)--10)
put npc(1,(hx*20)+5,(hy*20))
wait(2)
put hero(0,(hx*20)+10,(hy*20)--15)
put npc(1,(hx*20)+10,(hy*20))
wait(2)
put hero(0,(hx*20)+15,(hy*20)--18)
put npc(1,(hx*20)+15,(hy*20))
wait(1)
put hero(0,(hx*20)+20,(hy*20)--19)
put npc(1,(hx*20)+20,(hy*20))
wait(1)
put hero(0,(hx*20)+25,(hy*20)--18)
put npc(1,(hx*20)+25,(hy*20))
wait(1)
put hero(0,(hx*20)+30,(hy*20)--15)
put npc(1,(hx*20)+30,(hy*20))
wait(1)
put hero(0,(hx*20)+35,(hy*20)--10)
put npc(1,(hx*20)+35,(hy*20))
wait(2)
put hero(0,(hx*20)+40,hy*20)
put npc(1,(hx*20)+40,(hy*20))
wait(2)
)
set npc position(1,0,0)
alter npc(1,NPCstat:picture,12)
if (check tag(19)) then(set hero picture(0,1))
if (check tag(20)) then(set hero picture(0,12))
end
###

############################
script, waterminiboss, begin
suspend player
suspend npcs
suspend obstruction
variable(mb1)
variable(mb2)
variable(mb3)
variable(mb4)
variable(mb5)
variable(mb6)
variable(mb7)
set variable(mb1,npc at spot(0,1))
set variable(mb2,npc at spot(1,1))
set variable(mb3,npc at spot(2,1))
set variable(mb4,npc at spot(3,1))
set variable(mb5,npc at spot(4,1))
set variable(mb6,npc at spot(5,1))
set variable(mb7,npc at spot(6,1))

walk hero to x(0,45)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
set party out
swap by position(find hero(0),0)
jig hero(0)
tb(637)
alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
wait(2)
set hero direction(0,right)
wait for npc(1)
set npc frame(1,0)
wait(2)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
jig npc(1)
play song(59)
tb(638)
jig hero(0)
tb(639)
alter npc(1,NPCstat:picture,80)
jig npc(1)
tb(640)
jig hero(0)
tb(641)
jig npc(1)
jig npc(1)
tb(642)
set npc position(mb1,45,12)
walk npc(mb1,down,1)

jig hero(0)
tb(643)
wait for npc(mb1)
set npc position(mb2,45,12)
walk npc(mb1,down,1)
walk npc(mb2,down,1)
set npc direction(mb2,right)

alter npc(1,NPCstat:picture,12)
jig npc(1)
tb(644)
wait for npc(mb2)
set npc position(mb3,45,12)
walk npc(mb1,down,1)
walk npc(mb2,down,1)
set npc direction(mb2,right)
walk npc(mb3,down,1)
set npc direction(mb3,right)

jig hero(0)
tb(645)
wait for npc(mb3)
set npc position(mb4,45,12)
walk npc(mb1,down,1)
walk npc(mb2,down,1)
set npc direction(mb2,right)
walk npc(mb3,down,1)
set npc direction(mb3,right)
walk npc(mb4,down,1)
set npc direction(mb4,right)


jig npc(1)
tb(646)
tb(647)
set npc position(mb7,45,12)
walk npc(mb7,down,3)
set npc direction(mb7,up)
wait(7)
set hero picture(0,50)
alter npc(1,NPCstat:picture,74)
wait for npc(mb7)
alter npc(27,NPCstat:movespeed,10)
set npc position(mb5,45,12)
set npc position(mb6,45,11)
set hero picture(0,1)
alter npc(1,NPCstat:picture,12)
set hero direction(0,up)
set npc direction(1,up)
walk npc(mb1,down,3)
walk npc(mb2,down,3)
set npc direction(mb2,right)
walk npc(mb3,down,3)
set npc direction(mb3,right)
walk npc(mb4,down,3)
set npc direction(mb4,right)
walk npc(mb5,down,3)
set npc direction(mb5,right)
walk npc(mb6,down,3)
set npc direction(mb6,right)
wait for npc(mb6)

battleflash
set tag(67,1)
set party in
ff(10,0,false)
suspend player
set party out
swap by position(find hero(0),0)
reset palette
tweak palette (-1,-6,-6)
update palette
waterdungeonauto(1)
suspend player

wait(15)
set npc direction(1,left)
jig npc(1)
show text box(648)
wait(2)
set hero direction(0,right)
wait for text box
jig hero(0)
tb(649)
wait(10)
jig hero(0)
tb(650)
alter npc(1,NPCstat:picture,77)
wait(2)
tb(651)
alter npc(1,NPCstat:picture,12)
walk npc(1,left,1)
wait for npc(1)
set npc position(1,0,0)
set party in

resume obstruction
resume npcs
resume player
end
###

########################
script, waterboss, begin
suspend player
suspend npcs
suspend obstruction

set hero frame(0,0)
set party out
swap by position(find hero(0),0)
alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
wait(2)
set npc direction(1,up)
wait(10)
jig hero(0)
tb(669)
wait(10)
jig npc(28)
tb(670)
wait(5)
set npc direction(28,left)
wait(2)
set npc direction(28,down)
jig npc(28)
play song(15)
tb(671)
set hero direction(0,right)
jig hero(0)
show text box(672)
wait(2)
set npc direction(1,left)
wait for text box
jig npc(1)
tb(673)
jig npc(28)
show text box(674)
wait(2)
set hero direction(0,up)
set npc direction(1,up)
wait for text box
jig hero(0)
tb(675)
jig npc(28)
tb(676)
set npc direction(28,left)
tb(677)
wait(10)
set npc direction(28,down)
tb(678)
wait(5)
jig hero(0)
tb(679)
jig npc(28)
tb(680)
jig npc(1)
tb(681)
wait(2)
show text box(682)
walk hero(0,up,1)
wait for hero(0)
set hero picture(0,49)
set hero frame(0,0)
wait for text box
tb(683)
tb(684)
wait(4)
set npc frame(28,1)
wait(4)
set npc frame(28,0)
wait(4)
tb(685)
tb(686)
set npc direction(28,left)
wait(2)
jig npc(28)
tb(687)
tb(688)
set npc direction(28,up)
wait(5)
jig npc(28)
tb(689)
walk npc(28,up,2)
wait for npc(28)
alter npc(28,NPCstat:palette,36)
set npc frame(28,0)
wait(2)
set npc direction(28,left)
wait(2)
set npc direction(28,down)
jig npc(28)
play song(8)
tb(690)

variable(i)
for(i,1,8,1) do(
alter npc(28,NPCstat:palette,73)
wait(1)
alter npc(28,NPCstat:palette,36)
wait(1))

battleflash(1)
set party in
ff(31,0,false)
play song(59)
reset palette
tweak palette (-1,-1,-1)
update palette
alter npc(28,NPCstat:picture,151)
set npc direction(28,right)
set party out
swap by position(find hero(0),0)

set hero picture(0,1)
walk hero(0,up,heroy(0)--18)
walk npc(1,up,npcy(1)--18)
wait for hero(0)
#set hero position(0,63,18)
#set npc position(1,64,18)
wait for hero(0)
set hero picture(0,26)
set hero direction(0,left)
wait for npc(1)

wait(8)
show text box(691)
jig npc(28)
jig npc(28)
jig npc(28)
jig npc(28)
wait for text box
jig npc(1)
tb(692)
set npc direction(28,left)
jig npc(28)
tb(693)
set npc direction(1,left)
jig npc(1)
tb(694)
set npc direction(28,right)
tb(695)

if (check tag(71)) then(
wait(20)
tb(775)
set npc direction(28,left)
jig npc(28)
show text box(696)
wait(2)
set npc direction(1,up)
wait for text box
walk npc(1,up,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
tb(651)
stop song
wait(5)
show backdrop(1)
set npc direction(28,right)
alter npc(1,NPCstat:picture,152)
wait(2)
show map
wait(2)
show backdrop(1)
set npc frame(1,1)
wait(2)
show map
wait(15)
set npc frame(28,1)
wait(4)
set npc direction(28,up)
wait(3)
alter npc(1,NPCstat:picture,12)
set npc frame(1,0)
set npc direction(1,down)
wait(10)
set hero direction(0,down)
wait(4)
set hero direction(0,right)
wait(4)
set hero direction(0,up)
wait(3)
set hero picture(0,1)
wait(20)
jig npc(1)
tb(697)
wait(5)
jig hero(0)
tb(698)
jig npc(1)
tb(699)
tb(700)
wait(2)
set hero speed(0,2)
walk hero(0,up,1)
wait for hero(0)
set hero speed(0,hspeed)
set npc direction(1,left)
set hero frame(0,0)
jig hero(0)
set hero picture(0,40)
tb(701)
jig npc(1)
tb(702)
tb(703)
wait(5)
set hero picture(0,1)
tb(704)
jig npc(1)
tb(705)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,left,1)
wait for npc(1)
set npc position(1,0,0)
set party in

for(i,1,5,1) do(
alter npc(28,NPCstat:picture,0)
wait(2)
alter npc(28,NPCstat:picture,151)
wait(2))
for(i,1,2,1) do(
alter npc(28,NPCstat:picture,0)
wait(3)
alter npc(28,NPCstat:picture,151)
wait(3))
alter npc(28,NPCstat:picture,0)
set tag(69,1)

)else(

wait(10)
tb(775)
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
wait(2)
set hero direction(0,up)
wait(2)
set hero picture(0,25)
stop song
jig npc(1)
tb(706)
set npc direction(28,left)
jig npc(28)
tb(696)
set hero picture(0,1)
jig hero(0)
set hero picture(0,25)
tb(707)
set npc direction(1,up)
jig npc(28)
tb(708)
wait(5)
set npc direction(28,right)
tb(709)
wait(2)
set npc direction(28,left)
wait(2)
set npc direction(28,down)
wait(2)
jig npc(28)
tb(710)
alter npc(28,NPCstat:palette,34)
alter npc(28,NPCstat:picture,153)
walk npc(28,left,1)
wait for npc(28)
walk npc(28,down,1)
wait for npc(28)
set hero direction(0,left)
set npc direction(1,left)
walk npc(28,down,2)
wait for npc(28)
set hero direction(0,down)
set npc direction(1,down)
walk npc(28,down,2)
wait for npc(28)
walk npc(28,right,1)
wait for npc(28)
walk npc(28,down,3)
wait for npc(28)
alter npc(1,NPCstat:picture,80)
set npc direction(1,left)
jig npc(1)
tb(711)
set hero picture(0,38)
wait(10)
tb(775)
walk npc(1,left,1)
wait for npc(1)
set npc position(1,0,0)
set hero picture(0,1)
set party in
alter npc(28,NPCstat:picture,0)
set npc position(28,63,16)
set tag(69,1)
)

resume obstruction
resume npcs
resume player
end
###

#######################
script, meetanon, begin
suspend player
suspend npcs
suspend obstruction

meet anon1
meet anon2
meet anon3

resume obstruction
resume npcs
end
###

########################
script, meetanon1, begin
suspend player
stop song
set tag(50,0)
set tag(51,0)
alter npc(2,NPCstat:picture,154)
alter npc(2,NPCstat:palette,60)
set npc speed(2,1)
alter npc(3,NPCstat:picture,15)
alter npc(3,NPCstat:palette,48)
set npc position(2,63,6)
set npc direction(2,down)
set npc position(3,66,6)
suspend obstruction

pan camera (up,6,10)
walk hero (0,up,4)
wait for camera
reset palette
tweak palette (-4,-4,10)
update palette
set pal(noon)
pan camera (up,6,10)
wait for camera
wait for hero (0)
set hero frame(0,0)
set party out
swap by position(find hero(0),0)

play song(75)
jig valorian(0)
tb(712)
jig hero(0)
tb(2363)
alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(2364)
set hero direction(0,right)
jig hero(0)
tb(2365)
wait(4)
jig valorian(0)
show text box(713)
wait(2)
set hero direction(0,up)
wait(2)
set npc direction(1,up)
wait for text box
jig hero(0)
tb(714)
jig valorian(0)
tb(715)
alter npc(1,NPCstat:picture,80)
walk npc(1,down,1)
wait(2)
set hero direction(0,right)
wait for npc(1)
walk npc(1,left,1)
wait(2)
set hero direction(0,down)
wait for npc(1)
walk npc(1,down,8)
wait(10)
jig valorian(0)
tb(716)
jig hero(0)
tb(717)
jig valorian(0)
show text box(718)
wait(4)
set hero direction(0,left)
wait(2)
set hero direction(0,up)
wait for text box
jig hero(0)
tb(719)
jig valorian(0)
tb(720)
jig hero(0)
tb(721)
jig valorian(0)
tb(722)
jig valorian(0)
tb(723)
set hero picture(0,49)
wait(10)
set hero picture(0,84)
wait(10)
tb(1052)
jig valorian(0)
tb(724)
wait(5)
set hero picture(0,49)
tb(725)
wait(10)
set hero picture(0,50)
tb(726)
jig valorian(0)
tb(727)
jig valorian(0)
tb(728)
jig valorian(0)
tb(729)
wait(4)
set hero picture(0,49)
wait(4)
set hero picture(0,1)
jig hero(0)
set hero picture(0,49)
tb(730)
tb(731)
wait(5)
tb(732)
wait(15)
set hero picture(0,84)
wait(5)
tb(733)
jig valorian(0)
tb(734)
wait(4)
jig valorian(0)
tb(735)
jig valorian(0)
tb(736)
set hero picture(0,49)
jig valorian(0)
tb(737)
wait(5)
jig valorian(0)
tb(738)
write pass block(63,9,0)
wait(4)
#walk npc(2,down,2)
walk npc to y(2,8)
wait for npc(2)

variable(i)
for(i,1,4,1) do(
alter npc(2,NPCstat:picture,155)
wait(2)
alter npc(2,NPCstat:picture,154)
wait(2)
)
for(i,1,2,1) do(
alter npc(2,NPCstat:picture,155)
wait(3)
alter npc(2,NPCstat:picture,154)
wait(3)
)
alter npc(2,NPCstat:picture,155)

#walk npc(2,down,1)
walk npc to y(2,9)
jig valorian(0)
tb(739)
wait for npc(2)
write pass block(63,9,1)
set npc position(2,0,3)
set tag(50,1)
wait(5)
set hero picture(0,40)
wait(5)
tb(740)
get item(186,1)
end
###

########################
script, meetanon2, begin
suspend player
wait(10)
set hero picture(0,1)
set hero direction(0,right)
wait(4)
set hero speed(0,2)
walk hero(0,down,2)
wait(7)
stop song
show text box(741)
wait for hero(0)
wait for text box
set hero frame(0,0)
set hero direction(0,left)
wait(2)
set hero speed(0,hspeed)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(742)
wait(10)
walk npc(3,left,3)
wait(10)
jig hero(0)
play song(64)
show text box(743)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,down)
wait for text box
jig npc(3)
tb(744)
jig hero(0)
tb(745)
jig npc(3)
tb(746)
jig hero(0)
tb(747)
jig npc(3)
tb(748)
jig hero(0)
tb(749)
jig npc(3)
tb(750)
jig hero(0)
tb(751)
jig npc(3)
tb(752)
wait(2)
set npc direction(3,left)
wait(15)
set npc direction(3,down)
jig npc(3)
tb(753)
tb(754)
set npc direction(3,right)
wait(4)
tb(755)
set npc direction(3,down)
wait(2)
jig npc(3)
tb(756)
jig hero(0)
tb(757)
jig npc(3)
tb(758)
wait(10)
set npc direction(3,left)
wait(20)
set npc direction(3,down)
wait(2)
jig npc(3)
tb(759)
jig hero(0)
tb(760)
jig npc(3)
tb(761)
stop song

wait(5)
set hero direction(0,right)
wait(15)
walk hero(0,down,2)
wait for hero(0)
alter npc(1,NPCstat:palette,30)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)

pan camera (down,6,10)
walk hero (0,down,5)
wait for camera
reset palette
tweak palette (-1,-1,-1)
update palette
set pal(morning)
pan camera (down,6,10)
wait for camera
wait for hero (0)
set hero frame(0,0)
set hero picture(0,49)
set tag(51,1)
end
###

########################
script, meetanon3, begin
suspend player
wait(15)
set npc direction(1,left)
wait(2)
tb(762)
set hero picture(0,1)
jig hero(0)
set hero picture(0,84)
tb(763)
alter npc(1,NPCstat:picture,12)
wait(2)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
tb(764)
set hero picture(0,1)
jig hero(1)
tb(765)
wait(15)
set npc direction(1,right)
wait(5)
tb(766)

wait(10)
palout(10)
camera follows hero(0)
sethp
teleporttomap(9+poff,77,157)
stop song
wait(1)
pan camera(down,0,0)

#getting around blasted forest pass npc limits
if(check tag(273)) then(
	set tag(563,1)
	set tag(273,0)
)
else(set tag(563,0))
alter npc(9,NPCstat:script,0)
alter npc(10,NPCstat:script,0)

set tag(10,0)
set npc position(9,herox(0),heroy(0))
set npc direction(9,down)
alter npc(9,NPCstat:picture,73)
alter npc(9,NPCstat:palette,29+poff)
alter npc(9,NPCstat:movespeed,2)
set hero position(0,75,155)
set hero picture(0,51)
wait(1)
palin(5)

wait(25)
set hero picture(0,1)
wait(2)
jig hero(0)
tb(767)
wait(10)
alter npc(9,NPCstat:picture,74)
wait(2)
play song(69)
tb(768)
jig hero(0)
tb(769)
alter npc(9,NPCstat:picture,12)
wait(2)
set npc direction(9,left)
wait(2)
walk npc(9,up,1)
wait for npc(9)
set hero direction(0,right)
walk npc(9,up,1)
wait for npc(9)
set npc direction(9,down)
set npc frame(9,0)
alter npc(9,NPCstat:picture,76)
wait(4)
set npc direction(9,left)
wait(2)
show text box(770)
set npc frame(9,1)
wait(3)
set npc frame(9,0)
wait(3)
set npc frame(9,1)
wait(3)
set npc frame(9,0)
wait for text box
jig hero(0)
tb(771)
alter npc(9,NPCstat:picture,12)
walk npc(9,left,1)
wait for npc(9)
set npc frame(9,0)
jig npc(9)
tb(772)
walk npc(9,up,4)
set hero picture(0,49)
wait(20)
set hero picture(0,39)
wait(10)
wait for npc(9)
set npc position(9,0,0)
set tag(10,1)
jig hero(0)
set hero frame(0,1)
show text box(773)
wait for text box
wait(4)
tb(774)
set hero frame(0,0)
set hero direction(0,right)
set hero picture(0,50)
wait(25)

settp

#variable(cm)
#set variable(cm,current map)

tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)

tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,4,0)
update palette
wait (1)
tweak palette (0,8,0)
update palette
reset palette
wait (1)
tweak palette (0,16,0)
update palette
reset palette
wait (1)
tweak palette (0,63,0)
update palette

#teleport to map(0,0,0)
stop song
show backdrop(0)
wait (1)

reset palette
tweak palette (0,16,0)
update palette
wait (1)
reset palette
tweak palette (0,8,0)
update palette
wait (1)
reset palette
tweak palette (0,4,0)
update palette
wait (1)
reset palette
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette

jadeup(4,0)
wait(15)
play song(15)
jig gahn
tb(1058)
jig gahn
tb(1059)
jig gahn
tb(1060)
jig gahn
tb(1061)
jig gahn
tb(1062)

#f-pass npc limit fix
if(check tag(563)) then(set tag(273,1))

palout(1)
set hero picture(0,1)
camera follows hero(0)
#teleport to map(cm,77,152)
set hero position(0,77,152)
stop song
set party in
set hero direction(0,up)

show map
wait(1)
palin(3)

#now in act 2
actadvance(2)

set tag (8,0)
save game

play song(82)

end
###

#####################################
script, jig valorian, whichone, begin
#0=Anon special, 1=Anon normal, 2=Gitleh special, 3=Anon-gitleh special
#4=gitleh normal, 5=fedora normal, 6=shoda normal
if (whichone==0) then(
tweak palette (-4,-4,11)
update palette
wait (1)
tweak palette (-4,-4,12)
update palette
wait (1)
tweak palette (-4,-4,13)
update palette
reset palette
wait (1)
tweak palette (-4,-4,12)
update palette
reset palette
wait (1)
tweak palette (-4,-4,11)
update palette
wait (1)
reset palette
tweak palette (-4,-4,10)
update palette
)
if (whichone==1) then(
tweak palette (0,0,2)
update palette
wait (1)
tweak palette (0,0,4)
update palette
wait (1)
tweak palette (0,0,8)
update palette
reset palette
wait (1)
tweak palette (0,0,4)
update palette
reset palette
wait (1)
tweak palette (0,0,2)
update palette
wait (1)
reset palette
update palette
)
if (whichone==2) then(
tweak palette (4,2,1)
update palette
wait (1)
tweak palette (8,4,2)
update palette
wait (1)
tweak palette (10,6,3)
update palette
reset palette
wait (1)
tweak palette (8,4,2)
update palette
reset palette
wait (1)
tweak palette (4,2,1)
update palette
wait (1)
reset palette
tweak palette (2,1,0)
update palette
)
if (whichone==3) then(
tweak palette (0,0,8)
update palette
wait (1)
tweak palette (0,0,9)
update palette
wait (1)
tweak palette (0,0,10)
update palette
reset palette
wait (1)
tweak palette (0,0,9)
update palette
reset palette
wait (1)
tweak palette (0,0,8)
update palette
wait (1)
reset palette
tweak palette (2,1,0)
update palette
)
if (whichone==4) then(
tweak palette (2,1,0)
update palette
wait (1)
tweak palette (4,2,1)
update palette
wait (1)
tweak palette (8,4,2)
update palette
reset palette
wait (1)
tweak palette (4,2,1)
update palette
reset palette
wait (1)
tweak palette (2,1,0)
update palette
wait (1)
reset palette
update palette
)
if (whichone==5) then(
tweak palette (2,0,0)
update palette
wait (1)
tweak palette (4,0,0)
update palette
wait (1)
tweak palette (8,0,0)
update palette
reset palette
wait (1)
tweak palette (4,0,0)
update palette
reset palette
wait (1)
tweak palette (2,0,0)
update palette
wait (1)
reset palette
update palette
)
if (whichone==6) then(
tweak palette (2,0,2)
update palette
wait (1)
tweak palette (4,1,4)
update palette
wait (1)
tweak palette (8,3,8)
update palette
reset palette
wait (1)
tweak palette (4,1,4)
update palette
reset palette
wait (1)
tweak palette (2,0,2)
update palette
wait (1)
reset palette
update palette
)
end
###

#####################################
script, waterdungeonauto, ARGH, begin
suspend player
set tag(8,1)
wait(1)

#placing door npcs if locked doors removed
if(ARGH==0) then(
	if(checktag(298))then(
		write pass block(63,40,0)
		destroy npc (npc at spot(63,40))
		destroy npc (npc at spot(63,39))
		destroy npc (npc at spot(63,38))
		destroy npc (npc at spot(63,37))
		create npc(35,63,37)
	)
	if(checktag(299))then(
		write pass block(63,28,0)
		destroy npc (npc at spot(63,28))
		destroy npc (npc at spot(63,27))
		destroy npc (npc at spot(63,26))
		destroy npc (npc at spot(63,25))
		create npc(35,63,25)
	)
	if(checktag(73))then(
		write pass block(45,64,0)
		destroy npc (npc at spot(45,64))
		destroy npc (npc at spot(45,63))
		destroy npc (npc at spot(45,62))
		destroy npc (npc at spot(45,61))
		create npc(35,45,61)
	)
	if(checktag(74))then(
		write pass block(45,40,0)
		destroy npc (npc at spot(45,40))
		destroy npc (npc at spot(45,39))
		destroy npc (npc at spot(45,38))
		destroy npc (npc at spot(45,37))
		create npc(35,45,37)
	)
)

#pass block taken care of outside of ARGH
if(checktag(298))then(write pass block(63,40,0))
if(checktag(299))then(write pass block(63,28,0))
if(checktag(73))then(write pass block(45,64,0))
if(checktag(74))then(write pass block(45,40,0))

if(checktag(56))then(write pass block(27,40,0))
if(checktag(61))then(set npc direction(23,left))
if(checktag(64)) then(set npc position(npc at spot(78,41),1,0))

set tag(8,0)
resume player
end
###

########################
script, adlezdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==101,and,heroy(0)==26) then(
set variable(time,0)
pan camera(up,15,20)
walk hero(0,up,5)
palout(3)
wait for camera
wait for hero(0)
camera follows hero(0)
wait(1)
teleport to map(currentmap--5,129,135)
wait(1)
pan camera(south,0,0)
set hero position(0,129,140)
walk hero(0,up,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if(herox(0)==102,and,heroy(0)==26) then(
set variable(time,0)
pan camera(up,15,20)
walk hero(0,up,5)
palout(3)
wait for camera
wait for hero(0)
camera follows hero(0)
wait(1)
teleport to map(currentmap--5,130,135)
wait(1)
pan camera(south,0,0)
set hero position(0,130,140)
walk hero(0,up,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if((herox(0)==103,or,herox(0)==104),and,heroy(0)==26) then(
set variable(time,0)
pan camera(up,15,20)
walk hero(0,up,5)
palout(3)
wait for camera
wait for hero(0)
camera follows hero(0)
wait(1)
teleport to map(currentmap--5,131,135)
wait(1)
pan camera(south,0,0)
set hero position(0,131,140)
walk hero(0,up,5)
wait(3)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==89,and,(heroy(0)==56,or,heroy(0)==57,or,heroy(0)==58,or,heroy(0)==59,or,heroy(0)==60)) then(
set variable (time,0)
	if(check tag(120)) then(
		set hero speed (0,10)
		pan camera (left,15,20)
		walk hero (0,left,15)
		wait for camera
		wait for hero (0)
		set hero speed (0,hspeed)
		camera follows hero
		if(check tag(343)==false,and,check tag(346)==false) then(annoyingknave)
	)
	else(
		set hero direction(0,down)
		wait(2)
		walk hero(0,right,1)
		wait for hero(0)
		set hero frame(0,0)
		jig hero(0)
		tb(3808)
	)
)
)
do(
if(herox(0)==75,and,(heroy(0)==56,or,heroy(0)==57,or,heroy(0)==58,or,heroy(0)==59,or,heroy(0)==60)) then(
set variable (time,0)
set hero speed (0,10)
pan camera (right,15,20)
walk hero (0,right,15)
wait for camera
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if(herox(0)==142) then(
	set variable (time,0)
	if(checktag(97)) then(
		if( checktag(101) ) then(
			pan camera(south,0,0)
			walk hero (0,right,4)
			palout(3)
			wait for hero(0)
			wait(1)
			camera follows hero(0)
			teleport to map(90,26,6)
			wait(1)
			load tileset(87+poff)
			pan camera(south,0,0)
			set hero position(0,37,6)
			pan camera(right,25,10)
			walk hero(0,right,15)
			wait(2)
			palin(5)
			wait for camera
			pan camera(right,15,10)
			palout(5)
			wait for camera
			wait for hero(0)
			camera follows hero(0)
			if(check tag(102)) then(
				teleport to map(24+poff,10,32)
				wait(1)
				pan camera(south,0,0)
				set hero position(0,6,32)
				walk hero(0,right,4)
				wait(2)
				palin(3)
				wait for hero(0)
				set hero frame(0,0)
				camera follows hero(0)
			)
			else(
				set tag (3,0)
				set tag (4,0)
				set tag (5,1)
				set tag (6,0)
				set pal(afternoon)
				setvariable(hour,1500)
				setvariable(minute,0)
				setvariable(second,1)
				teleport to map(25,10,32)
				wait(1)
				pan camera(south,0,0)
				set hero position(0,6,32)
				walk hero(0,right,4)
				wait(2)
				palin(3)
				wait for hero(0)
				set hero frame(0,0)
				camera follows hero(0)
				#turn off item and avis items
				set tag(433,1)
				set tag(280,1)
			)
		)
		else(scenethreepointone)
	)
	else(
		set hero direction(0,down)
		wait(2)
		walk hero(0,left,1)
		wait for hero(0)
		set hero frame(0,0)
		jig hero(0)
		tb(6654)
	)
)
)
do(
if(herox(0)==95,and,heroy(0)==56) then(
	set variable(time,0)
	if(check tag(77)) then(
	palout(1)
	teleport to map(currentmap+4,4,141)
	wait(1)
	palin(1)
	)
	else(
	walk hero(0,down,1)
	set hero direction(0,up)
	show text box(84)
	wait for hero(0)
	wait for text box
	)
)
)

palout(time)

if(herox(0)==96,and,heroy(0)==40) then(
teleport to map(currentmap+4,3,7))
else(
if(herox(0)==112,and,heroy(0)==48) then(
teleport to map(currentmap+4,2,23))
)
do(
if(herox(0)==120,and,heroy(0)==48) then(
teleport to map(currentmap+4,3,40)
if(check tag(349)==false) then(write map block(4,36,read map block(3,36)))
)
)
do(
if(herox(0)==108,and,heroy(0)==56) then(
teleport to map(currentmap+4,3,57))
)
do(
if(herox(0)==115,and,heroy(0)==56) then(
teleport to map(currentmap+4,3,90))
)
do(
if(herox(0)==124,and,heroy(0)==56) then(
teleport to map(currentmap+4,3,73))
)
do(
if(herox(0)==111,and,heroy(0)==64) then(
teleport to map(currentmap+4,3,106))
)
do(
if(herox(0)==120,and,heroy(0)==64) then(
teleport to map(currentmap+4,3,123))
)
do(
if(herox(0)==66,and,heroy(0)==68) then(
teleport to map(currentmap+4,3,158))
)
do(
if(herox(0)==48,and,heroy(0)==78) then(
teleport to map(currentmap+4,6,175))
)
do(
if(herox(0)==56,and,heroy(0)==78) then(
teleport to map(currentmap+4,14,175))
)
do(
if(herox(0)==26,and,heroy(0)==78) then(
teleport to map(currentmap+4,6,193))
)
do(
if(herox(0)==33,and,heroy(0)==78) then(
teleport to map(currentmap+4,13,193))
)
do(
if(herox(0)==23,and,heroy(0)==57) then(
teleport to map(currentmap+4,7,212))
)
do(
if(herox(0)==31,and,heroy(0)==42) then(
teleport to map(currentmap+4,5,229))
)
do(
if(herox(0)==52,and,heroy(0)==42) then(
teleport to map(currentmap+4,7,246))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

##############################
script, adlezindoordoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==3,and,heroy(0)==118) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0))
else(
if(herox(0)==8,and,heroy(0)==191) then(
set hero speed(0,2)
walk hero(0,up,2)
wait for hero(0)
set hero speed(0,4)
walk hero(0,right,1)
wait for hero(0)
set hero speed(0,hspeed)
set variable(time,0))
)
do(
if(herox(0)==8,and,heroy(0)==189) then(
walk hero(0,left,1)
wait for hero(0)
set hero speed(0,2)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)
set hero speed(0,4)
walk hero(0,down,1)
wait for hero(0)
set hero speed(0,hspeed)
set variable(time,0))
)
do(
if(herox(0)==11,and,heroy(0)==191) then(
set hero speed(0,2)
walk hero(0,up,2)
wait for hero(0)
set hero speed(0,4)
walk hero(0,left,1)
wait for hero(0)
set hero speed(0,hspeed)
set variable(time,0))
)
do(
if(herox(0)==11,and,heroy(0)==189) then(
walk hero(0,right,1)
wait for hero(0)
set hero speed(0,2)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)
set hero speed(0,4)
walk hero(0,down,1)
wait for hero(0)
set hero speed(0,hspeed)
set variable(time,0))
)
do(
if(herox(0)==7,and,heroy(0)==205) then(
	set variable(time,0)
	pan camera(south,0,0)
	walk hero(0,up,1)
	wait for hero(0)
	palout(3)
	camera follows hero(0)
	teleport to map(22,43,135)
	if(check tag(83)==false) then(stop song)
	pan camera(up,2,20)
	set pal(noon)
	if(check tag(346)==false,and,check tag(91)) then(
		set npc position(3,43,131)
		set npc direction(3,down)
		alter npc(3,NPCstat:script,208)
	)
	wait(1)
	palin(3)
	walk hero(0,up,2)
	wait for hero(0)
	camera follows hero
	if(check tag(83)==false) then(scene2point4))
)
do(
if(herox(0)==4,and,heroy(0)==36) then(
	set variable(time,0)
	if(check tag(349)) then(
		pan camera(south,0,0)
		write pass block(4,37,128)
		write pass block(4,38,128)
		set hero speed(0,2)
		walk hero(0,down,2)
		set hero direction(0,up)
		wait for hero(0)
		palout(2)
		set pal(noon)
		camera follows hero(0)
		teleport to map(22,15,21)
		wait(1)
		pan camera(south,0,0)
		set hero position(0,15,23)
		set hero speed(0,hspeed)
		wait(1)
		palin(2)
		walk hero(0,up,2)
		wait for hero(0)
		set hero frame(0,0)
		camera follows hero(0)
	)
)
)
do(
if(herox(0)==4,and,heroy(0)==136) then(
set variable(time,0)
write pass block(4,137,128)
write pass block(4,138,128)
pan camera(south,0,0)
set hero speed(0,2)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map(70,40,5)
set hero speed(0,hspeed)
wait(1)
pan camera(south,0,0)
set hero position(0,40,7)
set pal(noon)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
)
)

palout(time)

if(herox(0)==3,and,heroy(0)==8) then(
teleport to map(currentmap--4,96,41))
else(
if(herox(0)==2,and,heroy(0)==24) then(
teleport to map(currentmap--4,112,49))
)
do(
if(herox(0)==3,and,heroy(0)==41) then(
teleport to map(currentmap--4,120,49))
)
do(
if(herox(0)==3,and,heroy(0)==58) then(
teleport to map(currentmap--4,108,57))
)
do(
if(herox(0)==3,and,heroy(0)==74) then(
teleport to map(currentmap--4,124,57))
)
do(
if(herox(0)==3,and,heroy(0)==91) then(
teleport to map(currentmap--4,115,57))
)
do(
if(herox(0)==3,and,heroy(0)==107) then(
teleport to map(currentmap--4,111,65))
)
do(
if(herox(0)==3,and,heroy(0)==124) then(
teleport to map(currentmap--4,120,65))
)
do(
if(herox(0)==4,and,heroy(0)==142) then(
teleport to map(currentmap--4,95,57))
)
do(
if(herox(0)==3,and,heroy(0)==159) then(
teleport to map(currentmap--4,66,69))
)
do(
if(herox(0)==6,and,heroy(0)==176) then(
teleport to map(currentmap--4,48,79))
)
do(
if(herox(0)==14,and,heroy(0)==176) then(
teleport to map(currentmap--4,56,79))
)
do(
if(herox(0)==6,and,heroy(0)==194) then(
teleport to map(currentmap--4,26,79))
)
do(
if(herox(0)==13,and,heroy(0)==194) then(
teleport to map(currentmap--4,33,79))
)
do(
if(herox(0)==7,and,heroy(0)==213) then(
teleport to map(currentmap--4,23,58))
)
do(
if(herox(0)==5,and,heroy(0)==230) then(
teleport to map(currentmap--4,31,43))
)
do(
if(herox(0)==7,and,heroy(0)==247) then(
teleport to map(currentmap--4,52,43))
)
do(
if(herox(0)==3,and,heroy(0)==117) then(
camera follows hero(0)
teleport to map(currentmap--4,120,59))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
set tag(75,0)
resume obstruction
resume npcs
resume player
end
###

########################
script, johandoor, begin
suspend player
suspend npcs
set hero frame(0,0)
jig hero(0)
wait(1)
variable(camx)
variable(camy)
set variable(camx,camera pixel X)
set variable(camy,camera pixel Y)
variable(i)
for(i,1,4,1) do(
put camera(random(camx--5,camx+5),random(camy--5,camy+5))
wait(1))

write map block(3,119,65)
write map block(3,118,33)
write pass block(3,119,0)
write pass block(3,118,0)
write pass block(3,117,128)

for(i,1,4,1) do(
put camera(random(camx--5,camx+5),random(camy--5,camy+5))
wait(1))

put camera(camx,camy)
camera follows hero
set tag(75,1)
resume npcs
resume player
end
###

####################################
script, undergroundquarrydoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

undergroundquarrydoor1
undergroundquarrydoor2
undergroundquarrydoor3

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###
#####################################
script, undergroundquarrydoor1, begin
if(herox(0)==43,and,heroy(0)==134) then(
	pan camera(south,0,0)
	walk hero(0,down,1)
	wait for hero(0)
	palout(3)
	camera follows hero
	teleport to map(18+poff,7,204)
	sethp
	settp
	pan camera(down,2,20)
	wait for camera
	palin(3)
	walk hero(0,down,2)
	wait for hero(0)
	camera follows hero)
else(
if(herox(0)==75,and,heroy(0)==5) then(
	write pass block(75,6,0)
	write pass block(75,7,128)
	write pass block(75,8,128)
	pan camera(south,0,0)
	walk hero(0,down,1)
	set hero direction(0,up)
	wait for hero(0)
	set hero speed(0,2)
	walk hero(0,down,2)
	set hero direction(0,up)
	wait for hero(0)
	palout(2)
	camera follows hero
	set hero position(0,176,131)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,0,0)
	wait(1)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	reset palette
	tweak palette (-5,-5,-5)
	update palette

	settp(-5,-5,-5)

	set hero position(0,176,129)
	walk hero(0,down,1)
	set hero direction(0,up)
	wait for hero(0)
	set hero speed(0,4)
	walk hero(0,down,1)
	set hero direction(0,up)
	wait for hero(0)
	set hero speed(0,hspeed)
	camera follows hero)
)
do(
if(herox(0)==176,and,heroy(0)==130) then(
	write pass block(75,6,0)
	write pass block(75,7,128)
	write pass block(75,8,128)
	pan camera(south,0,0)
	set hero speed(0,2)
	walk hero(0,up,1)
	wait for hero(0)
	palout(2)
	camera follows hero
	set hero position(0,75,8)
	wait(1)
	pan camera(up,4,20)
	wait for camera
	wait(1)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	reset palette
	tweak palette (-5,-5,-5)
	update palette

	settp(-5,-5,-5)

	walk hero(0,up,2)
	wait for hero(0)
	set hero speed(0,4)
	walk hero(0,up,2)
	wait for hero(0)
	set hero speed(0,hspeed)
	camera follows hero
	write pass block(75,6,2+4+8)
	write pass block(75,7,0)
	write pass block(75,8,0))
)
do(
if(herox(0)==142,and,heroy(0)==29) then(
	pan camera(south,0,0)
	walk hero(0,up,1)
	wait for hero(0)
	palout(3)
	camera follows hero
	teleport to map(23,9,54)
	suspend player
	pan camera(south,0,0)
	set hero position(0,9,60)
	wait(3)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (3)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (3)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (3)
	reset palette
	tweak palette (-7,-7,-7)
	update palette

	settp(-7,-7,-7)

	walk hero(0,up,2)
	wait for hero(0))
)
end
###
#####################################
script, undergroundquarrydoor2, begin
if((herox(0)==42,or,herox(0)==43),and,heroy(0)==111) then(
	settp
	tp
)
else(
if((herox(0)==42,or,herox(0)==43),and,heroy(0)==110) then(
	settp(-1,-1,-1)
	tp

	if(check tag(309)==false) then(
		tb(1348)
		set tag(309,1)
	)
)
)
do(
if((herox(0)==42,or,herox(0)==43),and,heroy(0)==86) then(
	settp(-1,-1,-1)
	tp
)
)
do(
if((herox(0)==42,or,herox(0)==43),and,heroy(0)==85) then(
	settp(-2,-2,-2)
	tp
	set pal(noon)
)
)
do(
if((herox(0)==42,or,herox(0)==43),and,heroy(0)==63) then(
	settp(-2,-2,-2)
	tp
	set pal(noon)
)
)
do(
if((herox(0)==42,or,herox(0)==43),and,heroy(0)==62) then(
	settp(-3,-3,-3)
	tp
	set pal(afternoon)

	if(check tag(88)==false) then(dangle1)
)
)
do(
if(herox(0)==3,and,heroy(0)==67) then(
	settp(-4,-4,-4)
	tp
)
)
do(
if(herox(0)==3,and,heroy(0)==66) then(
	settp(-3,-3,-3)
	set pal(afternoon)

	if(check tag(88)==true,and,check tag(89)==false) then(
		set npc position(3,176,106)
		alter npc(3,NPCstat:display text,1378)
		alter npc(3,NPCstat:palette,107)
	)
)
)
do(
if(herox(0)==75,and,heroy(0)==51) then(
	settp(-3,-3,-3)
	tp
	set pal(afternoon)
)
)
do(
if(herox(0)==75,and,heroy(0)==50) then(
	settp(-4,-4,-4)
	tp

	if(check tag(88)==true,and,check tag(89)==false) then(
		set npc position(3,176,106)
		alter npc(3,NPCstat:display text,1378)
		alter npc(3,NPCstat:palette,107)
	)
)
)
do(
if(herox(0)==75,and,heroy(0)==28) then(
	settp(-4,-4,-4)
	tp
)
)
do(
if(herox(0)==75,and,heroy(0)==27) then(
	settp(-5,-5,-5)
	tp
	set pal(afternoon)
)
)
do(
if(herox(0)==176,and,heroy(0)==113) then(
	settp(-5,-5,-5)
	tp
	set pal(afternoon)
)
)
do(
if(herox(0)==176,and,heroy(0)==112) then(
	settp(-6,-6,-6)
	tp
	set pal(night)

	if(check tag(88)==true,and,check tag(89)==false) then(dangle2)
)
)
do(
if(herox(0)==210,and,(heroy(0)==109,or,heroy(0)==110)) then(
	settp(-6,-6,-6)
	tp
	set pal(night)

	if(check tag(89)==true,and,check tag(90)==false) then(
		set npc position(3,142,39)
		alter npc(3,NPCstat:palette,107)
	)
)
)
do(
if(herox(0)==211,and,(heroy(0)==109,or,heroy(0)==110)) then(
	settp(-7,-7,-7)
	tp
)
)
end
###
#####################################
script, undergroundquarrydoor3, begin
if(herox(0)==152,and,heroy(0)==107) then(
	settp(-6,-6,-6)
	tp
	set pal(night)

	if(check tag(89)==true,and,check tag(90)==false) then(
		set npc position(3,142,39)
		alter npc(3,NPCstat:palette,107)
	)
)
else(
if(herox(0)==151,and,heroy(0)==107) then(
	settp(-7,-7,-7)
	tp
)
)
do(
if((herox(0)==149,or,herox(0)==150),and,heroy(0)==82) then(
	settp(-7,-7,-7)
	tp
)
)
do(
if((herox(0)==149,or,herox(0)==150),and,heroy(0)==81) then(
	settp(-8,-8,-8)
	tp
)
)
do(
if(herox(0)==143,and,heroy(0)==71) then(
	settp(-8,-8,-8)
	tp
)
)
do(
if(herox(0)==143,and,heroy(0)==70) then(
	settp(-9,-9,-9)
	tp
)
)
do(
if(herox(0)==142,and,heroy(0)==51) then(
	settp(-9,-9,-9)
	tp
)
)
do(
if(herox(0)==142,and,heroy(0)==50) then(
	settp(-10,-10,-10)
	tp
)
)
do(
if(herox(0)==156,and,heroy(0)==42,and,check tag(91)==false) then(
	settp(-10,-10,-10)
	tp
)
)
do(
if(herox(0)==157,and,heroy(0)==42,and,check tag(91)==false) then(
	settp(-10,-10,-10,0,4,0)
	tp
)
)
do(
if(herox(0)==162,and,heroy(0)==42,and,check tag(91)==false) then(
	settp(-10,-10,-10,0,4,0)
	tp
)
)
do(
if(herox(0)==163,and,heroy(0)==42,and,check tag(91)==false) then(
	settp(-10,-10,-10,0,10,0)
	tp
)
)
do(
if(herox(0)==15,and,heroy(0)==22) then(
	pan camera(south,0,0)
	walk hero(0,down,1)
	wait for hero(0)
	palout(2)
	camera follows hero(0)
	teleport to map(18+poff,3,36)
	set npc direction(15,up)
	set hp
	wait(1)
	pan camera(south,0,0)
	set hero position(0,4,38)
	write pass block(4,37,128)
	write pass block(4,38,128)
	set hero speed(0,2)
	wait(1)
	palin(2)
	walk hero(0,up,2)
	wait for hero(0)
	set hero speed(0,hspeed)
	walk hero(0,left,1)
	wait for hero(0)
	set hero frame(0,0)
	camera follows hero(0)
	write pass block(4,37,0)
	write pass block(4,38,0)
)
)
do(
if(herox(0)==168,and,heroy(0)==42,and,check tag(567)==false) then(
	set hero speed(0,4)
	pan camera(right,6,2)
	walk hero(0,right,6)
	wait for hero(0)
	set hero frame(0,0)
	set hero speed(0,hspeed)
	wait for camera
	camera follows hero(0)
	wait(4)
	set hero direction(0,down)
	wait(2)
	set hero direction(0,left)
	wait(7)
	set hero direction(0,down)
	wait(2)
	set hero direction(0,right)
	wait(7)
	battleflash
	ff(126,0,false)
	tp
	set tag(567,1)
)
)
end
###

#############################
script, gitlehtombdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

gitlehtombdoor11
gitlehtombdoor111
gitlehtombdoor1111

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###
###############################
script, gitlehtombdoor11, begin
if(herox(0)==9,and,heroy(0)==59) then(
	walk hero(0,down,1)
	wait for hero(0)
	palout(3)
	teleport to map(22,142,28)
	camera follows hero(0)
	if(check tag(346)==false) then(
		set npc position(3,142,34)
		set npc direction(3,up)
		alter npc(3,NPCstat:script,208)
		alter npc(3,NPCstat:palette,107)
	)
	wait(1)
	pan camera(down,2,20)
	wait for camera
	wait(1)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (3)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (3)
	reset palette
	tweak palette (-10,-10,-10)
	update palette

	settp(-10,-10,-10)

	walk hero(0,down,2)
	wait for hero(0)
	camera follows hero)
else(
if(herox(0)==9,and,heroy(0)==49) then(mrup(-6,-6,-6))
)
do(
if(herox(0)==9,and,heroy(0)==47) then(mrdown(-7,-7,-7))
)
do(
if(herox(0)==17,and,heroy(0)==42) then(mrright(-5,-5,-5,afternoon))
)
do(
if(herox(0)==19,and,heroy(0)==42) then(mrleft(-6,-6,-6,night))
)
do(
if(herox(0)==27,and,heroy(0)==37) then(mrup(1,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==27,and,heroy(0)==35) then(mrdown(-5,-5,-5,afternoon))
)
do(
if(herox(0)==17,and,heroy(0)==30) then(mrright(1,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==35,and,(heroy(0)==30,or,heroy(0)==31)) then(mrright(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==37,and,(heroy(0)==30,or,heroy(0)==31)) then(mrleft(1,-2,-2,0,3,0,0,4))
)
do(
if((herox(0)==43,or,herox(0)==44),and,heroy(0)==25) then(mrup(1,-2,-2,0,3,0,0,4))
)
do(
if((herox(0)==43,or,herox(0)==44),and,heroy(0)==23) then(mrdown(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==35,and,heroy(0)==18) then(mrright(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==37,and,heroy(0)==18) then(mrleft(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==27,and,heroy(0)==25) then(mrup(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==27,and,heroy(0)==23) then(mrdown(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==45,and,heroy(0)==37) then(mrup(1,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==45,and,heroy(0)==47) then(mrdown(-4,-4,-4,afternoon))
)
end
###
###############################
script, gitlehtombdoor111, begin
if(herox(0)==45,and,heroy(0)==49) then(mrup(-2,1,-2,noon))
else(
if(herox(0)==55,and,heroy(0)==30) then(mrleft(1,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==53,and,heroy(0)==18) then(mrright(-2,-2,-2,noon))
)
do(
if(herox(0)==55,and,heroy(0)==18) then(mrleft(1,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==60,and,heroy(0)==13) then(mrup(1,-1,-1))
)
do(
if(herox(0)==60,and,heroy(0)==11) then(mrdown(-2,-2,-2))
)
do(
if(herox(0)==60,and,heroy(0)==6) then(
	write pass block(60,4,128)
	walk hero(0,up,1)
	wait for hero(0)
	palout(2)
	camera follows hero
	set hero position(0,63,66)
	wait(1)
	pan camera(south,0,0)
	set pal(afternoon)
	wait(1)
	set hero position(0,60,65)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	reset palette
	tweak palette (-6,-6,-6)
	tweak palette (6,0,0)
	update palette

	settp(-6,-6,-6,6,0,0)

	walk hero(0,down,2)
	wait for hero(0)
)
)
do(
if(herox(0)==60,and,heroy(0)==66) then(
	write pass block(60,4,128)
	walk hero(0,up,1)
	wait for hero(0)

	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	tweak palette (-111,-111,-111)
	update palette
	wait (2)

	camera follows hero
	set hero position(0,63,6)
	wait(1)
	pan camera(south,0,0)
	set pal(noon)
	wait(1)
	set hero position(0,60,5)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	reset palette
	tweak palette (-5,-5,-5)
	update palette
	wait (2)
	reset palette
	tweak palette (1,-1,-1)
	update palette

	settp(1,-1,-1)

	walk hero(0,down,2)
	wait for hero(0)
	write pass block(60,4,0))
)
do(
if(herox(0)==55,and,heroy(0)==68) then(mrleft(-7,-7,-7,0,3,4,0,0))
)
do(
if(herox(0)==53,and,heroy(0)==68) then(mrright(-6,-6,-6,0,3,6,0,0))
)
do(
if(herox(0)==43,and,heroy(0)==71) then(mrdown(-8,-8,-8,night))
)
do(
if(herox(0)==43,and,heroy(0)==73) then(mrup(-7,-7,-7,afternoon,3,4,0,0))
)
do(
if(herox(0)==37,and,heroy(0)==78) then(mrleft(-5,-5,-5,afternoon,3,3,0,0))
)
do(
if(herox(0)==35,and,heroy(0)==78) then(mrright(-8,-8,-8,night))
)
end
###
###############################
script, gitlehtombdoor1111, begin
if(herox(0)==19,and,heroy(0)==30) then(
	pan camera (left,9,10)
	walk hero (0,left,3)

	if(check tag(98)) then(
		wait for camera
		settp(-2,1,-2)
		tp
		set pal(noon)
		pan camera (left,9,10)
		wait for camera
		wait for hero (0))

	if(check tag(98)==false) then(gitlehtombmini1)
)
else(
if(herox(0)==45,and,heroy(0)==35) then(
	pan camera (down,6,10)
	walk hero (0,down,3)

	if(check tag(99)) then(
		wait for camera
		settp(-2,1,-2)
		tp
		set pal(noon)
		pan camera (down,6,10)
		wait for camera
		wait for hero (0))

	if(check tag(99)==false) then(gitlehtombmini2)
)
)
do(
if(herox(0)==53,and,heroy(0)==30) then(
	pan camera (right,9,10)
	walk hero (0,right,3)

	if(check tag(100)) then(
		wait for camera
		settp(-1,2,-2)
		tp
		set pal(noon)
		pan camera (right,9,10)
		wait for camera
		wait for hero (0))

	if(check tag(100)==false) then(gitlehtombmini3)
)
)
end
###

##########################
script, gitlehtombdoor2, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

gitlehtombdoor22
gitlehtombdoor222
gitlehtombdoor2222

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###
###########################
script, gitlehtombdoor22, begin
if(herox(0)==33,and,heroy(0)==76) then(
	walk hero(0,up,1)
	wait for hero(0)
	palout(2)
	camera follows hero
	set hero position(0,27,18)
	wait(1)
	pan camera(south,0,0)
	set pal(morning)
	wait(1)
	set hero position(0,33,20)
	settp(1,-2,-2,0,0,4)
	palin(2)
	tp
	walk hero(0,down,2)
	wait for hero(0))
else(
if(herox(0)==33,and,heroy(0)==21) then(
	walk hero(0,up,1)
	wait for hero(0)
	palout(2)
	camera follows hero
	set hero position(0,27,78)
	wait(1)
	pan camera(south,0,0)
	wait(1)
	set hero position(0,33,75)
	set pal(afternoon)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	reset palette
	tweak palette (-5,-5,-5)
	tweak palette (3,0,0)
	update palette

	settp(-5,-5,-5,3,0,0)

	walk hero(0,down,2)
	wait for hero(0))
)
do(
if(herox(0)==27,and,heroy(0)==11) then(mrdown(1,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==19,and,heroy(0)==18) then(mrleft(-1,-4,-4,0,3,0,0,4))
)
do(
if(herox(0)==17,and,heroy(0)==18) then(mrright(1,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==9,and,heroy(0)==13) then(mrup(-1,-4,-4,afternoon,3,4,0,0))
)
do(
if(herox(0)==9,and,heroy(0)==11) then(mrdown(-1,-4,-4,morning,3,0,0,4))
)
do(
if(herox(0)==17,and,heroy(0)==4) then(mrright(-2,-2,-2,noon,3,0,6,0))
)
do(
if(herox(0)==19,and,heroy(0)==4) then(mrleft(-1,-4,-4,afternoon,3,4,0,0))
)
do(
if(herox(0)==37,and,heroy(0)==4) then(mrleft(-2,-2,-2,noon,3,0,6,0))
)
do(
if(herox(0)==53,and,heroy(0)==4) then(mrright(1,-1,-1,noon))
)
do(
if(herox(0)==55,and,heroy(0)==4) then(mrleft(-3,-3,-3,afternoon,3,8,2,2))
)
do(
if(herox(0)==71,and,heroy(0)==4) then(
	set npc position(4,83,8)
	set npc direction(4,down)
	alter npc(4,NPCstat:picture,496)
	alter npc(4,NPCstat:palette,26)

	if( read map block(82,17) <> read map block(106,0) ) then(set npc frame(4,0))
	else(set npc frame(4,1))

	mrright(-2,-2,-2,afternoon,3,4,0,0)
)
)
do(
if(herox(0)==73,and,heroy(0)==4) then(
	pan camera (left,9,10)
	walk hero (0,left,3)
	wait for camera
	settp(1,-1,-1)
	tp
	set pal(noon)
	pan camera (left,9,10)
	wait for camera

	set npc position(4,2,1)
	set npc frame(4,0)
	alter npc(4,NPCstat:picture,164)
	alter npc(4,NPCstat:palette,33)

	wait for hero (0))
)
do(
if(herox(0)==67,and,heroy(0)==11) then(mrdown(-2,-2,-2))
)
do(
if(herox(0)==67,and,heroy(0)==13) then(mrup(1,-1,-1))
)
end
###
###########################
script, gitlehtombdoor222, begin
if(herox(0)==67,and,heroy(0)==23) then(mrdown(-1,2,-2))
else(
if(herox(0)==67,and,heroy(0)==25) then(mrup(-2,-2,-2))
)
do(
if(herox(0)==67,and,heroy(0)==35) then(mrdown(-2,-2,-2,morning,3,0,0,4))
)
do(
if(herox(0)==67,and,heroy(0)==37) then(mrup(-1,2,-2,noon))
)
do(
if(herox(0)==71,and,heroy(0)==16) then(mrright(-2,-2,-2,morning,3,2,0,4))
)
do(
if(herox(0)==73,and,heroy(0)==16) then(mrleft(-2,-2,-2,noon))
)
do(
if(herox(0)==89,and,heroy(0)==18) then(mrright(-2,-2,-2,0,3,0,0,4))
)
do(
if(herox(0)==91,and,heroy(0)==18) then(mrleft(-2,-2,-2,0,3,2,0,4))
)
do(
if((herox(0)==79,or,herox(0)==82,or,herox(0)==83),and,heroy(0)==23) then(mrdown(-4,-4,-4,0,3,0,0,5))
)
do(
if((herox(0)==79,or,herox(0)==82,or,herox(0)==83),and,heroy(0)==25) then(mrup(-2,-2,-2,0,3,2,0,4))
)
do(
if((herox(0)==79,or,herox(0)==82,or,herox(0)==83),and,heroy(0)==35) then(mrdown(-5,-5,-5,0,3,0,0,6))
)
do(
if((herox(0)==79,or,herox(0)==82,or,herox(0)==83),and,heroy(0)==37) then(mrup(-4,-4,-4,0,3,0,0,5))
)
do(
if((herox(0)==79,or,herox(0)==82,or,herox(0)==83),and,heroy(0)==47) then(mrdown(-2,-2,-2,noon,3,0,6,3))
)
do(
if((herox(0)==79,or,herox(0)==82,or,herox(0)==83),and,heroy(0)==49) then(mrup(-5,-5,-5,morning,3,0,0,6))
)
do(
if(herox(0)==89,and,heroy(0)==56) then(
	mrright(-4,-4,-4,0,3,2,2,2)
	if(check tag(581)==false) then(
		show backdrop(7)
		wait(3)
		show map
		tb(7342)
		set tag(581,1)
		set tag(8,0)
		wait(2)
		save game
	)
)
)
do(
if(herox(0)==91,and,heroy(0)==56) then(mrleft(-2,-2,-2,0,3,0,6,3))
)
do(
if(herox(0)==99,and,heroy(0)==47) then(mrdown(-4,-4,-4,0,3,2,2,2))
)
do(
if(herox(0)==99,and,heroy(0)==37) then(
	pan camera (up,6,10)
	walk hero (0,up,3)
	wait for camera
	settp(2,1,0)
	tp

	if(check tag(97)) then(
		pan camera (up,6,10)
		wait for camera
		wait for hero (0))
	if(check tag(97)==false) then(gitlehtombgitleh)

)
)
do(
if(herox(0)==99,and,heroy(0)==35) then(mrdown(-4,-4,-4,0,3,4,4,4))
)
end
###
###########################
script, gitlehtombdoor2222, begin
if(herox(0)==27,and,heroy(0)==13) then(
	pan camera (up,6,10)
	walk hero (0,up,3)
	wait for camera
	settp(-2,-2,-2,0,6,0)
	tp
	set pal(noon)

	if(check tag(92)) then(
		pan camera (up,6,10)
		wait for camera
		wait for hero (0))
	if(check tag(92)==false) then(gitlehtombintro)
)
else(
if(herox(0)==35,and,heroy(0)==4) then(
	pan camera (right,9,10)
	walk hero (0,right,3)
	wait for camera
	settp(-3,-3,-3,8,2,2)
	tp
	set pal(afternoon)

	if(checktag(93)) then(
		pan camera (right,9,10)
		wait for camera
		wait for hero (0))
	if(checktag(93)==false) then(gitlehtombrift)
)
)
do(
if(herox(0)==99,and,heroy(0)==49) then(
	pan camera (up,6,10)
	walk hero (0,up,3)
	wait for camera
	settp(-4,-4,-4,4,4,4)
	tp

	if(check tag(96)) then(
		pan camera (up,6,10)
		wait for camera
		wait for hero (0)
	)
	if(check tag(96)==false) then(gitlehtombfight)
)
)
end
###

#############################
script, troubleinadlez, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(5)) then(destroy npc(12))

focus camera(105,42,2)
wait for camera
wait(2)

jig npc(5)
tb(1063)
jig npc(7)
tb(1064)
jig npc(4)
tb(1065)
jig npc(5)
tb(1066)
jig npc(7)
tb(1067)
jig npc(4)
tb(1068)
jig npc(7)
tb(1069)
jig npc(8)
tb(1070)
jig npc(6)
tb(1071)
set npc direction(7,down)
jig npc(7)
tb(1072)
jig npc(4)
show text box(1073)
wait(2)
set npc direction(7,left)
set npc direction(6,right)
wait(2)
set npc direction(7,up)
set npc direction(6,up)
set npc direction(5,up)
set npc direction(8,up)
wait for text box
set npc direction(7,left)
jig npc(7)
show text box(1074)
wait(4)
set npc direction(5,right)
set npc direction(6,right)
wait(2)
set npc direction(8,left)
wait for text box
jig npc(6)
tb(1075)
jig npc(4)
tb(1076)
jig npc(8)
tb(1077)
set npc direction(5,down)
jig npc(5)
tb(1078)

walk npc(5,left,1)
walk npc(6,left,1)
walk npc(7,right,1)
walk npc(8,right,1)
wait for npc(8)
walk npc(5,down,7)
walk npc(6,down,7)
walk npc(7,down,7)
walk npc(8,down,7)
wait for npc(8)

set npc position(5,118,65)
set npc position(6,119,66)
set npc position(7,121,66)
set npc position(8,122,65)
set npc direction(5,right)
set npc direction(6,up)
set npc direction(7,up)
set npc direction(8,left)
set npc frame(5,0)
set npc frame(6,0)
set npc frame(7,0)
set npc frame(8,0)

jig npc(4)
tb(1079)
walk hero to x(0,102)
wait for hero(0)
walk hero to y(0,41)
wait for hero(0)
set hero direction(0,right)
set hero frame(0,0)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set hero speed(0,4)
walk npc(1,down,1)
wait for npc(1)
set npc direction(1,right)
set npc frame(1,0)
wait(4)
jig hero(0)
tb(1080)
wait(2)
set npc direction(4,left)
wait(5)
jig npc(4)
tb(1081)
jig hero(0)
tb(1082)
walk npc(4,left,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(1083)
jig npc(1)
tb(1084)
jig npc(4)
tb(1085)
set hero direction(0,down)
jig hero(0)
show text box(1086)
wait(2)
set npc direction(1,up)
wait for text box
jig npc(1)
tb(1087)
set hero direction(0,right)
wait(5)
jig hero(0)
show text box(1088)
wait(2)
set npc direction(1,right)
wait for text box
jig npc(4)
tb(1089)
tb(1090)
jig hero(0)
tb(1091)
jig npc(4)
tb(1092)
jig hero(0)
tb(1093)
walk hero(0,down,2)
walk npc(1,down,2)
wait(2)
set npc direction(4,down)
wait(2)
jig npc(4)
tb(1094)
wait for npc(1)
set hero frame(0,0)
set npc frame(1,0)
set hero direction(0,right)
set npc direction(1,right)
wait(2)
set hero direction(0,up)
set npc direction(1,up)
wait(4)
jig npc(4)
tb(1095)
jig hero(0)
tb(1096)
wait(6)
set npc frame(4,1)
wait(4)
set npc frame(4,0)
wait(2)
tb(1097)
jig hero(0)
tb(1098)
wait(2)
jig npc(4)
tb(1099)
jig hero(0)
tb(1100)
set hero direction(0,right)
set npc direction(1,right)
wait(2)
walk hero(0,down,7)
walk npc(1,down,7)
wait(6)
jig npc(4)
tb(1101)
wait for npc(1)
wait(6)
jig npc(4)
show text box(1102)
walk npc(4,down,1)
wait for npc(4)
wait for text box
wait(4)

set npc position(1,0,0)
set partyin
focus camera(102,50,4)
set hero frame(0,0)
wait for camera
set tag(76,1)
camera follows hero
set hero speed(0,hspeed)

save game
resume obstruction
resume npcs
resume player
resume box advance
end
###

########################
script, meetjohan, begin
suspend player
suspend npcs
suspend obstruction

meetjohan1
meetjohan2
meetjohan3
meetjohan4

save game
resume obstruction
resume npcs
resume player
resume box advance
end
###
#########################
script, meetjohan1, begin
set tag(120,1)
focus camera(120,66,4)

set hero frame(0,0)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set hero speed(0,4)

if(herox(0)==117,and,heroy(0)==65) then(
set hero direction(0,right)
walk npc(1,down,1)
wait for npc(1)
set npc direction(1,right))
if(herox(0)==117,and,heroy(0)==66) then(
set hero direction(0,right)
walk npc(1,up,1)
wait for npc(1)
set npc direction(1,right))
if((herox(0)==118,or,herox(0)==121),and,heroy(0)==67) then(
set hero direction(0,up)
walk npc(1,right,1)
wait for npc(1)
set npc direction(1,up))
if((herox(0)==119,or,herox(0)==122),and,heroy(0)==67) then(
set hero direction(0,up)
walk npc(1,left,1)
wait for npc(1)
set npc direction(1,up))
if(herox(0)==123,and,heroy(0)==65) then(
set hero direction(0,left)
walk npc(1,down,1)
wait for npc(1)
set npc direction(1,left))
if(herox(0)==123,and,heroy(0)==66) then(
set hero direction(0,left)
walk npc(1,up,1)
wait for npc(1)
set npc direction(1,left))

set npc frame(1,0)
wait for camera
wait(4)

jig npc(6)
stop song
tb(1103)
wait(7)
set npc position(2,120,64)
walk npc(2,down,1)
wait for npc(2)
set npc frame(2,0)
jig npc(1)
tb(1104)
wait(6)
jig npc(2)
play song(84)
tb(1105)
jig npc(7)
tb(1106)
wait(4)
jig npc(2)
tb(1107)
wait(4)
set npc direction(2,left)
wait(8)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
wait(8)
set npc direction(2,down)
jig npc(2)
tb(1108)
jig npc(5)
set npc direction(2,left)
tb(1109)
jig npc(8)
show text box(1110)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
wait for text box
jig npc(2)
tb(1111)
wait(6)
set npc direction(2,down)
wait(10)
tb(1112)
if(herox(0)==117) then(set npc direction(2,left))
if(herox(0)==123) then(set npc direction(2,right))
jig npc(2)
tb(1113)
set npc direction(2,down)
jig npc(2)
show text box(1114)

if(herox(0)==117,and,heroy(0)==65) then(
walk npc(1,down,1)
walk hero(0,down,1)
wait for hero(0)
walk npc(1,right,1)
walk hero(0,down,1)
wait for hero(0)
walk npc(1,right,2)
walk hero(0,right,2)
wait for hero(0)
walk npc(1,up,1)
walk hero(0,right,1)
wait(2)
set npc direction(2,left)
wait for hero(0)
wait for text box
walk npc(2,up,1)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(2,0,0)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(1,0,0)
walk hero(0,up,1)
wait for hero(0)
set hero position(0,0,0))
if(herox(0)==117,and,heroy(0)==66) then(
walk hero(0,down,1)
walk npc(1,down,1)
wait for npc(1)
walk hero(0,right,1)
walk npc(1,down,1)
wait for npc(1)
walk hero(0,right,2)
walk npc(1,right,2)
wait for npc(1)
walk hero(0,up,1)
walk npc(1,right,1)
wait(2)
set npc direction(2,left)
wait for npc(1)
wait for text box
walk npc(2,up,1)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set npc position(2,0,0)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set hero position(0,0,0)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0))
if(herox(0)==118,and,heroy(0)==67) then(
walk npc(1,right,1)
walk hero(0,right,1)
wait for hero(0)
walk npc(1,up,1)
walk hero(0,right,1)
wait(2)
set npc direction(2,left)
wait for hero(0)
wait for text box
walk npc(2,up,1)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(2,0,0)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(1,0,0)
walk hero(0,up,1)
wait for hero(0)
set hero position(0,0,0))
if(herox(0)==119,and,heroy(0)==67) then(
walk hero(0,right,1)
walk npc(1,right,1)
wait for npc(1)
walk hero(0,up,1)
walk npc(1,right,1)
wait(2)
set npc direction(2,left)
wait for npc(1)
wait for text box
walk npc(2,up,1)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set npc position(2,0,0)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set hero position(0,0,0)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0))
if(herox(0)==121,and,heroy(0)==67) then(
walk hero(0,left,1)
walk npc(1,left,1)
wait for npc(1)
walk hero(0,up,1)
walk npc(1,left,1)
wait(2)
set npc direction(2,right)
wait for npc(1)
wait for text box
walk npc(2,up,1)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set npc position(2,0,0)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set hero position(0,0,0)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0))
if(herox(0)==122,and,heroy(0)==67) then(
walk npc(1,left,1)
walk hero(0,left,1)
wait for hero(0)
walk npc(1,up,1)
walk hero(0,left,1)
wait(2)
set npc direction(2,right)
wait for hero(0)
wait for text box
walk npc(2,up,1)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(2,0,0)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(1,0,0)
walk hero(0,up,1)
wait for hero(0)
set hero position(0,0,0))
if(herox(0)==123,and,heroy(0)==65) then(
walk npc(1,down,1)
walk hero(0,down,1)
wait for hero(0)
walk npc(1,left,1)
walk hero(0,down,1)
wait for hero(0)
walk npc(1,left,2)
walk hero(0,left,2)
wait for hero(0)
walk npc(1,up,1)
walk hero(0,left,1)
wait(2)
set npc direction(2,right)
wait for hero(0)
wait for text box
walk npc(2,up,1)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(2,0,0)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
set npc position(1,0,0)
walk hero(0,up,1)
wait for hero(0)
set hero position(0,0,0))
if(herox(0)==123,and,heroy(0)==66) then(
walk hero(0,down,1)
walk npc(1,down,1)
wait for npc(1)
walk hero(0,left,1)
walk npc(1,down,1)
wait for npc(1)
walk hero(0,left,2)
walk npc(1,left,2)
wait for npc(1)
walk hero(0,up,1)
walk npc(1,left,1)
wait(2)
set npc direction(2,right)
wait for npc(1)
wait for text box
walk npc(2,up,1)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set npc position(2,0,0)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
set hero position(0,0,0)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0))
end
###
#########################
script, meetjohan2, begin
palout(1)
camera follows hero(0)
teleport to map(currentmap+4,3,121)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,3,122)
set npc position(1,4,122)
set npc position(2,3,119)
set hero frame(0,0)
set hero direction(0,up)
set npc direction(1,up)
set npc direction(2,down)
wait(6)
palin(1)

wait(4)
jig npc(2)
play song(84)
tb(1115)
jig hero(0)
tb(1116)
walk npc(2,down,1)
show text box(1117)
wait for npc(2)
set npc frame(2,0)
wait for text box
jig npc(1)
tb(1118)
wait(10)
jig npc(2)
tb(1119)
alter npc(1,NPCstat:picture,80)
walk npc(1,up,2)
wait for npc(1)
set npc direction(1,left)
set npc frame(1,0)
show text box(1120)
wait(2)
set npc frame(1,1)
walk npc(2,left,1)
set npc direction(2,right)
wait(2)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
wait for text box
jig hero(0)
tb(1121)
set npc direction(2,down)
wait(4)
jig npc(2)
tb(1122)
tb(1123)
jig hero(0)
tb(1124)
wait(2)
jig npc(2)
tb(1125)
jig npc(1)
tb(1126)
set npc direction(2,right)
show text box(1127)
jig npc(2)
wait for text box
walk npc(1,left,1)
wait for npc(1)
wait(2)
alter npc(1,NPCstat:picture,77)
wait(8)
tb(1128)
jig npc(2)
tb(1129)
jig hero(0)
tb(1130)
set npc direction(2,down)
jig npc(2)
tb(1131)
jig hero(0)
tb(1132)
jig npc(2)
alter npc(1,NPCstat:picture,12)
tb(1133)
jig npc(1)
tb(1134)
set npc direction(2,right)
jig npc(2)
tb(1135)
tb(1136)
jig npc(1)
tb(1137)
set npc direction(2,down)
wait(2)
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)

jig npc(2)
wait(1)
variable(camx)
variable(camy)
set variable(camx,camera pixel X)
set variable(camy,camera pixel Y)
variable(i)
for(i,1,4,1) do(
put camera(random(camx--5,camx+5),random(camy--5,camy+5))
wait(1))

write map block(3,119,65)
write map block(3,118,33)
write pass block(3,119,0)
write pass block(3,118,0)
write pass block(3,117,128)

alter npc(1,NPCstat:picture,74)

for(i,1,4,1) do(
put camera(random(camx--5,camx+5),random(camy--5,camy+5))
wait(1))

put camera(camx,camy)
set tag(75,1)

wait(2)
set npc direction(2,right)
jig npc(2)
alter npc(1,NPCstat:picture,12)
tb(1138)
jig npc(1)
tb(1139)
walk npc(1,up,3)
wait(15)
show text box(1140)
wait(6)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
wait for text box
jig hero(0)
tb(1141)
walk hero(0,up,3)
walk npc(2,right,2)
wait for npc(2)
walk npc(2,up,3)
wait for npc(2)

palout(1)
camera follows hero(0)
teleport to map(currentmap--4,95,57)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,107,59)
set npc position(1,104,58)
set npc position(2,106,57)
wait(6)
palin(1)
end
###
#########################
script, meetjohan3, begin
walk npc(1,left,8)
walk npc(2,left,11)
walk hero(0,left,13)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
set npc direction(1,up)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)

wait(6)
jig npc(2)
play song(84)
tb(1142)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
tb(1143)
set npc direction(2,right)
jig npc(2)
tb(1144)
set npc direction(2,up)
wait(4)
jig npc(2)
jig npc(2)
wait(4)
jig npc(2)
wait(2)
jig npc(2)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)
jig npc(2)
wait(6)
jig npc(2)
jig npc(2)
jig npc(2)
wait(15)
set npc direction(2,right)
jig npc(2)
tb(1145)
set npc direction(1,left)
tb(1146)
alter npc(1,NPCstat:picture,12)
walk npc(1,left,1)
walk npc(2,down,1)
wait for npc(2)
set npc frame(1,0)
set npc frame(2,0)
set npc direction(1,up)
set npc direction(2,left)
wait(2)
set npc direction(2,up)
wait(2)
jig npc(1)
jig npc(1)
jig npc(1)
jig npc(1)
wait(4)
jig npc(1)
jig npc(1)
jig npc(1)
wait(6)
jig npc(1)
jig npc(1)
jig npc(1)
jig npc(1)
jig npc(1)
jig npc(1)
jig npc(1)
wait(15)
jig npc(2)
tb(1147)
set npc direction(1,right)
wait(2)
set npc direction(1,down)
jig npc(1)
tb(1148)
alter npc(2,NPCstat:picture,169)
set npc frame(2,1)
wait(1)
set npc frame(2,0)
wait(1)
set npc frame(2,1)
wait(1)
set npc frame(2,0)
wait(1)
set npc frame(2,1)
wait(1)
set npc frame(2,0)
wait(1)
set npc frame(2,1)
wait(1)
set npc frame(2,0)
tb(1149)
jig npc(1)
tb(1150)
alter npc(2,NPCstat:picture,13)
jig npc(2)
tb(1151)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
write pass block(95,55,0)
wait(10)
alter npc(2,NPCstat:movespeed,10)
walk npc(2,up,2)
wait for npc(2)
alter npc(2,NPCstat:movespeed,2)
walk npc(2,down,1)
set npc direction(2,up)

variable(camx)
variable(camy)
variable(i)

set variable(camx,camera pixel X)
set variable(camy,camera pixel Y)
for(i,1,8,1) do(
put camera(random(camx--5,camx+5),random(camy--5,camy+5))
wait(1))
put camera(camx,camy)
write pass block(95,55,128)

wait for npc(2)
alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
walk npc(2,left,1)
set npc direction(2,up)
wait(2)
set npc direction(2,right)
wait(2)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait for npc(2)
walk npc(2,left,1)
set npc direction(2,up)
wait(2)
set npc direction(2,right)
wait(2)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait for npc(2)
set npc frame(2,0)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
tb(1152)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
jig npc(2)
show text box(1153)
wait(2)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
wait for text box
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
show text box(1154)
wait(5)
set hero speed(0,10)
walk hero(0,up,3)
wait for hero(0)
write map block(95,56,1)
walk hero(0,up,1)

set variable(camx,camera pixel X)
set variable(camy,camera pixel Y)
for(i,1,4,1) do(
put camera(random(camx--5,camx+5),random(camy--5,camy+5))
wait(1))
put camera(camx,camy)

wait for hero(0)
set hero position(0,0,0)
wait for text box
alter npc(1,NPCstat:picture,12)
wait(4)
set npc direction(1,left)
wait(10)
tb(1155)
set hero speed(0,4)
wait(10)

palout(1)
camera follows hero(0)
teleport to map(currentmap+4,4,139)
stop song
wait(1)
set hero direction(0,up)
pan camera(south,0,0)
set hero position(0,4,140)
set npc position(1,4,142)
set npc position(2,4,142)
wait(6)
palin(1)

walk npc(2,up,1)
wait for npc(2)
walk npc(2,left,1)
walk npc(1,up,1)
wait for npc(1)
walk npc(2,up,4)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
walk npc(2,right,2)
wait for npc(2)
wait(15)
tb(1156)
walk hero(0,up,2)
walk npc(1,up,3)
wait for hero(0)
set hero direction(0,right)
set hero frame(0,0)
wait for npc(1)
set npc direction(1,right)
set npc frame(1,0)
wait(6)
jig npc(1)
tb(1157)
jig hero(0)
tb(1158)
wait(4)
tb(1159)
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
jig npc(2)
set hero direction(0,up)
tb(1160)

palout(1)
camera follows hero(0)
teleport to map(currentmap--4,120,65)
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
wait(6)
palin(1)

wait(15)
set npc position(1,120,64)
walk npc(1,down,1)
wait for npc(1)
set hero position(0,120,64)
walk npc(1,right,1)
walk hero(0,down,1)
wait for hero(0)
set npc frame(1,0)
set npc direction(1,down)
set npc position(2,120,64)
walk hero(0,left,1)
walk npc(2,down,1)
wait for npc(2)
set hero frame(0,0)
set hero direction(0,down)
set npc frame(2,0)
wait(2)
jig npc(2)
tb(1161)
jig npc(6)
tb(1162)
set npc direction(8,left)
jig npc(8)
tb(1163)
set npc direction(5,right)
set npc direction(6,right)
set npc direction(7,left)
jig npc(5)
tb(1164)
jig npc(2)
tb(1165)
wait(2)
stop song
tb(1166)
set npc direction(5,down)
set npc direction(6,down)
set npc direction(1,left)
wait(2)
set npc direction(5,left)
set npc direction(6,left)
set npc direction(2,left)
set hero direction(0,left)
set npc position(10,111,66)
walk npc(10,right,5)
wait for npc(10)
jig npc(10)
tb(1167)

walk npc(5,down,1)
walk npc(8,down,1)
wait for npc(8)
walk npc(5,left,7)
walk npc(6,left,8)
walk npc(7,left,10)
walk npc(8,left,11)
wait(2)
set npc direction(10,down)
wait(2)
walk npc(10,left,6)
wait for npc(10)
set npc position(10,0,0)

walk hero(0,down,1)
walk npc(1,down,1)
wait for npc(1)
set hero direction(0,left)
set npc direction(1,left)
wait(6)
set hero direction(0,up)
jig hero(0)
tb(1168)
set npc direction(2,down)
jig npc(2)
tb(1169)
set npc direction(1,up)
jig npc(1)
tb(1170)
walk npc(1,left,1)
jig npc(2)
show text box(1171)
wait for npc(1)
set npc frame(1,0)
wait for text box
set npc direction(1,up)
jig npc(1)
tb(1172)
jig hero(0)
play song(82)
tb(1173)
walk npc(2,left,1)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
jig npc(2)
tb(1174)
set npc direction(1,left)
tb(1175)
jig hero(0)
tb(1176)
walk npc(2,down,1)
wait for npc(2)
set npc position(2,0,0)
end
###
#########################
script, meetjohan4, begin
tb(1180)

set party in
add hero(2)
set hero palette(find hero(1),33+poff,outside battle)
set hero palette(find hero(1),33+poff,inside battle)
set party out
swap by position(find hero(0),0)

#setting johan stats
set hero stat(find hero(2),2,dostr+5,current stat)
set hero stat(find hero(2),2,dostr+5,maximum stat)
set hero stat(find hero(2),3,doacc--5,current stat)
set hero stat(find hero(2),3,doacc--5,maximum stat)
set hero stat(find hero(2),4,dodef,current stat)
set hero stat(find hero(2),4,dodef,maximum stat)
set hero stat(find hero(2),5,doddg+10,current stat)
set hero stat(find hero(2),5,doddg+10,maximum stat)
set hero stat(find hero(2),6,doskl--5,current stat)
set hero stat(find hero(2),6,doskl--5,maximum stat)
set hero stat(find hero(2),7,doevd,current stat)
set hero stat(find hero(2),7,doevd,maximum stat)

#saving johan hero stats for rts use
set variable(johp,get hero stat(find hero(2),0,maximum stat))
set variable(josp,get hero stat(find hero(2),1,maximum stat))
set variable(jostr,get hero stat(find hero(2),2,maximum stat))
set variable(joacc,get hero stat(find hero(2),3,maximum stat))
set variable(jodef,get hero stat(find hero(2),4,maximum stat))
set variable(joddg,get hero stat(find hero(2),5,maximum stat))
set variable(joskl,get hero stat(find hero(2),6,maximum stat))
set variable(joevd,get hero stat(find hero(2),7,maximum stat))

#here is where you check for johan level ups
variable(jolevel)
set variable(jolevel,get hero level(find hero(2)))
if ( jolevel >> 0 ) then(
	palout(1)
	show backdrop(0)
	palin(1)
	johan hp calculator
	set hero stat(find hero(2),0,get hero stat(find hero(2),0,maximum stat),current stat)
	johan level up(jolevel,228)
	wait(4)
	show backdrop(0)
	wait(4)
	palout(1)
	show map
	wait(1)
	palin(1)
)


walk hero(0,left,2)
wait(5)
alter npc(1,NPCstat:picture,73)
set npc frame(1,1)
show text box(1177)
wait for hero(0)
set hero frame(0,0)
wait for text box
set hero direction(0,down)
wait(2)
set hero direction(0,right)
jig hero(0)
tb(1178)
wait(12)
set npc frame(1,0)
alter npc(1,NPCstat:picture,80)
jig npc(1)
jig npc(1)
tb(1179)
stop song
walk npc(1,left,3)
wait for npc(1)
set npc position(1,0,0)
alter npc(1,NPCstat:picture,12)
set tag(77,1)
set tag(75,0)

focus camera(herox(0),heroy(0),2)
wait for camera
camera follows hero(0)

set hp
set hero speed(0,hspeed)
set party in

if(check tag(3)) then(play song(29))
if(check tag(4)) then(play song(29))
if(check tag(5)) then(play song(29))
if(check tag(6)) then(play song(73))

end
###

##############################
script, somethingsneaky, begin
suspend player
suspend npcs
suspend obstruction

somethingsneaky1

tb(1203)

if(check tag(79)) then( somethingsneaky2 )

if(check tag(80)) then(
somethingsneaky3
somethingsneaky4
)

set npc direction(9,down)
set hero frame(0,0)
set hero speed(0,hspeed)

resume obstruction
resume npcs
resume player
resume box advance
end
###
###############################
script, somethingsneaky1, begin
pan camera(south,0,0)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set hero speed(0,4)

if(herox(0)==30,and,heroy(0)<=59) then(
set hero direction(0,left)
set hero frame(0,0)
walk npc(1,down,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
)
if(herox(0)==30,and,heroy(0)==60) then(
set hero frame(0,0)
set hero direction(0,left)
walk npc(1,up,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
)
if(herox(0)==16,and,heroy(0)==57) then(
set hero direction(0,right)
set hero frame(0,0)
walk npc(1,down,1)
walk npc(2,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
)

jig npc(2)
stop song
tb(1181)
jig hero(0)
tb(1182)
wait(5)
jig npc(2)
tb(1183)
jig hero(0)
tb(1184)
jig npc(2)
tb(1185)

wait(2)
if(herox(0)==30) then(
walk npc to x(2,27)
wait for npc(2)
walk npc to y(2,57)
focus camera(27,57,2)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)
wait for camera
wait(10)
)
if(herox(0)==16) then(
walk npc to x(2,19)
focus camera(19,57,2)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)
wait(5)
walk npc(2,down,1)
wait for npc(2)
walk npc to x(2,27)
wait for camera
focus camera(27,57,2)
wait for npc(2)
walk npc to y(2,57)
wait for npc(2)
wait for camera
wait(10)
)
variable(hx)
variable(hy)
variable(nx1)
variable(ny1)
set variable(hx,herox(0))
set variable(hy,heroy(0))
set variable(nx1,npcx(1))
set variable(ny1,npcy(1))

palout(1)
camera follows hero(0)
wait(1)
teleport to map(currentmap+4,12,209)
stop song
pan camera(south,0,0)
wait(1)
set hero position(0,0,1)
wait(1)
set npc position(4,11,209)
set npc direction(4,up)
set npc position(6,10,207)
set npc direction(5,down)
set npc position(5,11,207)
set npc direction(6,down)
set npc position(7,12,207)
set npc direction(7,down)
set npc position(8,13,207)
set npc direction(8,down)
wait(3)
palin(1)
play song(9)

wait(25)
set npc direction(5,left)
wait(4)
set npc direction(5,down)
wait(2)
set npc direction(5,right)
wait(4)
set npc direction(5,down)
wait(2)
jig npc(5)
wait(2)
walk npc(6,down,2)
wait for npc(6)
set npc frame(6,0)
set npc direction(6,right)
set npc direction(4,left)
jig npc(6)
wait(4)
walk npc(8,down,1)
wait for npc(8)
set npc direction(4,up)
walk npc(8,down,1)
wait for npc(8)
set npc direction(4,right)
walk npc(8,left,1)
wait for npc(8)
set npc frame(8,0)
jig npc(8)
wait(10)
jig npc(5)
wait(2)
#insert npc 5's weapon thing here
walk npc(5,down,1)
wait for npc(5)
wait(4)
set npc frame(5,0)
wait(2)
set npc frame(5,1)
walk npc(4,down,1)
set npc direction(4,up)
wait(2)
set npc direction(6,down)
set npc direction(8,down)
set npc frame(5,0)
wait for npc(4)
wait(4)
walk npc(6,down,1)
walk npc(8,down,1)
wait for npc(6)
walk npc(6,left,1)
wait for npc(8)
set npc direction(8,left)
set npc frame(8,0)
wait for npc(6)
walk npc(6,left,8)
wait(12)
set npc frame(8,1)
walk npc(4,left,1)
set npc direction(4,right)
wait(2)
set npc frame(8,0)
wait for npc(4)
walk npc(4,left,9)
walk npc(8,left,11)

wait(4)
walk npc(7,down,5)
wait(6)
walk npc(5,down,3)
wait(6)

palout(1)
camera follows hero(0)
wait(1)
teleport to map(currentmap--4,27,57)
stop song
pan camera(south,0,0)
wait(1)
set hero position(0,hx,hy)
set npc position(1,nx1,ny1)
if(hx==30) then(
set hero direction(0,left)
set npc direction(1,left))
if(hx==16) then(
set hero direction(0,right)
set npc direction(1,right))
set npc position(2,27,57)
set npc direction(2,up)
wait(4)
palin(1)

wait(2)
jig npc(2)
tb(1186)

if(hx==30) then(
focus camera(herox(0),heroy(0),2)
walk npc to y(2,heroy(0))
wait for npc(2)
walk npc(2,right,2)
wait for npc(2)
set npc frame(2,0)
)
if(hx==16) then(
focus camera(herox(0),heroy(0),2)
walk npc(2,down,1)
wait for npc(2)
walk npc(2,left,7)
wait for npc(2)
walk npc(2,up,1)
wait for npc(2)
walk npc(2,left,3)
wait for npc(2)
set npc frame(2,0)
)

wait for camera
alter npc(2,NPCstat:picture,169)
set npc direction(2,down)
jig npc(2)
play song(84)
tb(1187)
alter npc(1,NPCstat:picture,80)
jig npc(1)
tb(1188)
alter npc(2,NPCstat:picture,13)
if(hx==30) then(set npc direction(2,right))
if(hx==16) then(set npc direction(2,left))
jig npc(2)
tb(1189)
jig hero(0)
tb(1190)
jig npc(2)
tb(1191)
alter npc(2,NPCstat:picture,169)
set npc direction(2,down)
tb(1192)
jig npc(1)
tb(1193)
wait(6)
alter npc(2,NPCstat:picture,170)
set npc frame(2,1)
wait(4)
set npc frame(2,0)
wait(2)
alter npc(2,NPCstat:picture,13)
wait(2)
if(hx==30) then(set npc direction(2,right))
if(hx==16) then(set npc direction(2,left))
wait(6)
jig npc(2)
tb(1194)
jig npc(1)
tb(1195)

focus camera(23,58,2)

if(hx==30) then(
walk hero(0,left,4)
walk npc(1,left,4)
walk npc(2,left,4)
wait for npc(2)
walk npc to y(2,58)
wait for hero(0)
walk hero to y(0,58)
wait for npc(1)
walk npc to y(1,59)
set tag(78,1)
walk npc(9,down,1)
wait for npc(9)
set npc frame(9,0)
set npc direction(9,right)
jig npc(9)
show text box(1196)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
)
if(hx==16) then(
walk npc(2,right,3)
walk npc(1,right,3)
walk hero(0,right,3)
wait for hero(0)
walk npc(2,down,1)
walk npc(1,down,1)
walk hero(0,down,1)
wait for hero(0)
walk npc(2,right,1)
walk npc(1,right,1)
walk hero(0,right,1)
set tag(78,1)
walk npc(9,down,1)
wait for npc(9)
set npc frame(9,0)
set npc direction(9,left)
jig npc(9)
show text box(1196)
wait for hero(0)
set hero frame(0,0)
set npc frame(1,0)
set npc frame(2,0)
)

alter npc(1,NPCstat:picture,12)
wait for text box
wait for camera
if(hx==30) then(walk npc(2,left,1))
if(hx==16) then(walk npc(2,right,1))
wait for npc(2)
set npc frame(2,0)
tb(1197)
jig npc(9)
tb(1198)
wait(15)
jig npc(2)
tb(1199)
wait(4)
set npc direction(2,down)
wait(2)
if(hx==30) then(set npc direction(2,right))
if(hx==16) then(set npc direction(2,left))
jig npc(2)
tb(1200)

if(hx==30) then(
walk hero to x(0,34)
walk npc to x(1,34)
walk npc to x(2,33)
wait(6)
focus camera(34,58,2)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait for camera
wait(4)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
)
if(hx==16) then(
focus camera(34,58,2)
walk npc(1,right,1)
walk hero(0,down,1)
wait for npc(1)
wait for hero(0)
set npc direction(2,down)
walk npc(1,right,2)
walk hero(0,right,2)
wait for npc(1)
wait for hero(0)
walk npc(1,right,1)
walk hero(0,right,1)
walk npc(2,down,1)
wait for npc(1)
wait for hero(0)
wait for npc(2)
set npc direction(9,down)
walk npc(1,right,10)
walk hero(0,right,10)
walk npc(2,right,10)
wait(15)
set npc direction(9,right)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for hero(0)
wait for npc(2)
walk hero(0,up,1)
walk npc(2,right,1)
wait for hero(0)
wait for npc(2)
walk hero(0,right,1)
walk npc(2,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait for camera
)

jig npc(2)
tb(1201)
wait(2)
set npc direction(1,up)
jig npc(1)
set hero direction(0,down)
tb(1202)
end
###
###############################
script, somethingsneaky2, begin
set hero direction(0,left)
jig hero(0)
tb(1204)
focus camera(26,57,2)
walk npc(1,left,8)
wait(2)
set npc direction(2,down)
wait(2)
walk npc(2,left,8)
wait(2)
walk hero(0,left,8)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
wait for hero(0)
set hero frame(0,0)
jig npc(9)
tb(1205)
jig npc(1)
tb(1206)
wait for camera
stop song
battleflash
if(check tag(4)) then(ff(32,0,false))
if(check tag(5)) then(ff(33,0,false))
if(check tag(6)) then(ff(34,0,false))
if(check tag(3)) then(ff(593,0,false))
alter npc(9,NPCstat:picture,172)
set npc direction(9,up)
wait(6)
jig npc(2)
tb(1207)
walk npc(1,left,1)
walk hero(0,down,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for hero(0)
walk hero(0,left,3)
wait for hero(0)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
set hero picture(0,41)
wait(4)
set hero picture(0,40)
wait(10)
set hero picture(0,1)
jig hero(0)
tb(1208)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
tb(1209)

variable(nx)
variable(ny)
set variable(nx,npc pixel x(9))
set variable(ny,npc pixel y(9))
variable(i)
for(i,1,3,1) do(
put npc(9,nx+random(-1,1),ny+random(-1,1))
wait(1))

wait(6)

for(i,1,3,1) do(
put npc(9,nx+random(-1,1),ny+random(-1,1))
wait(1))

put npc(9,nx,ny)
tb(1210)
set npc direction(1,down)
wait(2)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)
tb(1211)
alter npc(1,NPCstat:picture,12)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
wait(2)
set npc frame(1,1)
walk npc(9,left,1)
set npc direction(9,up)
wait(2)
set npc frame(1,0)
wait for npc(9)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0)
wait(10)
set npc direction(2,down)
wait(2)
jig npc(2)
tb(1212)
wait(6)
set hero picture(0,65)
wait(12)
set hero picture(0,1)
walk hero(0,up,1)
wait for hero(0)
set npc direction(2,left)
walk hero(0,up,1)
wait for hero(0)
set hero position(0,0,0)
palout(1)
set hero picture(0,1)
set tag(82,1)
camera follows hero(0)
wait(1)
teleport to map(currentmap+4,7,212)
set hero direction(0,up)
wait(1)
set party in
palin(1)
wait(2)
end
###
###############################
script, somethingsneaky3, begin
set hero direction(0,down)
jig hero(0)
tb(1213)
jig npc(2)
set hero direction(0,left)
tb(1214)
alter npc(1,NPCstat:picture,82)
set npc direction(1,left)
set hero direction(0,down)
tb(1215)
alter npc(2,NPCstat:picture,169)
set npc direction(2,right)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
set hero direction(0,left)
tb(1216)
alter npc(1,NPCstat:picture,12)
set npc direction(1,up)
wait(1)
set npc frame(1,1)
walk hero(0,up,1)
set hero direction(0,down)
show text box(1217)
wait(1)
set npc frame(1,0)
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
wait for hero(0)
set hero frame(0,0)
wait for text box
alter npc(2,NPCstat:picture,171)
set npc frame(2,1)
set npc direction(2,right)
wait(6)
set npc frame(2,0)
tb(1218)
wait(2)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait(6)
set hero direction(0,left)
wait(4)
set npc direction(1,left)
wait(15)
tb(1219)
wait(6)
jig npc(1)
tb(1220)
wait(2)
set npc direction(2,down)
wait(1)
set npc direction(2,right)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
tb(1221)
tb(1222)
end
###
###############################
script, somethingsneaky4, begin
if(check tag(81)==false) then(
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
jig hero(0)
tb(1223)
alter npc(2,NPCstat:picture,13)
set npc direction(2,right)
jig npc(2)
tb(1224)
wait(10)
set hero picture(0,51)
wait(15)
tb(775)
jig npc(2)
tb(1225)
wait(2)
set hero picture(0,41)
tb(1226)
alter npc(2,NPCstat:picture,173)
jig npc(2)
tb(1227)
tb(1228)
stop song
alter npc(2,NPCstat:movespeed,2)
walk npc(2,up,6)
wait(4)
set npc direction(1,up)
wait(12)
set hero direction(0,up)
wait for npc(2)
set npc position(2,0,0)
jig npc(1)
tb(1229)
set hero picture(0,1)
wait(2)
set hero direction(0,left)
wait(2)
set hero direction(0,down)
jig hero(0)
tb(1230)
wait(2)
set npc direction(1,left)
wait(2)
alter npc(1,NPCstat:picture,74)
tb(1231)
jig hero(0)
tb(1232)
alter npc(1,NPCstat:picture,77)
tb(1233)
walk hero(0,left,1)
wait for hero(0)
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
jig hero(0)
tb(1234)
alter npc(1,NPCstat:picture,12)
jig npc(1)
tb(1235)
focus camera(herox(0),heroy(0),2)
walk npc(1,left,1)
wait for npc(1)
set npc position(1,0,0)
wait for camera
camera follows hero(0)
set party in
swap out hero(2)
lock hero(2)
if(check tag(6)) then(play song(73))
else(play song(29))
)

if(check tag(81)) then(
walk hero(0,down,1)
wait for hero(0)
set hero direction(0,left)
set hero frame(0,0)
jig hero(0)
show text box(1236)
wait(2)
alter npc(2,NPCstat:picture,13)
set npc frame(2,0)
wait for text box
tb(1237)
jig npc(2)
tb(1238)
alter npc(1,NPCstat:picture,79)
set npc direction(1,down)
wait(2)
show text box(1239)
wait(4)
set npc frame(1,1)
wait for text box
alter npc(1,NPCstat:picture,80)
set npc frame(1,0)
set npc direction(1,left)
wait(2)
set npc direction(1,up)
jig npc(1)
show text box(1240)
wait(2)
set hero direction(0,down)
set npc direction(2,down)
wait for text box
jig hero(0)
tb(1241)
jig npc(1)
tb(1242)
jig hero(0)
tb(1243)
show text box(1244)
set npc direction(1,left)
wait(2)
walk npc(1,down,1)
wait for npc(1)
set npc frame(1,0)
wait for text box
walk hero(0,down,1)
wait(2)
show text box(1245)
wait for hero(0)
set hero frame(0,0)
wait for text box
set npc direction(1,left)
wait(1)
set npc direction(1,up)
jig npc(1)
show text box(1246)
wait(2)
set hero picture(0,41)
wait for text box
stop song
tb(1247)
set npc direction(1,left)
wait(1)
walk npc(1,down,6)
wait(4)
wait for npc(1)
set npc position(1,0,0)
wait(10)
jig npc(2)
tb(1248)
wait(20)
set npc direction(2,right)
jig npc(2)
tb(1249)
set hero picture(0,38)
wait(2)
set hero picture(0,41)
wait(2)
set hero picture(0,38)
wait(2)
set hero picture(0,41)
wait(2)
tb(1250)
wait(4)
set hero picture(0,66)
tb(1251)
focus camera(herox(0),heroy(0),2)
walk npc(2,down,1)
wait for npc(2)
set hero picture(0,41)
walk npc(2,right,1)
wait for npc(2)
set hero picture(0,1)
set npc position(2,0,0)
wait for camera
camera follows hero
set party in
swap out hero(1)
lock hero(1)
if(check tag(6)) then(play song(73))
else(play song(29))
)
end
###

########################
script, loadadlez, begin

#if(check tag(120)) then(write pass block(95,57,0))

if(check tag(76),and,checktag(77)==false) then(
set npc position(5,118,65)
set npc position(6,119,66)
set npc position(7,121,66)
set npc position(8,122,65)
set npc direction(5,right)
set npc direction(6,up)
set npc direction(7,up)
set npc direction(8,left)
)

if(check tag(78),and,check tag(82)==false) then(
	set npc position(9,23,58)
	set npc direction(9,down)

	if(check tag(6)) then(
		set npc direction(9,up)
		alter npc(9,NPCstat:picture,172)
		alter npc(9,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
		alter npc(9,NPCstat:pushability,NPCpush:full)
		alter npc(9,NPCstat:display text,1729)

		if(herox(0)==23,and,heroy(0)==58) then(set npc position(9,22,58))

	)
)

if(check tag(313)==false,and,check tag(312)) then(
	set npc position(14,0,0)
	if(jayday <= day--2) then(set npc position(14,23,38))
)

if(check tag(331),and,check tag(5)) then(
alter npc(21,NPCstat:script,0)
alter npc(22,NPCstat:script,0)
alter npc(23,NPCstat:script,0)
alter npc(24,NPCstat:script,0)

if(check tag(328)==false,and,check tag(329)==false,and,check tag(330)==false) then(
alter npc(21,NPCstat:displaytext,5355)
alter npc(22,NPCstat:displaytext,5356)
alter npc(23,NPCstat:displaytext,5357)
alter npc(24,NPCstat:displaytext,5358)
)

if(check tag(328),and,check tag(329)==false,and,check tag(330)==false) then(
alter npc(21,NPCstat:displaytext,5355)
alter npc(22,NPCstat:displaytext,5369)
alter npc(23,NPCstat:displaytext,5357)
alter npc(24,NPCstat:displaytext,5358)
)

if(check tag(328),and,check tag(329),and,check tag(330)==false) then(
alter npc(21,NPCstat:displaytext,5355)
alter npc(22,NPCstat:displaytext,5383)
alter npc(23,NPCstat:displaytext,5357)
alter npc(24,NPCstat:displaytext,5358)
)

if(check tag(328),and,check tag(329),and,check tag(330)) then(
alter npc(21,NPCstat:displaytext,5397)
alter npc(22,NPCstat:displaytext,5398)
alter npc(23,NPCstat:displaytext,5399)
alter npc(24,NPCstat:displaytext,5400)
)

)

if(check tag(331),and,check tag(4),and,check tag(328),and,check tag(329),and,check tag(330)) then(
set npc position(21,73,90)
set npc position(22,74,90)
set npc position(23,72,89)
set npc position(24,75,89)
alter npc(21,NPCstat:displaytext,5397)
alter npc(22,NPCstat:displaytext,5398)
alter npc(23,NPCstat:displaytext,5399)
alter npc(24,NPCstat:displaytext,5400)
)

if(check tag(347)) then(set tag(336,1))

if(check tag(320),and,check tag(321)) then(set tag(322,1))

end
###

###########################
script, scene2point4, begin
suspend player
suspend npcs
suspend obstruction

scene2point4p1

#Have Mi'la, Not Johan
if(check tag(85),and,check tag(86)==false) then(scene2point4point1)

#Have Mi'la and Johan, or Johan only
if(check tag(86)) then(scene2point4point2)

if(check tag(85)==false) then(
unlock hero(1)
swap in hero(1)
)
if(check tag(86)==false) then(
unlock hero(2)
swap in hero(2)
)

set tag(121,1)
set hero speed(0,hspeed)
set tag(8,0)
save game
resume obstruction
resume npcs
resume player
resume box advance
end
###

#############################
script, scene2point4p1, begin
walk hero(0,up,1)
wait for hero(0)
pan camera(south,0,0)
set hero frame(0,0)
set party out
swap by position(find hero(0),0)
set hero speed(0,4)
if(check tag(85)) then(
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1))
if(check tag(86)) then(
set npc position(2,herox(0),heroy(0))
walk npc(2,left,1))
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)

wait(4)
set npc direction(5,left)
set npc direction(6,right)
set npc direction(7,down)
set npc direction(8,down)
wait(2)
set npc direction(5,down)
set npc direction(6,down)
wait(2)
battleflash
ff(124,0,false)
alter npc(5,NPCstat:Picture,175)
set npc direction(5,down)
alter npc(6,NPCstat:Picture,175)
set npc direction(6,right)
alter npc(7,NPCstat:Picture,175)
set npc direction(7,left)
alter npc(8,NPCstat:Picture,175)
set npc direction(8,up)
set npc position(5,41,131)
set npc position(6,40,130)
set npc position(7,43,128)
end
###

###############################
script,scene2point4point1,begin
wait(6)
set npc direction(1,left)
jig npc(1)
show text box(1252)
wait(2)
set hero direction(0,right)
wait for text box
jig hero(0)
tb(1253)
jig npc(4)
jig npc(4)
show text box(1254)
wait(2)
set hero direction(0,up)
set npc direction(1,up)
wait for text box
walk hero(0,up,2)
walk npc(1,up,3)
wait for hero(0)
walk hero(0,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
jig hero(0)
jig hero(0)
jig hero(0)
alter npc(4,NPCstat:picture,163)
wait(6)
jig npc(4)
tb(1255)
jig hero(0)
tb(1256)
jig npc(4)
tb(1257)
jig hero(0)
tb(1258)
set npc direction(4,left)
jig npc(4)
tb(1259)
wait(6)
set npc direction(4,down)
tb(1260)
tb(1261)
jig npc(1)
tb(1262)
set npc direction(4,right)
jig npc(4)
tb(1263)
jig hero(0)
tb(1264)
set npc direction(4,down)
jig npc(4)
tb(1265)
walk npc(1,left,1)
wait(3)
show text box(1266)
wait for npc(1)
set npc frame(1,0)
wait for text box
set npc direction(4,right)
wait(4)
jig npc(4)
tb(1267)
set npc direction(1,up)
set npc frame(1,0)
set hero direction(0,right)
wait(15)
set npc direction(1,left)
wait(2)
walk npc(1,down,2)
wait for npc(1)
set npc direction(4,down)
set hero direction(0,down)
walk npc(1,left,1)
wait for npc(1)
set npc frame(1,0)
wait(15)
set npc direction(1,up)
jig npc(1)
tb(1268)
jig hero(0)
tb(1269)

palout(1)
camera follows hero(0)
wait(1)
teleport to map(18+poff,3,208)
sethp
pan camera(south,0,0)
set hero position(0,7,204)
set npc position(1,7,204)
set npc position(4,7,204)
set npc position(2,3,209)
set npc position(3,2,209)
set npc frame(3,1)
set npc direction(3,down)
set npc direction(2,up)
wait(1)
palin(1)

wait(12)
walk npc(4,down,2)
walk hero(0,down,1)
wait for npc(4)
walk npc(4,left,4)
wait for hero(0)
walk hero(0,down,1)
walk npc(1,down,1)
wait for hero(0)
walk hero(0,left,3)
wait for npc(1)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,left,2)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,down)
wait(5)
jig npc(4)
show text box(1270)
wait for npc(1)
set hero direction(0,down)
wait for text box
jig npc(2)
tb(1271)
walk npc(4,left,2)
walk hero(0,left,2)
walk npc(1,left,2)
wait for npc(4)
walk npc(4,down,2)
wait for hero(0)
set hero direction(0,down)
set hero frame(0,0)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(4)
set npc direction(2,left)
walk npc(4,right,2)
wait for npc(4)
set npc direction(4,down)
set npc frame(4,0)
set npc direction(2,up)
jig npc(4)
tb(1272)
jig npc(2)
tb(1273)
tb(1274)
wait(2)
set npc frame(3,0)
wait(2)
set npc frame(3,1)
wait(2)
show text box(1275)
set npc frame(3,0)
wait(2)
set npc frame(3,1)
wait for text box
jig npc(1)
tb(1276)
wait(2)
set npc frame(3,0)
tb(1277)
walk npc(2,down,1)
wait for npc(2)
walk npc(2,left,1)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)
wait(12)
jig npc(2)
tb(1278)
jig npc(2)
jig npc(2)
jig npc(2)
jig npc(2)
jig npc(2)
wait(12)
jig npc(2)
tb(1279)
write spell(find hero(2),0,11,576+1)
wait(3)
tb(1351)
jig gahn
tb(1352)
wait(5)
jig hero(0)
tb(1280)
walk npc(2,left,1)
wait for npc(2)
set npc direction(4,left)
walk npc(2,up,1)
wait for npc(2)
set npc frame(2,0)
jig npc(2)
tb(1281)
jig hero(0)
tb(1282)
walk npc(2,up,3)
wait for npc(2)
set hero direction(0,left)
set npc direction(1,left)
set npc frame(2,0)
set npc direction(2,right)
jig npc(2)
tb(1283)
set hero direction(0,down)
wait(2)
walk hero(0,right,5)
walk npc(2,right,6)
walk npc(4,left,2)
set npc direction(1,down)
wait for npc(4)
set npc direction(1,right)
walk npc(4,up,2)
wait for npc(4)
walk npc(4,right,1)
wait for hero(0)
walk hero(0,up,2)
wait for npc(2)
walk npc(2,up,2)
wait for npc(4)
set npc frame(4,0)
alter npc(1,NPCstat:picture,74)
tb(1284)
jig npc(4)
show text box(1285)
wait(2)
alter npc(1,NPCstat:picture,12)
walk npc(1,right,4)
wait for npc(1)
walk npc(1,up,2)
wait for text box
wait for npc(1)
jig npc(4)
tb(1286)

palout(1)
camera follows hero(0)
wait(1)
teleport to map(22,43,135)
pan camera(up,2,20)
wait for camera
set pal(noon)
set party in
wait(1)
unlock hero(2)
swap in hero(2)
set tag(83,1)
wait(1)
palin(1)
wait(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0)
end
###

###############################
script,scene2point4point2,begin

s2p4p2p1

#Have both Mi'la and Johan
if(check tag(85)) then(s2p4p2p2)

#Have Johan only
if(check tag(85)==false) then(s2p4p2p3)

end
###
#######################
script, s2p4p2p1, begin
wait(10)
walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
jig hero(0)
jig hero(0)
jig hero(0)
jig hero(0)
alter npc(4,NPCstat:picture,163)
wait(5)
jig hero(0)
tb(1287)
jig npc(4)
walk npc(4,right,1)
wait for npc(4)
set hero direction(0,right)
walk npc(4,down,3)
wait(2)
show text box(1288)
wait(4)
set hero direction(0,down)
set npc direction(2,right)
wait for npc(4)
set npc direction(4,left)
set npc frame(4,0)
set npc direction(1,left)
wait for text box
jig npc(2)
tb(1289)
jig npc(4)
tb(1290)
alter npc(2,NPCstat:picture,173)
jig npc(2)
tb(1291)
jig npc(4)
tb(1292)
jig npc(2)
tb(1293)
jig npc(4)
tb(1294)
jig npc(2)
tb(1295)
jig npc(4)
tb(1296)
jig npc(2)
tb(1297)
wait(2)
set npc frame(4,1)
wait(2)
set npc frame(4,0)
show text box(1298)
wait(2)
set npc frame(4,1)
walk npc(2,left,1)
set npc direction(2,right)
wait(2)
set npc frame(4,0)
wait(2)
wait for npc(2)
set npc frame(2,0)
wait for text box
walk hero(0,down,1)
show text box(1299)
wait for hero(0)
set hero frame(0,0)
wait for text box
set npc direction(4,up)
jig npc(4)
tb(1300)
tb(1301)
jig hero(0)
tb(1302)
jig npc(4)
tb(1303)
jig hero(0)
tb(1304)
jig npc(4)
tb(1305)
alter npc(2,NPCstat:picture,13)
set npc direction(2,up)
wait(15)
walk npc(2,right,1)
wait for npc(2)
walk hero(0,up,1)
walk npc(2,up,1)
wait for hero(0)
set hero direction(0,down)
set hero frame(0,0)
wait for npc(2)
walk npc(2,right,1)
set hero direction(0,right)
wait for npc(2)
set npc direction(4,up)
walk npc(2,up,2)
wait(2)
set npc direction(1,up)
set hero direction(0,up)
wait for npc(2)
set npc frame(2,0)
wait(15)
set npc direction(2,left)
wait(2)
set npc direction(2,down)
jig npc(2)
tb(1306)
jig npc(4)
tb(1307)
jig npc(2)
tb(1308)
jig npc(4)
tb(1309)
wait(2)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
end
###
#######################
script, s2p4p2p2, begin
wait(2)
jig hero(0)
tb(1310)
jig npc(1)
tb(1311)
walk npc(4,left,1)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,down,3)
wait for npc(4)
set npc frame(4,0)
wait(2)
set npc direction(4,up)
wait for npc(1)
jig npc(4)
tb(1312)
wait(4)
set hero picture(0,41)
wait(6)
set hero picture(0,38)
wait(8)
tb(1313)
jig npc(4)
tb(1314)
set hero picture(0,41)
wait(2)
tb(1315)
wait(20)
walk npc(1,up,3)
wait for npc(1)
set npc direction(4,right)
jig npc(1)
tb(1316)
set hero picture(0,1)
jig hero(0)
set npc direction(4,up)
tb(1317)
set hero direction(0,right)
wait(2)
walk npc(1,up,2)
wait for npc(1)
set npc direction(2,left)
walk hero(0,up,2)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,up,1)
jig npc(4)
show text box(1318)
wait for npc(1)
set npc frame(1,0)
wait for hero(0)
set hero frame(0,0)
wait for text box
wait(2)
set hero direction(0,right)
set npc direction(2,down)
set npc direction(1,down)
wait(2)
set hero direction(0,down)
wait(4)
jig npc(1)
tb(1319)
jig npc(4)
tb(1320)
jig npc(2)
tb(1321)
wait(4)
jig npc(4)
tb(1322)
jig npc(2)
tb(1323)
set npc direction(1,right)
jig npc(1)
tb(1324)
wait(2)
focus camera(42,122,2)
walk hero(0,up,6)
walk npc(1,up,7)
walk npc(2,left,1)
wait for npc(2)
walk npc(2,up,7)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for camera
set tag(83,1)
camera follows hero(0)
end
###
#######################
script, s2p4p2p3, begin
wait(2)
jig hero(0)
tb(1310)
wait(3)

palout(3)
camera follows hero(0)
wait(1)
teleport to map(18+poff,7,204)
sethp
pan camera(south,0,0)
set hero position(0,7,204)
set npc position(2,7,204)
set npc position(4,7,204)
set npc position(1,3,210)
alter npc(1,NPCstat:picture,82)
set npc position(3,2,210)
set npc frame(3,1)
set npc direction(3,down)
set npc direction(1,up)
wait(1)
palin(3)

wait(12)
focus camera(3,209,2)
walk npc(4,down,1)
wait for npc(4)

walk npc(4,down,1)
walk hero(0,down,1)

wait for npc(4)
walk npc(4,left,6)
wait for hero(0)
walk hero(0,down,1)
walk npc(2,down,1)

wait for hero(0)
walk hero(0,left,6)
wait for npc(2)
walk npc(2,down,1)

wait for npc(2)
walk npc(2,left,5)

wait for npc(4)
walk npc(4,down,2)
wait for npc(4)
walk npc(4,right,3)

wait for hero(0)
walk hero(0,down,1)
wait for npc(2)
walk npc(2,left,1)
wait for hero(0)
walk hero(0,down,1)
wait for npc(1)
walk npc(2,down,2)
wait for hero(0)
walk hero(0,right,2)
wait for hero(0)
set hero frame(0,0)
set npc frame(2,0)
set npc frame(4,0)
set npc direction(4,down)
set hero direction(0,down)
wait for camera
wait(2)
set npc direction(1,left)
tb(1325)
jig hero(0)
tb(1326)
alter npc(1,NPCstat:picture,12)
set npc direction(1,left)
wait(2)
set npc direction(1,up)
show text box(1327)
jig npc(1)
wait for text box
alter npc(2,NPCstat:picture,169)
set npc direction(2,right)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
show text box(1328)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait for text box
set npc direction(4,left)
jig npc(4)
tb(1329)
show text box(1330)
set npc direction(1,left)
wait for text box
alter npc(2,NPCstat:picture,13)
set npc direction(2,down)
wait(1)
set npc direction(2,left)
wait(1)
set npc direction(2,up)
wait(1)
set npc direction(2,right)
wait(1)
show text box(1331)
set npc direction(2,down)
wait(1)
set npc direction(2,left)
wait(1)
set npc direction(2,up)
wait(1)
set npc direction(2,right)
wait(1)
set npc direction(2,down)
wait(1)
set npc direction(2,left)
wait(1)
set npc direction(2,up)
wait(1)
set npc direction(2,right)
wait(1)
alter npc(2,NPCstat:picture,169)
set npc direction(2,right)
wait for text box
walk npc(1,up,1)
wait for npc(1)
walk npc(1,left,2)
set hero direction(0,left)
set npc direction(4,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
alter npc(1,NPCstat:move speed,10)
wait(2)
tweak palette(63,63,63)
walk npc(1,up,1)
wait for npc(1)
update palette
walk npc(1,down,1)
wait for npc(1)
set npc direction(1,up)
reset palette
update palette
show text box(1332)
walk npc(2,up,1)
set npc direction(2,down)
wait for npc(2)
wait for text box
jig npc(4)
tb(1333)
alter npc(2,NPCstat:picture,13)
walk npc(2,down,1)
wait for npc(2)
alter npc(1,NPCstat:move speed,4)
wait for npc(2)
walk npc(2,right,1)
set npc direction(1,right)
jig npc(1)
show text box(1334)
wait for npc(2)
walk npc(2,down,1)
wait for npc(2)
set npc frame(2,0)
wait for text box
walk npc(4,down,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,left)
jig npc(4)
tb(1335)
jig npc(1)
tb(1336)
jig npc(4)
tb(1337)
show text box(1338)
jig npc(1)
wait for text box
alter npc(2,NPCstat:picture,169)
set npc direction(2,right)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
show text box(1339)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait for text box
walk npc(4,left,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(1340)
wait(4)
alter npc(2,NPCstat:picture,13)
set npc direction(2,down)
wait(12)
set hero direction(0,down)
jig hero(0)
tb(1341)
jig npc(2)
tb(1342)
set npc direction(2,left)
wait(2)
set npc direction(2,up)
jig npc(2)
jig npc(2)
jig npc(2)
wait(6)
jig npc(2)
tb(1279)
write spell(find hero(2),0,11,576+1)
wait(3)
tb(1351)
jig gahn
tb(1352)
wait(5)
jig hero(0)
tb(1343)
walk hero(0,left,1)
wait(2)
set npc direction(2,left)
wait for hero(0)
walk hero(0,left,1)
walk npc(2,up,1)
wait for hero(0)
set npc direction(1,up)
walk hero(0,up,1)
wait for npc(2)
walk npc(2,left,1)
wait for hero(0)
walk hero(0,up,1)
wait for npc(2)
walk npc(2,up,1)
wait for hero(0)
set npc direction(4,up)
set hero frame(0,0)
wait for npc(2)
set npc frame(2,0)
wait(2)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
set npc direction(2,right)
wait(2)
set npc direction(2,down)
jig hero(0)
tb(1344)
jig npc(1)
tb(1345)
set npc direction(1,right)
jig npc(1)
set npc direction(4,left)
tb(1346)
walk hero(0,right,6)
walk npc(2,up,1)
walk npc(1,up,1)
wait for npc(2)
set npc direction(4,up)
show text box(1347)
walk npc(2,right,6)
wait for npc(1)
walk npc(1,up,2)
wait for npc(1)
walk npc(1,right,6)
wait for hero(0)
walk hero(0,up,2)
wait for npc(2)
walk npc(2,up,2)
wait for npc(1)
walk npc(1,up,2)
wait for hero(0)
wait for text box
wait(10)
walk npc(4,down,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,left)
jig npc(4)
tb(1286)

palout(1)
camera follows hero(0)
wait(1)
teleport to map(22,43,135)

pan camera(up,2,20)
set pal(noon)
set tag(83,1)
wait(1)
palin(1)
walk hero(0,up,2)
wait for hero(0)
camera follows hero
end
###

#########################
script, loadquarry, begin

#dangle 1st encounter
if(check tag(88)==false) then(
set npc position(3,43,56)
alter npc(3,NPCstat:display text,1365)
)

#dangle 2nd encounter
if(check tag(88)==true,and,check tag(89)==false) then(
set npc position(3,176,106)
alter npc(3,NPCstat:display text,1378)
alter npc(3,NPCstat:palette,107)
)

#dangle 3rd encounter
if(check tag(89)==true,and,check tag(90)==false) then(
set npc position(3,142,39)
alter npc(3,NPCstat:palette,107)
)

#dangle final encounter
if(check tag(90)==true,and,check tag(91)==false) then(
set npc position(3,142,39)
set npc position(npc at spot(141,45),141,39)
set npc position(npc at spot(142,45),140,39)
set npc position(npc at spot(143,45),143,39)
alter npc(3,NPCstat:display text,1733)
)

#afterward
if(check tag(91)) then(
alter npc(3,NPCstat:display text,none)
set npc position(npc at spot(156,42),1,0)
set npc position(npc at spot(156,42),1,0)
set npc position(npc at spot(162,42),1,0)
set npc position(npc at spot(163,42),1,0)
set npc position(npc at spot(168,42),1,0)
)

end
###

######################
script, dangle1, begin
suspend player
suspend npcs
suspend obstruction


focus camera(43,58,2)
walk hero(0,up,4)
wait for hero(0)
walk hero to x(0,43)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)

wait for camera
stop song
wait(4)
jig npc(3)
tb(1354)

alter npc(1,NPCstat:palette,30)
alter npc(2,NPCstat:palette,34)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
jig npc(2)
play song(96)
tb(1355)
set npc direction(3,left)
jig npc(3)
tb(1356)
wait(10)
set npc direction(3,down)
wait(12)
jig npc(3)
tb(1357)
jig npc(1)
tb(1358)
wait(2)
set npc direction(2,right)
wait(2)
jig npc(2)
tb(1359)
jig npc(3)
show text box(1360)
wait(2)
set npc direction(2,up)
wait for text box
tb(1361)
wait(4)
jig npc(2)
tb(1362)
walk npc(1,up,1)
wait for npc(1)
alter npc(3,NPCstat:picture,176)
walk npc(1,left,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
jig npc(1)
tb(1363)
wait(12)
set hero picture(0,41)
wait(6)
set hero picture(0,40)
wait(4)
set hero picture(0,41)
wait(6)
walk npc(1,down,1)
walk npc(2,right,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
set hero picture(0,1)
wait(2)
set npc direction(3,right)
wait(8)
set npc direction(3,left)
wait(2)
set npc direction(3,up)
stop song
tb(1364)
set npc direction(3,right)
wait(2)
alter npc(3,NPCstat:picture,156)
set npc direction(3,down)

alter npc(3,NPCstat:display text,1365)
set party in
camera follows hero(0)

play song(9)

set tag(88,1)
set tag(8,0)
resume obstruction
resume npcs
resume player
resume box advance
end
###

######################
script, dangle2, begin
suspend player
suspend npcs
suspend obstruction

focus camera(176,108,2)
walk hero(0,up,4)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)
if(npc direction(3)==up) then(set npc direction(3,left))
wait(2)
if(npc direction(3)==left,or,npc direction(3)==right) then(set npc direction(3,down))
wait for camera

stop song
wait(4)
jig npc(3)
tb(1366)

alter npc(1,NPCstat:palette,31)
alter npc(2,NPCstat:palette,35)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)

jig npc(1)
play song(96)
tb(1367)
wait(4)
jig npc(3)
tb(1368)
jig npc(2)
tb(1369)
alter npc(3,NPCstat:picture,176)
set npc direction(3,right)
wait(8)
tb(1370)
wait(6)
jig npc(1)
tb(1371)
alter npc(3,NPCstat:picture,156)
set npc direction(3,down)
jig npc(3)
tb(1372)
tb(1373)
set npc direction(2,right)
jig npc(2)
tb(1374)
jig npc(3)
show text box(1375)
wait(3)
set npc direction(2,up)
wait for text box
wait(4)
jig hero(0)
tb(1376)
walk npc(1,left,1)
walk npc(2,right,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
stop song
wait(6)
jig npc(3)
tb(1377)

alter npc(3,NPCstat:display text,1378)
set party in
camera follows hero(0)

play song(9)

set tag(89,1)
set tag(8,0)
save game
resume obstruction
resume npcs
resume player
resume box advance
end
###

######################
script, dangle3, begin
suspend player
suspend npcs
suspend obstruction

if((herox(0)==141,or,herox(0)==142,or,herox(0)==143),and,heroy(0)==45) then(
	dangle3sub1
)

if((herox(0)==141,or,herox(0)==143),and,heroy(0)==39) then(

set npc position(npc at spot(141,39),141,38)
set npc position(npc at spot(140,39),142,38)
set npc position(npc at spot(143,39),143,38)

if(herox(0)==141) then(set npc direction(3,left))
if(herox(0)==143) then(set npc direction(3,right))
jig npc(3)
tb(1391)

)
if((herox(0)==141,or,herox(0)==142,or,herox(0)==143),and,heroy(0)==38) then(

set npc position(npc at spot(141,38),141,37)
set npc position(npc at spot(142,38),142,37)
set npc position(npc at spot(143,38),143,37)

set npc direction(3,up)
jig npc(3)
tb(1392)

)
if((herox(0)==141,or,herox(0)==142,or,herox(0)==143),and,heroy(0)==37) then(
	dangle4
)
resume obstruction
resume npcs
resume player
resume box advance
end
###

##########################
script, dangle3sub1, begin
set npc position(npc at spot(141,45),141,39)
set npc position(npc at spot(142,45),140,39)
set npc position(npc at spot(143,45),143,39)

set npc direction(3,down)

focus camera(npcx(3),npcy(3),2)
walk hero(0,up,4)
wait for hero(0)
walk hero to x(0,142)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)
alter npc(1,NPCstat:palette,31)
alter npc(2,NPCstat:palette,35)
wait for camera
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)

jig npc(2)
stop song
tb(1379)
jig npc(3)
play song(96)
tb(1380)
jig npc(1)
tb(1381)
wait(8)
jig npc(3)
tb(1382)
jig npc(1)
tb(1383)
wait(4)
jig npc(3)
tb(1384)
jig npc(2)
tb(1385)
tb(1386)
alter npc(3,NPCstat:picture,176)
set npc direction(3,down)
wait(4)
set npc direction(3,right)
wait(3)
set npc direction(3,left)
wait(6)
set npc direction(3,up)
tb(1387)
wait(4)
jig npc(1)
tb(1388)
wait(15)
set npc direction(3,left)
wait(3)
set npc direction(3,right)
wait(2)
set npc direction(3,down)
wait(2)
alter npc(3,NPCstat:picture,156)
wait(8)
jig npc(3)
stop song
tb(1389)
tb(1390)

play song(59)

focus camera(herox(0),heroy(0),2)
walk npc(1,left,1)
walk npc(2,right,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for camera
alter npc(3,NPCstat:display text,1733)
set party in
camera follows hero(0)
set tag(90,1)
end
###

#############################
script, dangle4, begin
suspend player

dangle4sub1
dangle4sub2
dangle4sub3

resume player
end
###

##########################
script, dangle4sub1, begin
set npc position(npc at spot(141,37),0,0)
set npc position(npc at spot(142,37),0,0)
set npc position(npc at spot(143,37),0,0)

focus camera(npcx(3),npcy(3),2)

set npc direction(3,left)
wait(2)
alter npc(3,NPCstat:picture,176)
set npc direction(3,left)
wait(4)
set npc direction(3,up)
stop song
tb(1393)

walk hero to x(0,142)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait(2)
alter npc(1,NPCstat:palette,31)
alter npc(2,NPCstat:palette,35)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)

wait for camera
wait(4)
jig hero(0)
tb(1394)
play song(87)
wait(12)
tb(1395)
jig npc(1)
tb(1396)
set npc direction(2,right)
jig npc(2)
tb(1397)
set npc direction(3,left)
wait(2)
set npc direction(3,right)
wait(2)
set npc direction(3,down)
wait(2)
alter npc(3,NPCstat:picture,156)
set npc direction(3,left)
wait(2)
set npc direction(3,up)
wait(7)
jig npc(3)
show text box(1398)
wait(2)
set npc direction(2,down)
wait for text box
jig hero(0)
tb(1399)
jig npc(3)
tb(1400)
jig npc(3)
tb(1401)
wait(4)
alter npc(3,NPCstat:picture,174)
set npc direction(3,up)
wait(15)
set npc frame(3,1)
wait(5)
tb(1402)
wait(4)
walk npc(1,down,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
tb(1403)
wait(8)
put npc(3,npc pixel x(3)+1,npc pixel y(3))
wait(3)
put npc(3,npc pixel x(3)--1,npc pixel y(3))
tb(1404)
tb(1405)
wait(2)
set npc direction(1,up)
wait(2)
show text box(1406)
walk npc(1,up,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait(2)
set npc direction(1,down)
wait for text box
set npc direction(2,right)
jig npc(2)
tb(1407)
set npc direction(1,left)
jig npc(1)
tb(1408)
wait(4)
set hero direction(0,right)
wait(2)
walk hero(0,up,6)
walk npc(1,up,6)
wait(6)
set npc direction(2,down)
jig npc(2)
tb(1409)
tb(1410)
wait(12)
set npc frame(3,0)
wait(2)
tb(1411)
walk npc(2,down,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
jig npc(2)
tb(1412)
alter npc(3,NPCstat:picture,156)
wait(2)
set npc direction(3,left)
wait(2)
jig npc(3)
tb(1413)
jig npc(2)
show text box(1414)
wait(3)
set npc direction(3,up)
alter npc(3,NPCstat:picture,174)
wait(4)
alter npc(2,NPCstat:picture,170)
wait for text box
wait(8)
alter npc(2,NPCstat:picture,177)
wait(15)
tb(1415)
alter npc(2,NPCstat:picture,170)
tb(1416)
tb(1417)
alter npc(2,NPCstat:picture,13)
jig npc(2)
tb(1418)
wait(16)
jig npc(2)
stop song
tb(1419)
wait(5)
set npc frame(3,1)
tb(1420)
wait(15)
set npc frame(3,0)
wait(3)
alter npc(3,NPCstat:picture,156)
jig npc(3)
tb(1421)
wait(20)
jig npc(3)
tb(1422)
jig npc(2)
tb(1423)
end
###

##########################
script, dangle4sub2, begin
focus camera(142,30,2)

wait for hero(0)
wait for npc(1)
set hero frame(0,0)
set npc frame(1,0)
set hero position(0,141,30)
set npc position(1,143,30)
set hero direction(0,up)
set npc direction(1,left)

set npc direction(2,left)
wait(2)
walk npc(2,up,6)
wait for npc(2)
set npc frame(2,0)
wait for camera

set npc direction(1,down)
wait(6)
jig npc(1)
play song(82)
tb(1424)
jig npc(2)
tb(1425)
jig npc(1)
tb(1426)
jig npc(2)
tb(1427)
jig npc(1)
tb(1428)
jig npc(2)
tb(1429)
wait(2)
alter npc(1,NPCstat:picture,83)
tb(1430)
jig npc(2)
tb(1431)
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait(2)
show text box(1432)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait for text box
set hero direction(0,right)
show text box(1433)
jig hero(0)
wait for text box
wait(2)
set hero direction(0,up)
wait(2)
alter npc(1,NPCstat:picture,12)
wait(2)
set npc direction(1,left)
wait(12)
jig hero(0)
tb(1434)
set hero direction(0,right)
tb(1435)

walk hero(0,right,1)
wait for hero(0)
walk hero(0,up,2)
walk npc(1,left,1)
walk npc(2,up,1)
wait for npc(1)
walk npc(1,up,2)
wait for npc(2)
walk npc(2,up,3)
wait for npc(2)
wait(10)

palout(5)
stop song
camera follows hero(0)
teleport to map(95,43,20)
wait(20)
alter npc(1,NPCstat:palette,45+poff)
alter npc(2,NPCstat:palette,109+poff)
alter npc(3,NPCstat:palette,65+poff)
alter npc(4,NPCstat:palette,61+poff)
alter npc(5,NPCstat:palette,129+poff)
alter npc(6,NPCstat:palette,57+poff)
alter npc(7,NPCstat:palette,149+poff)
alter npc(8,NPCstat:palette,49+poff)
alter npc(9,NPCstat:palette,233+poff)
if(check tag(5)) then(load tileset(28))
if(check tag(6)) then(load tileset(29))
if(check tag(3)) then(load tileset(30))

set npc frame(2,1)
pan camera(south,0,0)
set hero position(0,0,0)
play song(59)
wait(1)
pan camera(up,12,4)
walk npc(1,up,8)
palin(10)

wait for npc(1)
set npc direction(1,right)
set npc frame(1,0)
wait for camera
wait(10)
set npc frame(2,0)
wait(5)
jig npc(1)
tb(1436)
wait(5)
alter npc(2,NPCstat:picture,110)
wait(2)
set npc direction(2,left)
jig npc(2)
tb(1437)
jig npc(1)
tb(1438)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
tb(1439)
tb(1440)
wait(5)
jig npc(2)
tb(1441)
wait(2)
jig npc(1)
tb(1442)
jig npc(2)
tb(1443)
wait(12)
jig npc(1)
tb(1444)
jig npc(2)
tb(1445)
jig npc(1)
tb(1446)
tb(1447)
wait(6)
jig npc(1)
tb(1448)
wait(2)
set npc direction(1,up)
wait(3)
walk npc(1,up,1)
wait for npc(1)
set npc direction(2,up)
set npc frame(1,0)
wait(6)
jig npc(1)
tb(1449)
wait(10)
end
###

##########################
script, dangle4sub3, begin
variable(i)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(3))
set variable(ny,npc pixel y(3))
for(i,1,4,1) do(
put npc(3,random(nx--1,nx+1),random(ny--1,ny+1))
wait(1)
)
wait(10)
for(i,1,4,1) do(
put npc(3,random(nx--1,nx+1),random(ny--1,ny+1))
wait(1)
)
put npc(3,nx,ny)
set npc frame(3,1)
wait(5)
alter npc(3,NPCstat:picture,138)
set npc frame(3,0)
wait(8)
jig npc(1)
tb(1450)
wait(5)
walk npc(3,left,2)
wait(2)
set npc direction(1,left)
wait(2)
set npc direction(2,left)
wait for npc(3)
walk npc(3,down,2)
wait for npc(3)
walk npc(3,left,7)
wait(10)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
jig npc(1)
tb(1451)
wait(2)
set npc direction(2,down)
wait(2)
walk npc(2,right,2)
wait for npc(2)
set npc frame(2,0)
tb(1452)
alter npc(1,NPCstat:movespeed,5)
walk npc(1,right,4)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
jig npc(1)
tb(1453)
wait(2)
set npc direction(2,up)
wait(20)
jig npc(2)
tb(1454)
jig npc(1)
tb(1455)
set npc direction(1,right)
wait(8)
jig npc(1)
tb(1456)
alter npc(1,NPCstat:movespeed,2)
walk npc(1,right,6)
walk npc(2,right,6)
wait(7)
wait for npc(3)
set npc direction(3,right)
set npc frame(3,0)
pan camera(left,9,4)
wait for camera
pan camera(left,20,4)
set npc direction(3,down)
wait(2)
walk npc(3,left,20)
wait for camera
pan camera(left,6,4)

palout(3)
wait for camera
camera follows hero(0)
suspend player
set tag(8,1)
teleport to map(23,9,54)
suspend player
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,9,60)
wait(3)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (3)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (3)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (3)
reset palette
tweak palette (-7,-7,-7)
update palette

walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)

wait(3)
jadeup(2,1)
reset palette
tweak palette (-7,-7,-7)
update palette
wait(3)

set tag(91,1)
set tag(8,0)
save game

play song(66)
end
###

##############################
script, gitlehtombintro, begin
suspend player
suspend npcs
suspend obstruction

gitlehtombintro1
gitlehtombintro2
gitlehtombintro3

resume box advance
resume obstruction
resume npcs
end
###
###############################
script, gitlehtombintro1, begin
stop song

set npc position(4,27,4)
set npc position(5,28,4)
set npc position(6,26,4)


pan camera (up,6,10)
wait for camera
wait for hero (0)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)

set tag(92,1)
alter npc(1,NPCstat:palette,29)
alter npc(2,NPCstat:palette,33)
setpartyout

jig npc(4)
play song(61)
tb(1491)

swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)
jig hero(0)
tb(1492)
jig npc(4)
tb(1493)
jig npc(2)
tb(1494)
variable(nx4)
variable(ny4)
wait(2)
set variable(nx4,npc pixel x(4))
set variable(ny4,npc pixel y(4))
put npc(4,nx4,ny4--1)
wait(2)
put npc(4,nx4,ny4)
wait(2)
show text box(1495)
put npc(4,nx4,ny4--1)
wait(2)
put npc(4,nx4,ny4)
wait(2)
wait for text box
tb(1496)
tb(1497)
wait(7)
jig npc(4)
tb(1498)
jig npc(2)
tb(1499)
jig npc(4)
tb(1500)
tb(1501)
jig hero(0)
tb(1502)
jig npc(4)
tb(1503)
stop song
wait(4)
set npc direction(4,right)
wait(4)
jig npc(4)
tb(1504)
set npc direction(5,left)
jig npc(5)
tb(1505)
jig npc(4)
tb(1506)
set npc direction(5,down)
jig npc(5)
tb(1507)
end
###
###############################
script, gitlehtombintro2, begin
variable(nx5)
variable(ny5)
set variable(nx5,npc pixel x(5))
set variable(ny5,npc pixel y(5))
variable(shadow)
set variable(shadow,create npc(3,npcx(5),npcy(5)))
alter npc(3,NPCstat:picture,71)

put npc(5,nx5,ny5--5)
put npc(shadow,nx5,ny5+5)
wait(2)
put npc(5,nx5,ny5--7)
put npc(shadow,nx5,ny5+10)
wait(2)
put npc(5,nx5,ny5--8)
put npc(shadow,nx5,ny5+15)
wait(2)
put npc(5,nx5,ny5--7)
put npc(shadow,nx5,ny5+20)
wait(2)
put npc(5,nx5,ny5--5)
put npc(shadow,nx5,ny5+25)
wait(2)
put npc(5,nx5,ny5)
put npc(shadow,nx5,ny5+30)
wait(1)
put npc(5,nx5,ny5+10)
put npc(shadow,nx5,ny5+35)
set npc direction(4,down)
wait(1)
put npc(5,nx5,ny5+20)
put npc(shadow,nx5,ny5+40)
wait(1)
put npc(5,nx5,ny5+30)
put npc(shadow,nx5,ny5+45)
wait(1)
put npc(5,nx5,ny5+40)
put npc(shadow,nx5,ny5+50)
wait(1)
put npc(5,nx5,ny5+50)
put npc(shadow,nx5,ny5+55)
wait(1)
put npc(5,nx5,ny5+60)
put npc(shadow,nx5,ny5+60)
wait(1)
set npc position(shadow,83,8)

stop song
battleflash
set party in
ff(148)
stop song
set party out
swap by position(find hero(0),0)
gitlehautoload(1)

reset palette
tweak palette (-2,-2,-2)
tweak palette (0,6,0)
update palette


set npc direction(5,up)
set npc position(shadow,npcx(5),npcy(5))
put npc(5,nx5,ny5+60)
put npc(shadow,nx5,ny5+60)
wait(1)
put npc(5,nx5,ny5+50)
put npc(shadow,nx5,ny5+55)
wait(1)
put npc(5,nx5,ny5+40)
put npc(shadow,nx5,ny5+50)
wait(1)
put npc(5,nx5,ny5+30)
put npc(shadow,nx5,ny5+45)
wait(1)
put npc(5,nx5,ny5+20)
put npc(shadow,nx5,ny5+40)
show text box(1508)
wait(1)
put npc(5,nx5,ny5+10)
put npc(shadow,nx5,ny5+35)
set npc direction(4,right)
wait(1)
put npc(5,nx5,ny5)
put npc(shadow,nx5,ny5+30)
wait(2)
put npc(5,nx5,ny5--5)
put npc(shadow,nx5,ny5+25)
wait(2)
put npc(5,nx5,ny5--7)
put npc(shadow,nx5,ny5+20)
wait(2)
put npc(5,nx5,ny5--8)
put npc(shadow,nx5,ny5+15)
wait(2)
put npc(5,nx5,ny5--7)
put npc(shadow,nx5,ny5+10)
wait(2)
put npc(5,nx5,ny5--5)
put npc(shadow,nx5,ny5+5)
wait(2)
set npc position(shadow,83,8)
put npc(5,nx5,ny5)
wait(2)

destroy npc(shadow)
end
###
###############################
script, gitlehtombintro3, begin
alter npc(3,NPCstat:picture,168)
alter npc(5,NPCstat:movespeed,10)
walk npc(5,right,8)
wait(2)
wait for text box
jig npc(4)
play song(82)
tb(1509)
wait for npc(5)
set npc position(5,3,1)
jig hero(0)
show text box(1510)
wait(3)
set npc direction(4,down)
wait for text box
jig npc(4)
show text box(1511)
jig npc(4)
wait for text box
jig npc(2)
tb(1512)
wait(8)
walk npc(4,right,2)
wait(7)
jig npc(6)
tb(1513)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,down)
wait(2)
set npc direction(4,left)
jig npc(4)
tb(1514)
jig npc(6)
tb(1515)
walk npc(6,right,10)
wait(2)
set npc direction(4,down)
wait(2)
walk npc(4,right,7)

	suspend npc walls
	variable (d1)
	variable (d2)
	variable (d3)
	variable (i)
	set variable (d1,NPC at spot (20,2))
	set variable (d2,NPC at spot (20,3))
	set variable (d3,NPC at spot (20,4))
	for (i,1,40,1) do(
		put npc (d1,20*20,40+i)
		put npc (d2,20*20,60+i)
		put npc (d3,20*20,80+i)
		wait (1)
	)
	#set npc position (d1,0,2)
	#set npc position (d2,0,2)
	#set npc position (d3,0,2)
	#set npc position (npc at spot(16,4),0,2)
	#set npc position (npc at spot(16,3),0,2)
	#set npc position (npc at spot(16,2),0,2)
	destroy npc (d1)
	destroy npc (d2)
	destroy npc (d3)
	destroy npc (npc at spot(16,4))
	destroy npc (npc at spot(16,3))
	destroy npc (npc at spot(16,2))
	resume npc walls
	write pass block(15,4,0)
	set tag(306,1)

wait for npc(4)
wait for npc(6)

set npc position(4,2,1)
set npc position(6,4,1)

walk npc(1,left,1)
walk npc(2,right,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
set party in

stop song
set tag(8,0)
if(check tag(305)) then(create npc(34,9,13))
save game
play song(66)
end
###

#############################
script, gitlehtombrift, begin
pan camera (right,9,10)

gitlehtombrift1
gitlehtombrift2

gitlehautoload(1)

set tag(8,0)
save game

play song(66)

resume box advance
resume obstruction
resume npcs
end
###

##############################
script, gitlehtombrift1, begin
suspend obstruction
suspend npcs

stop song

set npc position(6,47,4)
set npc direction(6,left)
alter npc(6,NPCstat:palette,74)
alter npc(1,NPCstat:palette,30)
alter npc(2,NPCstat:palette,34)

wait for camera
wait for hero (0)
walk hero(0,right,5)
wait for hero(0)
set hero frame(0,0)

jig npc(6)
play song(56)
tb(1516)

set party out
swap by position(findhero(0),0)

set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)

set tag(93,1)

wait(5)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(1517)
jig hero(0)
tb(1518)
jig npc(6)
show text box(1519)
wait(2)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait for text box
wait(15)
alter npc(6,NPCstat:picture,181)
set npc direction(6,up)
wait(7)
set npc direction(6,right)
wait(4)
set npc direction(6,down)
wait(7)
set npc direction(6,left)
jig npc(6)
tb(1520)
jig npc(1)
tb(1521)
jig npc(2)
tb(1522)
alter npc(1,NPCstat:picture,80)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(1523)
jig hero(0)
tb(1524)
jig npc(6)
show text box(1525)
wait(2)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait for text box
jig npc(2)
tb(1526)
jig npc(6)
tb(1527)
tb(1528)
wait(5)
jig hero(0)
tb(1529)
alter npc(1,NPCstat:picture,12)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(1530)

if(check tag(94)) then(
jig npc(6)
show text box(1531)
alter npc(1,NPCstat:picture,80)
wait(10)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait for text box
jig npc(1)
tb(1532)
battleflash
set party in
swap out hero(0)
swap out hero(2)
swap by position(find hero(1),1)
ff(149)
stop song
swap in hero(0)
swap in hero(2)
set party in
)

if(check tag(94)==false) then(
jig npc(1)
tb(1533)
)

if(check tag(95)) then(
walk hero(0,right,1)
walk npc(1,left,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait(2)
jig npc(6)
tb(1534)
jig hero(0)
tb(1535)
jig npc(6)
tb(1536)
jig hero(0)
set hero picture(0,41)
tb(1537)
jig npc(6)
tb(1538)
set hero picture(0,1)
battleflash
set party in
swap out hero(1)
swap out hero(2)
swap by position(find hero(0),1)
ff(149)
stop song
swap in hero(1)
swap in hero(2)
set party in
)

if(check tag(95)==false,and,check tag(94)==false) then(
wait(15)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait(10)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
wait(6)
jig npc(2)
tb(1539)
jig npc(1)
tb(1540)
wait(2)
alter npc(2,NPCstat:picture,171)
tb(1541)
alter npc(2,NPCstat:picture,13)
walk npc(2,right,2)
walk npc(1,left,1)
walk hero(0,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
wait for npc(2)
set npc frame(2,0)
jig npc(6)
tb(1542)
jig npc(2)
tb(1543)
wait(3)
jig npc(6)
tb(1544)
battleflash
set party in
swap out hero(0)
swap out hero(1)
swap by position(find hero(2),1)
ff(149)
stop song
swap in hero(0)
swap in hero(1)
set party in
)

set party out
swap by position(find hero(0),0)

reset palette
tweak palette (-3,-3,-3)
tweak palette (8,2,2)
update palette
alter npc(1,NPCstat:picture,12)
alter npc(6,NPCstat:picture,166)
set npc direction(6,left)
jig npc(6)
tb(1545)
show text box(1546)
wait(4)
set npc direction(6,down)
wait for text box
alter npc(6,NPCstat:picture,182)
alter npc(6,NPCstat:move speed,10)
write pass block(47,5,0)
walk npc(6,down,9)
wait(2)
set npc direction(1,down)
set npc direction(2,down)
wait(2)
set hero direction(0,down)
wait for npc(6)
alter npc(6,NPCstat:picture,166)
alter npc(6,NPCstat:move speed,2)
write pass block(47,5,1)
set npc position(6,4,1)
end
###

##############################
script, gitlehtombrift2, begin
if(check tag(94)) then(
wait(2)
set npc direction(1,left)
jig npc(1)
tb(1547)
set hero direction(0,right)
wait(2)
set npc direction(2,right)
wait(8)
jig hero(0)
tb(1548)
alter npc(1,NPCstat:picture,73)
jig npc(1)
jig npc(1)
tb(1549)
alter npc(1,NPCstat:picture,12)
jig hero(0)
tb(1550)
wait(5)
jig npc(2)
tb(1551)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
jig npc(1)
tb(1552)
walk npc(2,right,2)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(2)
set npc position(2,1,1)
set npc position(1,0,1)
set party in
)

if(check tag(95)) then(
set npc direction(2,right)
jig npc(2)
jig npc(2)
tb(1553)
set npc direction(1,left)
jig npc(1)
tb(1554)
wait(15)
tb(1555)
jig npc(2)
tb(1556)
set hero direction(0,left)
jig hero(0)
show text box(1557)
wait(2)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait for text box
jig npc(1)
tb(1558)
set hero picture(0,81)
wait(10)
jig hero(0)
tb(1559)
jig npc(1)
tb(1560)
wait(10)
jig hero(0)
tb(1561)
jig npc(1)
tb(1562)
tb(1563)
wait(10)
set hero picture(0,65)
tb(1564)
show text box(1565)
wait(2)
set npc frame(1,1)
set hero picture(0,1)
walk hero(0,right,1)
set hero direction(0,left)
wait(2)
set npc frame(1,0)
jig npc(1)
wait for hero(0)
set hero frame(0,0)
wait for text box
show text box(1566)
wait(2)
set hero picture(0,38)
wait for text box
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
tb(1567)
alter npc(1,NPCstat:picture,79)
set npc direction(1,down)
wait(2)
set npc frame(1,1)
tb(1568)
wait(6)
jig npc(2)
tb(1569)
set npc direction(1,left)
set npc frame(1,0)
alter npc(1,NPCstat:picture,80)
jig npc(1)
tb(1570)
jig npc(2)
tb(1571)
alter npc(1,NPCstat:picture,77)
wait(2)
set npc frame(1,1)
alter npc(1,NPCstat:picture,73)
wait(2)
set npc frame(1,0)
alter npc(1,NPCstat:picture,77)
tb(1572)
jig npc(2)
tb(1573)
wait(2)
set npc frame(1,1)
alter npc(1,NPCstat:picture,73)
wait(2)
set npc frame(1,0)
alter npc(1,NPCstat:picture,77)
tb(1574)
jig npc(2)
tb(1575)
wait(2)
set npc frame(1,1)
alter npc(1,NPCstat:picture,73)
wait(2)
set npc frame(1,0)
alter npc(1,NPCstat:picture,77)
tb(1576)
wait(6)
jig npc(2)
tb(1577)
alter npc(1,NPCstat:picture,80)
jig npc(1)
tb(1578)
jig npc(2)
tb(1579)
set hero picture(0,1)
jig hero(0)
tb(1580)
jig npc(2)
tb(1581)
wait(15)
tb(1582)
wait(2)
jig hero(0)
tb(1583)
walk npc(2,right,3)
set npc direction(1,down)
set hero direction(0,down)
wait(2)
walk npc(1,right,1)
set hero direction(0,right)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
)

if(check tag(94)==false,and,check tag(95)==false) then(
set npc direction(2,left)
jig npc(2)
tb(1584)
set npc direction(1,right)
jig npc(1)
tb(1585)
jig npc(2)
tb(1586)
wait(5)
set hero direction(0,right)
jig npc(1)
tb(1587)
jig hero(0)
show text box(1588)
wait(2)
alter npc(1,NPCstat:picture,80)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
wait for text box
jig npc(1)
show text box(1589)
wait(2)
set hero picture(0,41)
wait for text box
wait(7)
set hero picture(0,66)
wait(16)
tb(775)
jig npc(1)
tb(1590)
wait(2)
set hero picture(0,41)
wait(2)
set hero picture(0,81)
jig hero(0)
show text box(1591)
wait(2)
alter npc(1,NPCstat:picture,12)
wait for text box
jig npc(1)
tb(1592)
walk npc(1,right,4)
wait(2)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
wait for npc(1)
show text box(1593)
walk npc(1,right,10)
wait for npc(1)
wait for text box
wait(2)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
jig npc(2)
tb(1594)
set hero picture(0,1)
jig hero(0)
tb(1595)
jig npc(2)
tb(1596)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
wait(4)
jig hero(0)
tb(1597)
wait(4)
jig npc(2)
tb(1598)
jig hero(0)
tb(1599)
alter npc(2,NPCstat:picture,169)
set npc direction(2,down)
wait(2)
jig npc(2)
tb(1600)
wait(6)
set hero picture(0,51)
tb(1601)
alter npc(1,NPCstat:picture,80)
walk npc(1,left,6)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
show text box(1602)
wait(2)
alter npc(2,NPCstat:picture,13)
set hero picture(0,1)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
set hero speed(0,4)
wait for text box
walk npc(2,right,7)
walk hero(0,right,8)
wait for npc(2)
set npc position(2,1,1)
wait for hero(0)
set hero speed(0,hspeed)
set npc position(1,0,1)
alter npc(1,NPCstat:picture,12)
set hero frame(0,0)
set party in
)
end
###

##############################
script, gitlehtombfight, begin
suspend npcs
suspend obstruction

gitlehtombfight1
gitlehtombfight2
gitlehtombfight3

resume box advance
resume obstruction
resume npcs
end
###

###############################
script, gitlehtombfight1, begin
stop song
pan camera (up,6,10)

set npc position(4,99,38)
set npc position(5,100,40)
set npc position(6,98,40)
set npc direction(4,down)
set npc direction(5,down)
set npc direction(6,down)
set npc frame(5,0)
set npc frame(6,0)

wait for camera
wait for hero (0)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)

set tag(96,1)

walk npc(4,down,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
play song(61)
tb(1604)

set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait(4)
jig npc(2)
tb(1605)
jig npc(6)
tb(1606)
alter npc(1,NPCstat:picture,80)
wait(2)
set npc direction(1,left)
jig npc(1)
tb(1607)
walk npc(4,down,1)
wait(2)
set npc direction(1,up)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(1608)
tb(1609)
jig npc(1)
tb(1610)
jig npc(6)
tb(1611)
walk npc(4,down,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(1612)
jig npc(2)
tb(1613)
tb(1614)
jig npc(2)
tb(1615)
wait(4)
set npc direction(4,left)
jig npc(4)
tb(1616)
jig npc(1)
tb(1617)
wait(2)
set npc direction(4,down)
jig npc(4)
tb(1618)
tb(1619)
wait(2)
set npc direction(2,right)
jig npc(2)
tb(1620)
jig npc(6)
show text box(1621)
wait(3)
set npc direction(2,up)
wait for text box
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
tb(1622)
alter npc(4,NPCstat:picture,182)
set npc direction(4,up)
wait(1)
set npc frame(4,1)
wait(1)
set npc frame(4,0)
wait(1)
set npc frame(4,1)
wait(1)
set npc frame(4,0)
show text box(1623)
wait(1)
set npc frame(4,1)
wait(1)
set npc frame(4,0)
wait(1)
set npc frame(4,1)
wait(1)
set npc frame(4,0)
wait(2)
set npc frame(4,1)
wait(2)
set npc frame(4,0)
wait(2)
set npc frame(4,1)
wait(2)
set npc frame(4,0)
alter npc(4,NPCstat:picture,164)
set npc direction(4,down)
wait for text box
jig npc(2)
tb(1624)
walk npc(2,up,1)
wait(2)
show text box(1625)
wait for npc(2)
set npc frame(2,0)
wait for text box
tb(1626)
wait(5)
jig npc(2)
tb(1627)
wait(2)
set npc direction(4,left)
wait(8)
set npc direction(4,down)
wait(2)
set npc direction(4,right)
wait(8)
set npc direction(4,down)
wait(5)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(1628)
jig npc(4)
tb(1629)
alter npc(4,NPCstat:picture,182)
set npc direction(4,up)
variable(i)
for(i,1,8,1) do(
wait(1)
set npc frame(4,1)
wait(1)
set npc frame(4,0)
)
show text box(1630)
stop song
for(i,1,8,1) do(
wait(2)
set npc frame(4,1)
wait(2)
set npc frame(4,0)
)
alter npc(4,NPCstat:picture,164)
set npc direction(4,down)
wait(2)
set npc direction(4,left)
wait(2)
set npc direction(4,up)
wait for text box

wait(10)
alter npc(4,NPCstat:picture,0)
wait(4)
alter npc(4,NPCstat:picture,164)
wait(4)
alter npc(4,NPCstat:picture,0)
wait(4)
alter npc(4,NPCstat:picture,164)
wait(4)
alter npc(4,NPCstat:picture,0)
wait(4)
alter npc(4,NPCstat:picture,164)
wait(4)
alter npc(4,NPCstat:picture,0)
end
###
###############################
script, gitlehtombfight2, begin
variable(nx4)
variable(ny4)
set variable(nx4,npc pixel x(4))
set variable(ny4,npc pixel y(4))

variable(tal)
variable(tal1)
variable(tal2)
variable(tal3)
variable(tal4)
set variable(tal,npc reference(4))
set variable(tal1,create npc(4,99,41,up))
set variable(tal2,create npc(4,99,41,up))
set variable(tal3,create npc(4,99,41,up))
set variable(tal4,create npc(4,99,41,up))

variable(i)
for(i,2,20,2) do(
wait(2)
put npc(tal1,nx4,ny4--i)
put npc(tal2,nx4+i,ny4)
put npc(tal3,nx4,ny4+i)
put npc(tal4,nx4--i,ny4)
alter npc(4,NPCstat:picture,164)
wait(2)
alter npc(4,NPCstat:picture,0)
)
wait(2)
alter npc(4,NPCstat:picture,164)
wait(15)
set npc direction(tal,left)
set npc direction(tal1,left)
set npc direction(tal2,left)
set npc direction(tal3,left)
set npc direction(tal4,left)
wait(5)
set npc direction(tal,down)
set npc direction(tal1,down)
set npc direction(tal2,down)
set npc direction(tal3,down)
set npc direction(tal4,down)
wait(5)

variable(kant)
set variable(kant,random(0,3))
battleflash(1)
set party in
ff(150+kant)
stop song
set party out
swap by position(find hero(0),0)

reset palette
tweak palette (-4,-4,-4)
tweak palette (4,4,4)
update palette
destroy npc(tal1)
destroy npc(tal2)
destroy npc(tal3)
destroy npc(tal4)
end
###
###############################
script, gitlehtombfight3, begin
gitlehautoload(1)

wait(1)
jig npc(4)
show text box(1631)
wait(2)
walk npc(5,down,1)
wait for npc(5)
set npc frame(5,0)
wait for text box
alter npc(1,NPCstat:move speed,10)
walk npc(1,up,1)
wait for npc(1)
variable(nx1)
variable(ny1)
set variable(nx1,npc pixel x(1))
set variable(ny1,npc pixel y(1))
put npc(1,nx1,ny1--10)
wait(2)
show backdrop(1)
wait(2)
alter npc(1,NPCstat:picture,152)
set npc position(1,100,40)
set npc frame(1,0)
alter npc(1,NPCstat:move speed,4)
set npc direction(4,right)
show map
show text box(1632)
variable(i)
for(i,1,4,1) do(
wait(1)
alter npc(5,NPCstat:picture,0)
wait(1)
alter npc(5,NPCstat:picture,165)
)
for(i,1,2,1) do(
wait(2)
alter npc(5,NPCstat:picture,0)
wait(2)
alter npc(5,NPCstat:picture,165)
)
wait(2)
alter npc(5,NPCstat:picture,0)
set npc position(5,3,1)
wait for text box
jig npc(4)
tb(1633)

write pass block(96,42,0)
set npc direction(4,down)
wait(2)
alter npc(4,NPCstat:move speed,5)
walk npc(4,left,3)
alter npc(1,NPCstat:picture,80)
wait(2)
set npc direction(1,left)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,up)
wait(2)
set npc direction(4,right)
jig npc(4)
tb(1634)
alter npc(6,NPCstat:move speed,5)

walk npc(4,down,2)
walk npc(6,left,2)
wait(2)
set npc direction(2,left)
wait for npc(4)

walk hero(0,up,1)

walk npc(4,left,3)
wait for npc(6)
walk npc(6,down,3)

wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)

wait for npc(4)
walk npc(4,up,1)
wait for npc(6)
walk npc(6,left,1)
wait for npc(4)
walk npc(4,left,1)
wait for npc(6)
walk npc(6,left,1)
wait for npc(4)
walk npc(4,up,1)
wait for npc(6)
walk npc(6,left,1)
wait for npc(4)
walk npc(4,left,2)
wait for npc(6)
walk npc(6,up,1)
wait for npc(6)
walk npc(6,left,1)
wait for npc(6)
walk npc(6,up,1)
wait for npc(6)
walk npc(6,left,2)
wait for npc(4)
set npc position(4,2,1)
wait for npc(6)
set npc position(6,4,1)

wait(5)
walk npc(1,down,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait(15)
jig hero(0)
play song(82)
tb(1635)
set npc direction(2,up)
jig npc(2)
tb(1636)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,down,1)
wait for npc(1)
set npc frame(1,0)
set variable(nx1,npc pixel x(1))
set variable(ny1,npc pixel y(1))
wait(2)
put npc(1,nx1--8,ny1)
wait(2)
show backdrop(1)
wait(2)
put npc(1,nx1,ny1)
set npc direction(2,right)
show map
jig npc(2)
show text box(1637)
wait(2)
set npc direction(1,left)
wait for text box
wait(8)
set hero direction(0,down)
jig hero(0)
tb(1638)

walk npc(2,up,1)
walk npc(1,left,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,1)

set party in

write pass block(96,42,1)

set tag(8,0)

wait(2)
jadeup(4,1)
end
###

###############################
script, gitlehtombgitleh, begin

endofactthree0
endofactthree1
endofactthree2
endofactthree3
endofactthree4

set hero speed(0,hspeed)
set tag(8,0)
save game

if(check tag(3)) then(play song(29))
if(check tag(4)) then(play song(29))
if(check tag(5)) then(play song(29))
if(check tag(6)) then(play song(73))

resume box advance
resume obstruction
resume npcs
end
###

#############################
script, endofactthree0, begin
stop song

alter npc(4,NPCstat:picture,183)
alter npc(4,NPCstat:palette,197)
set npc direction(4,down)
set npc position(4,99,29)

pan camera (up,6,10)
wait for camera
wait for hero (0)
set hero speed(0,4)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)

set tag(97,1)
set tag(121,0)

suspend npcs
suspend obstruction

write pass block(99,32,0)

play song(75)
jig valorian(2)
tb(1639)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)

jig valorian(2)
tb(1640)
wait(5)
jig valorian(2)
tb(1641)
wait(10)
jig valorian(2)
tb(1642)

alter npc(5,NPCstat:picture,155)
alter npc(5,NPCstat:palette,57)
set npc direction(up)
set npc position(5,herox(0),heroy(0))
walk npc(5,up,1)
wait for npc(5)
wait(5)
variable(i)
for(i,1,4,1) do(
wait(1)
alter npc(5,NPCstat:picture,154)
wait(1)
alter npc(5,NPCstat:picture,155)
)
for(i,1,2,1) do(
wait(2)
alter npc(5,NPCstat:picture,154)
wait(2)
alter npc(5,NPCstat:picture,155)
)
wait(2)
alter npc(5,NPCstat:picture,154)
jig valorian(3)
tb(1643)
jig valorian(2)
tb(1644)
jig valorian(3)
tb(1645)
jig valorian(2)
tb(1646)
jig valorian(3)
tb(1647)
jig valorian(3)
tb(1648)
jig valorian(2)
tb(1649)
wait(5)
jig valorian(2)
tb(1650)
jig valorian(2)
tb(1651)

wait(4)
for(i,1,4,1) do(
wait(1)
alter npc(5,NPCstat:picture,154)
wait(1)
alter npc(5,NPCstat:picture,155)
)
for(i,1,2,1) do(
wait(2)
alter npc(5,NPCstat:picture,154)
wait(2)
alter npc(5,NPCstat:picture,155)
)
walk npc(5,down,1)
wait for npc(5)
set npc position(5,0,0)
wait(5)
alter npc(4,NPCstat:move speed,2)
walk npc(4,down,2)
wait for npc(4)
wait(5)

for(i,1,4,1) do(
wait(1)
set npc direction(4,down)
alter npc(4,NPCstat:picture,183)
wait(1)
set npc direction(4,left)
alter npc(4,NPCstat:picture,155)
)
for(i,1,2,1) do(
wait(2)
set npc direction(4,down)
alter npc(4,NPCstat:picture,183)
wait(2)
set npc direction(4,left)
alter npc(4,NPCstat:picture,155)
)
walk npc(4,down,1)
set npc direction(4,left)

jig valorian(2)
tb(1652)
wait for npc(4)
wait(2)
tb(1653)
get item(187,1)
wait(7)
end
###

#############################
script, endofactthree1, begin
palout(5)
camera follows hero(0)
wait(1)
teleport to map(18+poff,4,208)
stop song
set hp
pan camera(south,0,0)
set hero position(0,7,204)
set npc position(1,7,204)
set npc position(2,7,204)
set npc position(4,3,210)
set npc direction(4,up)
wait(5)
palin(2)

wait(5)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,down,1)
walk hero(0,down,1)
wait for hero(0)
walk npc(1,left,6)
walk hero(0,down,1)
walk npc(2,down,1)
wait for npc(2)
walk hero(0,left,6)
walk npc(2,down,1)
wait for npc(2)
walk npc(2,left,6)
wait for npc(1)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,down,1)
walk hero(0,down,1)

jig npc(4)
show text box(1654)
play song(84)

wait for npc(1)
walk npc(1,right,3)
walk hero(0,down,1)
walk npc(2,down,1)
wait for hero(0)
walk hero(0,right,2)
wait for npc(2)
walk npc(2,down,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)

wait for text box

jig npc(4)
tb(1655)
walk npc(4,up,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(1656)
tb(1657)
jig hero(0)
tb(1658)
jig npc(4)
tb(1659)
wait(10)
jig npc(2)
tb(1660)
jig npc(4)
tb(1661)
wait(2)
walk npc(1,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
show text box(1662)
wait(2)
set npc direction(4,right)
wait for text box
jig npc(4)
tb(1663)
jig npc(1)
tb(1664)
wait(20)
tb(1665)
jig hero(0)
show text box(1666)
wait(4)
set npc direction(4,up)
wait for text box
jig npc(4)
tb(1667)
tb(1668)
wait(5)
jig npc(4)
tb(1669)
jig hero(0)
tb(1670)

end
###

#############################
script, endofactthree2, begin
walk npc(1,down,1)
walk hero(0,right,1)
walk npc(2,right,1)
wait for npc(2)
walk npc(1,right,1)
walk hero(0,down,1)
walk npc(2,right,1)
wait for npc(2)
set npc direction(4,right)
walk npc(1,right,1)
walk hero(0,down,1)
walk npc(2,down,1)
wait for npc(2)
set npc direction(4,down)
walk npc(1,right,1)
walk hero(0,right,1)
walk npc(2,down,1)
jig npc(4)

stop song
show text box(1671)
wait for npc(2)
set npc frame(2,0)

walk npc(1,down,3)
walk hero(0,right,2)
wait for hero(0)
walk hero(0,down,3)

wait for text box
set npc direction(2,left)
wait(2)
set npc direction(2,up)
jig npc(2)
tb(1672)
walk npc(4,right,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,down)
jig npc(4)
tb(1673)
tb(1674)
jig npc(4)
tb(1675)
jig npc(4)
tb(1676)
wait(15)
set npc direction(4,left)
wait(15)
jig npc(4)
play song(91)
tb(1677)
wait(8)
jig npc(4)
tb(1678)
wait(20)
set npc direction(4,down)
show text box(1679)
jig npc(4)
wait for text box
wait(5)
jig npc(2)
tb(1680)
wait(8)
set npc direction(4,left)
tb(1681)
wait(6)
walk npc(2,right,3)
wait for npc(2)
set npc frame(2,0)
wait(5)
alter npc(2,NPCstat:picture,170)
set npc direction(2,down)
wait(2)
alter npc(2,NPCstat:picture,178)
wait(25)
alter npc(2,NPCstat:picture,13)
walk npc(2,down,3)
wait for npc(2)
end
###

#############################
script, endofactthree3, begin
palout(2)
camera follows hero(0)
wait(1)
teleport to map(14+poff,38,58)
stop song
pan camera(south,0,0)
set hero position(0,38,57)
set hero direction(0,up)
set hero picture(0,49)
set npc position(1,39,58)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)
set npc position(2,29,58)
wait(15)
palin(5)

wait(15)
walk npc(2,right,4)
wait for npc(2)
walk npc(2,right,4)
set npc direction(1,left)
show text box(1682)
wait for npc(2)
set npc frame(2,0)
wait for text box
jig npc(2)
show text box(1683)
wait(2)
set hero picture(0,1)
set hero direction(0,left)
wait(3)
alter npc(1,NPCstat:picture,12)
set hero direction(0,down)
wait for text box
jig npc(1)
tb(1684)
wait(5)
jig npc(2)
tb(1685)
wait(6)
jig npc(1)
tb(1686)
jig npc(2)
tb(1687)
wait(4)
jig npc(1)
tb(1688)
alter npc(2,NPCstat:move speed,2)
walk npc(2,right,1)
wait for npc(2)
set npc frame(2,0)
alter npc(2,NPCstat:move speed,4)
wait(5)
jig npc(2)
play song(82)
tb(1689)
alter npc(1,NPCstat:picture,73)
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
show text box(1690)
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait for text box
jig npc(2)
tb(1691)
alter npc(1,NPCstat:picture,80)
jig npc(1)
tb(1692)
wait(3)
set hero picture(0,1)
jig hero(0)
show text box(1693)
wait(2)
set npc direction(2,up)
wait for text box
jig npc(2)
tb(1694)
jig npc(1)
tb(1695)
set npc direction(2,right)
jig npc(2)
tb(1696)
alter npc(1,NPCstat:picture,77)
wait(2)
alter npc(1,NPCstat:picture,73)
set npc frame(1,1)
wait(2)
alter npc(1,NPCstat:picture,77)
set npc frame(1,0)
tb(1697)
jig npc(2)
show text box(1698)
wait(3)
alter npc(1,NPCstat:picture,80)
wait for text box
jig npc(1)
tb(1699)
jig npc(2)
tb(1700)
jig hero(0)
tb(1701)
wait(4)
jig npc(1)
tb(1702)
jig npc(2)
tb(1703)
alter npc(1,NPCstat:picture,77)
wait(2)
alter npc(1,NPCstat:picture,73)
set npc frame(1,1)
wait(2)
alter npc(1,NPCstat:picture,77)
tb(1704)
jig npc(2)
tb(1705)
wait(12)
alter npc(1,NPCstat:picture,73)
set npc frame(1,1)
wait(2)
alter npc(1,NPCstat:picture,77)
set npc frame(1,0)
tb(1706)
jig npc(2)
show text box(1707)
wait(2)
jig npc(2)
wait for text box

show text box(1708)
variable(j)
for(j,1,3,1) do(
set npc direction(2,down)
wait(1)
set npc direction(2,left)
wait(1)
set npc direction(2,up)
wait(1)
set npc direction(2,right)
wait(1)
)
alter npc(2,NPCstat:move speed,2)
walk npc(2,left,1)
alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
for(j,1,2,1) do(
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait(2)
set npc direction(2,up)
wait(2)
set npc direction(2,right)
wait(2)
)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
set npc frame(2,0)
alter npc(2,NPCstat:move speed,4)
wait(5)
set npc direction(2,down)
wait(3)
set npc direction(2,right)
wait for text box

wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
show text box(1709)
for(j,1,4,1) do(
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
)
wait for text box
wait(4)
jig hero(0)
show text box(1710)
wait(2)
alter npc(1,NPCstat:picture,12)
set npc direction(1,left)
set npc direction(2,up)
wait(2)
set npc direction(1,up)
wait for text box
end
###

#############################
script, endofactthree4, begin
variable(nx11)
variable(ny11)
set variable(nx11,npc pixel x(1))
set variable(ny11,npc pixel y(1))
wait(2)
put npc(1,nx11,ny11--3)
wait(2)
put npc(1,nx11,ny11)
show text box(1711)
wait(2)
set hero picture(0,41)
put npc(1,nx11,ny11--3)
wait(2)
put npc(1,nx11,ny11)
wait for text box
alter npc(2,NPCstat:move speed,5)
walk npc(2,right,1)
wait(1)
set npc direction(2,up)
wait for npc(2)
set npc frame(2,0)
variable(nx22)
variable(ny22)
set variable(nx22,npc pixel x(2))
set variable(ny22,npc pixel y(2))
wait(2)
put npc(2,nx22,ny22--3)
wait(2)
put npc(2,nx22,ny22)
show text box(1712)
wait(2)
put npc(2,nx22,ny22--3)
wait(2)
put npc(2,nx22,ny22)
wait(2)
put npc(2,nx22,ny22--3)
wait(2)
put npc(2,nx22,ny22)
wait for text box
set hero picture(0,81)
jig hero(0)
tb(1713)
jig npc(1)
show text box(1714)
wait(2)
set hero picture(0,72)
wait for text box
jig hero(0)
tb(1715)
wait(2)
set npc direction(1,right)
jig npc(1)
alter npc(1,NPCstat:picture,79)
show text box(1716)
wait(2)
set hero picture(0,41)
wait for text box

wait(2)
put npc(2,nx22,ny22--3)
wait(2)
put npc(2,nx22,ny22)
show text box(1717)
wait(2)
put npc(2,nx22,ny22--3)
wait(2)
put npc(2,nx22,ny22)
wait for text box

settp

wait(25)

#variable(cm)
#set variable(cm,current map)

tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)

tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,4,0)
update palette
wait (1)
tweak palette (0,8,0)
update palette
reset palette
wait (1)
tweak palette (0,16,0)
update palette
reset palette
wait (1)
tweak palette (0,63,0)
update palette

#teleport to map(0,0,0)
stop song
show backdrop(0)
wait (1)

reset palette
tweak palette (0,16,0)
update palette
wait (1)
reset palette
tweak palette (0,8,0)
update palette
wait (1)
reset palette
tweak palette (0,4,0)
update palette
wait (1)
reset palette
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette

wait(15)
play song(15)
jig gahn
tb(1718)
jig gahn
tb(1719)
wait(10)
jig gahn
tb(1720)
jig gahn
tb(1721)

palout(1)
set hero picture(0,1)
camera follows hero(0)
#teleport to map(cm,38,58)
set npc position(1,0,1)
set npc position(2,0,1)
alter npc(1,NPCstat:picture,12)
stop song
set party in
set hero direction(0,right)

#now in act 3
actadvance(3)

set tag(346,1)
set tag(82,1)

show map
wait(1)
palin(3)

#wait(2)
#save game

end
###

#############################
#Gitleh Tomb Locked Doors
script, gitlehtomblock, begin



end
###

##############################
#A3 - Breeder
script, gitlehtombmini1, begin

stop song

resume obstruction
resume npcs

wait for camera
reset palette
tweak palette (-2,1,-2)
update palette
set pal(noon)
pan camera (left,9,10)
wait for camera
wait for hero (0)
walk hero(0,left,3)
wait for hero(0)
set hero frame(0,0)

jig npc(10)
play song(15)
tb(1457)

set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,down,1)
wait for npc(1)
set npc direction(1,left)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,left)
set npc frame(2,0)

if(check tag(48)) then(

jig hero(0)
tb(1458)
wait(5)
set npc direction(10,down)
jig npc(10)
show text box(1459)
wait(8)
set npc direction(10,left)
wait for text box
jig npc(2)
tb(1460)
jig npc(1)
tb(1461)
set npc direction(10,down)
wait(2)
set npc direction(10,right)
jig npc(10)
tb(1462)
set npc direction(10,down)
wait(2)
set npc direction(10,left)
wait(4)
jig npc(10)
tb(1463)

battle flash
set tag(98,1)
ff(35)
)

if(check tag(48)==false) then(
jig hero(0)
tb(1464)
set npc direction(10,down)
wait(2)
set npc direction(10,right)
jig npc(10)
tb(1465)
tb(1466)
wait(6)
jig npc(10)
tb(1467)

battle flash
set tag(98,1)
ff(35)
)
set tag(98,1)

wait(4)
gitlehautoload(1)
get item(29,1)
tb(1053)

suspend npcs
suspend obstruction
walk npc(1,down,1)
walk npc(2,up,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
set party in
set tag(48,0)
resume obstruction
resume npcs
end
###

##############################
#C4 - Insane Illusionist
script, gitlehtombmini2, begin
stop song

wait for camera
reset palette
tweak palette (-2,1,-2)
update palette
set pal(noon)
pan camera (down,6,10)
wait for camera
wait for hero (0)
walk hero(0,down,2)
wait for hero(0)
set hero frame(0,0)

jig npc(13)
play song(15)
tb(1468)
tb(1469)

if(check tag(48)==false) then(
set hero direction(0,left)
wait(2)
walk hero(0,up,3)
wait for hero(0)
stop song
pan camera (up,6,10)
walk hero (0,up,3)
wait for camera
reset palette
tweak palette (1,-2,-2)
tweak palette (0,0,4)
update palette
set pal(morning)
pan camera (up,6,10)
wait for camera
wait for hero (0)
play song(66)
)

if(check tag(48)) then(
set party out
swap by position(find hero(0),0)
suspend npcs
suspend obstruction
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)

jig hero(0)
tb(1470)
walk npc(13,up,1)
set npc direction(13,left)
wait(2)
set npc direction(13,up)
wait for npc(13)
set npc frame(13,0)
jig npc(13)
tb(1471)

if(check tag(48)) then(
jig hero(0)
tb(1472)
jig npc(13)
tb(1473)

battleflash
set tag(99,1)
ff(146)
gitlehautoload(1)
)

if(check tag(48)==false) then(
jig npc(2)
tb(1474)
jig npc(13)
tb(1475)
wait(6)
jig npc(13)
tb(1476)

battleflash
set tag(99,1)
ff(146)
gitlehautoload(1)
)

set tag(99,1)

walk npc(1,left,1)
walk npc(2,right,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
set party in
resume obstruction
resume npcs
)

set tag(48,0)

end
###

###################################
#D3 - Summoner Self-Sacrifice Fight
script, gitlehtombmini3, begin

stop song

wait for camera
reset palette
tweak palette (-1,2,-2)
update palette
set pal(noon)
pan camera (right,9,10)
wait for camera
wait for hero (0)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0)

jig npc(14)
play song(15)
tb(1477)
wait(2)
tb(1603)

suspend npcs
suspend obstruction
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,down,1)
walk npc(2,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)

#tears chosen
if(check tag(48)==false,and,check tag(609)==false) then(
	jig hero(0)
	tb(1486)
	set npc direction(14,down)
	wait(2)
	set npc direction(14,left)
	jig npc(14)
	tb(1487)
	jig npc(npc at spot(61,31))
	tb(1488)
	jig npc(npc at spot(60,29))
	tb(1489)
	jig npc(npc at spot(62,30))
	tb(1490)

	battle flash
	set tag(100,1)
	ff(147)
	set tag(609,1)
)

#Doing what chosen
if(check tag(48),and,check tag(609)==false) then(
	jig hero(0)
	tb(1478)
	set npc direction(14,down)
	wait(2)
	set npc direction(14,left)
	jig npc(14)
	set tag(48,0)
	tb(1479)

	#transition chosen
	if(check tag(48),and,check tag(609)==false) then(
		jig hero(0)
		tb(1480)
		jig npc(14)
		tb(1481)

		battle flash
		set tag(100,1)
		ff(147)
		set tag(609,1)
	)

	#kill them chosen
	if(check tag(48)==false,and,check tag(609)==false) then(
		jig npc(1)
		tb(1482)
		set npc direction(2,down)
		wait(4)
		set npc direction(2,right)
		jig npc(2)
		tb(1483)
		set npc direction(1,up)
		jig npc(1)
		tb(1484)
		jig npc(14)
		show text box(1485)
		wait(2)
		set npc direction(1,right)
		wait for text box

		battle flash
		set tag(100,1)
		ff(147)
		set tag(609,1)
	)
)
set tag(100,1)
set tag(48,0)

wait(4)
gitlehautoload(1)
get item(29,1)
tb(1053)

walk npc(1,up,1)
walk npc(2,down,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
set party in

resume obstruction
resume npcs
end
###

#########################
script, desertdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(herox(0)==9,and,heroy(0)==32) then(
	pan camera(south,0,0)
	walk hero (0,left,4)
	palout(3)
	wait for hero(0)
	if(check tag(102)==false) then(set hero picture(find hero(0),1))
	wait(1)
	camera follows hero(0)
	teleport to map(90,66,6)
	wait(1)
	load tileset(87+poff)
	pan camera(south,0,0)
	set hero position(0,55,6)
	pan camera(left,25,10)
	walk hero(0,left,15)
	wait(2)
	palin(5)
	wait for camera
	pan camera(left,15,10)
	palout(5)
	wait for camera
	wait for hero(0)
	camera follows hero(0)
	teleport to map(14+poff,141,54)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,145,54)
	walk hero(0,left,4)
	wait(2)
	palin(3)
	wait for hero(0)
	set hero frame(0,0)
	camera follows hero(0)

	#check to see if need to turn on rest and avis items
	if(check tag(604)) then(
		set tag(433,0)
		set tag(280,0)
	)

)
else(
if(herox(0)==240,and,heroy(0)==32) then(
pan camera(south,0,0)
walk hero (0,right,4)
palout(3)
wait for hero(0)
wait(1)

if(check tag(115)) then(
camera follows hero(0)
teleport to map(28+poff,10,20)
wait(1)
pan camera(south,0,0)
set hero position(0,6,20)
walk hero(0,right,4)
wait(2)
palin(3)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0))
else(scenethreepointthree)

)
)
do(
if(herox(0)==174,and,heroy(0)==57) then(

if(check tag(131)==false) then(enteringdun3)
else(
pan camera(south,0,0)
walk hero(0,down,6)
wait(5)
palout(5)
wait for hero(0)
camera follows hero(0)
set hero position(0,17,90)
wait(1)
pan camera(up,7,4)
set hero speed(0,2)
walk hero(0,up,3)
wait(2)
palin(5)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
)

)
)
do(
if((herox(0)==14,or,herox(0)==15,or,herox(0)==16,or,herox(0)==17,or,herox(0)==18,or,herox(0)==19,or,herox(0)==20),and,heroy(0)==88) then(
walk hero(0,down,5)
wait(5)
palout(5)
wait for hero(0)
camera follows hero(0)
set hero position(0,174,56)
wait(1)
pan camera(south,0,0)
set hero position(0,174,61)
walk hero(0,up,5)
wait(5)
palin(5)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
)
)
do(
if(herox(0)==17,and,heroy(0)==79) then(
stop song
pan camera(up,4,4)
set hero speed(0,2)
walk hero(0,up,1)
wait for hero(0)
wait for camera
pan camera(up,4,4)
wait(5)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(36,45,186)
wait(1)
set pal(noon)
pan camera(south,0,0)
set hero position(0,45,193)
set hero speed(0,hspeed)
palin(3)
walk hero(0,up,3)
wait for hero(0)
set hero frame(0,0)
)
)
do(
if(herox(0)==84,and,heroy(0)==15) then(
	if(check tag(604)) then(
		walk hero(0,down,1)
		set hero direction(0,up)
		wait for hero(0)
		jig hero(0)
		tb(7369)
	)
	else(
		pan camera(south,0,0)
		set hero position(0,0,0)
		palout(2)
		camera follows hero(0)
		teleport to map(71,27,45)
		stop song
		set pal(noon)
		wait(1)
		pan camera(south,0,0)
		set hero position(0,27,51)
		wait(1)
		palin(2)
		walk hero(0,up,2)
		wait for hero(0)
	)
)
)

set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

#########################
script, keltandoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==9,and,heroy(0)==20) then(
set variable(time,0)

if(check tag(117)) then(
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(2357))

if(check tag(117)==false,and,check tag(129)==false) then(
pan camera(south,0,0)
walk hero (0,left,4)
palout(3)
wait for hero(0)
wait(1)
camera follows hero(0)
teleport to map(24+poff,239,32)
wait(1)
pan camera(south,0,0)
set hero position(0,243,32)
walk hero(0,left,4)
wait(2)
palin(3)
wait for hero(0)
camera follows hero(0))

if(check tag(129)) then(raiderconfrontation)

)
else(
if(herox(0)==28,and,heroy(0)==10) then(
set variable(time,0)
pan camera(south,0,0)
write pass block(28,11,128)
write pass block(28,12,128)
walk hero(0,down,2)
set hero direction(0,up)
wait(2)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap+4,2,20)
wait(1)
pan camera(south,0,0)
set hero position(0,2,17)
walk hero(0,down,3)
set hero direction(0,up)
wait(2)
palin(2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==56,and,heroy(0)==11) then(
set variable(time,0)
pan camera(south,0,0)
write pass block(56,12,128)
write pass block(56,13,128)
walk hero(0,down,2)
set hero direction(0,up)
wait(2)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap+4,8,75)
wait(1)
pan camera(south,0,0)
set hero position(0,8,72)
walk hero(0,down,3)
set hero direction(0,up)
wait(2)
palin(2)
wait for hero(0)
camera follows hero(0))
)

palout(time)

if(herox(0)==17,and,heroy(0)==18) then(
teleport to map(currentmap+4,3,6))
else(
if(herox(0)==32,and,heroy(0)==17) then(
teleport to map(currentmap+4,6,24))
)
do(
if(herox(0)==35,and,heroy(0)==13) then(
teleport to map(currentmap+4,4,42))
)
do(
if(herox(0)==43,and,heroy(0)==17) then(
teleport to map(currentmap+4,4,60))
)
do(
if(herox(0)==51,and,heroy(0)==18) then(
teleport to map(currentmap+4,3,79))
)
do(
if(herox(0)==53,and,heroy(0)==13) then(
	if(check tag(385),and,check tag(392)==false) then(
		set variable(time,0)
		teleport to map(currentmap+4,5,95)
		wait(1)
		palin(1)
		wait(10)
		set npc direction(33,down)
		wait(10)
		raiderbattles(4)
		set tag(373,1)
	)
	else(teleport to map(currentmap+4,5,95))
)
)
do(
if(herox(0)==51,and,heroy(0)==27) then(
	if(check tag(385),and,check tag(393)==false) then(
		set variable(time,0)
		teleport to map(currentmap+4,4,111)
		wait(1)
		palin(1)
		wait(10)
		set npc direction(34,down)
		wait(10)
		raiderbattles(5)
	)
		else(teleport to map(currentmap+4,4,111))
)
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

###############################
script, keltanindoordoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==2,and,heroy(0)==19) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,2)
wait(2)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--4,29,10)
write pass block(28,11,128)
write pass block(28,12,128)
wait(1)
pan camera(south,0,0)
set hero position(0,28,12)
walk hero(0,up,2)
wait(2)
palin(2)
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
write pass block(28,11,0)
write pass block(28,12,0)
camera follows hero(0))
else(
if(herox(0)==8,and,heroy(0)==74) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,2)
wait(2)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(currentmap--4,55,11)
write pass block(56,12,128)
write pass block(56,13,128)
wait(1)
set hero position(0,56,13)
walk hero(0,up,2)
wait(2)
palin(2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(56,12,0)
write pass block(56,13,0)
camera follows hero(0))
)
do(
if(herox(0)==5,and,heroy(0)==108) then(
	set variable(time,0)
	if(check tag(122)) then(
		write pass block(5,109,128)
		write pass block(5,110,128)
		set hero speed(0,2)
		walk hero(0,down,2)
		set hero direction(0,up)
		wait for hero(0)
		palout(2)
		camera follows hero
		set hero position(0,4,124)
		wait(1)
		pan camera(south,0,0)
		set hero position(0,0,0)
		write pass block(5,124,0)
		wait(1)
		palin(2)
		wait(2)
		set hero position(0,5,122)
		walk hero(0,down,2)
		set hero direction(0,up)
		wait for hero(0)
		set hero speed(0,hspeed)
		set hero frame(0,0)
		write pass block(5,124,1))
	)
)
do(
if(herox(0)==4,and,heroy(0)==112) then(
set variable(time,0)

if(check tag(122)) then(
set hero direction(0,right)
wait(2)
walk hero(0,up,1)
wait for hero(0)
)
else(
palout(1)
teleport to map(currentmap--4,51,28)
palin(1)))

)
do(
if(herox(0)==2,and,heroy(0)==122) then(
set variable(time,0)
gunfight)
)
do(
if(herox(0)==5,and,heroy(0)==96) then(
	set variable(time,0)
	if(check tag(373),and,check tag(374),and,check tag(375)==false) then(
		jadeneurosis
	)
	else(
		palout(1)
		teleport to map(currentmap--4,53,14)
		palin(1)
	)
)
)

palout(time)

if(herox(0)==3,and,heroy(0)==7) then(
teleport to map(currentmap--4,17,19))
else(
if(herox(0)==6,and,heroy(0)==25) then(

if(check tag(128)) then(
set variable(time,0)
midnightraiders)
else(teleport to map(currentmap--4,32,18))

)
)
do(
if(herox(0)==4,and,heroy(0)==43) then(
teleport to map(currentmap--4,35,14))
)
do(
if(herox(0)==4,and,heroy(0)==61) then(
teleport to map(currentmap--4,43,18))
)
do(
if(herox(0)==3,and,heroy(0)==80) then(
teleport to map(currentmap--4,51,19))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

#################################
script, scenethreepointone, begin
pan camera(south,0,0)
walk hero (0,right,4)
wait(3)
palout(3)
wait for hero(0)
wait(1)
camera follows hero(0)
teleport to map(90,23,6)
wait(1)
pan camera(south,0,0)
set hero position(0,44,6)
load tileset(87+poff)
wait(2)
set party out
swap by position(find hero(0),0)
alter npc(1,NPCstat:palette,29+poff)
alter npc(2,NPCstat:palette,33+poff)
set npc position(1,42,5)
set npc position(2,41,6)
set hero direction(0,right)
set npc direction(1,right)
set npc direction(2,right)
set hero frame(0,0)
wait(1)
play song(69)
pan camera(right,20,10)
wait(2)
palin(5)
wait for camera
wait(15)
jig hero(0)
tb(1734)
jig npc(1)
tb(1735)
jig npc(2)
tb(1736)
wait(7)
set hero direction(0,down)
wait(2)
set hero direction(0,left)
jig hero(0)
tb(1737)
jig npc(1)
show text box(1738)
wait(2)
set npc direction(2,up)
wait for text box
jig npc(2)
tb(1739)
set npc direction(1,down)
jig npc(1)
tb(1740)
wait(5)
jig hero(0)
tb(1741)
set npc direction(1,right)
set npc direction(2,right)
jig npc(1)
show text box(1742)
wait(2)
set hero picture(0,81)
wait for text box
wait(2)
jig hero(0)
tb(1743)
jig npc(1)
tb(1744)
wait(2)
jig hero(0)
tb(1745)
jig npc(1)
tb(1746)
set hero picture(0,72)
jig hero(0)
tb(1747)

alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
set npc frame(1,0)

variable(j)
for(j,1,4,1) do(
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
)
for(j,1,2,1) do(
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
)
tb(1748)
jig hero(0)
tb(1749)
alter npc(1,NPCstat:picture,75)
wait(2)
alter npc(1,NPCstat:picture,12)
set npc direction(1,right)
#jig npc(1)
tb(1750)
walk hero(0,up,1)
wait for hero(0)
walk hero(0,left,1)
set npc direction(2,up)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
stop song
tb(1751)
jig npc(1)
tb(1752)
jig hero(0)
tb(1753)
jig npc(1)
play song(32)
tb(1754)
jig npc(2)
tb(1755)
set npc direction(1,down)
jig npc(1)
tb(1756)
jig npc(2)
tb(1757)
set hero direction(0,down)
jig hero(0)
tb(1758)

pan camera(right,15,5)
wait(3)
palout(3)
wait for camera
set party in
camera follows hero(0)

set tag (3,0)
set tag (4,0)
set tag (5,1)
set tag (6,0)

setheropalette(find hero(0),2,inside battle)
setheropalette(find hero(0),2,outsidebattle)
setheropalette(find hero(1),30,inside battle)
setheropalette(find hero(1),30,outsidebattle)
setheropalette(find hero(2),34,inside battle)
setheropalette(find hero(2),34,outsidebattle)

setvariable(hour,1500)
setvariable(minute,0)
setvariable(second,1)

teleport to map(25,10,32)
wait(1)
pan camera(south,0,0)
set hero position(0,6,32)
walk hero(0,right,4)
wait(2)
palin(3)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
set tag(101,1)

#turn off enemies
set tag(604,1)
#turn off item rest
set tag(433,1)
#turn off avis
set tag(280,1)

end
###

###############################
script, restingbythefire, begin

if(check tag(130)) then(write pass block(174,57,0))

if(check tag(133)) then(
write map block(17,79,143)
write pass block(17,79,0)
)

if(check tag(102)==false,and,currentmap==26) then(restingbythefire2)

if(check tag(385)) then(
set tag(385,0)
set tag(387,1)
)

end
###

################################
script, restingbythefire2, begin
suspend player
suspend npcs
suspend obstruction

stop song

wait for hero(0)
set hero frame(0,0)
write global(34,herox(0))
write global(35,heroy(0))
wait(2)
palout(2)
set hero position(0,149,79)
wait(1)
set party out
swap by position(find hero(0),0)
set hero direction(0,left)
pan camera(south,0,0)
wait(1)
palin(2)

play song(17)
wait(1)
jig hero(0)
tb(1763)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,right,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,left)
set npc frame(2,0)
jig npc(1)
tb(1764)
jig hero(0)
tb(1765)
tb(1766)
jig npc(2)
tb(1767)
wait(2)
set hero direction(0,up)
set npc direction(1,right)
set hero picture(0,1)
wait(2)
set hero direction(0,right)
wait(2)
jig hero(0)
tb(1768)
jig npc(2)
tb(1769)
jig npc(1)
tb(1770)
wait(2)
set npc direction(1,down)
wait(2)
tb(1771)
set hero direction(0,up)
jig hero(0)
tb(1772)
wait(3)
jig npc(2)
show text box(1773)
wait(2)
set hero direction(0,right)
wait for text box
wait(2)
play song(82)
alter npc(1,NPCstat:picture,82)
set npc direction(1,left)
tb(1774)
wait(2)
set hero picture(0,41)
alter npc(2,NPCstat:picture,173)
wait(15)
set hero picture(0,38)
wait(2)
set hero picture(0,41)
wait(2)
set hero picture(0,38)
wait(2)
set hero picture(0,41)
show text box(1775)
wait(2)
set hero picture(0,50)
wait for text box
set npc direction(1,up)
tb(1776)
jig npc(2)
tb(1777)
alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
set npc frame(1,0)
variable(j)
for(j,1,2,1) do(
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
)
tb(1778)
set hero picture(0,1)
jig hero(0)
show text box(1779)
wait(2)
alter npc(2,NPCstat:picture,13)
wait for text box
jig npc(2)
tb(1780)
alter npc(1,NPCstat:picture,12)
wait(2)
set npc direction(1,right)
jig npc(1)
tb(1781)
jig npc(2)
tb(1782)
jig npc(1)
tb(1783)

palout(3)
stop song
resume obstruction
resume npcs

camera follows hero(0)
set hero position(0,124,80)
wait(1)
pan camera(south,0,0)
set hero picture(0,191)
set hero direction(0,down)
set hero position(0,122,80)
set npc direction(1,left)
set npc position(1,125,79)
alter npc(2,NPCstat:picture,193)
set npc direction(2,down)
set npc position(2,124,78)
wait(1)
put hero(0,(122*20),(80*20)+5)
wait(10)
palin(3)

play song(17)
wait(15)
alter npc(1,NPCstat:movespeed,2)
alter npc(1,NPCstat:picture,75)
wait(25)
alter npc(1,NPCstat:picture,12)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,left,2)
wait(2)
set npc direction(2,left)
wait for npc(1)
set npc frame(1,0)
wait(12)
alter npc(1,NPCstat:picture,192)
set hero frame(0,1)
wait(4)
set npc frame(1,1)
wait(12)
alter npc(1,NPCstat:picture,12)
set npc direction(1,left)
set npc frame(1,0)
jig npc(1)
tb(1784)
wait(15)
tb(775)
jig npc(1)
tb(1785)
wait(4)
set hero frame(0,0)
set hero direction(97,down)
set hero picture(0,97)
put hero(0,(122*20),(80*20))
wait(2)
set hero direction(0,up)
wait(2)
set hero picture(0,41)
set hero direction(0,right)
wait(10)
tb(1786)
jig npc(1)
tb(1787)
wait(2)
set hero picture(0,66)
tb(1788)
set npc direction(1,up)
wait(2)
set npc direction(2,down)
walk npc(1,right,2)
wait(2)
show text box(1789)
wait(3)
set hero picture(0,81)
wait for npc(1)
set npc frame(1,0)
wait for text box
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
tb(1790)
set npc direction(1,up)
show text box(1791)
jig npc(1)
wait for text box
alter npc(1,NPCstat:picture,80)
walk npc(1,right,2)
wait(2)
set npc direction(2,right)
wait for npc(1)
set npc frame(1,0)
wait(4)
set npc direction(1,down)
alter npc(1,NPCstat:picture,79)
wait(6)
set npc frame(1,1)
tb(1792)
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
tb(1793)
alter npc(1,NPCstat:picture,80)
set npc direction(1,right)
wait(1)
set npc direction(1,up)
set npc frame(1,0)
tb(1794)
set npc direction(1,right)
wait(2)
set npc direction(1,down)
wait(2)
alter npc(1,NPCstat:picture,192)
set npc direction(1,left)
wait(4)
set npc direction(1,down)
put npc(1,(127*20),(80*20)+5)
wait(15)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait(20)
tb(775)
wait(2)
set hero picture(0,38)
wait(7)

palout(10)
camera follows hero(0)
teleport to map(89,1,3)
stop song
wait(1)
set hero palette(find hero(0),2)
load tileset(96)
alter NPC(35,NPCstat:script argument,96)
set hero picture(find hero(0),198)
set hero direction(0,down)
set hero frame(0,0)
resume obstruction
resume npcs
wait(15)

play song(31)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (10)
reset palette
greyscale palette
update palette

wait(30)
fade screen out(63,63,63)
reset palette
wait(1)
fade screen in

wait(15)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)

set variable(isrunning,0)
swap out hero(find hero(1))
lock hero(find hero(1))
swap out hero(find hero(2))
lock hero(find hero(2))
wait(1)
resume player
end
###

############################
script, flashbackdoor, phase set, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==12,and,heroy(0)==28) then(

if(check tag(126)==false) then(
set tag(126,1)
alter npc(5,NPCstat:movespeed,5)
stop song
tb(2062)
wait(2)
show text box(2063)
jig hero(0)
wait for textbox
walk npc(5,down,heroy(0)--npcy(5)--1)
wait for npc(5)
jig npc(5)
show text box(2064)
play song(8)
set hero direction(0,left)
wait(2)
set hero direction(0,up)
wait for text box
walk npc(5,down,1)
wait for npc(5)
set npc position(5,1,4)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
)

set variable(time,0)
set hero speed(0,10)
walk hero(0,down,14)
focus camera(14,45,20)
wait for camera
wait for hero(0)
set hero speed(0,5)

)
else(
if(herox(0)==12,and,heroy(0)==41) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,up,14)

if(check tag(126)) then(
focus camera(12,27,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0)
)
else(
manxmoon
)

)
)
do(
if(herox(0)==21,and,heroy(0)==46) then(
set variable(time,0)

if(check tag(127),or,check tag(126)==false) then(
set hero speed(0,10)
walk hero(0,right,8)
focus camera(29,46,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0))
else(
set tag(127,1)
animals can talk)

)
)
do(
if(herox(0)==28,and,heroy(0)==46) then(
set variable(time,0)
if(check tag(102)) then(
set hero speed(0,10)
walk hero(0,left,8)
focus camera(14,45,20)
wait for camera
wait for hero(0)
set hero speed(0,5))
else(
write pass block(27,46,2)
set hero direction(0,down)
wait(2)
walk hero(0,right,1)
wait for hero(0))
)
)
do(
if(herox(0)==33,and,heroy(0)==40) then(
set variable(time,0)

if(check tag(126)) then(

	if((check tag(185),and,check tag(186),and,check tag(187)),or,(check tag(185)==false,and,check tag(186)==false,and,check tag(187)==false)) then(
		set hero speed(0,5)
		walk hero(0,up,3)
		focus camera(43,17,20)
		wait for hero(0)
		walk hero(0,right,1)
		wait for hero(0)
		set hero position(0,43,29)
		walk hero(0,up,8)
		wait for camera
		wait for hero(0)
		set hero speed(0,5)
	)

	if(check tag(185),and,check tag(186),and,check tag(187)==false) then(endfourpointfour)

	if(check tag(185),and,check tag(186)==false) then(dodgeball)

)
else(
	set hero direction(0,left)
	wait(2)
	walk hero(0,down,1)
	wait for hero(0)
)

)
)
do(
if(herox(0)==43,and,heroy(0)==22) then(
set variable(time,0)
set hero speed(0,5)
walk hero(0,down,4)
focus camera(33,41,20)
wait for hero(0)
set hero position(0,36,36)
walk hero(0,left,2)
wait for hero(0)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
walk hero(0,down,4)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==50,and,heroy(0)==16) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,right,6)
focus camera(61,14,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
)
)
do(
if(herox(0)==55,and,heroy(0)==16) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,left,6)
focus camera(43,17,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
)
)
do(
if(herox(0)==49,and,(heroy(0)==45,or,heroy(0)==46,or,heroy(0)==47)) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,right,4)
focus camera(63,44,20)
wait for hero(0)
walk hero to y(0,45)
wait for hero(0)
walk hero(0,right,5)
wait for hero(0)
walk hero(0,up,1)
wait for hero(0)
walk hero(0,right,5)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==62,and,heroy(0)==44) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,left,4)
focus camera(48,46,20)
wait for hero(0)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,left,5)
wait for hero(0)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,left,5)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==40,and,heroy(0)==53) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,down,7)
focus camera(40,60,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==40,and,heroy(0)==59) then(
set variable(time,0)
set hero speed(0,10)
walk hero(0,up,7)
focus camera(40,52,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==50,and,heroy(0)==43) then(
set variable(time,0)
variable(i)
for(i,44,47,1) do(
write pass block(50,i,0))
set hero speed(0,10)
walk hero(0,down,10)
focus camera(50,53,20)
wait for camera
wait for hero(0)
for(i,44,47,1) do(
write pass block(50,i,128))
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==50,and,heroy(0)==52) then(
set variable(time,0)
variable(j)
for(j,44,47,1) do(
write pass block(50,j,0))
set hero speed(0,10)
walk hero(0,up,10)
focus camera(50,42,20)
wait for camera
wait for hero(0)
for(i,44,47,1) do(
write pass block(50,i,128))
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==41,and,heroy(0)==57) then(
set variable(time,0)
write pass block(40,57,0)
set hero speed(0,10)
walk hero(0,left,15)
focus camera(26,57,20)
wait for camera
wait for hero(0)
write pass block(40,57,128)
set hero speed(0,5)
camera follows hero(0)
)
)
do(
if(herox(0)==27,and,heroy(0)==57) then(
set variable(time,0)
write pass block(40,57,0)
set hero speed(0,10)
walk hero(0,right,15)
focus camera(42,57,20)
wait for camera
wait for hero(0)
write pass block(40,57,128)
set hero speed(0,5)
camera follows hero(0)
)
)


palout(time)

if(herox(0)==35,and,heroy(0)==65) then(
teleport to map(89,3,7)
wait(1)
load tileset(phase set+4)
alter NPC(35,NPCstat:script argument,phase set+4)
wait(1))
else(
if(herox(0)==73,and,heroy(0)==47) then(
teleport to map(89,2,22)
wait(1)
load tileset(phase set+4)
alter NPC(35,NPCstat:script argument,phase set+4)
wait(1))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

########################
script, cabindoor, phase set, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

palout(time)

if(herox(0)==3,and,heroy(0)==8) then(
teleport to map(94,35,66)
wait(1)
load tileset(phase set--4)
alter NPC(35,NPCstat:script argument,phase set--4)
wait(1))
else(
if(herox(0)==2,and,heroy(0)==23) then(
teleport to map(94,73,48)
wait(1)
load tileset(phase set--4)
alter NPC(35,NPCstat:script argument,phase set--4)
wait(1))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

############################
script, flashbackload, begin

#####race flashback
if (check tag(102)==false) then(
set npc position(1,44,47)
set npc position(2,42,45)
set npc position(3,39,46)
set npc position(4,33,42)
set npc position(5,34,42)
set npc direction(2,down)
set npc direction(4,right)
set npc direction(5,left)
alter npc(1,NPCstat:move type,NPCmovetype:wander)
alter npc(3,NPCstat:move type,NPCmovetype:wander)
alter npc(4,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(5,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(1,NPCstat:display text,1801)
alter npc(2,NPCstat:display text,1807)
alter npc(3,NPCstat:display text,1804)
alter npc(4,NPCstat:display text,1795)
alter npc(5,NPCstat:display text,1798)

alter npc(1,NPCstat:palette,30)
alter npc(2,NPCstat:palette,102)
alter npc(3,NPCstat:palette,46)
alter npc(4,NPCstat:palette,106)
alter npc(5,NPCstat:palette,110)


alter npc(10,NPCstat:palette,94)
alter npc(11,NPCstat:palette,10)
alter npc(12,NPCstat:palette,146)
alter npc(10,NPCstat:displaytext,6762)
alter npc(11,NPCstat:displaytext,6763)
alter npc(12,NPCstat:displaytext,6764)
alter npc(10,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(11,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(12,NPCstat:move type,NPCmovetype:wander)
alter npc(12,NPCstat:move speed,4)
set npc position(10,68,44)
set npc position(11,69,44)
set npc position(12,69,46)

alter npc(22,NPCstat:palette,2)
alter npc(22,NPCstat:displaytext,7423)
set npc position(22,36,45)
alter npc(22,NPCstat:move type,NPCmovetype:wander)
alter npc(22,NPCstat:movespeed,2)
)

#####manx flashback
if (check tag(126)==false,and,check tag(102)) then(
set npc position(5,12,18)
set npc direction(5,up)
alter npc(5,NPCstat:palette,111)
alter npc(5,NPCstat:display text,2059)
alter npc(5,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
)

#####fourth flashback
if (check tag(137)==false,and,check tag(126),and,check tag(102)) then(
set npc position(1,39,68)
set npc position(2,60,15)
set npc position(3,35,42)
set npc position(4,41,17)
set npc position(5,45,17)
set npc position(6,43,14)
set npc position(7,43,15)
set npc position(8,43,16)
set npc position(10,12,44)
set npc position(11,14,45)
set npc position(12,16,47)
set npc position(17,71,51)
set npc position(18,68,45)
set npc position(19,39,46)
set npc position(20,45,38)
set npc position(22,44,47)
alter npc(6,NPCstat:picture,351)
alter npc(7,NPCstat:picture,351)
alter npc(8,NPCstat:picture,351)
alter npc(8,NPCstat:palette,153)
set npc direction(6,down)
set npc direction(7,right)
set npc direction(8,up)
set npc direction(10,down)
set npc direction(11,left)
set npc direction(20,up)
alter npc(8,NPCstat:activation,NPCactivation:stepon)
alter npc(2,NPCstat:move type,NPCmovetype:wander)
alter npc(5,NPCstat:move type,NPCmovetype:wander)
alter npc(12,NPCstat:move type,NPCmovetype:wander)
alter npc(12,NPCstat:move speed,2)
alter npc(18,NPCstat:move type,NPCmovetype:wander)
alter npc(18,NPCstat:move speed,1)
alter npc(19,NPCstat:move type,NPCmovetype:wander)
alter npc(19,NPCstat:move speed,1)
alter npc(22,NPCstat:move type,NPCmovetype:wander)
alter npc(22,NPCstat:move speed,1)
alter npc(6,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
alter npc(7,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
alter npc(8,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
alter npc(1,NPCstat:display text,2310)
alter npc(2,NPCstat:display text,2326)
alter npc(3,NPCstat:display text,2323)
alter npc(4,NPCstat:display text,2316)
alter npc(5,NPCstat:display text,2320)
alter npc(7,NPCstat:display text,2313)
alter npc(10,NPCstat:display text,6780)
alter npc(11,NPCstat:display text,6781)
alter npc(12,NPCstat:display text,6782)
alter npc(17,NPCstat:display text,6783)
alter npc(18,NPCstat:display text,6784)
alter npc(19,NPCstat:display text,6785)
alter npc(20,NPCstat:display text,6786)
alter npc(22,NPCstat:display text,7426)
if(check tag(138)) then(
alter npc(4,NPCstat:picture,352)
alter npc(4,NPCstat:displaytext,2319))
)

#####fifth flashback
if (check tag(186)==false,and,check tag(137),and,check tag(126),and,check tag(102)) then(
set npc position(17,15,45)
set npc position(18,43,59)
set npc position(19,74,48)
set npc position(20,68,45)
set npc position(22,44,47)
alter npc(20,NPCstat:move type,NPCmovetype:wander)
alter npc(20,NPCstat:move speed,1)
alter npc(22,NPCstat:move type,NPCmovetype:wander)
alter npc(22,NPCstat:move speed,1)
alter npc(17,NPCstat:display text,6788)
alter npc(18,NPCstat:display text,6789)
alter npc(19,NPCstat:display text,6791)
alter npc(20,NPCstat:display text,6792)
alter npc(22,NPCstat:display text,7427)
)

#####fifth flashback --part two--
if (check tag(187)==false,and,check tag(186),and,check tag(137),and,check tag(126),and,check tag(102)) then(

)

#####---FINAL FLASH--- flashback
if (check tag(187),and,check tag(186),and,check tag(137),and,check tag(126),and,check tag(102)) then(
set npc position(1,43,47)
set npc position(3,63,14)
set npc position(4,70,45)
set npc position(5,36,44)
set npc position(10,10,46)
set npc position(11,11,44)
set npc position(12,12,48)
set npc position(17,68,44)
set npc position(22,53,57)
alter npc(1,NPCstat:palette,32)
alter npc(2,NPCstat:palette,104)
alter npc(3,NPCstat:palette,48)
alter npc(4,NPCstat:palette,108)
alter npc(5,NPCstat:palette,112)
alter npc(10,NPCstat:palette,96)
alter npc(11,NPCstat:palette,12)
alter npc(12,NPCstat:palette,148)
alter npc(17,NPCstat:palette,260)
alter npc(22,NPCstat:palette,4)
set npc direction(3,right)
set npc direction(10,right)
set npc direction(11,down)
set npc direction(12,up)
alter npc(1,NPCstat:move type,NPCmovetype:wander)
alter npc(4,NPCstat:move type,NPCmovetype:wander)
alter npc(5,NPCstat:move type,NPCmovetype:wander)
alter npc(22,NPCstat:move type,NPCmovetype:wander)
alter npc(22,NPCstat:move speed,1)
alter npc(3,NPCstat:when activated,NPCwhenactivated:donotfaceplayer)
alter npc(1,NPCstat:display text,3521)
alter npc(3,NPCstat:display text,3527)
alter npc(4,NPCstat:display text,3533)
alter npc(5,NPCstat:display text,3530)
alter npc(10,NPCstat:display text,6795)
alter npc(11,NPCstat:display text,6796)
alter npc(12,NPCstat:display text,6797)
alter npc(17,NPCstat:display text,6798)
alter npc(22,NPCstat:display text,7428)

if(check tag(203)==false) then(
set npc position(2,43,17)
alter npc(2,NPCstat:move type,NPCmovetype:wander)
alter npc(2,NPCstat:display text,3524))
else(
set npc position(2,14,46)
set npc direction(2,left)
alter npc(2,NPCstat:move type,NPCmovetype:standstill)
alter npc(2,NPCstat:whenactivated,NPCwhenactivated:donotfaceplayer)
alter npc(2,NPCstat:script,137))
)

end
###

###############################
script, flashbackraceone, _switch, begin
suspend player
suspend npcs

#npc player steps on starts the race with the argument of 7
#otherwise, it sets up the race at the end of katina chatter
if(_switch==7) then(

stop song

suspend box advance
wait(15)

set hero speed(0,10)
alter npc(1,NPCstat:movespeed,10)
alter npc(2,NPCstat:movespeed,10)
alter npc(3,NPCstat:movespeed,10)
alter npc(4,NPCstat:movespeed,10)
alter npc(5,NPCstat:movespeed,10)

jig npc(16)
show text box(6800)
wait for key(usekey)
advance text box
wait(10)
jig npc(16)
show text box(6801)
play song(72)
wait(2)

walk npc(1,right,6)
walk hero(0,right,6)
wait(1)
walk npc(5,right,6)
wait(1)
walk npc(2,right,6)
wait(1)
walk npc(3,right,6)
wait(2)
walk npc(4,right,6)
wait(5)

palout(5)
wait for npc(4)
advance text box

wait(5)
show backdrop(0)
wait(1)
show text box(1817)
palin(3)
wait for key(use key)
palout(3)
advance text box
show map
load tileset(92)
camera follows hero(0)
set hero position(0,40,88)
wait(1)
pan camera(south,0,0)
set hero position(0,30,88)
set npc position(1,32,87)
wait(15)
walk hero(0,right,30)
walk npc(1,right,30)
pan camera(right,7,2)
palin(5)
wait for camera
pan camera(right,2,2)
palout(5)
wait for camera
wait for hero(0)
wait for npc(1)

wait(5)
show backdrop(0)
wait(1)
show text box(1818)
palin(3)
wait for key(use key)
palout(3)
advance text box
show map
load tileset(92)
camera follows hero(0)
set hero position(0,65,109)
wait(1)
pan camera(south,0,0)
set hero position(0,65,100)
set npc position(1,66,101)
wait(15)
palin(5)
wait(15)
walk hero(0,down,5)
walk npc(1,down,5)
wait for hero(0)
walk hero(0,down,4)
walk hero(0,left,4)
wait for npc(1)
walk npc(1,down,4)
walk npc(1,left,4)
set hero direction(0,left)
set npc direction(1,left)
wait for hero(0)
walk hero(0,left,7)
wait for npc(1)
walk npc(1,left,8)
wait for npc(1)
wait(5)
palout(5)

wait(5)
show backdrop(0)
wait(1)
show text box(1819)
palin(3)
wait for key(use key)
palout(3)
advance text box
show map
load tileset(92)
camera follows hero(0)
set hero position(0,16,136)
wait(1)
pan camera(south,0,0)
set hero position(0,15,143)
set npc position(1,16,142)
wait(15)
walk hero(0,up,28)
walk npc(1,up,28)
pan camera(up,10,5)
palin(5)
wait for camera
pan camera(up,4,5)
palout(5)
wait for camera

wait(5)
show backdrop(0)
wait(1)
show text box(1820)
palin(3)
wait for key(use key)
advance text box
wait(12)
stop song
show text box(1821)
wait for key(use key)
advance text box
wait(2)
show text box(1822)
wait for key(use key)
advance text box
wait(6)
show text box(1823)
wait for key(use key)
palout(3)
advance text box

wait(15)

camera follows hero(0)
set hero position(0,53,60)
set hero direction(0,down)
set hero frame(0,0)
set hero speed(0,5)

variable(k)
for(k,103,114,1) do(
set tag(k,0))

set npc frame(1,0)
set npc frame(2,0)
set npc frame(3,0)
set npc frame(4,0)
set npc frame(5,0)
set npc frame(12,0)

set npc position(1,20,66)
set npc position(2,52,64)
set npc position(3,63,50)
set npc position(4,50,53)
set npc position(5,51,53)
set npc position(10,61,59)
set npc position(11,61,61)
set npc position(12,63,60)
set npc position(16,54,64)
set npc position(17,53,62)
set npc position(18,54,59)
set npc position(19,56,66)
set npc position(20,53,58)
set npc position(21,55,58)
set npc position(22,45,59)
alter npc(22,NPCstat:move type,NPCmovetype:wander)
alter npc(22,NPCstat:move speed,1)

set npc direction(1,down)
set npc direction(2,right)
set npc direction(3,up)
set npc direction(4,right)
set npc direction(5,left)
set npc direction(10,down)
set npc direction(11,up)
set npc direction(12,left)
set npc direction(16,left)
set npc direction(17,down)
set npc direction(18,up)
set npc direction(19,down)
set npc direction(20,right)
set npc direction(21,left)

alter npc(1,NPCstat:display text,1836)
alter npc(2,NPCstat:display text,1833)
alter npc(3,NPCstat:display text,1830)
alter npc(4,NPCstat:display text,1824)
alter npc(5,NPCstat:display text,1827)
alter npc(10,NPCstat:display text,6770)
alter npc(11,NPCstat:display text,6771)
alter npc(12,NPCstat:display text,6772)
alter npc(16,NPCstat:display text,6773)
alter npc(17,NPCstat:display text,6774)
alter npc(18,NPCstat:display text,6775)
alter npc(19,NPCstat:display text,6776)
alter npc(20,NPCstat:display text,6777)
alter npc(21,NPCstat:display text,6778)
alter npc(22,NPCstat:display text,7425)

alter npc(10,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(11,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(12,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(16,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(17,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(18,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(19,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(20,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(21,NPCstat:when activated,NPCwhenactivated:faceplayer)

alter npc(1,NPCstat:palette,31)
alter npc(2,NPCstat:palette,103)
alter npc(3,NPCstat:palette,47)
alter npc(4,NPCstat:palette,107)
alter npc(5,NPCstat:palette,111)
alter npc(10,NPCstat:palette,95)
alter npc(11,NPCstat:palette,11)
alter npc(12,NPCstat:palette,147)
alter npc(16,NPCstat:palette,255)
alter npc(17,NPCstat:palette,259)
alter npc(18,NPCstat:palette,131)
alter npc(19,NPCstat:palette,219)
alter npc(20,NPCstat:palette,199)
alter npc(21,NPCstat:palette,167)
alter npc(22,NPCstat:palette,3)
set hero palette(0,3)

show map
load tileset(93)
wait(1)
play song(33)
palin(5)

resume box advance
)

else(
palout(3)

set npc position(1,22,85)
set npc position(2,22,87)
set npc position(3,22,86)
set npc position(4,22,89)
set npc position(5,22,90)
set npc position(16,23,84)
set npc position(17,17,86)
set npc position(18,18,87)
set npc position(19,16,89)
set npc position(20,11,88)

set npc direction(16,down)
set npc direction(17,right)
set npc direction(18,right)
set npc direction(19,right)
set npc direction(20,right)

alter npc(17,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(18,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(19,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(20,NPCstat:when activated,NPCwhenactivated:faceplayer)

variable(i)
for(i,1,5,1) do(
set npc direction(i,right)
set npc frame(i,0)
alter npc(i,NPCstat:when activated,NPCwhenactivated:faceplayer)
)

alter npc(1,NPCstat:move type,NPCmovetype:stand still)
alter npc(3,NPCstat:move type,NPCmovetype:stand still)

alter npc(1,NPCstat:display text,1814)
alter npc(2,NPCstat:display text,1813)
alter npc(3,NPCstat:display text,1815)
alter npc(4,NPCstat:display text,1812)
alter npc(5,NPCstat:display text,1816)

alter npc(17,NPCstat:display text,6766)
alter npc(18,NPCstat:display text,6767)
alter npc(19,NPCstat:display text,6768)
alter npc(20,NPCstat:display text,6769)

alter npc(22,NPCstat:move type,NPCmovetype:standstill)
alter npc(22,NPCstat:when activated,NPCwhenactivated:faceplayer)
alter npc(22,NPCstat:display text,7424)
set npc position(22,15,85)
set npc direction(22,right)

camera follows hero(0)
set hero position(0,17,87)
set hero direction(0,right)
set hero frame(0,0)
wait(1)
pan camera(south,0,0)
set hero position(0,17,88)
wait(15)
palin(5)
)

resume npcs
resume player
end
###

###############################
script, flashbackracetwo, begin
suspend player
suspend box advance
text out(1)
wait(1)
show text box(1842)
wait(2)
text in(2)
wait for key(use key)
text out(2)
advance text box
textin(1)
show text box(1843)
wait for key(use key)
advance text box
textout(1)
wait(1)
show text box(1844)
wait(2)
textin(2)
wait for key(use key)
palout(10)
advance text box

teleport to map(27,124,80)
stop song
wait(1)
resume box advance
pan camera(south,0,0)
swap by position(find hero(0),0)
set hero picture(0,191)
set hero palette(0,4)
set hero frame(0,0)
set hero direction(0,down)
put hero(0,(122*20),(80*20)+5)
alter npc(1,NPCstat:picture,192)
alter npc(1,NPCstat:movespeed,5)
set npc direction(1,right)
set npc frame(1,0)
put npc(1,(122*20)+9,(80*20)+6)
alter npc(2,NPCstat:picture,177)
set npc direction(2,down)
set npc frame(2,0)
set npc position(2,124,78)
alter npc(2,NPCstat:movespeed,2)
wait(15)
palin(10)

wait(20)
put npc(1,(122*20)+8,(80*20)+6)
wait(2)
put npc(1,(122*20)+9,(80*20)+6)
wait(2)
alter npc(2,NPCstat:picture,170)
wait(4)
alter npc(2,NPCstat:picture,178)
wait(12)

variable(i)
for(i,1,3,1) do(
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0))
wait(6)
set npc frame(1,1)
wait(15)
set npc direction(1,up)
wait(2)
put npc(1,(122*20)+15,(80*20))
set npc direction(1,left)
wait(5)
alter npc(1,NPCstat:picture,74)
set npc direction(1,down)
put npc(1,(123*20),(80*20))
set npc frame(1,0)
wait(20)
alter npc(2,NPCstat:picture,169)
set npc direction(2,right)
for(i,1,4,1) do(
wait(1)
set npc frame(2,1)
wait(1)
set npc frame(2,0))

play song(84)
show text box(1845)
for(i,1,2,1) do(
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0))
wait for text box
alter npc(1,NPCstat:picture,12)
wait(2)
set npc direction(1,right)
wait(2)
set npc direction(1,up)
show text box(1846)
jig npc(1)
wait for text box
jig npc(2)
tb(1847)
alter npc(1,NPCstat:picture,80)
walk npc(1,up,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait(2)
set npc frame(1,1)
alter npc(2,NPCstat:picture,13)
walk npc(2,right,1)
set npc direction(2,left)
wait(2)
set npc frame(1,0)
jig npc(1)
show text box(1848)
wait for npc(2)
set npc frame(2,0)
wait for text box
jig npc(2)
tb(1849)
set npc direction(1,down)
wait(2)
alter npc(1,NPCstat:picture,78)
wait(2)
alter npc(1,NPCstat:picture,79)
show text box(1850)
wait(2)
set npc frame(1,1)
wait for text box
wait(8)
jig npc(2)
tb(1851)
wait(10)
show text box(1852)
set npc frame(1,0)
wait for text box
jig npc(2)
tb(1853)
alter npc(1,NPCstat:picture,12)
wait(2)
set npc direction(1,right)
show text box(1854)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
wait(2)
set npc frame(1,1)
walk npc(2,right,1)
set npc direction(2,left)
wait(2)
set npc frame(1,0)
jig npc(1)
wait for npc(2)
set npc frame(2,0)
wait for text box
jig npc(2)
tb(1855)
wait(2)
alter npc(2,NPCstat:picture,169)
set npc direction(2,down)
wait(6)
jig npc(2)
tb(1856)
wait(2)
put hero(0,(122*20)+1,(80*20)+5)
wait(2)
put hero(0,(122*20),(80*20)+5)
stop song
show text box(1857)
wait(2)
put hero(0,(122*20)+1,(80*20)+5)
wait(2)
put hero(0,(122*20),(80*20)+5)
wait for text box
walk npc(1,left,1)
alter npc(2,NPCstat:picture,13)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
jig npc(1)
tb(1858)
wait(2)
set hero frame(0,1)
wait(10)
set hero frame(0,0)
set hero direction(97,down)
set hero picture(0,97)
put hero(0,(122*20),(80*20))
wait(2)
set hero direction(0,up)
wait(2)
set hero picture(0,41)
set hero direction(0,right)
wait(5)
set hero picture(0,39)
wait(10)
play song(15)
tb(1859)
alter npc(2,NPCstat:movespeed,4)
walk npc(2,down,2)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
jig npc(2)
tb(1860)
set hero picture(0,1)
jig npc(0)
tb(1861)
alter npc(2,NPCstat:picture,169)
set npc direction(2,down)
jig npc(2)
tb(1862)
alter npc(1,NPCstat:picture,80)
set npc direction(1,right)
jig npc(1)
tb(1863)
wait(4)
set hero direction(0,down)
wait(2)
set hero picture(0,51)
set hero direction(0,left)
wait(12)
set hero picture(0,49)
wait(4)
set hero picture(0,50)
wait(15)
stop song
tb(1864)
set hero picture(0,1)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
jig hero(0)
play song(91)
show text box(1865)
wait(2)
set npc direction(1,down)
wait for text box
alter npc(2,NPCstat:picture,13)
set npc direction(2,left)
jig npc(2)
tb(1866)
jig hero(0)
tb(1867)
jig npc(1)
tb(1868)
wait(2)
jig npc(2)
tb(1869)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)
wait(2)
set npc direction(1,right)
tb(1870)
set npc direction(2,up)
jig npc(2)
tb(1871)
jig hero(0)
show text box(1872)
wait(2)
set npc direction(2,left)
wait for text box
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
jig npc(2)
tb(1873)
tb(1874)
jig hero(0)
show text box(1875)
wait(2)
set npc direction(1,up)
wait for text box
wait(5)
palout(5)
stop song
camera follows hero(0)
unlock hero(find hero(1))
swap in hero(find hero(1))
unlock hero(find hero(2))
swap in hero(find hero(2))
#special cases
if(read global(34)==84,and,read global(35)==16) then(
	write global(35,read global(35)+1)
)
if(read global(34)==10,and,read global(35)==32) then(
	write global(34,read global(34)+1)
)
wait(1)
#clearing area of npcs, save for doors
set npc position(npc at spot(read global(34)--1,read global(35)--1),0,0)
set npc position(npc at spot(read global(34),read global(35)--1),0,0)
set npc position(npc at spot(read global(34)+1,read global(35)--1),0,0)
set npc position(npc at spot(read global(34)--1,read global(35)),0,0)
set npc position(npc at spot(read global(34),read global(35)),0,0)
set npc position(npc at spot(read global(34)+1,read global(35)),0,0)
set npc position(npc at spot(read global(34)--1,read global(35)+1),0,0)
set npc position(npc at spot(read global(34),read global(35)+1),0,0)
set npc position(npc at spot(read global(34)+1,read global(35)+1),0,0)
wait(1)
create npc(35,9,32)
create npc(35,84,15)
create npc(35,240,32)
wait(1)
set party in
set hero position(0,read global(34),read global(35))
set hero direction(0,right)
set variable(hour,morningtime)
set tag (3,1)
set tag (4,0)
set tag (5,0)
set tag (6,0)
set hp
#set npc position(npc at spot(herox(0)--1,heroy(0)--1),0,0)
#set npc position(npc at spot(herox(0),heroy(0)--1),0,0)
#set npc position(npc at spot(herox(0)+1,heroy(0)--1),0,0)
#set npc position(npc at spot(herox(0)--1,heroy(0)),0,0)
#set npc position(npc at spot(herox(0)+1,heroy(0)),0,0)
#set npc position(npc at spot(herox(0)--1,heroy(0)+1),0,0)
#set npc position(npc at spot(herox(0),heroy(0)+1),0,0)
#set npc position(npc at spot(herox(0)+1,heroy(0)+1),0,0)
write pass block(84,15,1+2+4+8)
wait(1)
set tag(102,1)
set variable(isrunning,1)
set npc position(npc at spot(0,0),herox(0),heroy(0)+1)
set npc position(npc at spot(1,0),herox(0),heroy(0)--1)
set npc position(npc at spot(2,0),herox(0)+1,heroy(0))
set npc position(npc at spot(3,0),herox(0)--1,heroy(0))
palin(5)
if(check equipment(find hero(0),4)==186) then(unequip(find hero(0),4))
if(check equipment(find hero(1),4)==186) then(unequip(find hero(1),4))
if(check equipment(find hero(2),4)==186) then(unequip(find hero(2),4))
if(check equipment(find hero(0),5)==187) then(unequip(find hero(0),5))
if(check equipment(find hero(1),5)==187) then(unequip(find hero(1),5))
if(check equipment(find hero(2),5)==187) then(unequip(find hero(2),5))
delete item(186,1)
delete item(187,1)
innrest
#turn on rest and avis items, turn off enemy encounter blocker
set tag(433,0)
set tag(280,0)
set tag(604,0)
wait(1)
save game
play song(90)
resume box advance
resume player
end
###

#####################
script, rts go, doinit, begin

if( doinit==1 ) then( run real time system(true) )
else( run real time system )
wait(1)

end
###

###################################
script, scenethreepointthree, begin

camera follows hero(0)
teleport to map(28+poff,15,20)
stop song
wait(1)
pan camera(south,0,0)
alter npc(3,NPCstat:picture,180)
set npc direction(3,down)
set npc frame(3,0)
set npc position(3,16,19)
set hero position(0,6,20)
walk hero(0,right,6)
wait(2)
variable(i)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(3))
set variable(ny,npc pixel y(3))
palin(3)
wait for hero(0)
walk hero(0,right,1)
wait(1)
put npc(3,nx--1,ny)
show text box(1876)
wait(2)
put npc(3,nx,ny)
wait for hero(0)
set hero frame(0,0)
wait for text box

wait(10)
for(i,1,4,1) do(
put npc(3,random(nx--1,nx+1),random(ny--1,ny+1))
wait(1)
)
wait(10)
for(i,1,4,1) do(
put npc(3,random(nx--1,nx+1),random(ny--1,ny+1))
wait(1)
)
put npc(3,nx,ny)
set npc frame(3,1)
wait(5)
alter npc(3,NPCstat:picture,138)
set npc frame(3,0)
wait(6)
play song(15)
tb(1877)

set party out
swap by position(find hero(0),0)
set hero speed(0,4)
set npc position(1,herox(0),heroy(0))
walk npc(1,up,1)
set npc position(2,herox(0),heroy(0))
walk npc(2,left,1)
wait for npc(1)
set npc direction(1,right)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)
wait(2)
jig hero(0)
tb(1878)
wait(2)
jig npc(3)
tb(1879)
jig npc(1)
tb(1880)
tb(1881)
wait(2)
set npc direction(3,right)
wait(8)
jig npc(3)
tb(1882)
jig hero(0)
tb(1883)
wait(2)
set npc direction(3,down)
wait(2)
walk npc(3,down,1)
wait(2)
show text box(1884)
wait for npc(3)
set npc frame(3,0)
wait(2)
set npc direction(3,left)
wait for text box
wait(2)
alter npc(3,NPCstat:picture,199)
tb(1885)
jig hero(0)
tb(1886)
jig npc(3)
tb(1887)
alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
jig npc(1)
tb(1888)
wait(2)
set npc frame(3,1)
tb(1889)
jig hero(0)
tb(1890)
alter npc(1,NPCstat:picture,12)
set npc direction(1,right)
show text box(1891)
wait(1)
set npc frame(3,0)
wait(1)
alter npc(3,NPCstat:picture,200)
wait for text box
wait(2)
alter npc(3,NPCstat:picture,199)
wait(6)
set npc frame(3,1)
tb(1892)
alter npc(1,NPCstat:movespeed,2)
walk npc(2,up,1)
wait(2)
stop song
show text box(1893)
wait for npc(2)
walk npc(2,right,1)
wait(2)
walk npc(1,up,1)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
wait for npc(1)
set npc frame(1,0)
wait for text box
wait(4)
jig npc(2)
tb(1894)
wait(5)
set npc direction(1,right)
alter npc(3,NPCstat:picture,138)
set npc frame(3,0)
wait(3)
jig npc(3)
play song(75)
tb(1895)
set npc direction(1,down)
jig npc(1)
tb(1896)
set npc direction(2,up)
jig npc(2)
tb(1897)
set npc direction(2,right)
wait(4)
alter npc(2,NPCstat:movespeed,2)
walk npc(2,right,1)
wait(2)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
wait(10)
jig npc(2)
tb(1898)
wait(5)
jig npc(2)
tb(1899)
wait(4)
jig npc(3)
stop song
tb(1900)
set variable(nx,npc pixel x(2))
set variable(ny,npc pixel y(2))
put npc(2,nx,ny--2)
wait(1)
put npc(2,nx,ny)
show text box(1901)
wait(1)
put npc(2,nx,ny--2)
wait(1)
put npc(2,nx,ny)
wait for text box
wait(2)
alter npc(3,NPCstat:picture,199)
wait(2)
set npc direction(3,up)
wait(5)
tb(1902)

palout(5)
variable(savemap)
set variable(savemap,current map)
camera follows hero(0)
teleport to map(95,19,8)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
set npc position(2,0,0)
load tileset(28)
alter npc(3,NPCstat:palette,66)
alter npc(4,NPCstat:palette,62)
alter npc(5,NPCstat:palette,130)
alter npc(6,NPCstat:palette,58)
alter npc(7,NPCstat:palette,150)
alter npc(8,NPCstat:palette,50)
wait(1)
focus camera(42,8,2)
wait(6)
palin(8)
play song(17)
wait(15)
tb(1903)
wait for camera
wait(12)
tb(1904)
wait(5)
palout(8)
camera follows hero(0)
teleport to map(savemap,15,20)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,13,20)
set hero direction(0,right)
set npc position(1,13,18)
set npc direction(1,right)
set npc position(2,14,19)
set npc direction(2,right)
set npc position(3,16,20)
set npc direction(3,left)
wait(5)
palin(5)

wait(2)
tb(1905)
set hero picture(0,38)
set hero frame(0,1)
wait(2)
set hero picture(0,39)
tb(1906)
set hero frame(0,0)
tb(1907)
jig npc(3)
tb(1908)

palout(8)
set variable(savemap,current map)
camera follows hero(0)
set hero picture(0,1)
teleport to map(30,54,12)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
set npc position(30,56,14)
set npc position(31,55,14)
set npc direction(30,left)
set npc direction(31,right)
wait(5)
palin(8)
play song(17)
wait(2)
jig npc(30)
set npc frame(30,1)
walk npc(31,left,1)
set npc direction(31,right)
wait(2)
set npc frame(30,0)
wait for npc(31)
set npc frame(31,0)
walk npc(30,left,1)
wait for npc(30)
set npc frame(30,0)
wait(8)
set npc direction(3,down)
set npc position(3,56,11)
wait(2)
set npc direction(30,up)
wait(5)
walk npc(3,down,3)
walk npc(30,down,1)
wait for npc(30)
suspend npc walls
alter npc(30,NPCstat:picture,347)
walk npc(30,down,5)
set npc direction(30,right)
wait for npc(3)
set npc frame(3,0)
wait for npc(30)
wait(15)
resume npc walls
tb(1909)
wait(5)
tb(1910)
wait(5)
palout(5)
camera follows hero(0)
teleport to map(savemap,15,20)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,13,20)
set hero direction(0,right)
set npc position(1,13,18)
set npc direction(1,right)
set npc position(2,14,19)
set npc direction(2,right)
set npc position(3,16,20)
set npc direction(3,left)
wait(5)
palin(5)

wait(10)
jig npc(2)
play song(91)
tb(1911)
walk npc(1,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
jig npc(1)
tb(1912)
jig npc(2)
tb(1913)
alter npc(3,NPCstat:picture,199)
jig npc(3)
tb(1914)
tb(1915)
wait(2)
set npc direction(3,up)
wait(6)
tb(1916)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(1917)
alter npc(3,NPCstat:picture,138)
set npc direction(3,left)
jig npc(3)
tb(1918)
wait(2)
set npc direction(3,up)
jig npc(3)
tb(1919)
alter npc(3,NPCstat:movespeed,2)
walk npc(3,up,1)
wait(2)
show text box(1920)
wait for npc(3)
set npc frame(3,0)
wait(12)
set npc direction(3,left)
wait(2)
set npc direction(3,down)
wait(4)
set npc frame(3,1)
alter npc(3,NPCstat:picture,180)
wait(2)
set npc frame(3,0)
wait for text box

wait(4)
pan camera(right,10,2)
wait(4)
walk hero(0,right,1)
walk npc(2,down,1)
walk npc(1,right,1)
wait for hero(0)
walk hero(0,right,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(1)
walk npc(1,down,1)
wait for hero(0)
walk hero(0,right,10)
wait for npc(2)
walk npc(2,right,10)
wait for npc(1)
walk npc(1,right,10)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(2)
walk npc(2,up,1)
wait for npc(1)
set npc frame(1,0)
set hero direction(0,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait(2)
set npc direction(2,down)
wait for camera

alter npc(2,NPCstat:picture,170)
wait(6)
jig hero(0)
alter npc(2,NPCstat:picture,177)
tb(1921)
show text box(1922)
set hero picture(0,49)
wait(2)
set hero picture(0,51)
wait(6)
set hero picture(0,49)
wait(2)
set hero picture(0,50)
wait(6)
wait for text box
jig npc(1)
alter npc(2,NPCstat:picture,170)
show text box(1923)
wait(2)
alter npc(2,NPCstat:picture,178)
set hero picture(0,49)
wait for text box
alter npc(2,NPCstat:picture,13)
jig npc(2)
tb(1924)
set npc direction(1,up)
jig npc(1)
tb(1925)
set variable(nx,npcx(2)*20)
set variable(ny,npcy(2)*20)
put npc(2,nx,ny--2)
wait(2)
put npc(2,nx,ny)
tb(1926)
walk npc(1,up,1)
wait(2)
set npc direction(2,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
jig npc(1)
show text box(1927)
set hero picture(0,41)
wait for text box
jig npc(2)
tb(1928)
jig npc(1)
tb(1929)
jig npc(2)
tb(1930)
wait(2)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)
wait(2)
set npc direction(1,right)
tb(1931)
wait(2)
set hero picture(0,1)
jig hero(0)
show text box(1932)
set npc direction(1,left)
wait(2)
alter npc(2,NPCstat:picture,173)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
wait for text box
wait(2)
set npc frame(2,1)
wait(4)
set npc frame(2,0)
tb(1933)
alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
jig npc(1)
show text box(1934)
wait(2)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
wait for text box
wait(4)
set npc frame(2,1)
wait(4)
set npc frame(2,0)
stop song
tb(1935)
wait(2)
alter npc(1,NPCstat:picture,12)
set hero direction(0,down)
wait(2)
walk npc(1,down,1)
walk hero(0,right,8)
wait(2)
set npc direction(2,down)
wait for npc(1)
walk npc(1,left,8)
pan camera(up,1,1)
wait for camera
wait for npc(1)
wait for hero(0)
set npc position(1,0,1)
set npc position(3,2,1)
set tag(116,1)
set tag(117,1)
swap out hero(0)
swap out hero(1)
lock hero(0)
lock hero(1)
set hero direction(0,down)
set hero frame(0,0)
set hero position(0,npcx(2),npcy(2))
wait(1)
set npc position(2,1,1)
set tag(115,1)
set tag(388,1)
#item rest & avis
set tag(433,1)
set tag(280,1)
set hero speed(0,hspeed)
camera follows hero(0)
set variable(isrunning,false)
wait(1)

if(check tag(3)) then(play song(71))
if(check tag(4)) then(play song(71))
if(check tag(5)) then(play song(71))
if(check tag(6)) then(play song(73))

end
###

########################
script, grinslime, begin
suspend player

if(check tag(118)==false) then(
set hero frame(0,0)
jig hero(0)
tb(2358)
set tag(118,1)
)

resume player
end
###

###########################
script, grinharmtile, begin
suspend player
suspend npcs

show backdrop(7)
wait(2)
show map
if(((get hero stat(find hero(0),0,current stat))--10)<<0) then(
set hero stat(find hero(0),0,1,current stat)
)else(
set hero stat(find hero(0),0,(get hero stat(find hero(0),0,current stat))--10,current stat)
)
if(((get hero stat(find hero(7),0,current stat))--10)<<0) then(
set hero stat(find hero(7),0,1,current stat)
)else(
set hero stat(find hero(7),0,(get hero stat(find hero(7),0,current stat))--10,current stat)
)
if(((get hero stat(find hero(8),0,current stat))--10)<<0) then(
set hero stat(find hero(8),0,1,current stat)
)else(
set hero stat(find hero(8),0,(get hero stat(find hero(8),0,current stat))--10,current stat)
)
if(((get hero stat(find hero(9),0,current stat))--10)<<0) then(
set hero stat(find hero(9),0,1,current stat)
)else(
set hero stat(find hero(9),0,(get hero stat(find hero(9),0,current stat))--10,current stat)
)

resume npcs
resume player
end
###

##############################
script, fralinintrodoor, begin
suspend player
set tag (8,1)
variable (time)
set variable (time,1)

if (herox(0)==59,and,heroy(0)==10) then(
set variable (time,0)
set hero speed (0,10)
pan camera (right,18,20)
walk hero (0,right,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
else(
if (herox(0)==59,and,heroy(0)==11) then(
set variable (time,0)
set hero speed (0,10)
pan camera (right,18,20)
walk hero (0,right,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==76,and,heroy(0)==10) then(
set variable (time,0)
set hero speed (0,10)
pan camera (left,18,20)
walk hero (0,left,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==76,and,heroy(0)==11) then(
set variable (time,0)
set hero speed (0,10)
pan camera (left,18,20)
walk hero (0,left,18)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==94,and,heroy(0)==26) then(
set variable (time,0)
set hero speed (0,10)
pan camera (down,9,20)
walk hero (0,down,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==94,and,heroy(0)==34) then(
set variable (time,0)
set hero speed (0,10)
pan camera (up,9,20)
walk hero (0,up,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==92,and,heroy(0)==63) then(
set variable (time,0)
set hero speed (0,10)
pan camera (down,27,20)
walk hero (0,down,7)
wait for hero(0)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(10,54,10)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,54,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==93,and,heroy(0)==63) then(
set variable (time,0)
set hero speed (0,10)
pan camera (down,27,20)
walk hero (0,down,7)
wait for hero(0)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(10,55,10)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,55,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==94,and,heroy(0)==63) then(
set variable (time,0)
set hero speed (0,10)
pan camera (down,27,20)
walk hero (0,down,7)
wait for hero(0)
palout(3)
wait for camera
camera follows hero(0)
teleport to map(10,56,10)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,56,5)
wait(5)
set hero speed(0,hspeed)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==19,and,heroy(0)==16) then(
set variable(time,0)
wait for hero(0)
wait(2)
set hero direction(0,down)
wait(2)
walk hero(0,right,1)
wait for hero(0))
)
do(
if (herox(0)==19,and,heroy(0)==17) then(
set variable(time,0)
wait for hero(0)
wait(2)
set hero direction(0,down)
wait(2)
walk hero(0,right,1)
wait for hero(0))
)
do(
if (herox(0)==127,and,(heroy(0)==52,or,heroy(0)==53)) then(
set variable (time,0)
set hero speed (0,10)
pan camera (right,17,20)
walk hero (0,right,17)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==143,and,(heroy(0)==52,or,heroy(0)==53)) then(
set variable (time,0)
set hero speed (0,10)
pan camera (left,17,20)
walk hero (0,left,17)
wait for hero (0)
set hero speed(0,hspeed)
camera follows hero)
)
do(
if (herox(0)==43,and,heroy(0)==67) then(
set variable (time,0)
set hero speed (0,10)
pan camera (up,9,20)
walk hero (0,up,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==43,and,heroy(0)==59) then(
set variable (time,0)
set hero speed (0,10)
pan camera (down,9,20)
walk hero (0,down,9)
wait for hero (0)
set hero speed (0,hspeed)
camera follows hero)
)
do(
if (herox(0)==115,and,heroy(0)==36) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
set hero position(0,162,88)
wait(1)
pan camera(south,0,0)
set hero position(0,162,93)
wait(1)
walk hero(0,up,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==162,and,heroy(0)==89) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,5)
wait(3)
palout(3)
wait for hero(0)
camera follows hero(0)
set hero position(0,115,37)
wait(1)
pan camera(south,0,0)
set hero position(0,115,32)
wait(1)
walk hero(0,down,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if (herox(0)==162,and,heroy(0)==77) then(
	set variable(time,0)
	walk hero(0,down,1)
	set hero direction(0,up)
	show text box(84)
	wait for hero(0)
	wait for text box)
)
do(
if(herox(0)==162,and,heroy(0)==56) then(
set variable(time,0)
palout(2)
teleport to map(69,3,6)
wait(1)
pan camera(south,0,0)
set hero position(0,3,8)
set pal(noon)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==99,and,heroy(0)==6) then(
	set variable(time,0)
	if(check tag(651)==false) then(
		set tag(651,1)
		get item(3,1)
		tb(7828)
	)
)
)
do(
#farmer's house, 6 gold
if(herox(0)==53,and,heroy(0)==6,and,check tag(718)==false) then(
	set variable(time,0)
	set tag(718,1)
	get money(6)
	tb(8272)
)
)
do(
#butter house, 2 HP
if(herox(0)==82,and,heroy(0)==35,and,check tag(720)==false) then(
	set variable(time,0)
	set tag(720,1)
	get item(50,2)
	tb(8274)
)
)
do(
#bar, 9 gold
if(herox(0)==81,and,heroy(0)==49,and,check tag(721)==false) then(
	set variable(time,0)
	set tag(721,1)
	get money(9)
	tb(8275)
)
)
do(
#manx's house, 1 HP+
if(herox(0)==109,and,heroy(0)==35,and,check tag(722)==false) then(
	set variable(time,0)
	set tag(722,1)
	get item(51,1)
	tb(8276)
)
)

palout(time)

if (herox(0)==51,and,heroy(0)==10) then(
teleport to map (97,6,7))
else(
if (herox(0)==94,and,heroy(0)==13) then(
teleport to map (97,5,25))
)
do(
if (herox(0)==87,and,heroy(0)==42) then(
teleport to map (97,7,60))
)
do(
if (herox(0)==85,and,heroy(0)==56) then(
teleport to map (97,11,80))
)
do(
if (herox(0)==104,and,heroy(0)==54) then(
teleport to map (97,9,101))
)
do(
if (herox(0)==105,and,heroy(0)==54) then(
teleport to map (97,10,101))
)
do(
if (herox(0)==107,and,heroy(0)==40) then(
teleport to map (97,3,118))
)
do(
if (herox(0)==122,and,heroy(0)==58) then(
teleport to map (97,3,135))
)
do(
if (herox(0)==112,and,heroy(0)==64) then(
teleport to map (97,3,153))
)

set hero frame(0,0)
palin(time)
set tag (8,0)
resume player
end
###

####################################
script, fralinindoorintrodoor, begin
suspend player
set tag (8,1)
variable (time)
set variable (time,1)

if (herox(0)==6,and,heroy(0)==20) then(
pan camera(up,0,0)
set variable (time,2)
walk hero(0,up,3)
wait for hero(0))
else(
if (herox(0)==1,and,heroy(0)==37) then(
pan camera(up,0,0)
set variable (time,2)
walk hero(0,down,2)
wait for hero(0))
)

palout(time)

if (herox(0)==6,and,heroy(0)==8) then(
teleport to map (96,51,11))
else(
if (herox(0)==6,and,heroy(0)==17) then(
camera follows hero(0)
teleport to map (97,1,36))
)
do(
if (herox(0)==5,and,heroy(0)==26) then(
teleport to map (96,94,14))
)
do(
if (herox(0)==1,and,heroy(0)==39) then(
camera follows hero(0)
teleport to map (97,6,21))
)
do(
if (herox(0)==7,and,heroy(0)==61) then(
teleport to map (96,87,43))
)
do(
if (herox(0)==11,and,heroy(0)==81) then(
teleport to map (96,85,57))
)
do(
if (herox(0)==9,and,heroy(0)==102) then(
teleport to map (96,104,55))
)
do(
if (herox(0)==10,and,heroy(0)==102) then(
teleport to map (96,105,55))
)
do(
if (herox(0)==3,and,heroy(0)==119) then(
teleport to map (96,107,41))
)
do(
if (herox(0)==3,and,heroy(0)==136) then(
teleport to map (96,122,59))
)
do(
if (herox(0)==3,and,heroy(0)==154) then(
teleport to map (96,112,65))
)
do(
if (herox(0)==3,and,heroy(0)==171) then(
teleport to map (96,159,22))
)
do(
if (herox(0)==4,and,heroy(0)==188) then(
teleport to map (96,133,80))
)
do(
if (herox(0)==3,and,heroy(0)==205) then(
teleport to map (96,57,37))
)
do(
if (herox(0)==3,and,heroy(0)==222) then(
teleport to map (96,25,80))
)

set hero frame(0,0)
palin(time)
set tag (8,0)
resume player
end
###

#########################
script, loadadlez2, begin

if(check tag(75)) then(
write map block(3,119,65)
write map block(3,118,33)
write pass block(3,119,0)
write pass block(3,118,0)
write pass block(3,117,128)
)

if(check tag(121)) then(
set npc position(3,2,209)
set npc position(4,3,209)
)

if(check tag(320),and,check tag(321)) then(set tag(322,1))

if(check tag(235)==false,and,check tag(6)==false) then(
alter npc(14,NPCstat:movetype,npcmovetype:wander)
alter npc(14,NPCstat:whenactivated,npcwhenactivated:changedirection)
)

if(check tag(349)==false) then(
write map block(4,36,read map block(3,36))
write map block(4,37,17)
)

end
###

###############################
script, keltanshopkeeper, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(384)) then(tb(6878))
else(
set tag(384,1)
scenethreepointfour
)

resume obstruction
resume npcs
resume player
end
###

##################################
script, scenethreepointfour, begin

set tag(388,0)
pan camera(south,0,0)

jig npc(4)
tb(1936)
jig hero(0)
tb(1937)
jig npc(4)
tb(1938)
jig hero(0)
tb(1939)
jig npc(4)
tb(1940)
wait(5)
jig hero(0)
tb(1941)
jig npc(4)
tb(1942)

set npc position(5,4,112)
walk npc(5,up,2)
wait(2)
set npc direction(4,down)
wait(2)
set hero direction(0,down)
wait for npc(5)

jig npc(4)
tb(1943)
stop song

set npc position(6,4,112)
walk npc(6,up,1)
wait for npc(6)
set npc position(7,4,112)
walk npc(6,left,1)
walk npc(7,up,1)
wait for npc(7)
set npc position(8,4,112)
walk npc(6,up,1)
walk npc(7,left,1)
walk npc(8,up,1)
wait for npc(8)
walk npc(7,left,1)
walk npc(8,left,1)
wait for npc(8)
walk npc(7,up,1)
walk npc(8,left,2)
wait for npc(8)
walk npc(8,up,1)
wait for npc(8)

wait(10)
jig hero(0)
tb(1944)
jig npc(4)
tb(1945)

palout(1)
camera follows hero
unlock hero(0)
unlock hero(1)
swap in hero(0)
swap in hero(1)
swap out hero(2)
lock hero(2)
swap by position(find hero(0),0)
swap by position(find hero(1),1)
teleport to map(28+poff,31,32)
stop song
wait(10)
pan camera(south,0,0)
set hero direction(0,right)
set hero picture(0,81)
palin(5)

wait(15)
alter npc(1,NPCstat:movespeed,2)
set npc position(1,22,32)
wait(1)
walk npc(1,right,1)
wait for npc(1)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,right,5)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc direction(1,right)
set npc frame(1,0)
wait(5)
jig npc(1)
tb(1946)
jig hero(0)
tb(1947)
alter npc(1,NPCstat:picture,82)
set npc direction(1,up)
tb(1948)
set hero picture(0,72)
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,left)
jig hero(0)
tb(1949)
wait(2)
set npc direction(1,left)
show text box(1950)
wait(2)
set hero picture(0,1)
wait for text box
set hero speed(0,2)
wait(7)
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
play song(32)
show text box(1951)
wait(2)
alter npc(1,NPCstat:picture,73)
set npc direction(1,down)
wait for text box
alter npc(1,NPCstat:movespeed,4)
alter npc(1,NPCstat:picture,12)
walk npc(1,left,1)
wait for npc(1)
set npc frame(1,0)
wait(10)
tb(1952)
jig hero(0)
tb(1953)
wait(2)
set npc direction(1,up)
wait(2)
set npc direction(1,right)
jig npc(1)
tb(1954)
wait(20)
jig hero(0)
tb(1955)
alter npc(1,NPCstat:picture,73)
set npc direction(1,down)
jig npc(1)
show text box(1956)
jig npc(1)
alter npc(1,NPCstat:picture,74)
wait(2)
set hero picture(0,72)
wait for text box
set hero speed(0,4)
walk hero(0,left,1)
wait(2)
show text box(1957)
wait for hero(0)
set hero frame(0,0)
wait for text box
tb(1958)
wait(2)
alter npc(1,NPCstat:picture,73)
wait(2)
alter npc(1,NPCstat:picture,75)
tb(1959)
wait(4)
jig hero(0)
tb(1960)
alter npc(1,NPCstat:picture,12)
set npc direction(1,right)
jig npc(1)
tb(1961)
wait(10)
set hero speed(0,2)
set hero direction(0,down)
wait(2)
walk hero(0,right,2)
wait for hero(0)
set hero frame(0,0)
wait(4)
set hero picture(0,81)
wait(5)
jig hero(0)
tb(1962)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
tb(1963)
set hero picture(0,1)
wait(4)
jig hero(0)
tb(1964)
jig npc(1)
tb(1965)
set hero direction(0,down)
wait(2)
set hero direction(0,left)
wait(5)
walk hero(0,left,2)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
stop song
tb(1966)
alter npc(1,NPCstat:picture,83)
set npc direction(1,down)
variable(i)
for(i,1,3,1) do(
set npc frame(1,1)
wait(1)
set npc frame(1,0)
wait(1)
)
show text box(1967)
for(i,1,2,1) do(
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait(2)
)
wait for text box
wait(5)

variable(hx)
variable(hy)
set variable(hx,herox(0))
set variable(hy,heroy(0))

put hero(0,(hx*20)--3,hy*20)
set hero frame(0,1)
wait(3)
put hero(0,(hx*20)--6,hy*20)
set hero frame(0,0)
wait(6)
jig hero(0)
tb(1968)
wait(4)

alter npc(1,NPCstat:picture,12)
set npc direction(1,right)

set variable(hx,npcx(1))
set variable(hy,npcy(1))

put npc(1,(hx*20)--2,hy*20)
set npc frame(1,1)
show text box(1969)
wait(3)
put npc(1,(hx*20)--4,hy*20)
set npc frame(1,0)
wait for text box
jig hero(0)
tb(1970)
wait(15)
suspend box advance
show text box(1971)
wait for key(use key)

palout(5)
advance text box
resume box advance

camera follows hero
teleport to map(32+poff,6,139)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
set npc position(2,7,139)
set npc position(4,5,139)
palin(2)

play song(15)

wait(4)
jig npc(2)
tb(1972)
set npc direction(4,right)
jig npc(4)
tb(1973)
set npc direction(4,down)

set variable(hx,camera pixel x)
set variable(hy,camera pixel y)
stop song
for(i,1,4,1) do(
put camera(hx+random(-2,2),hy+random(-2,2))
wait(1)
)
for(i,1,2,1) do(
put camera(hx+random(-2,2),hy+random(-2,2))
wait(2)
)
put camera(hx,hy)
jig npc(2)
suspend box advance
show text box(1974)
wait for key(use key)
palout(2)
advance text box
resume box advance
camera follows hero
teleport to map(28+poff,31,32)
stop song
wait(1)
pan camera(south,0,0)
set hero direction(0,right)
set npc position(1,28,32)
set npc direction(1,right)
wait(1)
palin(2)

set variable(hx,camera pixel x)
set variable(hy,camera pixel y)

wait(4)
for(i,1,2,1) do(
put camera(hx+random(-2,2),hy+random(-2,2))
wait(2)
)
put camera(hx,hy)
jig hero(0)
tb(1975)
set hero speed(0,4)
set hero direction(0,down)
wait(2)
walk hero(0,left,2)
wait(2)
show text box(1976)
wait for hero(0)
set hero frame(0,0)
wait for text box
alter npc(1,NPCstat:movespeed,4)
set npc direction(1,down)
wait(2)
walk npc(1,left,2)
walk hero(0,left,2)
wait for npc(1)
walk npc(1,up,4)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
walk hero(0,up,4)
wait(2)

palout(2)
wait for hero(0)
set tag(122,1)
set tag(8,1)
camera follows hero
teleport to map(32+poff,4,109)
stop song
wait(1)
pan camera(south,0,0)
set hero speed(0,hspeed)
set hero position(0,4,112)
set hero frame(0,0)
write map block(5,108,22)
set npc position(4,2,0)
wait(1)
palin(2)
play song(15)
wait(5)
walk hero(0,up,1)
wait for hero(0)
set tag(8,0)
set variable(isrunning,0)

end
###


#######################
script, gunfight, begin

palout(1)
camera follows hero
set hero position(0,6,139)
wait(1)
pan camera(south,0,0)
set hero position(0,6,144)
set npc position(4,5,139)
set npc position(2,7,139)
set npc position(5,4,141)
set npc position(6,5,141)
set npc position(7,6,141)
set npc position(8,7,141)
set npc direction(5,up)
set npc direction(6,up)
set npc direction(7,up)
set npc direction(8,up)
wait(2)
palin(1)

wait(5)
walk hero(0,up,2)
wait for hero(0)
suspend npcs
suspend obstruction
set npc position(1,herox(0),heroy(0))
walk npc(1,left,1)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
unlock hero(2)
swap in hero(2)
innrest
battleflash
set party in
set npc position(5,0,1)
set npc position(6,1,1)
set npc position(7,2,1)
set npc position(8,3,1)
ff(222+poff)
stop song
set party out
swap by position(find hero(0),0)

set npc direction(2,left)
jig npc(2)
play song(84)
show text box(1977)
walk hero(0,up,1)
walk npc(1,right,2)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
alter npc(1,NPCstat:picture,74)
wait for text box
set npc direction(4,right)
jig npc(4)
tb(1978)
set npc direction(4,down)
tb(1979)
alter npc(1,NPCstat:picture,73)
tb(1980)
wait(5)
jig npc(4)
tb(1981)
alter npc(1,NPCstat:picture,12)
jig npc(1)
tb(1982)
jig npc(2)
show text box(1983)
wait(3)
set npc direction(4,right)
wait for text box
jig npc(4)
tb(1984)
set npc direction(4,down)
tb(1985)
jig npc(2)
tb(1986)
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
jig npc(2)
show text box(1987)
wait(2)
set npc direction(4,right)
wait for text box
jig npc(4)
tb(1988)

wait(2)
set npc frame(4,1)
wait(3)
set npc frame(2,1)
wait(3)
set npc frame(4,0)
wait(3)
set npc frame(2,0)
wait(2)

jig npc(2)
tb(1989)
jig npc(4)
tb(1990)
jig npc(2)
tb(1991)
jig npc(4)
tb(1992)
jig npc(2)
tb(1993)
jig npc(4)
tb(1994)
tb(1995)

stop song
palout(2)
wait(1)
show backdrop(0)
wait(1)
palin(2)

tb(1996)
wait(2)
tb(1997)

palout(2)
show map
camera follows hero
teleport to map(28+poff,51,29)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
set hero picture(find hero(0),229,outside battle)
set hero picture(find hero(0),5,inside battle)
set hero picture(find hero(1),232,outside battle)
set hero picture(find hero(1),16,inside battle)
set hero picture(find hero(2),234,outside battle)
set hero picture(find hero(2),20,inside battle)
set default weapon(find hero(2),40)
set hero speed(0,4)
alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)
wait(1)
palin(2)
wait(2)
play song(82)

set hero position(0,51,27)
walk hero(0,down,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
set npc position(1,51,27)
walk npc(1,down,2)
set hero frame(0,0)
set hero direction(0,down)
wait(1)
set hero direction(0,right)
wait for npc(1)
walk npc(1,right,1)
wait for npc(1)
set npc position(2,51,27)
walk npc(2,down,1)
set npc frame(1,0)
set npc direction(1,down)
wait(1)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)

jig npc(1)
show text box(1998)
wait(2)
set npc direction(2,left)
wait(2)
set npc direction(2,up)
wait for text box
jig npc(2)
jig npc(2)
jig npc(2)
wait(2)
set npc direction(2,right)
wait(2)
set npc direction(2,down)
jig npc(2)
tb(1999)
jig npc(1)
tb(2000)
jig hero(0)
tb(2001)
jig npc(1)
tb(2002)

put npc(2,51*20,(28*20)--3)
wait(2)
put npc(2,51*20,28*20)

tb(2003)
set npc direction(1,up)
jig npc(1)
show text box(2004)
wait(2)
set hero picture(0,332)
wait for text box
jig hero(0)
tb(2005)
set npc direction(1,left)
alter npc(1,NPCstat:picture,334)
jig npc(1)
tb(2006)
wait(15)
jig npc(2)
tb(2007)
tb(2008)
set npc direction(1,up)
jig npc(1)
show text box(2009)
wait(2)
set hero picture(0,229)
wait for text box
jig hero(0)
stop song
show text box(2010)
wait(2)
set npc direction(1,left)
alter npc(1,NPCstat:picture,232)
wait for text box
jig npc(1)
show text box(2011)
wait(2)
set hero picture(0,331)
wait for text box
jig hero(0)
tb(2012)
wait(10)
alter npc(2,NPCstat:picture,329)
wait(5)
jig npc(2)
tb(2013)
set hero direction(0,up)
set hero picture(0,229)
jig hero(0)
tb(2014)
alter npc(2,NPCstat:picture,330)
jig npc(2)
tb(2015)

alter npc(2,NPCstat:picture,329)
walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
wait for hero(0)
wait for npc(1)
wait for npc(2)
set npc position(1,0,1)
set npc position(2,1,1)
alter npc(2,NPCstat:picture,234)
set hero frame(0,0)
set hero direction(0,down)
set hero speed(0,hspeed)

set npc position(npc at spot(0,0),herox(0),heroy(0)+1)
set npc position(npc at spot(1,0),herox(0),heroy(0)--1)
set npc position(npc at spot(2,0),herox(0)+1,heroy(0))
set npc position(npc at spot(3,0),herox(0)--1,heroy(0))

camera follows hero
set variable(isrunning,1)
set tag(8,0)
set tag(122,0)
#turn off no-leave keltan
set tag(117,0)
#tag 123 is desert clothing
set tag(123,1)
set tag(433,0)
set party in
wait(1)
save game

if(check tag(3)) then(play song(71))
if(check tag(4)) then(play song(71))
if(check tag(5)) then(play song(71))
if(check tag(6)) then(play song(73))

resume npcs
resume obstruction
end
###

#############################
script, threepointfive, begin
suspend player
suspend npcs
suspend obstruction
stop song

set tag(8,1)

#resuming item & avis
set tag(433,0)
set tag(280,0)

focus camera(31,20,2)

walk npc(5,right,2)
wait(2)
show text box(2016)
wait for npc(5)
set npc frame(5,0)
wait for text box
wait(2)
alter npc(5,NPCstat:picture,199)
wait(2)
set npc frame(5,1)
tb(2017)

play song(91)

alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)

set hero speed(0,4)
walk hero to y(0,20)
wait for hero(0)
set hero direction(0,left)
set hero frame(0,0)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,down,1)
walk npc(2,up,1)
wait for npc(1)
set npc direction(1,left)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,left)
set npc frame(2,0)

wait(2)
jig npc(2)
tb(2018)
alter npc(5,NPCstat:picture,138)
set npc frame(5,0)
jig npc(5)
tb(2019)
jig hero(0)
tb(2020)
wait(4)
set npc frame(5,1)
wait(4)
set npc frame(5,0)
wait(2)
tb(2021)
wait(2)
set npc direction(2,down)
wait(6)
alter npc(2,NPCstat:picture,330)
set npc direction(2,up)
jig npc(2)
jig npc(2)
stop song
show text box(2022)
wait(2)
set hero direction(0,up)
wait(2)
set npc direction(1,up)
wait for text box
tb(2023)
jig npc(5)
tb(2024)
alter npc(2,NPCstat:picture,234)
set npc direction(2,left)
jig npc(2)
tb(2025)
jig npc(1)
tb(2026)
set npc direction(2,down)
jig npc(2)
tb(2027)

wait(4)
tb(3815)
if(check tag(125)) then(
set hero direction(0,left)
jig hero(0)
show text box(2028)
wait(2)
set npc direction(1,left)
wait(2)
set npc direction(2,left)
wait for text box
jig npc(5)
tb(2029)
jig hero(0)
tb(2030)
alter npc(5,NPCstat:movespeed,4)
walk npc(5,up,2)
wait for npc(5)
walk npc(5,right,3)
wait(2)
set hero direction(0,up)
wait(2)
set npc direction(1,up)
wait(2)
set npc direction(2,up)
wait for npc(5)
set npc frame(5,0)
set npc direction(5,down)
jig npc(5)
tb(2031)
set npc direction(5,left)
wait(2)
walk npc(5,up,1)
wait for npc(5)
set npc position(5,0,0)
walk npc(2,right,1)
walk hero(0,up,1)
walk npc(1,up,1)
wait for npc(1)
walk npc(2,up,1)
walk hero(0,right,1)
walk npc(1,up,1)
wait for npc(1)
walk npc(2,up,1)
walk hero(0,up,1)
walk npc(1,right,1)
wait for npc(1)
set npc position(2,0,0)
walk hero(0,up,1)
walk npc(1,up,1)
wait for hero(0)
wait for npc(1)
set hero position(0,0,0)
walk npc(1,up,1)
wait for npc(1)
set npc position(1,0,0)
wait(10)

palout(10)
wait(1)
set tag(116,0)
flashbackmanx

)
else(
set hero direction(0,left)
jig hero(0)
show text box(2032)
wait(2)
set npc direction(1,left)
wait for text box

set npc direction(2,down)
wait(2)
variable(ny)
set variable(ny,npcy(2))
put npc(2,npcx(2)*20,(ny*20)--3)
wait(2)
put npc(2,npcx(2)*20,(ny*20))
show text box(2033)
wait(2)
put npc(2,npcx(2)*20,(ny*20)--3)
wait(2)
put npc(2,npcx(2)*20,(ny*20))
wait for text box

jig npc(5)
tb(2034)
set npc direction(5,down)
wait(2)
walk npc(5,left,8)
wait(6)
set npc direction(2,left)
wait for npc(5)
set tag(124,1)
walk npc(1,up,1)
walk npc(2,down,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
set party in
set tag(116,1)
set hero speed(0,hspeed)
camera follows hero
if(check tag(3)) then(play song(71))
if(check tag(4)) then(play song(71))
if(check tag(5)) then(play song(71))
if(check tag(6)) then(play song(73))
)

set tag(8,0)

resume obstruction
resume npcs
resume player
end
###

##########################
script, talktopyrus, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(123)) then(

focus camera(16,20,2)
walk hero to y(0,20)
wait for hero(0)
walk hero to x(0,16)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)
set party out
alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,left,1)
walk npc(2,right,1)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,up)
set npc frame(2,0)

set npc direction(4,up)
jig npc(4)
tb(2035)
wait(2)
tb(3816)

if(check tag(125)) then(
stop song
jig hero(0)
tb(2036)
set npc direction(4,down)
wait(2)
set npc frame(4,1)
wait(4)
alter npc(4,NPCstat:picture,138)
set npc frame(4,0)
jig npc(4)
tb(2029)
jig hero(0)
tb(2030)
alter npc(4,NPCstat:movespeed,4)
walk npc(4,right,3)
wait(2)
set npc direction(1,right)
wait(2)
set hero direction(0,right)
wait(2)
set npc direction(2,right)
wait for npc(4)
walk npc(4,down,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,left)
jig npc(4)
tb(2031)
set hero speed(0,4)
set npc direction(4,down)
wait(2)
walk npc(4,right,8)
wait(2)
walk npc(2,right,10)
wait(2)
walk hero(0,right,11)
wait(4)
walk npc(1,right,12)
wait(8)
palout(10)
wait for hero(0)
set tag(116,0)
wait(1)
flashbackmanx
)
else(
jig hero(0)
tb(2037)
set npc direction(2,left)
wait(2)
set npc frame(2,1)
wait(4)
set npc frame(2,0)
tb(2038)
walk npc(1,right,1)
walk npc(2,left,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
set party in
camera follows hero
)

)
#pre-desert clothes talk
else(
tb(1919)
)

resume obstruction
resume npcs
resume player
end
###

############################
script, flashbackmanx, begin

set tag(124,1)

wait(40)

variable(k)
for(k,103,114,1) do(
set tag(k,0))

set hero speed(0,hspeed)
set hero frame(0,0)
set tag(8,0)
camera follows hero(0)
teleport to map(89,1,3)
stop song
wait(1)
set hero palette(find hero(0),3)
load tileset(97)
alter NPC(35,NPCstat:script argument,97)
set hero picture(find hero(0),198)
set hero direction(0,down)
set hero frame(0,0)
wait(15)

play song(31)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (10)
reset palette
greyscale palette
update palette

wait(30)
fade screen out(63,63,63)
reset palette
wait(1)
fade screen in

wait(15)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)

set variable(isrunning,0)
swap out hero(find hero(1))
lock hero(find hero(1))
swap out hero(find hero(2))
lock hero(find hero(2))
wait(1)

set tag(3,0)
set tag(4,0)
set tag(5,0)
set tag(6,1)
set variable(hour,nighttime)
setvariable(currenttime,hour+minute)

reset palette
tweak palette (-3,-3,0)
update palette
wait (1)
reset palette
tweak palette (-2,-2,0)
update palette
wait (1)
reset palette
tweak palette (-1,-1,0)
update palette
wait (1)
reset palette
update palette

end
###

#######################
script, manxmoon, begin

stop song

focus camera(12,27,20)
wait for camera
focus camera(12,18,2)
wait for camera
wait for hero(0)
set hero speed(0,2)
walk hero(0,up,6)
wait for hero(0)
set hero frame(0,0)
wait(25)

jig npc(5)
tb(2039)
play song(83)
wait(5)
walk hero(0,right,1)
wait for hero(0)
walk hero(0,up,3)
wait for hero(0)
set hero frame(0,0)
wait(2)
jig hero(0)
tb(2040)
wait(15)
jig npc(5)
tb(2041)
jig hero(0)
tb(2042)
wait(6)
set npc direction(5,right)
wait(8)
jig npc(5)
show text box(2043)
wait(2)
set npc direction(5,up)
wait(7)
set hero direction(0,left)
wait for text box
jig hero(0)
tb(2044)
wait(6)
jig npc(5)
tb(2045)
wait(4)
set npc direction(5,right)
wait(5)
jig npc(5)
tb(2046)
set hero direction(0,up)
jig hero(0)
tb(2047)
wait(4)
tb(2048)
jig npc(5)
tb(2049)
set npc direction(5,up)
wait(4)
tb(2050)
wait(8)
tb(2051)
wait(2)
set hero direction(0,left)
jig hero(0)
tb(2052)
wait(4)
jig npc(5)
tb(2053)
wait(10)
set npc direction(5,right)
jig npc(5)
tb(2054)
wait(4)
tb(2055)
wait(2)
set npc direction(5,up)
wait(4)
tb(2056)
wait(4)
set hero direction(0,up)
wait(6)
jig hero(0)
tb(2057)
wait(4)
jig npc(5)
tb(2058)

wait(4)
focus camera(herox(0),heroy(0),1)
wait for camera
camera follows hero(0)

end
###

#############################
script, animalscantalk, begin

stop song

alter npc(2,NPCstat:picture,341)
alter npc(2,NPCstat:palette,103)
alter npc(6,NPCstat:palette,155)
alter npc(7,NPCstat:palette,155)
alter npc(8,NPCstat:palette,159)
alter npc(9,NPCstat:palette,159)
set npc direction(2,down)
set npc direction(6,up)
set npc direction(7,up)
set npc direction(8,up)
set npc direction(9,up)
set npc position(2,40,44)
set npc position(6,40,53)
set npc position(7,40,54)
set npc position(8,40,46)
set npc position(9,40,47)
alter npc(6,NPCstat:movespeed,2)
alter npc(7,NPCstat:movespeed,2)
alter npc(8,NPCstat:movespeed,2)
alter npc(9,NPCstat:movespeed,2)

alter npc(7,NPCstat:displaytext,2085)
alter npc(7,NPCstat:whenactivated,NPCwhenactivated:donotfaceplayer)
alter npc(5,NPCstat:displaytext,81)
alter npc(5,NPCstat:whenactivated,NPCwhenactivated:donotfaceplayer)
alter npc(2,NPCstat:whenactivated,NPCwhenactivated:donotfaceplayer)
alter npc(2,NPCstat:script,85)

set hero speed(0,10)
walk hero(0,right,8)
focus camera(40,45,20)
wait for camera
wait for hero(0)
set hero speed(0,5)
wait(5)
walk hero(0,right,4)
wait for hero(0)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
set npc position(5,herox(0),heroy(0))
walk npc(5,down,1)
wait for npc(5)
set npc frame(5,0)
set npc direction(5,right)

wait(15)
jig npc(2)
play song(15)
tb(2065)
wait(4)
walk npc(8,up,1)
walk npc(9,up,1)
wait for npc(8)
wait for npc(9)
set npc frame(8,0)
set npc frame(9,0)
wait(2)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
show text box(2066)
wait(4)
set npc direction(8,right)
set npc direction(9,right)
wait(2)
set npc direction(8,down)
set npc direction(9,down)
wait for text box
walk npc(6,up,5)
walk npc(7,up,5)
wait for npc(6)
wait for npc(7)
set npc frame(6,0)
set npc frame(7,0)
wait(2)
set npc direction(8,right)
set npc direction(9,right)
wait(2)
set npc direction(8,up)
set npc direction(9,up)
wait(1)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
tb(2067)
jig npc(2)
show text box(2068)
set npc direction(2,up)
jig npc(2)
jig npc(2)
wait for text box
wait(2)
set npc direction(8,left)
set npc direction(9,left)
wait(1)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
tb(2069)
wait(2)
set npc frame(5,1)
wait(3)
set npc frame(5,0)
tb(2070)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(2071)
wait(1)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
tb(2072)
wait(5)
set npc direction(8,up)
set npc direction(9,up)
wait(10)
wait(1)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
tb(2073)
jig npc(2)
tb(2074)
walk npc(6,up,1)
walk npc(7,up,1)
wait for npc(6)
wait for npc(7)
set npc frame(6,0)
set npc frame(7,0)
wait(2)
set npc frame(6,1)
set npc frame(7,1)
wait(2)
set npc frame(6,0)
set npc frame(7,0)
tb(2075)
wait(1)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
tb(2076)
wait(12)
set npc frame(6,1)
set npc frame(7,1)
wait(2)
set npc frame(6,0)
set npc frame(7,0)
tb(2077)
set npc direction(8,right)
set npc direction(9,right)
play song(57)
show text box(2078)
wait(2)
set npc direction(8,down)
set npc direction(9,down)
wait(2)
set npc frame(8,1)
set npc frame(9,1)
wait for text box
alter npc(8,NPCstat:picture,339)
alter npc(9,NPCstat:picture,339)
set npc direction(9,up)
tb(2079)
alter npc(8,NPCstat:picture,337)
alter npc(9,NPCstat:picture,338)
set npc direction(9,down)
set npc frame(8,0)
set npc frame(9,0)
wait(8)
set npc direction(8,left)
set npc direction(9,left)
wait(2)
set npc direction(8,up)
set npc direction(9,up)
wait(15)
set npc frame(8,1)
set npc frame(9,1)
wait(1)
set npc frame(8,0)
set npc frame(9,0)
tb(2080)
wait(4)
jig npc(2)
tb(2081)
wait(6)
set npc frame(6,1)
set npc frame(7,1)
wait(2)
set npc frame(6,0)
set npc frame(7,0)
tb(2082)
set npc direction(8,right)
set npc direction(9,right)
wait(2)
set npc direction(8,down)
set npc direction(9,down)
tb(2083)
wait(6)
set npc frame(6,1)
set npc frame(7,1)
wait(2)
set npc frame(6,0)
set npc frame(7,0)
tb(2084)
stop song

alter npc(6,NPCstat:movespeed,10)
alter npc(7,NPCstat:movespeed,10)
walk npc(6,up,2)
walk npc(7,up,2)
wait(3)
show backdrop(1)
wait for npc(6)
wait for npc(7)
set npc frame(6,0)
set npc frame(7,0)
set npc position(8,0,0)
set npc position(9,0,0)
wait(3)
fade screen out(0,0,0)
set npc position(6,41,44)
set npc position(7,41,45)
set npc direction(6,left)
set npc direction(7,left)
show map
load tileset(93)
wait(4)
fade screen in
wait(2)
walk npc(5,right,7)
wait for npc(5)
set npc direction(5,up)
set npc frame(5,0)

write pass block(33,41,1)
write pass block(47,44,2)
write pass block(47,45,2)
write pass block(47,46,2)
write pass block(47,47,2)
write pass block(39,49,4)
write pass block(40,49,4)
write pass block(41,49,4)
write pass block(42,49,4)
write pass block(33,43,8)
write pass block(33,44,8)
write pass block(33,45,8)
write pass block(33,46,8)
write pass block(42,45,1)

play song(17)

end
###

###############################
script, endmanxflashback, begin
suspend player
suspend npcs
suspend obstruction

jig hero(0)
tb(2086)
wait(8)
jig npc(5)
tb(2087)
wait(10)

palout(10)
wait(1)
show backdrop(0)
wait(1)
palin(10)
tb(2088)
wait(6)
tb(2089)
tb(2090)
tb(2091)

palout(10)
show map
camera follows hero(0)
set hero picture(0,344)
teleport to map(34,6,22)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,4,20)
set npc position(1,6,20)
set npc position(2,8,20)
set hero direction(0,down)
set npc direction(1,up)
set npc direction(2,right)
alter npc(1,NPCstat:picture,345)
alter npc(2,NPCstat:picture,346)
set hero frame(0,0)
#turn on special tags
set tag(385,1)
set tag(386,1)
wait(10)
palin(10)

wait(20)

variable(cx)
variable(cy)
set variable(cx,camera pixel x)
set variable(cy,camera pixel y)

variable(i)
for(i,1,5,1) do(
put camera(cx+random(-5,5),cy+random(-5,5))
wait(1)
)
put camera(cx,cy)

set hero picture(0,229)
wait(20)

for(i,1,5,1) do(
put camera(cx+random(-5,5),cy+random(-5,5))
wait(1)
)
put camera(cx,cy)

jig hero(0)
tb(2092)
play song(8)

innrest

alter npc(1,NPCstat:script,87)
alter npc(2,NPCstat:script,86)
write pass block(2,20,1)
write pass block(6,24,4+128)

set tag(3,0)
set tag(4,0)
set tag(5,0)
set tag(6,1)
set variable(hour,nighttime)
setvariable(currenttime,hour+minute)

#turning off rest and avis
set tag(433,1)
set tag(280,1)

resume obstruction
resume npcs
resume player
end
###

##########################
script, wakeupjohan, begin
suspend player
suspend npcs
suspend obstruction

swap by position(find hero(0),0)
set hero picture(0,229)

jig hero(0)
tb(2097)
if(herox(0)<<npcx(2)) then(
wait(2)
set npc direction(2,left))
else(
set npc direction(2,right))
wait(2)
alter npc(2,NPCstat:picture,234)
wait(2)
alter npc(2,NPCstat:picture,346)
wait(2)
alter npc(2,NPCstat:picture,234)
tb(2098)
jig hero(0)
tb(2099)
jig npc(2)
tb(2100)

if(herox(0)<<npcx(2)) then(
walk npc(2,left,1))
else(
walk npc(2,right,1))
wait for npc(2)
set npc position(2,0,0)

unlock hero(find hero(2))
swap in hero(2)

set hp

if(room in active party==1) then(
set tag(128,1)
write pass block(6,24,128)
)

resume obstruction
resume npcs
resume player
end
###

#########################
script, wakeupmila, begin
suspend player
suspend npcs
suspend obstruction

swap by position(find hero(0),0)

jig hero(0)
tb(2093)
wait(6)
if(herox(0)<<npcx(1)) then(
set npc direction(1,right))
else(
set npc direction(1,left))
wait(2)
show text box(2094)
wait(2)
set hero picture(0,331)
wait for text box
jig hero(0)
tb(2095)
wait(2)
set npc direction(1,down)
wait(2)
if(herox(0)<<npcx(1)) then(
set npc direction(1,left))
else(
set npc direction(1,right))
wait(2)
alter npc(1,NPCstat:picture,334)
wait(2)
alter npc(1,NPCstat:picture,345)
wait(2)
alter npc(1,NPCstat:picture,334)
wait(2)
alter npc(1,NPCstat:picture,345)
wait(2)
alter npc(1,NPCstat:picture,334)
wait(2)
tb(2096)

if(herox(0)<<npcx(1)) then(
walk npc(1,left,1))
else(
walk npc(1,right,1))
wait for npc(1)
set npc position(1,0,0)

unlock hero(find hero(1))
swap in hero(1)

set hp

if(room in active party==1) then(
set tag(128,1)
write pass block(6,24,128)
)

resume obstruction
resume npcs
resume player
end
###

##############################
script, midnightraiders, begin

midnightraiders1
midnightraiders2

end
###
###############################
script, midnightraiders1, begin
set tag(128,0)
set tag(129,1)
camera follows hero
teleport to map(30,32,18)
stop song
wait(1)
set npc position(3,35,20)
set npc position(6,29,20)
set npc direction(3,left)
set npc direction(6,right)
pan camera(south,0,0)
set hero position(0,0,0)
set hero direction(0,down)
swap by position(find hero(0),0)
set hero picture(0,229)
wait(1)
palin(1)

play song(59)

wait(10)
set hero position(0,32,17)
walk hero(0,down,1)
wait for hero(0)
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
walk npc(1,left,1)
walk npc(2,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
pan camera(down,2,10)
wait for camera

wait(2)
jig hero(0)
tb(2101)
jig npc(3)
tb(2102)
wait(4)

set npc speed(3,2)
set npc speed(6,2)
walk npc(3,left,1)
walk npc(6,right,1)
wait for npc(3)
wait for npc(6)
set npc speed(3,10)
set npc speed(6,10)
walk npc(3,left,2)
walk npc(6,right,2)
wait for npc(3)
wait for npc(6)
stop song
show backdrop(1)
set npc position(3,31,20)
set npc position(6,33,20)
alter npc(3,NPCstat:picture,200)
set npc frame(6,1)
wait(2)
show map

wait(4)
alter npc(3,NPCstat:picture,199)
wait(1)
set npc frame(6,0)
wait(1)
set npc frame(3,1)
wait(2)
alter npc(6,NPCstat:picture,0)
wait(2)
alter npc(6,NPCstat:picture,201)
wait(2)
alter npc(6,NPCstat:picture,0)
wait(2)
alter npc(6,NPCstat:picture,201)
wait(2)
alter npc(6,NPCstat:picture,0)
wait(4)
alter npc(6,NPCstat:picture,201)
wait(4)
set npc position(6,0,0)

wait(5)
jig npc(3)
tb(2103)
wait(5)
jig npc(2)
tb(2104)
wait(2)
set npc direction(2,left)
tb(2105)
wait(2)
alter npc(3,NPCstat:picture,138)
set npc frame(3,0)
wait(2)
set npc direction(3,up)
jig npc(3)
tb(2106)
wait(2)
set npc direction(1,right)
jig npc(1)
tb(2107)
jig hero(0)
tb(2108)

wait(2)
focus camera(herox(0),heroy(0),2)
wait(2)

set npc speed(3,4)

walk npc(1,right,1)
walk npc(2,left,1)
walk npc(3,right,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for npc(3)
walk npc(3,up,2)
wait for npc(3)
set npc position(3,0,0)

wait for camera
wait(2)

play song(5)
tb(3817)

set party in

add hero(3)
set hp
end
###
###############################
script, midnightraiders2, begin
#set pyrus stats
set hero stat(find hero(3),2,dostr+15,current stat)
set hero stat(find hero(3),2,dostr+15,maximum stat)
set hero stat(find hero(3),3,doacc--5,current stat)
set hero stat(find hero(3),3,doacc--5,maximum stat)
set hero stat(find hero(3),4,dodef+5,current stat)
set hero stat(find hero(3),4,dodef+5,maximum stat)
set hero stat(find hero(3),5,doddg--5,current stat)
set hero stat(find hero(3),5,doddg--5,maximum stat)
set hero stat(find hero(3),6,doskl--5,current stat)
set hero stat(find hero(3),6,doskl--5,maximum stat)
set hero stat(find hero(3),7,doevd,current stat)
set hero stat(find hero(3),7,doevd,maximum stat)

#saving pyrus hero stats for rts use
set variable(pyhp,get hero stat(find hero(3),0,maximum stat))
set variable(pysp,get hero stat(find hero(3),1,maximum stat))
set variable(pystr,get hero stat(find hero(3),2,maximum stat))
set variable(pyacc,get hero stat(find hero(3),3,maximum stat))
set variable(pydef,get hero stat(find hero(3),4,maximum stat))
set variable(pyddg,get hero stat(find hero(3),5,maximum stat))
set variable(pyskl,get hero stat(find hero(3),6,maximum stat))
set variable(pyevd,get hero stat(find hero(3),7,maximum stat))

#here is where you check for johan level ups
variable(pylevel)
set variable(pylevel,get hero level(find hero(3)))
if ( pylevel >> 0 ) then(
	palout(1)
	show backdrop(0)
	palin(1)
	pyrus hp calculator
	set hero stat(find hero(3),0,get hero stat(find hero(3),0,maximum stat),current stat)
	pyrus level up(pylevel,231)
	wait(4)
	show backdrop(0)
	wait(4)
	palout(1)
	show map
	wait(1)
	palin(1)
)

camera follows hero
set tag(433,1)
end
###

###############################
script, mainforcesfallen, begin
suspend player
suspend npcs
suspend obstruction

wait(5)
jig hero(0)
tb(2110)
jig npc(3)
tb(2111)
jig hero(0)
tb(2112)
jig npc(3)
tb(2113)
jig npc(2)
tb(2114)
jig npc(1)
tb(2115)
jig hero(0)
tb(2116)

set hero speed(0,4)
walk hero(0,down,1)
walk npc(1,left,1)
walk npc(2,right,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for npc(3)
set npc position(3,0,0)
set hero speed(0,hspeed)
camera follows hero(0)

set party in

resume obstruction
resume npcs
resume player
end
###

##################################
script, raiderconfrontation, begin
suspend player
suspend npcs
suspend obstruction

raiderconfrontationA
raiderconfrontationB
raiderconfrontationC

resume obstruction
resume npcs
resume player
end
###
#################################
script,raiderconfrontationA,begin
play song(15)
jig gahn
tb(3819)

pan camera(right,5,2)
wait(5)
set hero direction(0,down)
wait(2)
set hero direction(0,right)

alter npc(1,NPCstat:picture,71)

#raider 1 jump
walk npc(8,down,1)
wait for npc(8)

alter npc(8,NPCstat:picture,347)
set npc direction(8,right)

put npc(8,16*20,(19*20)--65)
put npc(1,16*20,(19*20)--20)
wait(2)
put npc(8,16*20,(19*20)--67)
put npc(1,16*20,(19*20)--18)
wait(2)
put npc(8,16*20,(19*20)--68)
put npc(1,16*20,(19*20)--16)
wait(2)
put npc(8,16*20,(19*20)--67)
put npc(1,16*20,(19*20)--14)
wait(2)
put npc(8,16*20,(19*20)--65)
put npc(1,16*20,(19*20)--12)
wait(2)
put npc(8,16*20,(19*20)--60)
put npc(1,16*20,(19*20)--10)
wait(1)
put npc(8,16*20,(19*20)--50)
put npc(1,16*20,(19*20)--8)
wait(1)
put npc(8,16*20,(19*20)--40)
put npc(1,16*20,(19*20)--6)
wait(1)
put npc(8,16*20,(19*20)--20)
put npc(1,16*20,(19*20)--4)
wait(1)
put npc(8,16*20,(19*20)--5)
put npc(1,16*20,(19*20)--2)
wait(1)

put npc(8,16*20,19*20)
put npc(1,0,0)
set npc direction(8,up)
wait(5)
alter npc(8,NPCstat:picture,201)
set npc direction(8,down)
set npc frame(8,0)
wait(2)
set npc direction(8,left)
wait(2)

#raider 2
walk npc(9,down,1)
wait for npc(9)

alter npc(9,NPCstat:picture,347)
set npc direction(9,right)

put npc(9,18*20,(19*20)--65)
put npc(1,18*20,(19*20)--20)
wait(2)
put npc(9,18*20,(19*20)--67)
put npc(1,18*20,(19*20)--18)
wait(2)
put npc(9,18*20,(19*20)--68)
put npc(1,18*20,(19*20)--16)
wait(2)
put npc(9,18*20,(19*20)--67)
put npc(1,18*20,(19*20)--14)
wait(2)
put npc(9,18*20,(19*20)--65)
put npc(1,18*20,(19*20)--12)
wait(2)
put npc(9,18*20,(19*20)--60)
put npc(1,18*20,(19*20)--10)
wait(1)
put npc(9,18*20,(19*20)--50)
put npc(1,18*20,(19*20)--8)
wait(1)
put npc(9,18*20,(19*20)--40)
put npc(1,18*20,(19*20)--6)
wait(1)
put npc(9,18*20,(19*20)--20)
put npc(1,18*20,(19*20)--4)
wait(1)
put npc(9,18*20,(19*20)--5)
put npc(1,18*20,(19*20)--2)
wait(1)

put npc(9,18*20,19*20)
put npc(1,0,0)
set npc direction(9,up)
wait(5)
alter npc(9,NPCstat:picture,201)
set npc direction(9,down)
set npc frame(9,0)
wait(2)
walk npc(9,down,2)
wait for npc(9)
walk npc(9,left,2)
wait for npc(9)
set npc frame(9,0)
wait(6)

#manx jump
write pass block(17,17,0)
alter npc(7,NPCstat:picture,347)
set npc direction(7,down)
wait(2)
set npc direction(7,left)

put npc(7,17*20,(19*20)--70)
put npc(1,17*20,(19*20)--20)
wait(2)
put npc(7,17*20,(19*20)--75)
put npc(1,17*20,(19*20)--18)
wait(2)
put npc(7,17*20,(19*20)--80)
put npc(1,17*20,(19*20)--16)
wait(2)
put npc(7,17*20,(19*20)--75)
put npc(1,17*20,(19*20)--14)
wait(2)
put npc(7,17*20,(19*20)--70)
put npc(1,17*20,(19*20)--12)
wait(2)
put npc(7,17*20,(19*20)--60)
put npc(1,17*20,(19*20)--10)
wait(1)
put npc(7,17*20,(19*20)--50)
put npc(1,17*20,(19*20)--8)
wait(1)
put npc(7,17*20,(19*20)--40)
put npc(1,17*20,(19*20)--6)
wait(1)
put npc(7,17*20,(19*20)--20)
put npc(1,17*20,(19*20)--4)
wait(1)
put npc(7,17*20,(19*20)--5)
put npc(1,17*20,(19*20)--2)
wait(1)

put npc(7,17*20,19*20)
put npc(1,0,0)
set npc direction(7,down)
wait(3)
alter npc(7,NPCstat:picture,342)
wait(1)
walk npc(7,down,1)
wait for npc(7)
walk npc(7,left,1)
wait for npc(7)
set npc frame(7,0)
write pass block(17,17,128)

wait(2)
set hero speed(0,4)
walk hero(0,right,4)
wait for hero(0)
set hero frame(0,0)

alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,up,1)
walk npc(2,left,1)
walk npc(3,down,1)
wait for npc(1)
set npc direction(1,right)
set npc frame(1,0)
wait for npc(3)
alter npc(3,NPCstat:picture,199)
set npc direction(3,right)
set npc frame(3,0)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
wait(2)
set npc direction(2,right)
wait(2)

jig hero(0)
tb(2117)
jig npc(3)
show text box(2118)
wait(2)
alter npc(3,NPCstat:picture,200)
wait(2)
alter npc(7,NPCstat:picture,348)
wait for text box
jig npc(7)
show text box(2119)
wait(2)
alter npc(3,NPCstat:picture,199)
wait for text box
wait(5)
jig npc(3)
tb(2120)
jig npc(7)
tb(2121)
jig npc(2)
tb(2122)
wait(2)
alter npc(7,NPCstat:picture,179)
set npc direction(7,up)
wait(3)
set npc frame(7,1)
tb(2123)
jig hero(0)
show text box(2124)
wait(2)
alter npc(7,NPCstat:picture,342)
set npc frame(7,0)
set npc direction(7,left)
wait for text box
jig npc(7)
play song(15)
tb(2125)
show text box(2126)
walk npc(7,left,1)
wait for npc(7)
set npc frame(7,0)
wait for text box
jig npc(1)
tb(2127)
alter npc(3,NPCstat:picture,138)
wait(2)
jig npc(3)
tb(2128)
wait(2)
jig npc(7)
show text box(2129)
wait(2)
set hero picture(0,331)
wait for text box
jig hero(0)
tb(2130)
tb(2131)
set hero speed(0,1)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
wait(4)
stop song
tb(2132)
jig npc(7)
tb(2133)
play song(8)
tb(2134)
end
###
#################################
script,raiderconfrontationB,begin
battleflash(1)
set party in
ff(230)
play song(7)
set party out
swap by position(find hero(0),0)
end
###
#################################
script,raiderconfrontationC,begin
alter npc(7,NPCstat:move speed,10)
alter npc(8,NPCstat:move speed,10)
alter npc(9,NPCstat:move speed,10)
walk npc(7,left,12)
walk npc(8,down,1)
wait for npc(8)
walk npc(8,left,13)
walk npc(9,up,1)
wait for npc(9)
walk npc(9,left,1)
set hero direction(0,down)
set npc direction(1,down)
set npc direction(2,up)
set npc direction(3,up)
wait for npc(9)
walk npc(9,left,12)
set hero direction(0,left)
set npc direction(1,left)
set npc direction(2,left)
set npc direction(3,left)
wait(10)
jig npc(2)
tb(2135)
wait(2)
stop song
show text box(2136)
wait for npc(9)
alter npc(9,NPCstat:picture,15)
alter npc(9,NPCstat:palette,47)
alter npc(9,NPCstat:move speed,4)
set npc position(7,0,0)
set npc position(8,0,0)
set npc position(9,5,20)
set npc direction(9,right)
set npc frame(9,0)
wait for text box
play song(64)
pan camera(left,4,5)
wait for camera
pan camera(left,1,4)
walk npc(9,right,1)
wait for camera
wait for npc(9)
set npc frame(9,0)
wait(2)
walk npc(3,up,1)
wait for npc(3)
walk npc(3,left,1)
wait(1)
walk npc(2,up,1)
set npc direction(2,down)
wait for npc(3)
set npc frame(3,0)
wait for npc(2)
set npc frame(2,0)
jig npc(3)
tb(2137)
jig npc(9)
tb(2138)
walk npc(1,left,1)
wait(1)
walk npc(2,left,1)
set npc direction(2,right)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
jig npc(1)
tb(2139)
jig npc(9)
tb(2140)
walk npc(1,left,1)
wait(1)
walk npc(2,up,1)
set npc direction(2,down)
wait for npc(1)
walk npc(1,down,1)
wait for npc(2)
set npc frame(2,0)
wait for npc(1)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,left,1)
set npc direction(2,left)
wait for npc(1)
set npc frame(1,0)
wait(6)
jig npc(1)
stop song
tb(2141)
wait(6)
set npc direction(9,up)
wait(3)
walk npc(9,left,1)
wait for npc(9)
set npc frame(9,0)
wait(5)
play song(19)
tb(2142)
wait(2)
set npc direction(9,down)
wait(2)
set npc direction(9,right)
jig npc(9)
tb(2143)
tb(2144)
set hero speed(0,4)
walk hero(0,left,1)
wait(2)
show text box(2145)
wait for hero(0)
wait for text box
wait(3)
jig npc(9)
tb(2146)
wait(2)
set npc direction(9,up)
wait(2)
set npc direction(9,left)
wait(2)
walk npc(9,left,5)
tb(2147)
wait(5)
set npc direction(2,down)
wait(2)
jig npc(2)
show text box(2148)
wait(2)
set npc direction(3,up)
wait for text box
set hero direction(0,up)
jig hero(0)
show text box(2149)
wait(2)
set npc direction(1,up)
wait(2)
set npc direction(1,right)
wait for text box
jig npc(1)
stop song
tb(2150)
wait(2)
set hero picture(0,332)
set hero direction(0,left)
wait(2)
set npc direction(2,left)
wait(1)
set npc direction(3,left)
tb(2151)
play song(91)
tb(2152)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
wait(4)
jig npc(1)
tb(2153)
wait(2)
set npc direction(3,up)
wait(2)
set npc direction(3,right)
wait(1)
jig npc(3)
show text box(2154)
wait(2)
set npc direction(2,down)
wait for text box
tb(2155)
jig npc(2)
tb(2156)
wait(2)
set npc direction(3,up)
wait(4)
jig npc(3)
tb(2157)
wait(2)
set npc direction(3,right)
wait(6)
jig npc(3)
tb(2158)
wait(2)
jig npc(0)
set hero picture(0,344)
tb(2159)
wait(2)
tb(2160)
wait(2)
set hero picture(0,229)
tb(2161)

focus camera(herox(0),heroy(0),2)

walk npc(3,right,1)
walk npc(1,right,1)
walk npc(2,down,1)
wait for npc(3)
set npc position(3,0,0)
wait for npc(1)
walk npc(1,right,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(1)
walk npc(1,right,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
walk npc(2,down,1)
wait for npc(2)
set npc position(2,0,0)

#set the flags on
set tag(130,1)

set npc position(9,0,0)
set tag(129,0)

wait for camera
camera follows hero(0)

set variable(isrunning,true)
set variable(hour,nighttime)
set tag(6,1)
set tag(5,0)
set tag(4,0)
set tag(3,0)
#set npc position(npc at spot(0,2),herox(0),heroy(0)+1)
#set npc position(npc at spot(1,2),herox(0),heroy(0)--1)
#set npc position(npc at spot(2,2),herox(0)+1,heroy(0))
#set npc position(npc at spot(3,2),herox(0)--1,heroy(0))

create npc(32,herox(0),heroy(0)+1)
create npc(32,herox(0),heroy(0)--1)
create npc(32,herox(0)+1,heroy(0))
create npc(32,herox(0)--1,heroy(0))

alter npc(32,NPCstat:script,76)

set hero speed(0,hspeed)
set tag(8,0)

#turning on rest and avis
set tag(433,0)
set tag(280,0)

save game
end
###

###########################
script, enteringdun3, begin
suspend player
suspend npcs
suspend obstruction

set tag(133,1)

pan camera(south,0,0)
walk hero(0,down,6)
wait(5)
palout(5)
stop song
wait for hero(0)
camera follows hero(0)
set hero position(0,17,90)
wait(1)
pan camera(up,7,4)
set hero speed(0,2)
walk hero(0,up,6)
wait(2)
palin(5)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,4)

alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)

tb(2162)
play song(64)
set npc position(5,17,90)
walk npc(5,up,3)

set hero direction(0,right)
wait(2)
set hero direction(0,down)
set party out
swap by position(0,find hero(0))
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
set npc position(2,herox(0),heroy(0))
walk npc(2,up,1)
set npc position(3,herox(0),heroy(0))
walk npc(3,left,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
wait for npc(3)
set npc direction(3,down)
set npc frame(3,0)

wait for npc(5)
set npc frame(5,0)
wait(5)
jig npc(5)
tb(2163)
jig npc(3)
tb(2164)
jig npc(5)
tb(2165)
jig npc(2)
tb(2166)
jig npc(5)
tb(2167)
jig npc(1)
tb(2168)
wait(6)
jig npc(5)
stop song
tb(2169)
set npc direction(5,right)
wait(2)
tb(2170)
wait(8)
set npc direction(5,up)
jig npc(5)
tb(2171)
tb(2172)

palout(5)
set tag(132,1)
camera follows hero(0)
teleport to map(66,56,150)
stop song
wait(1)
set npc position(33,1,1)
set npc position(34,2,2)
focus camera (56,156,2)
set hero position(0,0,0)
wait(1)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (10)
reset palette
greyscale palette
update palette

play song(17)

wait for camera

wait(4)
tb(2173)
wait(4)
tb(2174)
wait(6)
tb(2175)

pan camera (down,20,20)
wait for camera
alter npc (34,npcstat:movespeed,5)
alter npc (33,npcstat:picture,88)
alter npc (33,npcstat:palette,66)
alter npc (33,npcstat:movespeed,10)
set npc position (34,56,170)
set npc position (33,56,170)
walk npc(34,down,6)
wait for npc(34)
walk npc (34,down,7)
walk npc (33,down,13)
wait for npc (34)
wait for npc (33)
reset palette
update palette
stop song
show backdrop (1)
wait (2)
show map
reset palette
greyscale palette
update palette
wait(10)

tb(2176)

palout(10)
set tag(132,0)
set tag(133,0)
camera follows hero(0)
teleport to map(24+poff,17,83)
stop song
wait(1)
set tag(133,1)
pan camera(south,0,0)
set hero position(0,17,84)
set npc position(1,18,84)
set npc position(2,17,83)
set npc position(3,16,84)
set npc position(5,17,87)
set npc direction(5,up)
alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)
wait(1)
palin(5)
wait(5)
jig npc(5)
tb(2177)
jig hero(0)
tb(2178)
wait(4)
jig npc(5)
show text box(2179)
wait(2)
set npc direction(5,right)
wait for text box
wait(2)
walk npc(5,down,5)
play song(69)
tb(2180)
wait for npc(5)
set npc position(5,3,1)

walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,right,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in

set tag(133,0)
set tag(131,1)
set tag(8,0)
set hero speed(0,hspeed)
save game

resume obstruction
resume npcs
resume player
end
###

#############################
script, fedoratombdoor, begin
suspend player
suspend npcs
suspend obstruction

set tag(8,1)

if(herox(0)<<54) then(
	if(heroy(0)<<105) then(fedoratombdoorupleft)
			else(fedoratombdoordownleft)
)
else(
	if(heroy(0)<<82) then(fedoratombdoorupright)
			else(fedoratombdoordownright)
)

set tag(8,0)

resume obstruction
resume npcs
resume player
end
###

#####################################
script, fedoratombdoordownleft, begin

if(herox(0)==45,and,heroy(0)==191) then(
	walk hero(0,down,2)
	wait(3)
	palout(3)
	camera follows hero(0)
	teleport to map(24+poff,17,83)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,17,78)
	set hp
	settp
	wait(1)
	palin(3)
	walk hero(0,down,2)
	wait for hero(0)
)
else(
if(herox(0)==45,and,heroy(0)==181) then(mrup(1,3,-5,afternoon))
)
do(
if(herox(0)==45,and,heroy(0)==179) then(mrdown(0,0,0,noon))
)
do(
if(herox(0)==45,and,heroy(0)==169) then(
	mrup(-3,-1,-5)
	alter npc(9,NPCstat:movespeed,2)
)
)
do(
if(herox(0)==45,and,heroy(0)==167) then(mrdown(1,3,-5))
)
do(
if(herox(0)==37,and,heroy(0)==163) then(mrleft(-3,-6,-6))
)
do(
if(herox(0)==35,and,heroy(0)==163) then(mrright(-3,-1,-5))
)
do(
if(herox(0)==45,and,heroy(0)==157) then(mrup(5,-1,-1))
)
do(
if(herox(0)==45,and,heroy(0)==155) then(mrdown(-3,-1,-5))
)
do(
if(herox(0)==51,and,heroy(0)==148) then(
	write pass block(51,149,128)
	write pass block(51,150,128)
	walk hero(0,down,2)
	set hero direction(0,up)
	wait for hero(0)

	tweak palette (0,-5,-5)
	update palette
	wait (2)
	tweak palette (-5,-10,-10)
	update palette
	wait (2)
	tweak palette (-15,-20,-20)
	update palette
	wait (2)
	tweak palette (-35,-40,-40)
	update palette
	wait (2)
	tweak palette (-111,-111,-111)
	update palette
	wait (2)

	set pal(night)
	camera follows hero(0)
	set hero position(0,99,150)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,105,144)
	write pass block(51,149,0)
	write pass block(51,150,0)
	wait(1)

	reset palette
	tweak palette (-40,-40,-40)
	update palette
	wait (2)
	reset palette
	tweak palette (-20,-20,-20)
	update palette
	wait (2)
	reset palette
	tweak palette (-10,-10,-10)
	update palette
	wait (2)
	reset palette
	tweak palette (-5,-5,-5)
	update palette
	wait (2)

	settp(-5,-5,-5)

	walk hero(0,down,4)
	set hero direction(0,up)
	wait for hero(0)
)
)
do(
if(herox(0)==22,and,heroy(0)==148) then(
write pass block(22,149,128)
write pass block(22,150,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (0,-5,-5)
update palette
wait (2)
tweak palette (-5,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(night)
camera follows hero(0)
set hero position(0,81,150)
wait(1)
pan camera(south,0,0)
set hero position(0,76,144)
write pass block(22,149,0)
write pass block(22,150,0)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)

settp(-5,-5,-5)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==29,and,heroy(0)==145) then(mrup(6,-3,-4))
)
do(
if(herox(0)==29,and,heroy(0)==143) then(mrdown(3,-3,-4))
)
do(
if(herox(0)==35,and,(heroy(0)==138,or,heroy(0)==139,or,heroy(0)==140)) then(mrright(6,-3,-4))
)
do(
if(herox(0)==37,and,(heroy(0)==138,or,heroy(0)==139,or,heroy(0)==140)) then(mrleft(6,-3,-4))
)
do(
if(herox(0)==35,and,(heroy(0)==124,or,heroy(0)==125,or,heroy(0)==126,or,heroy(0)==127)) then(mrright(6,-3,-4))
)
do(
if(herox(0)==37,and,(heroy(0)==124,or,heroy(0)==125,or,heroy(0)==126,or,heroy(0)==127)) then(mrleft(6,-3,-4))
)
do(
if((herox(0)==25,or,herox(0)==26,or,herox(0)==27,or,herox(0)==28,or,herox(0)==29),and,heroy(0)==133) then(mrup(6,-3,-4))
)
do(
if((herox(0)==25,or,herox(0)==26,or,herox(0)==27,or,herox(0)==28,or,herox(0)==29),and,heroy(0)==131) then(mrdown(6,-3,-4))
)
do(
if((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47,or,herox(0)==48),and,heroy(0)==133) then(mrup(6,-3,-4))
)
do(
if((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47,or,herox(0)==48),and,heroy(0)==131) then(mrdown(6,-3,-4))
)
do(
if(herox(0)==45,and,heroy(0)==119) then(mrdown(6,-3,-4))
)
do(
if(herox(0)==45,and,heroy(0)==121) then(mrup(1,6,4))
)
do(
if(herox(0)==45,and,heroy(0)==112) then(
write pass block(45,113,128)
write pass block(45,114,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (-5,0,0)
update palette
wait (2)
tweak palette (-10,-5,-5)
update palette
wait (2)
tweak palette (-20,-15,-15)
update palette
wait (2)
tweak palette (-40,-30,-30)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(night)
camera follows hero(0)
set hero position(0,99,114)
wait(1)
pan camera(south,0,0)
set hero position(0,99,108)
write pass block(45,113,0)
write pass block(45,114,0)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)

settp(-5,-5,-5)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==9,and,heroy(0)==123) then(
write pass block(9,124,128)
write pass block(9,125,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (-5,-5,-5)
update palette
wait (2)
tweak palette (-10,-10,-10)
update palette
wait (2)
tweak palette (-20,-20,-20)
update palette
wait (2)
tweak palette (-40,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(night)
camera follows hero(0)
set hero position(0,63,126)
wait(1)
pan camera(south,0,0)
set hero position(0,63,120)
write pass block(9,124,0)
write pass block(9,125,0)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)

settp(-5,-5,-5)

walk hero(0,down,3)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==31,and,heroy(0)==112) then(
write pass block(31,113,128)
write pass block(31,114,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (-5,-5,-5)
update palette
wait (2)
tweak palette (-10,-10,-10)
update palette
wait (2)
tweak palette (-20,-20,-20)
update palette
wait (2)
tweak palette (-40,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(night)
camera follows hero(0)
set hero position(0,81,114)
wait(1)
pan camera(south,0,0)
set hero position(0,85,108)
write pass block(31,113,0)
write pass block(31,114,0)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)

settp(-5,-5,-5)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==24,and,heroy(0)==112) then(
write pass block(24,113,128)
write pass block(24,114,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (-5,-5,-5)
update palette
wait (2)
tweak palette (-10,-10,-10)
update palette
wait (2)
tweak palette (-20,-20,-20)
update palette
wait (2)
tweak palette (-40,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(night)
camera follows hero(0)
set hero position(0,81,114)
wait(1)
pan camera(south,0,0)
set hero position(0,78,108)
write pass block(24,113,0)
write pass block(24,114,0)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)

settp(-5,-5,-5)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==9,and,heroy(0)==109) then(mrup(2,0,0,noon))
)
do(
if(herox(0)==9,and,heroy(0)==107) then(
	mrdown
	if(check tag(580)==false) then(
		show backdrop(7)
		wait(3)
		show map
		tb(7341)
		set tag(580,1)
		set tag(8,0)
		wait(2)
		save game
	)
)
)
do(
if(herox(0)==27,and,heroy(0)==121) then(mrup(2,0,-1))
)
do(
if(herox(0)==27,and,heroy(0)==119) then(mrdown(6,-3,-4))
)

end
###
##################################
script, fedoratombdoorupleft, begin

if(herox(0)==7,and,heroy(0)==100) then(
write pass block(7,101,128)
write pass block(7,102,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (-5,-5,-5)
update palette
wait (2)
tweak palette (-10,-10,-10)
update palette
wait (2)
tweak palette (-20,-20,-20)
update palette
wait (2)
tweak palette (-40,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(afternoon)
camera follows hero(0)
set hero position(0,63,102)
wait(1)
pan camera(south,0,0)
set hero position(0,61,96)
write pass block(7,101,0)
write pass block(7,102,0)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)

settp(-5,-5,-5)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
else(
if(herox(0)==19,and,heroy(0)==102) then(mrleft(2,0,0))
)
do(
if(herox(0)==17,and,heroy(0)==102) then(mrright(3,0,0))
)
do(
if(herox(0)==35,and,(heroy(0)==100,or,heroy(0)==101,or,heroy(0)==102,or,heroy(0)==103,or,heroy(0)==104)) then(mrright(3,0,0))
)
do(
if(herox(0)==37,and,(heroy(0)==100,or,heroy(0)==101,or,heroy(0)==102,or,heroy(0)==103,or,heroy(0)==104)) then(mrleft(3,0,0))
)
do(
if(herox(0)==45,and,heroy(0)==97) then(mrup(2,0,0))
)
do(
if(herox(0)==45,and,heroy(0)==95) then(mrdown(3,0,0))
)
do(
if(herox(0)==27,and,heroy(0)==97) then(mrup(3,-3,-3))
)
do(
if(herox(0)==27,and,heroy(0)==95) then(mrdown(3,0,0))
)
do(
if(herox(0)==27,and,heroy(0)==85) then(mrup(7,0,0))
)
do(
if(herox(0)==27,and,heroy(0)==83) then(mrdown(3,-3,-3))
)
do(
if(herox(0)==17,and,heroy(0)==79) then(mrright(7,0,0))
)
do(
if(herox(0)==19,and,heroy(0)==79) then(mrleft(14,-2,-2))
)
do(
if(herox(0)==35,and,heroy(0)==79) then(mrright(14,-2,-2))
)
do(
if(herox(0)==37,and,heroy(0)==79) then(mrleft(7,0,0))
)
do(
if(herox(0)==27,and,heroy(0)==73) then(
	if(check tag(405)) then(mrup(8,0,0))
	else(manxrunsaway)
)
)
do(
if(herox(0)==27,and,heroy(0)==71) then(mrdown(7,0,0))
)
do(
if(herox(0)==17,and,heroy(0)==66) then(
	if(check tag(405)) then(mrright(8,0,0))
	else(manxrunsaway)
)
)
do(
if(herox(0)==19,and,heroy(0)==66) then(mrleft(14,-2,-2))
)
do(
if(herox(0)==35,and,heroy(0)==66) then(mrright(14,-2,-2))
)
do(
if(herox(0)==37,and,heroy(0)==66) then(
	if(check tag(405)) then(mrleft(8,0,0))
	else(manxrunsaway)
)
)
do(
if(herox(0)==27,and,heroy(0)==61) then(

if(check tag(134)==false) then(manxhype)
else(mrup(10,0,0))

)
)
do(
if(herox(0)==27,and,heroy(0)==59) then(mrdown(8,0,0))
)
do(
if(herox(0)==27,and,heroy(0)==49) then(mrup(1,-4,-4))
)
do(
if(herox(0)==27,and,heroy(0)==47) then(mrdown(10,0,0))
)
do(
if(herox(0)==27,and,heroy(0)==37) then(mrup(5,1,1))
)
do(
if(herox(0)==27,and,heroy(0)==35) then(mrdown(1,-4,-4))
)
do(
if(herox(0)==4,and,heroy(0)==81) then(
write pass block(4,82,128)
write pass block(4,83,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (5,-5,-5)
update palette
wait (2)
tweak palette (0,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

camera follows hero(0)
set hero position(0,63,78)
wait(1)
pan camera(south,0,0)
set hero position(0,58,72)
write pass block(4,82,0)
write pass block(4,83,1+2+4+8)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-12,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (5,-2,-2)
update palette
wait (2)

settp(5,-2,-2)

walk hero(0,down,9)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==4,and,heroy(0)==64) then(
write pass block(4,65,128)
write pass block(4,66,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (5,-5,-5)
update palette
wait (2)
tweak palette (0,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

camera follows hero(0)
set hero position(0,63,66)
wait(1)
pan camera(south,0,0)
set hero position(0,58,60)
write pass block(4,65,0)
write pass block(4,66,1+2+4+8)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-12,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (5,-2,-2)
update palette
wait (2)

settp(5,-2,-2)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==50,and,heroy(0)==81) then(
write pass block(50,82,128)
write pass block(50,83,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (5,-5,-5)
update palette
wait (2)
tweak palette (0,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

camera follows hero(0)
set hero position(0,99,78)
wait(1)
pan camera(south,0,0)
set hero position(0,104,72)
write pass block(50,82,0)
write pass block(50,83,1+2+4+8)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-12,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (5,-2,-2)
update palette
wait (2)

settp(5,-2,-2)

walk hero(0,down,9)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==50,and,heroy(0)==64) then(
write pass block(50,65,128)
write pass block(50,66,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (5,-5,-5)
update palette
wait (2)
tweak palette (0,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

camera follows hero(0)
set hero position(0,99,66)
wait(1)
pan camera(south,0,0)
set hero position(0,104,60)
write pass block(50,65,0)
write pass block(50,66,1+2+4+8)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-12,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (5,-2,-2)
update palette
wait (2)

settp(5,-2,-2)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
do(
if(herox(0)==27,and,heroy(0)==28) then(
write pass block(27,29,128)
write pass block(27,30,128)
walk hero(0,down,2)
set hero direction(0,up)
wait for hero(0)

tweak palette (5,-5,-5)
update palette
wait (2)
tweak palette (0,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

camera follows hero(0)
set hero position(0,81,30)
wait(1)
pan camera(south,0,0)
set hero position(0,81,24)
write pass block(27,29,0)
write pass block(27,30,1+2+4+8)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-12,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (10,0,0)
update palette
wait (2)

settp(10,0,0)

walk hero(0,down,4)
set hero direction(0,up)
wait for hero(0)
)
)
end
###
##################################
script, fedoratombdoordownright, begin

if(herox(0)==105,and,heroy(0)==147) then(
write pass block(51,149,128)
write pass block(51,150,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

camera follows hero(0)
set hero position(0,45,150)
wait(1)
pan camera(south,0,0)
set hero position(0,51,150)
wait(1)

reset palette
tweak palette (-35,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-15,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (5,-1,-1)
update palette
wait (2)

settp(5,-1,-1)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(51,149,0)
write pass block(51,150,0)
)
else(
if(herox(0)==91,and,heroy(0)==149) then(mrleft(-5,-5,-5))
)
do(
if(herox(0)==89,and,heroy(0)==149) then(mrright(-5,-5,-5))
)
do(
if(herox(0)==76,and,heroy(0)==147) then(
write pass block(22,149,128)
write pass block(22,150,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,27,150)
wait(1)
pan camera(south,0,0)
set hero position(0,22,150)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)
reset palette
tweak palette (3,-3,-4)
update palette
wait (2)

settp(3,-3,-4)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
write pass block(22,149,0)
write pass block(22,150,0)
)
)
do(
if(herox(0)==99,and,heroy(0)==111) then(
write pass block(45,113,128)
write pass block(45,114,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,45,114)
wait(1)
pan camera(south,0,0)
wait(1)

reset palette
tweak palette (-40,-35,-35)
update palette
wait (2)
reset palette
tweak palette (-20,-15,-15)
update palette
wait (2)
reset palette
tweak palette (-10,-5,-5)
update palette
wait (2)
reset palette
tweak palette (-5,0,0)
update palette
wait (2)
reset palette
tweak palette (1,6,4)
update palette
wait (2)

settp(1,6,4)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(45,113,0)
write pass block(45,114,0)
)
)
do(
if(herox(0)==99,and,heroy(0)==121) then(mrup(-5,-5,-5,afternoon))
)
do(
if(herox(0)==99,and,heroy(0)==119) then(mrdown(-5,-7,-7,night))
)
do(
if(herox(0)==99,and,heroy(0)==133) then(mrup(-5,-7,-7))
)
do(
if(herox(0)==99,and,heroy(0)==131) then(mrdown(-4,-9,-9))
)
do(
if(herox(0)==89,and,heroy(0)==138) then(mrright(-4,-9,-9))
)
do(
if(herox(0)==91,and,heroy(0)==138) then(
	mrleft(-4,-9,-9)
	if(check tag(582)==false) then(
		show backdrop(7)
		wait(3)
		show map
		tb(7343)
		set tag(582,1)
	)
)
)
do(
if(herox(0)==71,and,heroy(0)==138) then(mrright(-4,-9,-9))
)
do(
if(herox(0)==73,and,heroy(0)==138) then(mrleft(-4,-9,-9))
)
do(
if(herox(0)==63,and,heroy(0)==133) then(mrup(-5,-5,-5,afternoon))
)
do(
if(herox(0)==63,and,heroy(0)==131) then(mrdown(-4,-9,-9,night))
)
do(
if(herox(0)==63,and,heroy(0)==122) then(
write pass block(9,124,128)
write pass block(9,125,128)
walk hero(0,up,2)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,9,126)
wait(1)
pan camera(south,0,0)
set hero position(0,9,125)
wait(1)

reset palette
tweak palette (-40,-35,-35)
update palette
wait (2)
reset palette
tweak palette (-20,-15,-15)
update palette
wait (2)
reset palette
tweak palette (-10,-5,-5)
update palette
wait (2)
reset palette
tweak palette (-5,0,0)
update palette
wait (2)
reset palette
tweak palette (0,4,3)
update palette
wait (2)

settp(0,4,3)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(9,124,0)
write pass block(9,125,0)
)
)
do(
if(herox(0)==85,and,heroy(0)==111) then(
write pass block(31,113,128)
write pass block(31,114,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,27,114)
wait(1)
pan camera(south,0,0)
set hero position(0,31,114)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)
reset palette
tweak palette (2,0,-1)
update palette
wait (2)

settp(2,0,-1)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(31,113,0)
write pass block(31,114,0)
)
)
do(
if(herox(0)==78,and,heroy(0)==111) then(
write pass block(24,113,128)
write pass block(24,114,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,27,114)
wait(1)
pan camera(south,0,0)
set hero position(0,24,114)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)
reset palette
tweak palette (2,0,-1)
update palette
wait (2)

settp(2,0,-1)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
write pass block(24,113,0)
write pass block(24,114,0)
)
)
do(
if(herox(0)==85,and,heroy(0)==121) then(mrup(-5,-5,-5))
)
do(
if(herox(0)==85,and,heroy(0)==119) then(mrdown(-7,-7,-7))
)
do(
if(herox(0)==73,and,heroy(0)==114) then(mrleft(-7,-7,-7))
)
do(
if(herox(0)==71,and,heroy(0)==114) then(mrright(-5,-5,-5))
)
do(
if(herox(0)==63,and,heroy(0)==109) then(mrup(-5,-5,-5))
)
do(
if(herox(0)==63,and,heroy(0)==107) then(mrdown(-7,-7,-7))
)
do(
if(herox(0)==61,and,heroy(0)==99) then(
write pass block(7,101,128)
write pass block(7,102,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,9,102)
wait(1)
pan camera(south,0,0)
set hero position(0,7,102)
wait(1)

reset palette
tweak palette (-40,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-20,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-10,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-5,-5,-5)
update palette
wait (2)
reset palette
tweak palette (2,0,0)
update palette
wait (2)

settp(2,0,0)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
write pass block(7,101,0)
write pass block(7,102,0)
)
)
do(
if(herox(0)==63,and,heroy(0)==83) then(mrdown(5,-2,-2))
)
do(
if(herox(0)==63,and,heroy(0)==85) then(mrup(5,-2,-2))
)
do(
if(herox(0)==71,and,heroy(0)==90) then(mrright(5,-2,-2))
)
do(
if(herox(0)==73,and,heroy(0)==90) then(mrleft(5,-2,-2))
)
do(
if(herox(0)==81,and,heroy(0)==85) then(mrup(5,-2,-2))
)
do(
if(herox(0)==81,and,heroy(0)==83) then(mrdown(5,-2,-2))
)
do(
if(herox(0)==89,and,heroy(0)==90) then(mrright(5,-2,-2))
)
do(
if(herox(0)==91,and,heroy(0)==90) then(mrleft(5,-2,-2))
)
do(
if(herox(0)==99,and,heroy(0)==85) then(mrup(5,-2,-2))
)
do(
if(herox(0)==99,and,heroy(0)==83) then(mrdown(5,-2,-2))
)
do(
if(herox(0)==99,and,heroy(0)==95) then(mrdown(10,-4,-4))
)
do(
if(herox(0)==99,and,heroy(0)==97) then(mrup(5,-2,-2))
)
do(
if(herox(0)==91,and,heroy(0)==102) then(mrleft(10,-4,-4))
)
do(
if(herox(0)==89,and,heroy(0)==102) then(mrright(10,-4,-4))
)
end
###
##################################
script, fedoratombdoorupright, begin

fedoratombdoorupright1
fedoratombdoorupright2
fedoratombdoorupright3

end
###

#####################################
script, fedoratombdoorupright1, begin
if(herox(0)==89,and,heroy(0)==30) then(mrright(15,-2,-2))
else(
if(herox(0)==91,and,heroy(0)==30) then(mrleft(10,0,0))
)
do(
if(herox(0)==101,and,heroy(0)==35) then(mrdown(20,-10,-10))
)
do(
if(herox(0)==101,and,heroy(0)==37) then(mrup(15,-2,-2))
)
do(
if(herox(0)==89,and,heroy(0)==42) then(mrright(20,-10,-10))
)
do(
if(herox(0)==91,and,heroy(0)==42) then(mrleft(20,-10,-10))
)
do(
if(herox(0)==71,and,heroy(0)==43) then(mrright(20,-10,-10))
)
do(
if(herox(0)==73,and,heroy(0)==43) then(mrleft(20,-10,-10))
)
do(
if(herox(0)==63,and,heroy(0)==37) then(mrup(20,-10,-10))
)
do(
if(herox(0)==63,and,heroy(0)==35) then(mrdown(20,-10,-10))
)
do(
if(herox(0)==61,and,heroy(0)==25) then(mrup(15,-8,-8))
)
do(
if(herox(0)==61,and,heroy(0)==23) then(mrdown(20,-10,-10))
)
do(
if(herox(0)==71,and,heroy(0)==20) then(

if(check tag(135)==false) then(manxfight)
else(mrright(10,-5,-5))

)
)
do(
if(herox(0)==73,and,heroy(0)==20) then(mrleft(15,-8,-8))
)
end
###

#####################################
script, fedoratombdoorupright2, begin
if(herox(0)==81,and,heroy(0)==13) then(

if(check tag(136)==false) then(endfedora)
else(mrup(20,-10,-10))

)
end
###

#####################################
script, fedoratombdoorupright3, begin
if(herox(0)==81,and,heroy(0)==11) then(mrdown(10,-5,-5))
else(
if(herox(0)==81,and,heroy(0)==71) then(mrdown(5,-2,-2))
)
do(
if(herox(0)==81,and,heroy(0)==73) then(mrup(5,-2,-2))
)
do(
if(herox(0)==89,and,heroy(0)==66) then(mrright(5,-2,-2))
)
do(
if(herox(0)==91,and,heroy(0)==66) then(mrleft(5,-2,-2))
)
do(
if(herox(0)==81,and,heroy(0)==61) then(mrup(5,-2,-2))
)
do(
if(herox(0)==81,and,heroy(0)==59) then(mrdown(5,-2,-2))
)
do(
if(herox(0)==89,and,heroy(0)==54) then(mrright(5,-2,-2))
)
do(
if(herox(0)==91,and,heroy(0)==54) then(mrleft(5,-2,-2))
)
do(
if(herox(0)==71,and,heroy(0)==54) then(mrright(5,-2,-2))
)
do(
if(herox(0)==73,and,heroy(0)==54) then(mrleft(5,-2,-2))
)
do(
if(herox(0)==65,and,heroy(0)==59) then(mrdown(5,-2,-2))
)
do(
if(herox(0)==65,and,heroy(0)==61) then(mrup(5,-2,-2))
)
do(
if(herox(0)==58,and,heroy(0)==80) then(
write pass block(4,82,128)
write pass block(4,83,128)
walk hero(0,up,8)
wait for hero(0)

reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,9,78)
wait(1)
pan camera(south,0,0)
set hero position(0,4,83)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (14,-2,-2)
update palette
wait (2)

settp(14,-2,-2)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
write pass block(4,82,0)
write pass block(4,83,1+2+4+8)
)
)
do(
if(herox(0)==58,and,heroy(0)==63) then(
write pass block(4,65,128)
write pass block(4,66,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,9,66)
wait(1)
pan camera(south,0,0)
set hero position(0,4,66)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (14,-2,-2)
update palette
wait (2)

settp(14,-2,-2)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,right,1)
wait for hero(0)
write pass block(4,65,0)
write pass block(4,66,1+2+4+8)
)
)
do(
if(herox(0)==104,and,heroy(0)==80) then(
write pass block(50,82,128)
write pass block(50,83,128)
walk hero(0,up,8)
wait for hero(0)

reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,45,78)
wait(1)
pan camera(south,0,0)
set hero position(0,50,83)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (14,-2,-2)
update palette
wait (2)

settp(14,-2,-2)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(50,82,0)
write pass block(50,83,1+2+4+8)
)
)
do(
if(herox(0)==104,and,heroy(0)==63) then(
write pass block(50,65,128)
write pass block(50,66,128)
walk hero(0,up,3)
wait for hero(0)

reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,45,66)
wait(1)
pan camera(south,0,0)
set hero position(0,50,66)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (14,-2,-2)
update palette
wait (2)

settp(14,-2,-2)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(50,65,0)
write pass block(50,66,1+2+4+8)
)
)
do(
if(herox(0)==81,and,heroy(0)==27) then(
write pass block(27,29,128)
write pass block(27,30,128)
walk hero(0,up,3)
wait for hero(0)

tweak palette (0,-5,-5)
update palette
wait (2)
tweak palette (-5,-10,-10)
update palette
wait (2)
tweak palette (-10,-20,-20)
update palette
wait (2)
tweak palette (-30,-40,-40)
update palette
wait (2)
tweak palette (-111,-111,-111)
update palette
wait (2)

set pal(noon)
camera follows hero(0)
set hero position(0,27,30)
wait(1)
pan camera(south,0,0)
wait(1)

reset palette
tweak palette (-30,-40,-40)
update palette
wait (2)
reset palette
tweak palette (-10,-20,-20)
update palette
wait (2)
reset palette
tweak palette (-5,-10,-10)
update palette
wait (2)
reset palette
tweak palette (0,-5,-5)
update palette
wait (2)
reset palette
tweak palette (5,-1,-1)
update palette
wait (2)

settp(5,-1,-1)

walk hero(0,up,2)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)
write pass block(27,29,0)
write pass block(27,30,1+2+4+8)
)
)
end
###

#######################
script, manxhype, begin
suspend player
suspend npcs
suspend obstruction

stop song

set npc position(4,27,54)
set npc direction(4,up)
alter npc(4,NPCstat:palette,109)
alter npc(1,NPCstat:palette,29)
alter npc(2,NPCstat:palette,33)
alter npc(3,NPCstat:palette,65)

mrup(10,0,0)

wait(4)
walk hero(0,up,1)
wait for hero(0)


set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(2,left,2)
walk npc(1,right,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)

wait(6)
jig hero(0)
tb(2181)
wait(15)
tb(2182)
jig hero(0)
tb(2183)
wait(4)
jig npc(4)
play song(15)
tb(2184)
wait(2)
tb(2185)
jig npc(1)
tb(2186)
set npc direction(4,left)
wait(2)
set npc direction(4,down)
show text box(2187)
jig npc(4)
wait for text box
tb(2188)
walk npc(4,down,1)
wait(2)
show text box(2189)
wait for npc(4)
set npc frame(4,0)
wait for text box
tb(2190)
jig npc(2)
tb(2191)
jig npc(3)
tb(2192)
tb(2193)
wait(2)
alter npc(4,NPCstat:movespeed,2)
set npc direction(4,left)
wait(2)
show text box(2194)
walk npc(4,up,2)
wait for npc(4)
set npc frame(4,0)
wait for text box
set hero speed(0,2)
walk hero(0,up,1)
wait(2)
tb(2195)
wait for hero(0)
set hero frame(0,0)
wait(6)
jig hero(0)
tb(2196)
alter npc(4,NPCstat:move speed,4)
stop song
show text box(2197)
set npc direction(4,left)
wait(2)
set npc direction(4,down)
wait for text box
wait(2)
set npc direction(4,right)
wait(2)
walk npc(4,up,5)
wait for npc(4)
set npc position(4,1,1)

set hero speed(0,hspeed)
walk npc(3,right,1)
walk npc(2,right,1)
walk npc(1,up,1)
wait for npc(3)
walk npc(3,up,1)
wait for npc(1)
walk npc(1,left,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(3)
set npc position(3,3,3)
wait for npc(1)
set npc position(1,1,3)
wait for npc(2)
walk npc(2,up,1)
wait for npc(2)
set npc position(2,2,3)
set party in
set tag(134,1)
set tag(8,0)
save game

play song(63)

resume obstruction
resume npcs
resume player
end
###

########################
script, manxfight, begin
suspend player
suspend npcs
suspend obstruction

manxfight2

manxfight2boss

manxfight3

resume obstruction
resume npcs
resume player
end
###

#########################
script, manxfight2, begin
set npc position(4,86,19)
set npc direction(4,right)
alter npc(4,NPCstat:picture,348)
alter npc(4,NPCstat:palette,109)
alter npc(1,NPCstat:palette,29)
alter npc(2,NPCstat:palette,33)
alter npc(3,NPCstat:palette,65)

stop song

mrright(10,-5,-5)

play song(8)

wait(6)
set hero speed(0,4)
walk hero(0,right,6)
wait for hero(0)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(2,down,2)
walk npc(1,up,1)
walk npc(3,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait(10)

tb(2198)
alter npc(4,NPCstat:picture,342)
wait(6)
set npc direction(4,down)
wait(2)
set npc direction(4,left)
wait(2)
jig npc(4)
play song(59)
tb(2199)
jig npc(1)
tb(2200)
jig npc(4)
tb(2201)
tb(2202)
jig npc(2)
tb(2203)
alter npc(4,NPCstat:picture,179)
set npc direction(4,up)
wait(4)
set npc frame(4,1)
show text box(2204)
wait(2)
set hero picture(0,331)
wait for text box
jig hero(0)
tb(2205)
show text box(2206)
set npc frame(4,0)
alter npc(4,NPCstat:picture,342)
set npc direction(4,left)
wait for text box
jig npc(4)
tb(2207)
set hero speed(0,2)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
wait(6)
jig hero(0)
tb(2208)
tb(2209)
tb(2210)
tb(2211)
show text box(2212)
jig hero(0)
wait for text box
wait(4)
jig npc(4)
tb(2213)
jig hero(0)
tb(2214)
walk npc(4,left,1)
wait(2)
show text box(2215)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
wait for text box
jig npc(1)
tb(2216)
jig npc(4)
tb(2217)
tb(2218)
jig hero(0)
show text box(2219)
wait(2)
alter npc(4,NPCstat:picture,348)
wait for text box
tb(2220)
wait(4)
set npc direction(4,down)
wait(4)
walk npc(4,right,1)
wait for npc(4)
stop song
tb(2221)
wait(2)
jig npc(4)
play song(15)
tb(2222)
variable(i)
variable(cx)
variable(cy)
set variable(cx,camera pixel x)
set variable(cy,camera pixel y)
write pass block(87,21,128)
write pass block(88,19,128)
suspend npc walls
variable(mn1)
variable(mn2)
variable(mn3)
variable(mn4)
set variable(mn1,create npc(5,87,22,down))
set variable(mn2,create npc(5,87,23,left))
set variable(mn3,create npc(5,88,20,down))
set variable(mn4,create npc(5,88,21,left))
wait(8)
for(i,1,20,1) do(
put camera(cx--1,cy)
wait(1)
put camera(cx+1,cy)
wait(1)
)
write pass block(87,21,1+2+4+8)
walk npc(mn1,up,2)
set npc direction(mn1,down)
walk npc(mn2,up,2)
set npc direction(mn2,left)
for(i,1,10,1) do(
put camera(cx--1,cy)
wait(1)
put camera(cx+1,cy)
wait(1)
)
write pass block(88,19,1+2+4+8)
walk npc(mn3,up,2)
set npc direction(mn3,down)
walk npc(mn4,up,2)
set npc direction(mn4,left)
for(i,1,10,1) do(
put camera(cx--1,cy)
wait(1)
put camera(cx+1,cy)
wait(1)
)
for(i,1,4,1) do(
put camera(cx--1,cy)
wait(2)
put camera(cx+1,cy)
wait(2)
)
put camera(cx,cy)
wait(15)
jig npc(4)
tb(2223)
walk npc(3,right,1)
wait(2)
show text box(2224)
wait for npc(3)
set npc frame(3,0)
wait for text box
wait(3)
set npc direction(4,down)
wait(3)
set npc direction(4,left)
wait(3)
jig npc(4)
tb(2225)
alter npc(4,NPCstat:picture,342)
stop song
show text box(2226)
jig npc(4)
wait for text box
resume npc walls
destroy npc(mn1)
destroy npc(mn2)
destroy npc(mn3)
destroy npc(mn4)
end
###

#############################
script, manxfight2boss, begin
set party in
battleflash(1)
ff(258)
stop song
end
###

#########################
script, manxfight3, begin
set tag(135,1)
set party out
swap by position(find hero(0),0)
set hero picture(0,229)
alter npc(4,NPCstat:picture,348)
wait(4)
set npc direction(4,down)
wait(8)
alter npc(4,NPCstat:picture,349)
set npc direction(4,up)
wait(4)
variable(nx)
variable(ny)
set variable(nx,npcx(4))
set variable(ny,npcy(4))
set npc direction(4,left)
put npc(4,nx*20,(ny*20)+8)

wait(20)
variable(i)
for(i,1,4,1) do(
put npc(4,(nx*20)+random(-1,1),((ny*20)+8)+random(-1,1))
wait(1)
)
put npc(4,nx*20,(ny*20)+8)
tb(2227)
set hero speed(0,2)
walk hero(0,right,4)
wait for hero(0)
set hero frame(0,0)
wait(2)
variable(hx)
variable(hy)
set variable(hx,herox(0))
set variable(hy,heroy(0))
put hero(0,(hx*20)+2,hy*20)
set hero frame(0,1)
wait(2)
put hero(0,(hx*20)+4,hy*20)
set hero frame(0,0)
wait(2)
put hero(0,(hx*20)+6,hy*20)
set hero frame(0,1)
wait(2)
set hero frame(0,0)
wait(2)
set hero picture(0,349)
set hero direction(0,right)
tb(2228)
for(i,1,4,1) do(
put npc(4,(nx*20)+random(-1,1),((ny*20)+8)+random(-1,1))
wait(1)
)
put npc(4,nx*20,(ny*20)+8)
show text box(2229)
wait(2)
set npc direction(4,down)
wait for text box
wait(6)
tb(2230)
play song(8)
wait(2)
set hero frame(0,1)

wait(150)
tb(2231)
jig npc(1)
show text box(2232)
wait(2)
set npc direction(2,up)
wait for text box
jig npc(2)
tb(2233)
alter npc(1,NPCstat:picture,333)
set npc direction(1,down)
jig npc(1)
tb(2234)
wait(2)
set npc direction(1,right)
wait(2)
tb(2235)
wait(2)
jig npc(2)
tb(2236)
wait(2)
set npc direction(1,down)
jig npc(1)
tb(2237)
jig npc(3)
tb(2238)
tb(2239)
wait(2)
show text box(2240)
wait(2)
set npc direction(1,right)
set npc direction(2,right)
wait for text box
wait(2)
set hero picture(0,344)
set hero frame(0,0)
wait(2)
tb(2241)

alter npc(1,NPCstat:movespeed,2)
alter npc(2,NPCstat:movespeed,2)
alter npc(3,NPCstat:movespeed,2)
wait(2)
walk npc(1,right,1)
walk npc(2,up,2)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc direction(2,right)
set npc frame(2,0)

wait(10)

set hero picture(0,332)
put hero(0,(hx*20)+4,hy*20)
set hero frame(0,1)
wait(2)
put hero(0,(hx*20)+2,hy*20)
set hero frame(0,0)
wait(2)
put hero(0,(hx*20),hy*20)
set hero frame(0,1)
wait(2)
set hero frame(0,0)
wait(15)

set hero direction(0,down)
wait(3)
walk hero(0,left,3)
wait for hero(0)
walk hero(0,left,1)
walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,up,1)
wait for npc(1)
set npc position(1,1,3)
wait for npc(2)
set npc position(2,2,3)
wait for npc(3)
set npc position(3,3,3)
wait for hero(0)
set hero frame(0)
set hero picture(0,229)

set party in

alter npc(1,NPCstat:movespeed,4)
alter npc(2,NPCstat:movespeed,4)
alter npc(3,NPCstat:movespeed,4)

set hero speed(0,hspeed)

write pass block(73,20,1+2+4+8)

stop song
end
###

########################
script, endfedora, begin
suspend obstruction
suspend npcs
suspend player

endfedora1
endfedora2
endfedora3
endfedora4
endfedora5

flashbackthree

resume obstruction
resume npcs
resume player
end
###

#########################
script, endfedora1, begin
set tag(136,1)
set tag(135,0)
set variable(isrunning,false)
variable(fed)
set variable(fed,create npc(5,81,4,down))

pan camera (up,6,10)
walk hero (0,up,3)
reset palette
tweak palette (20,-10,-10)
wait for camera
alter npc(5,NPCstat:picture,350)
alter npc(5,NPCstat:palette,9)
update palette
pan camera (up,6,10)
wait for camera
wait for hero (0)

set hero speed(0,4)
wait(2)
walk hero(0,up,2)
wait for hero(0)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,up,1)
walk npc(1,right,1)
walk npc(3,left,1)
set npc direction(2,up)
set npc frame(2,0)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc direction(1,up)
set npc frame(1,0)
wait for npc(3)
set npc direction(3,up)
set npc frame(3,0)

wait(4)
jig npc(3)
tb(2242)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2243)
jig hero(0)
play song(75)
tb(2244)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2245)
jig npc(1)
tb(2246)
jig hero(0)
tb(2247)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2248)
jig hero(0)
tb(2249)
wait(3)
show backdrop(1)
wait(2)
show map
wait(2)
show backdrop(1)
wait(2)
show map
tb(2250)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2251)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2252)
wait(4)
jig hero(0)
tb(2253)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2254)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2255)
jig npc(2)
tb(2256)
wait(3)
show backdrop(1)
wait(3)
show map
tb(2257)
wait(2)
suspend npc walls
walk npc(fed,down,2)
wait for npc(fed)
variable(i)
for(i,1,4,1) do(
alter npc(5,NPCstat:picture,155)
wait(2)
alter npc(5,NPCstat:picture,350)
wait(2)
)
for(i,1,2,1) do(
alter npc(5,NPCstat:picture,155)
wait(3)
alter npc(5,NPCstat:picture,350)
wait(3)
)
alter npc(5,NPCstat:picture,155)
wait(3)
show backdrop(1)
wait(3)
show map
walk npc(fed,down,1)
tb(2258)
wait for npc(fed)
set tag(135,1)
resume npc walls
stop song
tb(3821)
get item(185,1)
end
###

#########################
script, endfedora2, begin
variable(i)
wait(5)
set hero direction(0,right)
wait(3)
set hero direction(0,down)
wait(5)
jig npc(2)
tb(2259)
alter npc(1,NPCstat:picture,333)
set npc direction(1,left)
jig npc(1)
tb(2260)
jig hero(0)
tb(2261)

palout(3)
camera follows hero(0)
set hero position(0,27,102)
wait(1)
pan camera(south,0,0)
set hero position(0,20,102)
set npc position(1,22,102)
set npc position(2,23,101)
set npc position(3,27,101)
set hero direction(0,left)
set npc direction(1,left)
set npc direction(2,left)
set npc direction(3,left)
alter npc(1,NPCstat:picture,232)
show backdrop(0)
wait(1)
palin(3)
wait(20)
tb(2262)

palout(3)
show map
wait(1)
palin(3)

wait(3)
set hero direction(0,down)
set npc direction(2,down)
wait(3)
set hero direction(0,right)
set npc direction(2,right)
set npc direction(1,down)
wait(3)
set npc direction(1,right)

wait(8)
jig npc(2)
tb(2263)
wait(3)
alter npc(3,NPCstat:picture,199)
wait(6)
jig npc(3)
play song(71)
tb(2264)
tb(2265)
show text box(2266)
wait(2)
set npc direction(3,up)
wait for text box
jig npc(1)
tb(2267)
tb(2268)
wait(12)
set npc direction(3,left)
wait(6)
jig npc(3)
tb(2269)
jig npc(1)
tb(2270)
variable(jy)
set variable(jy,npc pixel y(2))
set npc direction(2,down)
wait(3)
put npc(2,npc pixel x(2),jy--3)
wait(3)
put npc(2,npc pixel x(2),jy)
show text box(2271)
wait(2)
alter npc(1,NPCstat:picture,83)
set npc direction(1,up)
for(i,1,7,1) do(
wait(1)
set npc frame(1,1)
wait(1)
set npc frame(1,0)
)
for(i,1,3,1) do(
wait(2)
set npc frame(1,1)
wait(2)
set npc frame(1,0)
)
wait for text box
end
###

#########################
script, endfedora3, begin
palout(3)
camera follows hero(0)
set hero position(0,45,186)
wait(1)
pan camera(south,0,0)
alter npc(1,NPCstat:picture,232)
alter npc(3,NPCstat:picture,138)
set hero position(0,45,180)
wait(10)
palin(3)

wait(6)
walk hero(0,down,7)
wait for hero(0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,up,1)
walk npc(1,right,1)
walk npc(3,down,1)
walk npc(2,left,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait(2)
set hero direction(0,down)
set npc direction(1,left)
set npc direction(3,up)
set npc direction(2,right)

jig hero(0)
tb(2272)
jig npc(3)
show text box(2273)
wait(3)
alter npc(3,NPCstat:picture,199)
alter npc(1,NPCstat:picture,333)
wait for text box
jig npc(1)
show text box(2274)
wait(2)
alter npc(1,NPCstat:picture,340)
set npc direction(1,up)
wait(4)
set npc frame(1,1)
set hero picture(0,332)
set hero direction(0,right)
wait for text box
jig hero(0)
stop song
tb(2275)
play song(87)
set npc frame(1,0)
wait(3)
alter npc(1,NPCstat:picture,333)
set npc direction(1,left)
wait(3)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
set hero speed(0,2)
walk hero(0,left,1)
set npc direction(2,up)
set hero direction(0,right)
show text box(2276)
wait for hero(0)
set hero frame(0,0)
wait for text box
wait(10)
jig hero(0)
tb(2277)
walk npc(1,left,1)
wait for npc(1)
set npc frame(1,0)
walk hero(0,left,1)
set hero direction(0,right)
jig npc(1)
show text box(2278)
wait for hero(0)
set npc direction(2,left)
walk npc(1,left,1)
wait for npc(1)
set npc frame(1,0)
walk hero(0,left,1)
set hero direction(0,right)
jig npc(1)
wait for hero(0)
set hero frame(0,0)
set npc direction(3,left)
walk npc(1,left,1)
wait for npc(1)
set npc frame(1,0)
wait for text box
jig npc(2)
tb(2279)
wait(15)
tb(2280)
jig hero(0)
tb(2281)

wait(25)

tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(4)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)

tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,4,0)
update palette
wait (1)
tweak palette (0,8,0)
update palette
reset palette
wait (1)
tweak palette (0,16,0)
update palette
reset palette
wait (1)
tweak palette (0,63,0)
update palette

#teleport to map(0,0,0)
show backdrop(0)
wait (1)

stop song

reset palette
tweak palette (0,16,0)
update palette
wait (1)
reset palette
tweak palette (0,8,0)
update palette
wait (1)
reset palette
tweak palette (0,4,0)
update palette
wait (1)
reset palette
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette

wait(15)
play song(15)
jig gahn
tb(2282)
wait(2)
jig gahn
tb(2283)
wait(10)
jig gahn
tb(2284)
wait(2)
jig gahn
tb(2285)

palout(5)
set hero picture(0,229)
camera follows hero(0)
teleport to map(24+poff,17,83)
stop song
set hp
show map
wait(1)
pan camera(south,0,0)
set hero position(0,17,78)
set npc position(5,17,86)
set npc direction(5,up)
end
###

#########################
script, endfedora4, begin
wait(1)

variable(thug1)
variable(thug2)
variable(thug3)
variable(thug4)
variable(thug5)
variable(thug6)
variable(thug7)
variable(thug8)
variable(thug9)
variable(thug10)
variable(thug11)
variable(thug12)
wait(1)
set variable(thug1,create npc(8,14,87,up))
set variable(thug2,create npc(7,15,87,up))
set variable(thug3,create npc(8,16,87,up))
set variable(thug4,create npc(7,17,87,up))
wait(1)
set variable(thug5,create npc(7,18,87,up))
set variable(thug6,create npc(8,19,87,up))
set variable(thug7,create npc(7,20,87,up))
set variable(thug8,create npc(8,15,88,up))
wait(1)
set variable(thug9,create npc(7,16,88,up))
set variable(thug10,create npc(8,17,88,up))
set variable(thug11,create npc(7,18,88,up))
set variable(thug12,create npc(8,19,88,up))
wait(1)
write map block(17,79,143)
write pass block(17,79,0)
wait(1)
palin(5)
wait(10)

alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)

walk hero(0,down,5)
wait for hero(0)
set hero frame(0,0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,left,1)
walk npc(3,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait(2)
set npc direction(3,down)

wait(10)
jig npc(5)
tb(2286)
wait(3)
set npc direction(5,right)
wait(3)
set npc direction(5,down)
wait(3)
jig npc(5)
show text box(2287)
wait(3)
set hero picture(0,331)
wait for text box
wait(3)
jig hero(0)
tb(2288)
wait(3)
set npc direction(5,right)
wait(3)
jig npc(5)
play song(64)
tb(2289)
wait(12)
set npc direction(5,down)
jig npc(5)
tb(2290)
walk npc(thug2,up,1)
walk npc(thug3,up,1)
walk npc(thug5,up,1)
walk npc(thug6,up,1)
walk npc(thug8,up,1)
walk npc(thug9,up,1)
walk npc(thug11,up,1)
walk npc(thug12,up,1)
walk npc(thug10,right,1)
wait for npc(thug10)
walk npc(thug2,up,1)
walk npc(thug3,up,1)
walk npc(thug5,up,1)
walk npc(thug6,up,1)
walk npc(thug8,up,1)
walk npc(thug9,up,1)
walk npc(thug11,up,1)
walk npc(thug12,up,1)
walk npc(thug10,up,1)
walk npc(thug4,left,1)
walk npc(thug1,right,1)
walk npc(thug7,left,1)
wait for npc(thug7)
walk npc(thug2,up,1)
walk npc(thug3,up,1)
walk npc(thug5,up,1)
walk npc(thug6,up,1)
walk npc(thug8,up,1)
walk npc(thug9,up,1)
walk npc(thug11,up,1)
walk npc(thug12,up,1)
walk npc(thug10,up,1)
walk npc(thug4,up,1)
walk npc(thug1,up,1)
walk npc(thug7,up,1)
wait for npc(thug7)
wait(5)
end
###

#########################
script, endfedora5, begin
walk npc(5,down,1)
wait(2)
jig hero(0)
show text box(2291)
wait for npc(5)
set npc frame(5,0)
wait for text box
tb(2292)
wait(3)
set npc direction(5,right)
wait(20)
jig npc(5)
tb(2293)
wait(3)
set npc direction(5,down)
jig npc(5)
tb(2294)

wait(5)
stop song
battleflash
wait(3)
show backdrop(1)
wait(3)
show map
wait(3)
fade screen out(63,0,0)
camera follows hero(0)
teleport to map(37+poff,10,6)
stop song
wait(1)
show backdrop(0)
wait(1)
fade screen in

wait(50)
tb(2295)
wait(10)
tb(2296)
wait(10)
tb(2297)
tb(2298)
wait(15)
tb(2299)
tb(2300)

reset palette
tweak palette(-111,-111,-111)
update palette
wait(1)
show map
wait(5)
reset palette
tweak palette(-40,-40,-40)
update palette
wait(15)
show backdrop(0)
wait(1)
reset palette
update palette
wait(1)

tb(2301)

reset palette
tweak palette(-111,-111,-111)
update palette
wait(1)
show map
wait(5)
reset palette
tweak palette(-40,-40,-40)
update palette
wait(10)
reset palette
tweak palette(-30,-30,-30)
update palette
wait(20)
reset palette
tweak palette(-40,-40,-40)
update palette
wait(10)
show backdrop(0)
wait(1)
reset palette
update palette
wait(1)

tb(2302)

reset palette
tweak palette(-111,-111,-111)
update palette
wait(1)
show map
wait(5)
reset palette
tweak palette(-40,-40,-40)
update palette
wait(5)
reset palette
tweak palette(-30,-30,-30)
update palette
wait(10)
reset palette
tweak palette(-15,-15,-15)
update palette
wait(20)
reset palette
tweak palette(-30,-30,-30)
update palette
wait(10)
reset palette
tweak palette(-40,-40,-40)
update palette
wait(5)
show backdrop(0)
wait(1)
reset palette
update palette
wait(1)

tb(2303)
wait(30)
play song(69)
tb(2304)
tb(2305)
tb(2306)
wait(10)
tb(2307)
wait(20)
tb(2308)
wait(10)
stop song
tb(2309)

palout(1)
teleport to map(0,0,0)
wait(1)
show map
end
###

#############################
script, flashbackthree, begin
wait(40)

variable(k)
for(k,103,114,1) do(
set tag(k,0))

set hero speed(0,hspeed)
set hero frame(0,0)
set tag(8,0)
camera follows hero(0)
teleport to map(89,1,3)
stop song
wait(1)
set hero palette(find hero(0),3)
load tileset(95)
alter NPC(35,NPCstat:script argument,95)
set hero picture(find hero(0),198)
set hero palette(find hero(0),1)
set hero direction(0,down)
set hero frame(0,0)
swap out hero(1)
swap out hero(2)
swap out hero(3)
lock hero(1)
lock hero(2)
lock hero(3)
wait(15)

play song(31)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (10)
reset palette
greyscale palette
update palette

wait(30)
fade screen out(63,63,63)
reset palette
wait(1)
fade screen in

wait(15)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)

set variable(isrunning,0)
swap out hero(find hero(1))
lock hero(find hero(1))
swap out hero(find hero(2))
lock hero(find hero(2))
wait(1)

reset palette
tweak palette (-3,-3,0)
update palette
wait (1)
reset palette
tweak palette (-2,-2,0)
update palette
wait (1)
reset palette
tweak palette (-1,-1,0)
update palette
wait (1)
reset palette
update palette
end
###

##########################
script, begincyport, begin
suspend player
suspend npcs
suspend obstruction

play song(19)

jig npc(2)
tb(2328)
tb(2329)
wait(10)
jig npc(2)
tb(2330)
tb(2331)
suspend box advance
show text box(2332)
wait for key(use key)
palout(10)
wait(1)
advance text box
resume box advance
wait(50)
camera follows hero(0)
teleport to map(0,0,0)
wait(1)
palin(1)

tb(2333)
wait(15)
tb(2334)
wait(15)
tb(2335)
tb(2336)
wait(3)
show backdrop(1)
wait(3)
show map
wait(8)
tb(2337)
wait(5)
tb(2338)
wait(3)
tb(2339)

palout(1)
teleport to map(37,12,42)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,12,46)
set npc position(1,12,46)
set npc position(2,12,46)
set npc position(3,12,46)
write pass block(12,46,128)
write pass block(12,45,128)
write pass block(12,44,0)
set hero speed(0,4)
set hero picture(0,229)
wait(1)
palin(20)

play song(17)

walk npc(2,up,1)
wait for npc(2)
walk npc(2,up,1)
walk npc(1,up,1)
wait for npc(1)
walk npc(2,up,1)
walk npc(1,up,1)
walk hero(0,up,1)
wait for hero(0)
walk npc(2,up,1)
walk npc(1,up,1)
walk npc(3,up,1)
walk hero(0,up,1)
wait for hero(0)
walk npc(2,up,1)
walk npc(1,up,1)
walk npc(3,up,1)
walk hero(0,up,1)
wait for hero(0)
walk npc(1,right,1)
walk npc(3,up,1)
walk hero(0,up,1)
wait for hero(0)
walk hero(0,left,1)
set npc frame(1,0)
set npc direction(1,down)
set npc frame(2,0)
set npc direction(2,right)
set npc frame(3,0)
wait for hero(0)
set hero frame(0,0)
set npc direction(2,down)
set npc direction(1,left)
wait(3)
set hero direction(0,up)
wait(5)
set hero direction(0,left)
wait(5)
set hero direction(0,down)
wait(5)
set hero direction(0,left)
wait(20)

write pass block(12,46,2+4+8)
write pass block(12,45,0)
write pass block(12,44,2+4+8)

jig hero(0)
tb(2340)
jig npc(2)
tb(2341)
wait(3)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
wait(6)
tb(2342)
jig npc(3)
tb(2343)
set hero direction(0,down)
jig hero(0)
show text box(2344)
wait(3)
alter npc(1,NPCstat:picture,333)
wait for text box
jig npc(1)
play song(84)
tb(2345)
wait(3)
set hero picture(0,332)
wait(10)
jig hero(0)
tb(2346)
jig npc(1)
tb(2347)
wait(2)
alter npc(1,NPCstat:picture,340)
set npc direction(1,up)
show text box(2348)
wait(6)
set npc frame(1,1)
wait(3)
set hero direction(0,right)
wait for text box
jig npc(2)
tb(2349)
alter npc(1,NPCstat:picture,333)
set npc direction(1,left)
wait(2)
set npc direction(1,up)
show text box(2350)
jig npc(1)
wait for text box
wait(4)
jig npc(3)
show text box(2351)
wait(4)
set npc direction(1,left)
wait for text box
set hero picture(0,229)
jig hero(0)
tb(2352)
jig npc(2)
tb(2353)
wait(15)
jig hero(0)
tb(2354)
jig npc(1)
show text box(2355)
wait(3)
set hero picture(0,332)
wait for text box
wait(3)
jig hero(0)
tb(2356)
stop song

walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
alter npc(1,NPCstat:picture,232)
set hero picture(0,229)
camera follows hero(0)

set tag(3,0)
set tag(4,1)
set tag(5,0)
set tag(6,0)
set tag(433,1)

set tp

if(check tag(261)) then(
delete item(72,1)
set tag(481,1)
)

set variable(hour,noontime)

unlock hero(1)
unlock hero(2)
unlock hero(3)
swap in hero(1)
swap in hero(2)
swap in hero(3)
set hp
set party in
set hero speed(0,hspeed)
set tag(137,1)
innrest

#now in act 4
actadvance(4)

play song(17)

resume obstruction
resume npcs
resume player
end
###

#########################
script, opensaysme, begin
suspend player
suspend npcs
suspend obstruction

stop song

set tag(133,1)

variable(cx)
variable(cy)
set variable(cx,camera pixel x)
set variable(cy,camera pixel y)

variable(i)
for(i,1,10,1) do(
put camera(cx+random(-4,4),cy+random(-4,4))
wait(1)
)

write map block(17,79,143)
write pass block(17,79,0)

for(i,1,10,1) do(
put camera(cx+random(-4,4),cy+random(-4,4))
wait(1)
)

play song(17)

wait(2)
jadeup(2,1)

resume obstruction
resume npcs
resume player
end
###

#############################
script, fedoratombload, GOGOGO, begin

if(GOGOGO==0) then(fedoratombloadA)

fedoratombloadB

end
###
############################
script,fedoratombloadA,begin
#get rid of door 1
if(check tag(395)) then(
destroy npc(npc at spot(27,89))
destroy npc(npc at spot(27,88))
destroy npc(npc at spot(27,87))
destroy npc(npc at spot(27,86))
write pass block(27,89,0)
)

#get rid of door 2
if(check tag(396)) then(
destroy npc(npc at spot(27,64))
destroy npc(npc at spot(27,63))
destroy npc(npc at spot(27,62))
destroy npc(npc at spot(27,61))
create npc(35,27,61)
write pass block(27,64,0)
)

#get rid of door 3
if(check tag(397)) then(
destroy npc(npc at spot(27,41))
destroy npc(npc at spot(27,40))
destroy npc(npc at spot(27,39))
destroy npc(npc at spot(27,38))
write pass block(27,41,0)
)

#get rid of chest 1
if(check tag(398)) then(destroy npc(npc at spot(9,128)))

#get rid of chest 2
if(check tag(399)) then(destroy npc(npc at spot(79,101)))

#get rid of chest 3
if(check tag(400)) then(destroy npc(npc at spot(101,54)))

#get rid of chest 4
if(check tag(401)) then(destroy npc(npc at spot(98,54)))

#get rid of chest 5
if(check tag(402)) then(destroy npc(npc at spot(98,56)))

#get rid of chest 6
if(check tag(403)) then(destroy npc(npc at spot(101,56)))
end
###
############################
script,fedoratombloadB,begin

#pass blocks outside of ARGH MODE GRANDE
if(check tag(395)) then(write pass block(27,89,0))
if(check tag(396)) then(write pass block(27,64,0))
if(check tag(397)) then(write pass block(27,41,0))

#red up, black down
if(check tag(404)) then(
	#red down
	set npc direction(npc at spot(81,56),left)
	set npc direction(npc at spot(81,57),up)
	set npc direction(npc at spot(87,65),left)
	set npc direction(npc at spot(87,66),up)
	set npc direction(npc at spot(93,89),left)
	set npc direction(npc at spot(93,90),up)
	set npc direction(npc at spot(93,101),left)
	set npc direction(npc at spot(93,102),up)
	write pass block(81,56,0)
	write pass block(81,57,0)
	write pass block(87,66,0)
	write pass block(93,90,0)
	write pass block(93,102,0)
	#black up
	set npc direction(npc at spot(75,53),up)
	set npc direction(npc at spot(75,54),right)
	set npc direction(npc at spot(87,53),up)
	set npc direction(npc at spot(87,54),right)
	set npc direction(npc at spot(61,80),up)
	set npc direction(npc at spot(61,81),right)
	set npc direction(npc at spot(99,80),up)
	set npc direction(npc at spot(99,81),right)
		set npc frame(npc at spot(75,53),1)
		set npc frame(npc at spot(75,54),1)
		set npc frame(npc at spot(75,55),1)
		set npc frame(npc at spot(87,53),1)
		set npc frame(npc at spot(87,54),1)
		set npc frame(npc at spot(87,55),1)
		set npc frame(npc at spot(61,80),1)
		set npc frame(npc at spot(61,81),1)
		set npc frame(npc at spot(61,82),1)
		set npc frame(npc at spot(99,80),1)
		set npc frame(npc at spot(99,81),1)
		set npc frame(npc at spot(99,82),1)
	write pass block(75,54,1+2+4+8)
	write pass block(87,54,1+2+4+8)
	write pass block(61,81,1+2+4+8)
	write pass block(99,80,1+2+4+8)
	write pass block(99,81,1+2+4+8)
	set npc frame(npc at spot(82,66),0)
)
#red down, black up
else(
	#red up
	set npc direction(npc at spot(81,56),up)
	set npc direction(npc at spot(81,57),right)
	set npc direction(npc at spot(87,65),up)
	set npc direction(npc at spot(87,66),right)
	set npc direction(npc at spot(93,89),up)
	set npc direction(npc at spot(93,90),right)
	set npc direction(npc at spot(93,101),up)
	set npc direction(npc at spot(93,102),right)
	write pass block(81,56,1+2+4+8)
	write pass block(81,57,1+2+4+8)
	write pass block(87,66,1+2+4+8)
	write pass block(93,90,1+2+4+8)
	write pass block(93,102,1+2+4+8)
	#black down
	set npc direction(npc at spot(75,53),left)
	set npc direction(npc at spot(75,54),up)
	set npc direction(npc at spot(87,53),left)
	set npc direction(npc at spot(87,54),up)
	set npc direction(npc at spot(61,80),left)
	set npc direction(npc at spot(61,81),up)
	set npc direction(npc at spot(99,80),left)
	set npc direction(npc at spot(99,81),up)
		set npc frame(npc at spot(75,53),1)
		set npc frame(npc at spot(75,54),1)
		set npc frame(npc at spot(75,55),1)
		set npc frame(npc at spot(87,53),1)
		set npc frame(npc at spot(87,54),1)
		set npc frame(npc at spot(87,55),1)
		set npc frame(npc at spot(61,80),1)
		set npc frame(npc at spot(61,81),1)
		set npc frame(npc at spot(61,82),1)
		set npc frame(npc at spot(99,80),1)
		set npc frame(npc at spot(99,81),1)
		set npc frame(npc at spot(99,82),1)
	write pass block(75,54,0)
	write pass block(87,54,0)
	write pass block(61,81,0)
	write pass block(99,80,0)
	write pass block(99,81,0)
	set npc frame(npc at spot(82,66),1)
)
end
###
#########################
script, scarfsleep, begin
suspend player
alter npc(4,NPCstat:picture,352)
alter npc(4,NPCstat:displaytext,2319)
set tag(138,1)
resume player
end
###

#############################
script, cyportwestdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==78,and,heroy(0)==23) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,right,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,15,52)
wait(1)
pan camera(south,0,0)
set hero position(0,10,52)
wait(1)
walk hero(0,right,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if(herox(0)==78,and,heroy(0)==24) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,right,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,15,53)
wait(1)
pan camera(south,0,0)
set hero position(0,10,53)
wait(1)
walk hero(0,right,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==78,and,heroy(0)==25) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,right,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,15,54)
wait(1)
pan camera(south,0,0)
set hero position(0,10,54)
wait(1)
walk hero(0,right,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==78,and,heroy(0)==37) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,right,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,15,66)
wait(1)
pan camera(south,0,0)
set hero position(0,10,66)
wait(1)
walk hero(0,right,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==78,and,heroy(0)==38) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,right,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,15,67)
wait(1)
pan camera(south,0,0)
set hero position(0,10,67)
wait(1)
walk hero(0,right,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==78,and,heroy(0)==39) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,right,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,15,68)
wait(1)
pan camera(south,0,0)
set hero position(0,10,68)
wait(1)
walk hero(0,right,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)

palout(time)

if(herox(0)==51,and,heroy(0)==16) then(
teleport to map(41+poff,4,7))
else(
if(herox(0)==61,and,heroy(0)==16) then(
teleport to map(41+poff,3,24))
)
do(
if(herox(0)==56,and,heroy(0)==25) then(
teleport to map(41+poff,4,42))
)
do(
if(herox(0)==66,and,heroy(0)==25) then(
teleport to map(41+poff,4,60))
)
do(
if(herox(0)==75,and,heroy(0)==35) then(
teleport to map(41+poff,3,77))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

############################
script, cyportcomdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

cyportcomdoorA
cyportcomdoorB
cyportcomdoorC

set tag(8,0)
resume obstruction
resume npcs
resume player
end
###
#############################
script, cyportcomdoorA, begin
if(herox(0)==40,and,heroy(0)==146) then(
stop song
set variable(isrunning,false)
walk hero(0,up,2)
wait for hero(0)
palout(3)
camera follows hero(0)
if(check tag(4)) then(teleport to map(53+poff,10,10))
if(check tag(5)) then(teleport to map(53+poff,28,10))
if(check tag(6)) then(teleport to map(53+poff,46,10))
if(check tag(3)) then(teleport to map(53+poff,64,10))
stop song
load tileset(105)
wait(1)
pan camera(up,4,20)
wait for camera
pan camera(left,1,20)
wait for camera
wait(1)
palin(3)
play song(17)
walk hero(0,up,1)
wait for hero(0)
#one time jadeup
if(check tag(655)==false) then(
	set tag(655,1)
	jadeup(2)
)
)
else(
if(herox(0)==7,and,heroy(0)==93) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,2,150)
wait(1)
pan camera(south,0,0)
set hero position(0,2,153)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0))
)
do(
if(herox(0)==2,and,heroy(0)==153) then(
	#if katina talk battle over
	if(check tag(649)) then(
		palout(2)
		camera follows hero(0)
		set hero position(0,7,94)
		wait(1)
		pan camera(south,0,0)
		set hero position(0,7,92)
		wait(1)
		palin(2)
		walk hero(0,down,2)
		wait for hero(0)
		camera follows hero(0)
	)
	else(
		walk hero(0,up,1)
		wait for hero(0)
		set hero frame(0,0)
		wait(1)
	)
)
)
end
###
#############################
script, cyportcomdoorB, begin
if(herox(0)==2,and,heroy(0)==149) then(
	if(check tag(143)) then(
		if(check tag(172)==false) then(katinafight)
		else(
			pan camera(south,0,0)
			walk hero(0,up,1)
			wait for hero(0)
			palout(2)
			camera follows hero(0)
			set hero position(0,4,171)
			wait(1)
			pan camera(south,0,0)
			set hero position(0,4,172)
			wait(1)
			palin(2)
			walk hero(0,up,1)
			wait for hero(0)
			camera follows hero(0)
		)
	)
	else(katinatalk)
)
end
###
#############################
script, cyportcomdoorC, begin
if(herox(0)==4,and,heroy(0)==172) then(
palout(2)
camera follows hero(0)
set hero position(0,2,150)
wait(1)
pan camera(south,0,0)
set hero position(0,2,148)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0))
else(
if(herox(0)==19,and,heroy(0)==1) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,19,44)
wait(1)
pan camera(south,0,0)
set hero position(0,19,46)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0))
)
do(
if(herox(0)==19,and,heroy(0)==46) then(
palout(2)
camera follows hero(0)
set hero position(0,19,2)
wait(1)
pan camera(south,0,0)
set hero position(0,19,0)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==34,and,heroy(0)==57) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,39,85)
wait(1)
pan camera(south,0,0)
set hero position(0,39,86)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==39,and,heroy(0)==86) then(
palout(2)
set hero position(0,34,58)
wait(1)
pan camera(south,0,0)
set hero position(0,34,56)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==20,and,heroy(0)==57) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,25,103)
wait(1)
pan camera(south,0,0)
set hero position(0,25,104)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==25,and,heroy(0)==104) then(
palout(2)
set hero position(0,20,58)
wait(1)
pan camera(south,0,0)
set hero position(0,20,56)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==24,and,heroy(0)==102) then(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,25,117)
wait(1)
pan camera(south,0,0)
set hero position(0,24,113)
wait(1)
palin(2)
walk hero(0,down,3)
wait for hero(0))
)
do(
if(herox(0)==24,and,heroy(0)==115) then(
walk hero(0,up,2)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,24,101)
wait(1)
pan camera(south,0,0)
set hero position(0,24,103)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==26,and,heroy(0)==119) then(
stop song
walk hero(0,down,9)
wait(5)
pan camera(south,7,10)
wait(10)
palout(5)
wait for camera
wait for hero(0)
camera follows hero(0)
teleport to map(57,115,5)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,115,1)
set pal(noon)
wait(1)
palin(5)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==26,and,heroy(0)==98) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,40,103)
wait(1)
pan camera(south,0,0)
set hero position(0,40,104)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==40,and,heroy(0)==104) then(
palout(2)
set hero position(0,26,99)
wait(1)
pan camera(south,0,0)
set hero position(0,26,97)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==38,and,heroy(0)==98) then(
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,39,117)
wait(1)
pan camera(south,0,0)
set hero position(0,38,120)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0))
)
do(
if(herox(0)==38,and,heroy(0)==119) then(
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,38,99)
wait(1)
pan camera(south,0,0)
set hero position(0,38,95)
wait(1)
palin(2)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==40,and,heroy(0)==115) then(
pan camera(south,0,0)
walk hero(0,up,2)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,39,133)
wait(1)
pan camera(south,0,0)
set hero position(0,40,136)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0))
)
do(
if(herox(0)==40,and,heroy(0)==135) then(
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,39,117)
wait(1)
pan camera(south,0,0)
set hero position(0,40,113)
wait(1)
palin(2)
walk hero(0,down,3)
wait for hero(0))
)
do(
if(herox(0)==38,and,heroy(0)==131) then(
pan camera(south,0,0)
walk hero(0,up,2)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,39,148)
wait(1)
pan camera(south,0,0)
set hero position(0,38,151)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0))
)
do(
if(herox(0)==38,and,heroy(0)==150) then(
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,39,133)
wait(1)
pan camera(south,0,0)
set hero position(0,38,129)
wait(1)
palin(2)
walk hero(0,down,3)
wait for hero(0))
)
do(
if(herox(0)==55,and,heroy(0)==3) then(
set npc position(10,52,22)
walk hero(0,up,1)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,52,44)
wait(1)
pan camera(south,0,0)
set hero position(0,52,46)
wait(1)
palin(3)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==52,and,heroy(0)==46) then(
palout(3)
camera follows hero(0)
set hero position(0,52,4)
wait(1)
pan camera(south,0,0)
set hero position(0,55,2)
wait(1)
palin(3)
walk hero(0,down,2)
wait for hero(0))
)
do(
if(herox(0)==1,and,heroy(0)==133) then(
stop song
palout(5)
camera follows hero(0)
set hero position(0,49,4)
wait(1)
pan camera(south,0,0)
set hero position(0,49,1)
load tileset(104)
wait(5)
play song(9)
palin(5)
wait(20)
suspend hero walls
set hero speed(0,2)
walk hero(0,down,3)
set hero direction(0,up)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
set hero speed(0,hspeed)
resume hero walls
)
)

if(herox(0)==4,and,heroy(0)==8) then(
	palout(1)
	teleport to map(37+poff,51,17)
	palin(1)
)
else(
	if(herox(0)==3,and,heroy(0)==25) then(
		if(check tag(469)==false,and,check tag(296)==false) then(
			lootcyport
		)
		else(
			palout(1)
			teleport to map(37+poff,61,17)
			palin(1)
		)
	)
)
do(
	if(herox(0)==4,and,heroy(0)==43) then(
		palout(1)
		teleport to map(37+poff,56,26)
		palin(1)
	)
)
do(
	if(herox(0)==4,and,heroy(0)==61) then(
		palout(1)
		teleport to map(37+poff,66,26)
		palin(1)
	)
)
do(
	if(herox(0)==3,and,heroy(0)==78) then(
		palout(1)
		teleport to map(37+poff,75,36)
		palin(1)
	)
)
do(
	if(herox(0)==7,and,heroy(0)==100) then(
		palout(1)
		teleport to map(45+poff,55,64)
		palin(1)
	)
)
do(
	if(herox(0)==4,and,heroy(0)==121) then(
		palout(1)
		teleport to map(53+poff,30,50)
		palin(1)
	)
)
do(
	if(herox(0)==5,and,heroy(0)==137) then(
		if(check tag(424),and,check tag(425)==false) then(worldending3)
		else(
			palout(1)
			teleport to map(53+poff,20,51)
			palin(1)
		)
	)
)
do(
	if(herox(0)==22,and,heroy(0)==15) then(
		if(check tag(424),and,check tag(425)==false) then(worldending)
		else(
			palout(1)
			teleport to map(45+poff,43,79)
			palin(1)
		)
	)
)
do(
	if(herox(0)==22,and,heroy(0)==33) then(
		palout(1)
		teleport to map(45+poff,69,60)
		palin(1)
	)
)
do(
	if(herox(0)==27,and,heroy(0)==66) then(
		palout(1)
		teleport to map(53+poff,41,37)
		palin(1)
	)
)

set hero frame(0,0)

end
###
################################
script, cyportcentraldoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==14,and,heroy(0)==52) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(37+poff,77,23)
wait(1)
pan camera(south,0,0)
set hero position(0,82,23)
wait(1)
walk hero(0,left,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if(herox(0)==14,and,heroy(0)==53) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(37+poff,77,24)
wait(1)
pan camera(south,0,0)
set hero position(0,82,24)
wait(1)
walk hero(0,left,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==14,and,heroy(0)==54) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(37+poff,77,25)
wait(1)
pan camera(south,0,0)
set hero position(0,82,25)
wait(1)
walk hero(0,left,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==14,and,heroy(0)==66) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(37+poff,77,37)
wait(1)
pan camera(south,0,0)
set hero position(0,82,37)
wait(1)
walk hero(0,left,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==14,and,heroy(0)==67) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(37+poff,77,38)
wait(1)
pan camera(south,0,0)
set hero position(0,82,38)
wait(1)
walk hero(0,left,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==14,and,heroy(0)==68) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(37+poff,77,39)
wait(1)
pan camera(south,0,0)
set hero position(0,82,39)
wait(1)
walk hero(0,left,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==51,and,heroy(0)==31) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(53+poff,31,56)
wait(1)
pan camera(south,0,0)
set hero position(0,31,61)
wait(1)
walk hero(0,up,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==52,and,heroy(0)==31) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(53+poff,32,56)
wait(1)
pan camera(south,0,0)
set hero position(0,32,61)
wait(1)
walk hero(0,up,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==53,and,heroy(0)==31) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(53+poff,33,56)
wait(1)
pan camera(south,0,0)
set hero position(0,33,61)
wait(1)
walk hero(0,up,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==32,and,heroy(0)==92) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(81+poff,16,43)
wait(1)
pan camera(south,0,0)
set hero position(0,16,38)
wait(1)
walk hero(0,down,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==33,and,heroy(0)==92) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(81+poff,17,43)
wait(1)
pan camera(south,0,0)
set hero position(0,17,38)
wait(1)
walk hero(0,down,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==34,and,heroy(0)==92) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(81+poff,18,43)
wait(1)
pan camera(south,0,0)
set hero position(0,18,38)
wait(1)
walk hero(0,down,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==20,and,heroy(0)==30) then(
set variable(time,0)
palout(2)
teleport to map(49+poff,2,4)
wait(1)
pan camera(south,0,0)
set hero position(0,2,0)
wait(1)
palin(2)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==26,and,heroy(0)==29) then(
set variable(time,0)
palout(2)
teleport to map(49+poff,2,21)
wait(1)
pan camera(south,0,0)
set hero position(0,2,17)
wait(1)
palin(2)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==75,and,heroy(0)==48) then(

set variable(time,0)
clothescheck(18,73,48)

)
)
do(
if(herox(0)==75,and,heroy(0)==49) then(

set variable(time,0)
clothescheck(18,74,49)

)
)
do(
if(herox(0)==75,and,heroy(0)==50) then(

set variable(time,0)
clothescheck(18,75,50)

)
)
do(
if(herox(0)==75,and,heroy(0)==62) then(

set variable(time,0)
clothescheck(13,87,62)

)
)
do(
if(herox(0)==75,and,heroy(0)==63) then(

set variable(time,0)
clothescheck(13,88,63)

)
)
do(
if(herox(0)==75,and,heroy(0)==64) then(

set variable(time,0)
clothescheck(13,89,64)

)
)

palout(time)

if(herox(0)==25,and,heroy(0)==36) then(
teleport to map(49+poff,7,9))
else(
if(herox(0)==36,and,heroy(0)==35) then(
teleport to map(49+poff,12,27))
)
do(
if(herox(0)==40,and,heroy(0)==33) then(
teleport to map(49+poff,3,45))
)
do(
if(herox(0)==44,and,heroy(0)==37) then(
teleport to map(49+poff,6,66))
)
do(
if(herox(0)==16,and,heroy(0)==50) then(
teleport to map(49+poff,2,84))
)
do(
if(herox(0)==26,and,heroy(0)==51) then(
teleport to map(49+poff,4,101))
)
do(
if(herox(0)==19,and,heroy(0)==64) then(
teleport to map(49+poff,5,116))
)
do(
if(herox(0)==30,and,heroy(0)==66) then(

if(check tag(408)) then(teleport to map(49+poff,6,134))
else(
set variable(time,0)
worldending)

)
)
do(
if(herox(0)==43,and,heroy(0)==78) then(
teleport to map(41+poff,22,14))
)
do(
if(herox(0)==55,and,heroy(0)==63) then(
teleport to map(41+poff,7,99))
)
do(
if(herox(0)==56,and,heroy(0)==37) then(
teleport to map(49+poff,2,150))
)
do(
if(herox(0)==68,and,heroy(0)==44) then(
teleport to map(49+poff,5,169))
)
do(
if(herox(0)==62,and,heroy(0)==47) then(
teleport to map(49+poff,29,8))
)
do(
if(herox(0)==69,and,heroy(0)==59) then(
teleport to map(41+poff,22,32))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

############################
script, cyportrezdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==2,and,heroy(0)==3) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map(45+poff,20,31)
set hero direction(0,down)
wait(1)
palin(2))
else(
if(herox(0)==2,and,heroy(0)==20) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map(45+poff,26,30)
set hero direction(0,down)
wait(1)
palin(2))
)
do(
if(herox(0)==24,and,heroy(0)==1) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,41,5)
wait(1)
pan camera(south,0,0)
set hero position(0,41,6)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==3,and,heroy(0)==94) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,16,98)
wait(1)
pan camera(south,0,0)
set hero position(0,16,99)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==41,and,heroy(0)==6) then(
set variable(time,0)
palout(2)
set hero position(0,24,2)
wait(1)
pan camera(south,0,0)
set hero position(0,24,0)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==16,and,heroy(0)==99) then(
set variable(time,0)
palout(2)
set hero position(0,3,95)
wait(1)
pan camera(south,0,0)
set hero position(0,3,93)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)

palout(time)

if(herox(0)==7,and,heroy(0)==10) then(
teleport to map(45+poff,25,37))
else(
if(herox(0)==12,and,heroy(0)==28) then(
teleport to map(45+poff,36,36))
)
do(
if(herox(0)==3,and,heroy(0)==46) then(
teleport to map(45+poff,40,34))
)
do(
if(herox(0)==6,and,heroy(0)==67) then(
teleport to map(45+poff,44,38))
)
do(
if(herox(0)==2,and,heroy(0)==85) then(
teleport to map(45+poff,16,51))
)
do(
if(herox(0)==4,and,heroy(0)==102) then(
teleport to map(45+poff,26,52))
)
do(
if(herox(0)==5,and,heroy(0)==117) then(
teleport to map(45+poff,19,65))
)
do(
if(herox(0)==6,and,heroy(0)==135) then(
teleport to map(45+poff,30,67))
)
do(
if(herox(0)==2,and,heroy(0)==151) then(
teleport to map(45+poff,56,38))
)
do(
if(herox(0)==5,and,heroy(0)==170) then(
teleport to map(45+poff,68,45))
)
do(
if(herox(0)==29,and,heroy(0)==9) then(
teleport to map(45+poff,62,48))
)
do(
if(herox(0)==26,and,heroy(0)==26) then(
teleport to map(53+poff,25,52))
)
do(
if(herox(0)==31,and,heroy(0)==46) then(
teleport to map(53+poff,50,53))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

##############################
script, cyportnorthdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==31,and,heroy(0)==57) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,51,32)
wait(1)
pan camera(south,0,0)
set hero position(0,51,27)
wait(1)
walk hero(0,down,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if(herox(0)==32,and,heroy(0)==57) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,52,32)
wait(1)
pan camera(south,0,0)
set hero position(0,52,27)
wait(1)
walk hero(0,down,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==33,and,heroy(0)==57) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,down,7)
wait(6)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,53,32)
wait(1)
pan camera(south,0,0)
set hero position(0,53,27)
wait(1)
walk hero(0,down,5)
wait(1)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if((herox(0)==10,or,herox(0)==28,or,herox(0)==46,or,herox(0)==64),and,heroy(0)==10) then(
set variable(time,0)
set tag(139,0)
set variable(isrunning,true)
palout(3)
camera follows hero(0)
teleport to map(41+poff,39,148)
wait(1)
pan camera(south,0,0)
set hero position(0,40,144)
wait(1)
palin(3)
create npc(34,39,147)
create npc(34,40,148)
walk hero(0,down,3)
wait for hero(0))
)
do(
if(check tag(410),and,check tag(411)==false,and,herox(0)==20,and,heroy(0)==50) then(set variable(time,0))
)
do(
if(check tag(411),and,check tag(413)==false,and,herox(0)==20,and,heroy(0)==50) then(set variable(time,0))
)
do(
if(check tag(413),and,check tag(424)==false,and,herox(0)==20,and,heroy(0)==50) then(set variable(time,0))
)
do(
if(check tag(424),and,check tag(425)==false,and,herox(0)==20,and,heroy(0)==50) then(set variable(time,0))
)
do(
if(herox(0)==41,and,heroy(0)==36) then(
	set variable(time,0)
	#check day
	if(check tag(480),and,check tag(453)) then(
		palout(1)
		teleport to map(41+poff,27,65)
		palin(1)
	)
	#else no enter
	else(
		walk hero(0,down,1)
		set hero direction(0,up)
		tb(84)
		wait for hero(0)
	)
)
)
do(
#MAZING GO!
if(herox(0)==30,and,heroy(0)==49) then(

if(check tag(282),and,((check tag(459)==false),or,(check tag(460),and,day--amazing<<3,and,check tag(463)==false),or,(check tag(460),and,day--amazing>=3,and,check tag(463)==false))) then(
	set variable(time,0)
	mazinggo
)
else(
palout(1)
teleport to map(41+poff,4,120))

)
)


palout(time)

if(herox(0)==20,and,heroy(0)==50) then(

if((check tag(410),and,check tag(411)==false)or,(check tag(406)==false),or,(check tag(413),and,check tag(424)==false),or,(check tag(411),and,check tag(413)==false),or,(check tag(424),and,check tag(425)==false),and,check tag(432)==false) then(
set variable(time,0)
worldending)
else(teleport to map(41+poff,5,136))

)
else(
if(herox(0)==25,and,heroy(0)==51) then(
teleport to map(49+poff,26,25))
)
do(
if(herox(0)==50,and,heroy(0)==52) then(
teleport to map(49+poff,31,45))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

#########################
script, rtsspecial, begin
set tag(139,1)
run real time system
wait(1)
end
###

############################
script, snowtraildoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(herox(0)==17,and,heroy(0)==73) then(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,48)
wait(1)
pan camera(south,0,0)
set hero position(0,79,48)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if(herox(0)==17,and,heroy(0)==74) then(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,49)
wait(1)
pan camera(south,0,0)
set hero position(0,79,49)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==17,and,heroy(0)==75) then(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,50)
wait(1)
pan camera(south,0,0)
set hero position(0,79,50)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==12,and,heroy(0)==87) then(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,62)
wait(1)
pan camera(south,0,0)
set hero position(0,79,62)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==12,and,heroy(0)==88) then(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,63)
wait(1)
pan camera(south,0,0)
set hero position(0,79,63)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==12,and,heroy(0)==89) then(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,64)
wait(1)
pan camera(south,0,0)
set hero position(0,79,64)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==83,and,heroy(0)==95) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(3)
camera follows hero(0)
teleport to map(72,3,80)
stop song
set tag(694,1)
set pal(noon)
wait(1)
pan camera(south,0,0)
set hero position(0,3,82)
wait(1)
palin(3)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==139,and,heroy(0)==110) then(

if(check tag(184)) then(
set hero speed(0,10)
pan camera(right,18,20)
walk hero(0,right,18)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
else(scenefourpointfour)

)
)
do(
if(herox(0)==139,and,heroy(0)==111) then(

if(check tag(184)) then(
set hero speed(0,10)
pan camera(right,18,20)
walk hero(0,right,18)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
else(scenefourpointfour)

)
)
do(
if(herox(0)==156,and,heroy(0)==110) then(
set hero speed(0,10)
pan camera(left,18,20)
walk hero(0,left,18)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if(herox(0)==156,and,heroy(0)==111) then(
set hero speed(0,10)
pan camera(left,18,20)
walk hero(0,left,18)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if(herox(0)==169,and,heroy(0)==111) then(

if(check tag(185)) then(
set variable(isrunning,false)
palout(1)
teleport to map(89,5,38)
stop song
wait(2)
load tileset(95+poff)
pan camera(south,0,0)
set hero position(0,5,39)
wait(1)
palin(2)
walk hero(0,up,1)
wait for hero(0)
camera follows hero(0))
else(onceaminion)

)
)
do(
if(herox(0)==243,and,heroy(0)==19) then(
pan camera(south,0,0)
walk hero(0,right,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(73+poff,15,66)
wait(1)
pan camera(south,0,0)
set hero position(0,20,66)
wait(1)
walk hero(0,right,5)
pan camera(right,10,10)
palin(3)
wait for hero(0)
wait for camera
camera follows hero(0))
)
do(
if(herox(0)==243,and,heroy(0)==20) then(
pan camera(south,0,0)
walk hero(0,right,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(73+poff,15,67)
wait(1)
pan camera(south,0,0)
set hero position(0,20,67)
wait(1)
walk hero(0,right,5)
pan camera(right,10,10)
palin(3)
wait for hero(0)
wait for camera
camera follows hero(0))
)
do(
if(herox(0)==243,and,heroy(0)==21) then(
pan camera(south,0,0)
walk hero(0,right,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(73+poff,15,68)
wait(1)
pan camera(south,0,0)
set hero position(0,20,68)
wait(1)
walk hero(0,right,5)
pan camera(right,10,10)
palin(3)
wait for hero(0)
wait for camera
camera follows hero(0))
)

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

############################
script, snowmountdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==24,and,heroy(0)==66) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
pan camera(left,10,10)
wait(7)
palout(3)
wait for camera
wait for hero(0)
camera follows hero(0)
teleport to map(58+poff,242,19)
wait(1)
pan camera(south,0,0)
set hero position(0,247,19)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
if(herox(0)==24,and,heroy(0)==67) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
pan camera(left,10,10)
wait(7)
palout(3)
wait for camera
wait for hero(0)
camera follows hero(0)
teleport to map(58+poff,242,20)
wait(1)
pan camera(south,0,0)
set hero position(0,247,20)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==24,and,heroy(0)==68) then(
set variable(time,0)
pan camera(south,0,0)
walk hero(0,left,7)
pan camera(left,10,10)
wait(7)
palout(3)
wait for camera
wait for hero(0)
camera follows hero(0)
teleport to map(58+poff,242,21)
wait(1)
pan camera(south,0,0)
set hero position(0,247,21)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
)
do(
if((herox(0)==136,or,herox(0)==137,or,herox(0)==138),and,heroy(0)==50) then(
set variable(time,0)
set hero speed(0,10)
pan camera(up,7,20)
walk hero(0,up,7)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if((herox(0)==136,or,herox(0)==137,or,herox(0)==138),and,heroy(0)==44) then(
set variable(time,0)
set hero speed(0,10)
pan camera(down,7,20)
walk hero(0,down,7)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if((herox(0)==131,or,herox(0)==132,or,herox(0)==133),and,heroy(0)==33) then(
set variable(time,0)
set hero speed(0,10)
pan camera(up,8,20)
walk hero(0,up,8)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if((herox(0)==131,or,herox(0)==132,or,herox(0)==133),and,heroy(0)==26) then(
set variable(time,0)
set hero speed(0,10)
pan camera(down,8,20)
walk hero(0,down,8)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if((herox(0)==109,or,herox(0)==110,or,herox(0)==111),and,heroy(0)==31) then(
set variable(time,0)
set hero speed(0,10)
pan camera(up,5,20)
walk hero(0,up,5)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if((herox(0)==109,or,herox(0)==110,or,herox(0)==111),and,heroy(0)==27) then(
set variable(time,0)
set hero speed(0,10)
pan camera(down,5,20)
walk hero(0,down,5)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if(herox(0)==121,and,heroy(0)==20) then(
set variable(time,0)
set hero speed(0,10)
pan camera(up,7,20)
walk hero(0,up,7)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if(herox(0)==121,and,heroy(0)==14) then(
set variable(time,0)
set hero speed(0,10)
pan camera(down,7,20)
walk hero(0,down,7)
wait for camera
wait for hero
set hero speed(0,hspeed)
camera follows hero(0))
)
do(
if(herox(0)==121,and,heroy(0)==6) then(
set variable(time,0)
palout(3)
teleport to map(92,9,66)
stop song
wait(1)
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
pan camera(south,0,0)
set hero position(0,9,70)
load tileset(100+poff)
wait(1)
palin(3)
play song(17)
walk hero(0,up,2)
wait for hero(0))
)

palout(time)

if(herox(0)==104,and,heroy(0)==32) then(
teleport to map(77+poff,6,33))
else(
if(herox(0)==126,and,heroy(0)==36) then(
teleport to map(77+poff,2,51))
)
do(
if(herox(0)==146,and,heroy(0)==34) then(
teleport to map(77+poff,4,71))
)
do(
if(herox(0)==140,and,heroy(0)==38) then(
teleport to map(77+poff,2,92))
)
do(
if(herox(0)==140,and,heroy(0)==17) then(
teleport to map(77+poff,24,6))
)
do(
if(herox(0)==134,and,heroy(0)==21) then(
teleport to map(77+poff,32,25))
)
do(
if(herox(0)==129,and,heroy(0)==18) then(
teleport to map(77+poff,27,22))
)
do(
if(herox(0)==113,and,heroy(0)==19) then(
teleport to map(77+poff,25,44))
)
do(
if(herox(0)==107,and,heroy(0)==18) then(
teleport to map(77+poff,26,65))
)
do(
if(herox(0)==71,and,heroy(0)==98) then(
teleport to map(77+poff,25,83))
)
do(
if(herox(0)==106,and,heroy(0)==88) then(
teleport to map(77+poff,25,97))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

###################
script, rorc, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)
variable (time)
set variable (time,1)

if(herox(0)==6,and,heroy(0)==17) then(
set variable(time,0)
write pass block(6,19,128)
set hero speed(0,10)
pan camera(south,0,0)
walk hero(0,down,14)
pan camera(down,14,20)
wait for camera
wait for hero(0)
write pass block(6,19,0)
set hero speed(0,hspeed)
camera follows hero(0))
else(
if(herox(0)==6,and,heroy(0)==30) then(
set variable(time,0)
set hero speed(0,10)
pan camera(south,0,0)
walk hero(0,up,14)
pan camera(up,14,20)
wait for camera
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0))
)

palout(time)

if(herox(0)==6,and,heroy(0)==34) then(
teleport to map(73+poff,104,33))
else(
if(herox(0)==2,and,heroy(0)==52) then(
teleport to map(73+poff,126,37))
)
do(
if(herox(0)==4,and,heroy(0)==72) then(
teleport to map(73+poff,146,35))
)
do(
if(herox(0)==2,and,heroy(0)==93) then(
teleport to map(73+poff,140,39))
)
do(
if(herox(0)==24,and,heroy(0)==7) then(
teleport to map(73+poff,140,18))
)
do(
if(herox(0)==32,and,heroy(0)==26) then(
teleport to map(73+poff,134,22))
)
do(
if(herox(0)==27,and,heroy(0)==23) then(
teleport to map(73+poff,129,19))
)
do(
if(herox(0)==25,and,heroy(0)==45) then(
teleport to map(73+poff,113,20))
)
do(
if(herox(0)==26,and,heroy(0)==66) then(
teleport to map(73+poff,107,19))
)
do(
if(herox(0)==25,and,heroy(0)==84) then(
teleport to map(73+poff,71,99))
)
do(
if(herox(0)==25,and,heroy(0)==98) then(
teleport to map(73+poff,106,89))
)

set hero frame(0,0)
palin(time)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

############################
script, snowcabindoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

set tag(139,0)

set variable(isrunning,true)
palout(3)
teleport to map(58+poff,169,112)
wait(1)
create npc(34,168,112)
create npc(34,169,113)
create npc(34,170,112)
set hero frame(0,0)
wait(1)
palin(3)

set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

##################################
script, shodatombdoor, bird, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(currentmap==91,or,currentmap==92) then(shodatombdoor0(bird))
else(
	if(herox(0)<<81) then(
		if(heroy(0)<<90) then(
			shodatombdoor1
			shodatombdoor11
		)
		else(
			shodatombdoor2
			shodatombdoor22
		)
	)
	else(
		if(heroy(0)<<90) then(
			shodatombdoor3
			shodatombdoor33
		)
		else(
			shodatombdoor4
			shodatombdoor44
		)
	)
)

set hero frame(0,0)
set tag(8,0)
resume obstruction
if(currentmap<>91) then(resume npcs)
resume player
end
###

###################################
script, shodatombdoor0, bird, begin

if(bird==0) then( shodatombdoor0A )

else( shodatombdoor0B(bird) )

end
###

##############################
script, shodatombdoor0A, begin
	if(currentmap==92,and,herox(0)==9,and,heroy(0)==69) then(
	walk hero(0,down,1)
	wait for hero(0)
	palout(3)
	camera follows hero(0)
	teleport to map(73+poff,121,7)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,0,0)
	wait(1)
	palin(3)
	set hero position(0,121,6)
	walk hero(0,down,1)
	wait for hero(0)
	camera follows hero(0))
	else(
	if(currentmap==92,and,herox(0)==9,and,heroy(0)==65) then(

	if(check tag(712)) then(
	walk hero(0,up,1)
	wait for hero(0)
	palout(3)
	stop song
	camera follows hero(0)
	set hero position(0,27,66)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,27,60)
	set hero speed(0,20)
	wait(1)
	walk hero(0,up,38)
	pan camera(up,48,20)
	play song(95)
	palin(10)
	wait for camera
	set hero frame(0,0)
	set hero speed(0,hspeed)
	)
	else(dartjadefirstscene)

	)
	)
do(
	if(currentmap==92,and,herox(0)==27,and,heroy(0)==23) then(
	set hero speed(0,2)
	walk hero(0,down,2)
	pan camera(down,48,20)
	wait for hero(0)
	set hero position(0,9,66)
	palout(10)
	stop song
	wait for camera
	camera follows hero(0)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,9,64)
	wait(1)
	palin(3)
	play song(17)
	set hero speed(0,hspeed)
	walk hero(0,down,2)
	wait for hero(0))
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==11) then(
		if(check tag(576)) then(mrdown)
		else(
			walk hero(0,down,3)
			wait for hero(0)
			battle flash
			ff(557)
			set tag(576,1)
			pan camera(down,12,10)
			wait for camera
		)
	)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==13) then(mrup)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==22) then(
	walk hero(0,down,3)
	wait for hero(0)
	wait(10)
	palout(15)
	wait(1)
	camera follows hero(0)
	set hero position(0,9,30)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,12,31)
	unlock hero(h1)
	swap in hero(h1)
	swap out hero(h3)
	lock hero(h3)
	swap by position(find hero(h1),1)
	wait(1)
	set hero direction(0,down)
	wait(10)
	palin(15)
	)
	)
do(
	if(currentmap==91,and,herox(0)==17,and,heroy(0)==31) then(
		if(check tag(577)) then(mrright)
		else(
			walk hero(0,right,3)
			wait for hero(0)
			battle flash
			ff(561)
			set tag(577,1)
			pan camera(right,18,10)
			wait for camera
		)
	)
	)
do(
	if(currentmap==91,and,herox(0)==19,and,heroy(0)==31) then(mrleft)
	)
do(
	if(currentmap==91,and,herox(0)==33,and,heroy(0)==31) then(
	walk hero(0,right,3)
	wait for hero(0)
	wait(10)
	palout(15)
	wait(1)
	camera follows hero(0)
	set hero position(0,45,66)
	wait(1)
	pan camera(south,0,0)
	unlock hero(h2)
	swap in hero(h2)
	swap out hero(h1)
	lock hero(h1)
	swap by position(find hero(h2),1)
	wait(1)
	set hero direction(0,down)
	wait(10)
	palin(15)
	)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==61) then(mrup)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==59) then(mrdown)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==49) then(
		if(check tag(578)) then(mrup)
		else(
			walk hero(0,up,3)
			wait for hero(0)
			battle flash
			ff(565)
			set tag(578,1)
			pan camera(up,12,10)
			wait for camera
		)
	)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==47) then(mrdown)
	)
do(
	if(currentmap==91,and,herox(0)==45,and,heroy(0)==40) then(
	walk hero(0,up,3)
	wait for hero(0)
	wait(10)
	stop song
	palout(15)
	wait(1)
	camera follows hero(0)
	set hero position(0,81,30)
	wait(1)
	pan camera(south,0,0)
	set hero position(0,82,30)
	unlock hero(h4)
	swap in hero(h4)
	swap out hero(h2)
	lock hero(h2)
	swap by position(find hero(h4),1)
	wait(1)
	set hero direction(0,down)
	wait(10)
	play song(17)
	palin(15)
	set variable(musicsave,17)
	set tag(8,0)
	save game
	)
	)
do(
	if(currentmap==91,and,herox(0)==73,and,heroy(0)==31) then(mrleft)
	)
do(
	if(currentmap==91,and,herox(0)==71,and,heroy(0)==31) then(mrright)
	)
do(
	if(currentmap==91,and,herox(0)==54,and,heroy(0)==31) then(dartconfrontation)
	)
end
###

##############################
script, shodatombdoor0B, bird, begin
#flyhigh ( nnum, npic, npal, cenx, ceny, desx, desy, dir, dis, beg )

shodatombdoor0B1(bird)
shodatombdoor0B2(bird)
shodatombdoor0B3(bird)

end
###

#####################################
script, shodatombdoor0B1, bird, begin
#noon1
if(bird==4) then(
flyhigh(4,421,25,63,78,63,79,up,0,18)
alter npc(1,NPCstat:scriptargument,4)
)

#afternoon1
if(bird==5) then(
flyhigh(5,418,9,99,78,99,79,up,0,18)
alter npc(1,NPCstat:scriptargument,5)
)

#morning1
if(bird==6) then(
flyhigh(6,427,41,63,102,63,101,down,0,18)
alter npc(1,NPCstat:scriptargument,6)
)
end
###

#####################################
script, shodatombdoor0B2, bird, begin
#night1
if(bird==7) then(
flyhigh(7,424,81,99,102,99,101,down,0,18)
alter npc(1,NPCstat:scriptargument,7)
)

#morning2
if(bird==8) then(
flyhigh(8,427,129,117,30,117,28,up,0,18)
alter npc(1,NPCstat:scriptargument,14)
)

#night2
if(bird==9) then(
flyhigh(9,424,149,27,54,23,55,up,0,18)
alter npc(1,NPCstat:scriptargument,13)
)
end
###

#####################################
script, shodatombdoor0B3, bird, begin
#noon2
if(bird==10) then(
flyhigh(10,421,1,135,150,139,151,down,0,18)
alter npc(1,NPCstat:scriptargument,16)
)

#afternoon2
if(bird==11) then(
flyhigh(11,418,125,9,138,9,140,down,0,18)
alter npc(1,NPCstat:scriptargument,15)
)
end
###

###############################
script, shodabirds, bird, begin
suspend player
suspend npcs
suspend obstruction

set tag(8,1)

#flyhigh ( nnum, npic, npal, cenx, ceny, desx, desy, dir, dis, beg )
#noon1
if(bird==4) then(flyhigh(4,421,25,27,18,23,16,down,0,78))

#afternoon1
if(bird==5) then(flyhigh(5,418,9,27,18,31,16,down,0,78))

#morning1
if(bird==6) then(flyhigh(6,427,41,27,18,23,20,up,0,102))

#night1
if(bird==7) then(flyhigh(7,424,81,27,18,31,20,up,0,102))

#morning2
if(bird==8) then(
set tag(194,1)
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,14))
flyhigh(8,427,129,27,18,27,16,down,4,30,up)
)
if(bird==14) then(
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,8))
flyhigh(8,427,129,27,18,27,16,down,4,30,down)
)

#night2
if(bird==9) then(
set tag(193,1)
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,13))
flyhigh(9,424,149,27,18,25,18,down,8,54,left)
)
if(bird==13) then(
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,9))
flyhigh(9,424,149,27,18,25,18,down,8,54,right)
)

#noon2
if(bird==10) then(
set tag(196,1)
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,16))
flyhigh(10,421,1,27,18,29,18,up,8,150,right)
)
if(bird==16) then(
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,10))
flyhigh(10,421,1,27,18,29,18,up,8,150,left)
)

#afternoon2
if(bird==11) then(
set tag(195,1)
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,15))
flyhigh(11,418,125,27,18,27,20,up,5,138,down)
)
if(bird==15) then(
tb(6437)
if(check tag(192)) then(alter npc(1,NPCstat:scriptargument,11))
flyhigh(11,418,125,27,18,27,20,up,5,138,up)
)

set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

#####################################################################################
script, flyhigh, nnum, npic, npal, cenx, ceny, desx, desy, dir, dis, beg, dir2, begin
suspend hero walls
suspend npc walls
suspend overlay

set tag(197,1)


#no fly across gap~~~~~~~~
if(check tag(192)==false) then(
variable(uno)
variable(duo)
variable(nnn)
if(current map==92) then(set variable(nnn,nnum))
else(set variable(nnn,1))
walk hero to x(0,npcx(nnn))
walk hero to y(0,npcy(nnn))
set variable(saveherox,get hero picture(0))
set variable(saveheroy,get hero palette(0))
wait for hero(0)
set hero direction(0,down)
set variable(uno,npc at spot(herox(0),heroy(0)))
set variable(duo,create npc(nnn,0,0))
flyhigh1(nnum,npic,npal,cenx,ceny,desx,dir,uno,duo,beg)
set variable(uno,text1)
set variable(duo,text2)
flyhigh2(nnum,npic,cenx,ceny,desy,dir,uno,duo)
)

#Fly across gap!~~~~~~~
if(check tag(192)) then(
flyhigh3(nnum,npic,npal,dis,beg,dir2)
)

set tag(197,0)

set npc frame(nnn,0)
set hero speed(0,hspeed)
resume overlay
resume hero walls
resume npc walls
end
###
###########################################################################################
script, flyhigh1, nnum, npic, npal, cenx, ceny, desx, dir, uno, duo, beg, begin
variable(nnn)
if(current map==92) then(set variable(nnn,nnum))
else(set variable(nnn,1))


flyhighalpha1(nnn,npic,npal,uno,duo)

flyhighalpha2(dir,npic,nnn,uno,duo,beg)


if(current map==92) then(
set variable(nnn,1)
camera follows hero(0)
teleport to map(62+poff,cenx,ceny)
suspend player
suspend npcs
wait(1)
pan camera(south,0,0)
set variable(uno,npc at spot(0,0))
set variable(duo,create npc(nnn,0,0))
)
else(
set variable(nnn,nnum)
camera follows hero(0)
teleport to map(92,cenx,ceny)
suspend player
suspend npcs
wait(1)
load tileset(100+poff)
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
pan camera(south,0,0)
set variable(uno,npc reference(nnn))
wait(1)
set variable(duo,create npc(nnn,0,0))
)

set variable(text1,uno)
set variable(text2,duo)

flyhighalpha3(dir,nnn,npic,desx,ceny,uno,duo)

end
###

######################################################################################
script, flyhigh2, nnum, npic, cenx, ceny, desy, dir, uno, duo, begin
variable(nnn)
if(current map==92) then(set variable(nnn,nnum))
else(set variable(nnn,1))

if(currentmap<>92,and,heroy(0)>>72,and,heroy(0)<<108) then(

	flyhighbeta1(nnum)

	flyhighbeta2(cenx,ceny,nnum)

)
else(palin(2))


alter npc(nnn,NPCstat:movespeed,5)

if(dir==up) then(

	flyhighbeta3(nnn,uno,duo,desy,npic)

)
else(

	flyhighbeta4(nnn,uno,duo,desy,npic)

)
end
###

#######################################################
script, flyhighalpha1, nnn, npic, npal, uno, duo, begin
set hero picture(0,npic)
set hero palette(0,npal+poff)
set npc position(uno,0,0)
alter npc(nnn,NPCstat:picture,npic)
alter npc(nnn,NPCstat:palette,npal)
set hero speed(0,2)
alter npc(nnn,NPCstat:movespeed,2)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set npc position(uno,herox(0)--1,heroy(0))
set npc position(duo,herox(0)+1,heroy(0))
walk hero(0,up,1)
walk npc(uno,up,1)
walk npc(duo,up,1)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero speed(0,5)
alter npc(nnn,NPCstat:movespeed,5)
end
###
###########################################################
script, flyhighalpha2, dir, npic, nnn, uno, duo, beg, begin
if(dir==up) then(
set hero picture(0,npic+2)
alter npc(nnn,NPCstat:picture,npic+2)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
walk hero to y(0,beg--6)
walk npc to y(uno,beg--6)
walk npc to y(duo,beg--6)
)
else(
set hero picture(0,npic+1)
alter npc(nnn,NPCstat:picture,npic+1)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
walk hero to y(0,beg+6)
walk npc to y(uno,beg+6)
walk npc to y(duo,beg+6)
)
set npc direction(uno,left)
set npc direction(duo,right)

wait for hero(0)

palout(2)
end
###
##################################################################
script, flyhighalpha3, dir, nnn, npic, desx, ceny, uno, duo, begin
wait(1)

if(dir==up) then(
alter npc(nnn,NPCstat:picture,npic+2)
set hero position(0,desx,ceny+6)
set npc position(uno,desx--1,ceny+6)
set npc position(duo,desx+1,ceny+6)
)
else(
alter npc(nnn,NPCstat:picture,npic+1)
set hero position(0,desx,ceny--6)
set npc position(uno,desx--1,ceny--6)
set npc position(duo,desx+1,ceny--6)
)

alter npc(nnn,NPCstat:palette,get hero palette(0))
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
wait(1)
end
###
#################################
script, flyhighbeta1, nnum, begin
if(nnum==4) then(
pan camera(right,20,40)
wait for camera
pan camera(down,20,40)
wait for camera
write pass block(62,83,128)
write pass block(63,83,128)
write pass block(64,83,128)
write pass block(62,84,128)
write pass block(63,84,128)
write pass block(64,84,128)
)
if(nnum==5) then(
pan camera(left,20,40)
wait for camera
pan camera(down,20,40)
wait for camera
write pass block(98,83,128)
write pass block(99,83,128)
write pass block(100,83,128)
write pass block(98,84,128)
write pass block(99,84,128)
write pass block(100,84,128)
)
if(nnum==6) then(
pan camera(right,20,40)
wait for camera
pan camera(up,20,40)
wait for camera
write pass block(62,95,128)
write pass block(63,95,128)
write pass block(64,95,128)
write pass block(62,96,128)
write pass block(63,96,128)
write pass block(64,96,128)
)
if(nnum==7) then(
pan camera(left,20,40)
wait for camera
pan camera(up,20,40)
wait for camera
write pass block(98,95,128)
write pass block(99,95,128)
write pass block(100,95,128)
write pass block(98,96,128)
write pass block(99,96,128)
write pass block(100,96,128)
)
end
###
#############################################
script, flyhighbeta2, cenx, ceny, nnum, begin
resume overlay
wait(1)
focus camera(cenx,ceny,10)
wait(5)
palin(5)
wait for camera
suspend overlay
if(nnum==4) then(
write pass block(62,83,0)
write pass block(63,83,0)
write pass block(64,83,0)
write pass block(62,84,0)
write pass block(63,84,0)
write pass block(64,84,0)
)
if(nnum==5) then(
write pass block(98,83,0)
write pass block(99,83,0)
write pass block(100,83,0)
write pass block(98,84,0)
write pass block(99,84,0)
write pass block(100,84,0)
)
if(nnum==6) then(
write pass block(62,96,0)
write pass block(63,96,0)
write pass block(64,96,0)
)
if(nnum==7) then(
write pass block(98,96,0)
write pass block(99,96,0)
write pass block(100,96,0)
)
end
###
######################################################
script, flyhighbeta3, nnn, uno, duo, desy, npic, begin
walk hero to y(0,desy--1)
walk npc to y(uno,desy--1)
walk npc to y(duo,desy--1)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set hero speed(0,2)
alter npc(nnn,NPCstat:movespeed,2)
set hero picture(0,npic)
alter npc(nnn,NPCstat:picture,npic)
walk hero to y(0,desy)
walk npc to y(uno,desy)
walk npc to y(duo,desy)
set hero direction(0,up)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
destroy npc(duo)
alter npc(nnn,NPCstat:picture,get hero picture(0))
alter npc(nnn,NPCstat:palette,get hero palette(0))
set npc position(nnn,herox(0),heroy(0))
set npc direction(nnn,down)
set hero picture(0,saveherox)
set hero palette(0,saveheroy)
set hero speed(0,hspeed)

if(read pass block(herox(0),heroy(0)+1)>>0) then(walk hero(0,up,1))
else(walk hero(0,down,1))

wait for hero(0)
set hero frame(0,0)
end
###
######################################################
script, flyhighbeta4, nnn, uno, duo, desy, npic, begin
walk hero to y(0,desy--1)
walk npc to y(uno,desy--1)
walk npc to y(duo,desy--1)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set hero speed(0,2)
alter npc(nnn,NPCstat:movespeed,2)
set hero picture(0,npic)
alter npc(nnn,NPCstat:picture,npic)
walk hero to y(0,desy)
walk npc to y(uno,desy)
walk npc to y(duo,desy)
set hero direction(0,up)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
destroy npc(duo)
alter npc(nnn,NPCstat:picture,get hero picture(0))
alter npc(nnn,NPCstat:palette,get hero palette(0))
set npc position(nnn,herox(0),heroy(0))
set npc direction(nnn,down)
set hero picture(0,saveherox)
set hero palette(0,saveheroy)
set hero speed(0,hspeed)

if(read pass block(herox(0),heroy(0)+1)>>0) then(walk hero(0,up,1))
else(walk hero(0,down,1))

wait for hero(0)
set hero frame(0,0)
end
###

######################################################################################
script, flyhigh3, nnn, npic, npal, dis, beg, dir2, begin
variable(hpic)
variable(hpal)
variable(uno)
variable(duo)
set variable(nnn,1)

walk hero to x(0,npcx(nnn))
walk hero to y(0,npcy(nnn))
set variable(hpic,get hero picture(0))
set variable(hpal,get hero palette(0))
wait for hero(0)
set variable(uno,npc at spot(herox(0),heroy(0)))
set variable(duo,create npc(nnn,0,0))
set hero picture(0,npic)
set hero palette(0,npal+poff)
set npc position(uno,0,0)
alter npc(nnn,NPCstat:picture,npic)
alter npc(nnn,NPCstat:palette,npal)
set hero speed(0,2)
alter npc(nnn,NPCstat:movespeed,2)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set npc position(uno,herox(0)--1,heroy(0))
set npc position(duo,herox(0)+1,heroy(0))
walk hero(0,up,1)
walk npc(uno,up,1)
walk npc(duo,up,1)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set hero speed(0,5)
alter npc(nnn,NPCstat:movespeed,5)

if(dir2==up) then(
set hero picture(0,npic+2)
alter npc(nnn,NPCstat:picture,npic+2)
walk hero(0,dir2,dis)
walk npc(uno,dir2,dis)
walk npc(duo,dir2,dis)
)
if(dir2==down) then(
set hero picture(0,npic+1)
alter npc(nnn,NPCstat:picture,npic+1)
walk hero(0,dir2,dis)
walk npc(uno,dir2,dis)
walk npc(duo,dir2,dis)
)
if(dir2==left) then(
set hero picture(0,npic+2)
alter npc(nnn,NPCstat:picture,npic+2)
walk hero to y(0,beg--6)
walk npc to y(uno,beg--6)
walk npc to y(duo,beg--6)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set hero position(0,herox(0)--dis,heroy(0))
set npc position(uno,herox(0)--1,heroy(0))
set npc position(duo,herox(0)+1,heroy(0))
set hero picture(0,npic+1)
alter npc(nnn,NPCstat:picture,npic+1)
walk hero(0,down,6)
walk npc(uno,down,6)
walk npc(duo,down,6)
)
if(dir2==right) then(
set hero picture(0,npic+1)
alter npc(nnn,NPCstat:picture,npic+1)
walk hero to y(0,beg+6)
walk npc to y(uno,beg+6)
walk npc to y(duo,beg+6)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set hero position(0,herox(0)+dis,heroy(0))
set npc position(uno,herox(0)--1,heroy(0))
set npc position(duo,herox(0)+1,heroy(0))
set hero picture(0,npic+2)
alter npc(nnn,NPCstat:picture,npic+2)
walk hero(0,up,6)
walk npc(uno,up,6)
walk npc(duo,up,6)
)

set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
set hero frame(0,0)
set npc frame(uno,0)
set npc frame(duo,0)
set hero speed(0,2)
alter npc(nnn,NPCstat:movespeed,2)
set hero picture(0,npic)
alter npc(nnn,NPCstat:picture,npic)
walk hero(0,down,1)
walk npc(uno,down,1)
walk npc(duo,down,1)
set hero direction(0,up)
set npc direction(uno,left)
set npc direction(duo,right)
wait for hero(0)
wait for npc(uno)
wait for npc(duo)
destroy npc(duo)
alter npc(nnn,NPCstat:picture,get hero picture(0))
alter npc(nnn,NPCstat:palette,get hero palette(0))
set npc position(nnn,herox(0),heroy(0))
set npc direction(nnn,down)
set hero picture(0,hpic)
set hero palette(0,hpal)
set hero speed(0,hspeed)

if(read pass block(herox(0),heroy(0)+1)>>0) then(walk hero(0,up,1))
else(walk hero(0,down,1))

wait for hero(0)
set hero frame(0,0)

set tag(192,0)
end
###

##################################
script, shodatombload, ARGH, begin
suspend player
suspend npcs

#temp, show me how many npcs are on the field
#variable(countit)
#set variable(countit,0)
#variable(i)
#for(i,0,35,1) do(
#set variable(countit, countit + npc copy count(i))
#)
#show value(1)
#wait(10)
#show value(countit)
#wait(30)

if(ARGH==0) then(

#remove chest tops
if(check tag(515)) then(destroy npc(npc at spot(27,42)))
if(check tag(516)) then(destroy npc(npc at spot(133,53)))
if(check tag(517)) then(destroy npc(npc at spot(156,78)))
if(check tag(518)) then(destroy npc(npc at spot(45,67)))
if(check tag(519)) then(destroy npc(npc at spot(105,54)))
if(check tag(520)) then(destroy npc(npc at spot(135,31)))
if(check tag(521)) then(destroy npc(npc at spot(117,4)))
if(check tag(522)) then(destroy npc(npc at spot(49,128)))

#remove locked doors
if(check tag(493)) then(
	destroy npc(npc at spot(63,53))
	destroy npc(npc at spot(63,52))
	write pass block(63,53,0)
	create npc(35,63,52)
)
if(check tag(523)) then(
	destroy npc(npc at spot(20,137))
	destroy npc(npc at spot(20,136))
	write pass block(20,137,0)
	create npc(35,20,136)
)
if(check tag(524)) then(
	destroy npc(npc at spot(99,65))
	destroy npc(npc at spot(99,64))
	write pass block(99,65,0)
	create npc(35,99,64)
)
if(check tag(525)) then(
	destroy npc(npc at spot(117,41))
	destroy npc(npc at spot(117,40))
	write pass block(117,41,0)
	create npc(35,117,40)
)
if(check tag(526)) then(
	destroy npc(npc at spot(135,41))
	destroy npc(npc at spot(135,40))
	write pass block(135,41,0)
	create npc(35,135,40)
)

)

#remove locked door pass blocks
if(check tag(493)) then(write pass block(63,53,0))
if(check tag(523)) then(write pass block(20,137,0))
if(check tag(524)) then(write pass block(99,65,0))
if(check tag(525)) then(write pass block(117,41,0))
if(check tag(526)) then(write pass block(135,41,0))

#bridge assembled
if(check tag(490)) then(
write pass block(9,30,0)
write pass block(9,31,0)
)

#ladders assembled
if(check tag(495)) then(
write pass block(112,126,0)
write pass block(132,115,0)
write pass block(157,113,0)
write pass block(157,138,0)
)

#Boss placement
#change of plans
#created before door
#due to all the calls to this script, it was placing more than one
#if(check tag(572)==false) then(create npc(32,117,150,right))
#if(check tag(573)==false) then(create npc(32,63,137,up))

#spunk placement
if(check tag(499),and,npc copy count(33)==0) then(create npc(33,45,159,down))

#PLACE THE BIRD!
if(check tag(197)==false) then(

#noon
if( (herox(0)>>54,and,herox(0)<<72),and,(heroy(0)>>72,and,heroy(0)<<84) ) then(
alter npc(1,NPCstat:picture,421)
alter npc(1,NPCstat:palette,25+poff)
set npc direction(1,down)
set npc position(1,63,79)
alter npc(1,NPCstat:scriptargument,4)
)
else(
#night 2 pre
if( (herox(0)>>27,and,herox(0)<<36),and,(heroy(0)>>48,and,heroy(0)<<60) ) then(
alter npc(1,NPCstat:picture,424)
alter npc(1,NPCstat:palette,149+poff)
set npc direction(1,down)

if(check tag(193),or,currentmap==64) then(
set npc position(1,31,55)
alter npc(1,NPCstat:scriptargument,9)
)
else(
set npc position(1,23,55)
alter npc(1,NPCstat:scriptargument,13)
)

)
)
do(
#night 2 post
if( (herox(0)>>18,and,herox(0)<<27),and,(heroy(0)>>48,and,heroy(0)<<60) ) then(
alter npc(1,NPCstat:picture,424)
alter npc(1,NPCstat:palette,149+poff)
set npc direction(1,down)
set npc position(1,23,55)
alter npc(1,NPCstat:scriptargument,13)
)
)
do(
#afternoon
if( (herox(0)>>90,and,herox(0)<<108),and,(heroy(0)>>72,and,heroy(0)<<84) ) then(
alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,9+poff)
set npc direction(1,down)
set npc position(1,99,79)
alter npc(1,NPCstat:scriptargument,5)
)
)
do(
#morning 2 pre
if( (herox(0)>>108,and,herox(0)<<126),and,(heroy(0)>>30,and,heroy(0)<<36) ) then(
alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,129+poff)
set npc direction(1,down)

if(check tag(194),or,currentmap==65) then(
set npc position(1,117,32)
alter npc(1,NPCstat:scriptargument,8)
)
else(
set npc position(1,117,28)
alter npc(1,NPCstat:scriptargument,14)
)

)
)
do(
#morning 2 post
if( (herox(0)>>108,and,herox(0)<<126),and,(heroy(0)>>24,and,heroy(0)<<30) ) then(
alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,129+poff)
set npc direction(1,down)
set npc position(1,117,28)
alter npc(1,NPCstat:scriptargument,14)
)
)
do(
#morning
if( (herox(0)>>54,and,herox(0)<<72),and,(heroy(0)>>96,and,heroy(0)<<108) ) then(
alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,41+poff)
set npc direction(1,down)
set npc position(1,63,101)
alter npc(1,NPCstat:scriptargument,6)
)
)
do(
#afternoon 2 pre
if( (herox(0)>>0,and,herox(0)<<18),and,(heroy(0)>>132,and,heroy(0)<<138) ) then(
alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,125+poff)
set npc direction(1,down)

if(check tag(195),or,currentmap==63) then(
set npc position(1,9,135)
alter npc(1,NPCstat:scriptargument,11)
)
else(
set npc position(1,9,140)
alter npc(1,NPCstat:scriptargument,15)
)

)
)
do(
#afternoon 2 post
if( (herox(0)>>0,and,herox(0)<<18),and,(heroy(0)>>138,and,heroy(0)<<144) ) then(
alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,125+poff)
set npc direction(1,down)
set npc position(1,9,140)
alter npc(1,NPCstat:scriptargument,15)
)
)
do(
#night
if( (herox(0)>>90,and,herox(0)<<108),and,(heroy(0)>>96,and,heroy(0)<<108) ) then(
alter npc(1,NPCstat:picture,424)
alter npc(1,NPCstat:palette,81+poff)
set npc direction(1,down)
set npc position(1,99,101)
alter npc(1,NPCstat:scriptargument,7)
)
)
do(
#noon 2 pre
if( (herox(0)>>126,and,herox(0)<<135),and,(heroy(0)>>144,and,heroy(0)<<156) ) then(
alter npc(1,NPCstat:picture,421)
alter npc(1,NPCstat:palette,1+poff)
set npc direction(1,down)

if(check tag(196),or,currentmap==62) then(
set npc position(1,131,151)
alter npc(1,NPCstat:scriptargument,10)
)
else(
set npc position(1,139,151)
alter npc(1,NPCstat:scriptargument,16)
)

)
)
do(
#noon 2 post
if( (herox(0)>>135,and,herox(0)<<144),and,(heroy(0)>>144,and,heroy(0)<<156) ) then(
alter npc(1,NPCstat:picture,421)
alter npc(1,NPCstat:palette,1+poff)
set npc direction(1,down)
set npc position(1,139,151)
alter npc(1,NPCstat:scriptargument,16)
)
)
)

resume npcs
resume player
end
###

#############################
script, shodatombdoor1, begin
#mrup: rr,gg,bb, setp, dis
if(herox(0)==63,and,heroy(0)==73) then(mrup(0,0,0,0,3))
else(
if(herox(0)==63,and,heroy(0)==71) then(

alter npc(1,NPCstat:picture,421)
alter npc(1,NPCstat:palette,25+poff)
set npc direction(1,down)
set npc position(1,63,79)
alter npc(1,NPCstat:scriptargument,4)
mrdown(0,0,0,0,3)

)
)
do(
if(herox(0)==63,and,heroy(0)==63) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==63,and,heroy(0)==58) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==63,and,heroy(0)==52) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==63,and,heroy(0)==47) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==55,and,heroy(0)==41) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==53,and,heroy(0)==41) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==45,and,heroy(0)==47) then(mrdown(0,0,0,0,7))
)
do(
if(herox(0)==45,and,heroy(0)==53) then(mrup(0,0,0,0,7))
)
do(
if(herox(0)==45,and,heroy(0)==58) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==45,and,heroy(0)==63) then(mrup(0,0,0,0,6))
)
do(
###############night2 - pre
if(herox(0)==38,and,heroy(0)==55) then(

alter npc(1,NPCstat:picture,424)
alter npc(1,NPCstat:palette,149+poff)
set npc direction(1,down)
if(check tag(193),or,check tag(6)) then(
set npc position(1,31,55)
alter npc(1,NPCstat:scriptargument,9)
)
else(
set npc position(1,23,55)
alter npc(1,NPCstat:scriptargument,13)
)
mrleft(0,0,0,0,4)

)
)
do(
if(herox(0)==35,and,heroy(0)==55) then(mrright(0,0,0,0,4))
)
do(
if(herox(0)==19,and,heroy(0)==55) then(mrleft(0,0,0,0,3))
)
do(
###############night2 - post
if(herox(0)==17,and,heroy(0)==55) then(

alter npc(1,NPCstat:picture,424)
alter npc(1,NPCstat:palette,149+poff)
set npc direction(1,down)
set npc position(1,23,55)
alter npc(1,NPCstat:scriptargument,13)
mrright(0,0,0,0,3)

)
)
do(
if(herox(0)==6,and,heroy(0)==49) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==6,and,heroy(0)==47) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==17,and,heroy(0)==44) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==19,and,heroy(0)==44) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==9,and,heroy(0)==39) then(
	mrup(0,0,0,0,6)
	if(check tag(490)==false) then(
		set hero speed(0,2)
		walk hero(0,up,1)
		wait for hero(0)
		set hero frame(0,0)
		set hero speed(0,hspeed)
		jig hero(0)
		tb(7124)
		set tag(489,1)
	)
)
)
do(
if(herox(0)==9,and,heroy(0)==34) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==9,and,heroy(0)==28) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==9,and,heroy(0)==23) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==9,and,heroy(0)==11) then(mrdown(0,0,0,0,6))
)
end
###

#############################
script, shodatombdoor11, begin
if(herox(0)==9,and,heroy(0)==16) then(
	mrup(0,0,0,0,6)
	if(check tag(574)==false) then(
		stop song
		wait(3)
		play song(8)
		battleflash(1)
		set tag(574,1)
		ff(549+poff)
		if(check tag(572),and,check tag(573),and,check tag(574),and,check tag(575)) then(set tag(579,1))
		shodatombload(1)
	)
)
end
###

#############################
script, shodatombdoor2, begin
if(herox(0)==55,and,heroy(0)==102) then(mrleft(0,0,0,0,4))
else(
if(herox(0)==52,and,heroy(0)==102) then(

alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,41+poff)
set npc direction(1,down)
set npc position(1,63,101)
alter npc(1,NPCstat:scriptargument,6)
mrright(0,0,0,0,4)

)
)
do(
if(herox(0)==45,and,heroy(0)==107) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==45,and,heroy(0)==109) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==63,and,heroy(0)==107) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==63,and,heroy(0)==112) then(

alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,41+poff)
set npc direction(1,down)
set npc position(1,63,101)
alter npc(1,NPCstat:scriptargument,6)
mrup(0,0,0,0,6)

)
)
do(
if(herox(0)==55,and,heroy(0)==115) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==53,and,heroy(0)==115) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==38,and,heroy(0)==115) then(mrleft(0,0,0,0,4))
)
do(
if(herox(0)==35,and,heroy(0)==115) then(mrright(0,0,0,0,4))
)
do(
if(herox(0)==30,and,heroy(0)==111) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==30,and,heroy(0)==106) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==24,and,heroy(0)==111) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==24,and,heroy(0)==106) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==19,and,heroy(0)==115) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==17,and,heroy(0)==115) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==6,and,heroy(0)==119) then(
	mrdown(0,0,0,0,3)
	if(check tag(602)==false) then(
		set tag(602,1)
		set tag(8,0)
		show backdrop(7)
		wait(3)
		show map
		tb(7367)
		wait(2)
		save game
	)
)
)
do(
if(herox(0)==6,and,heroy(0)==121) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==48,and,heroy(0)==118) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==48,and,heroy(0)==123) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==42,and,heroy(0)==118) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==42,and,heroy(0)==123) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==37,and,(heroy(0)==129,or,heroy(0)==130)) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==35,and,(heroy(0)==129,or,heroy(0)==130)) then(mrright(0,0,0,0,3))
)
do(
if((herox(0)==23,or,herox(0)==24),and,heroy(0)==131) then(
	mrdown(0,0,0,0,3)
	if(check tag(497)==false) then(
		set hero direction(0,right)
		jig hero(0)
		tb(7169)
		set tag(496,1)
	)
)
)
do(
if((herox(0)==23,or,herox(0)==24),and,heroy(0)==133) then(mrup(0,0,0,0,3))
)
do(
if((herox(0)==39,or,herox(0)==40),and,heroy(0)==131) then(mrdown(0,0,0,0,3))
)
do(
if((herox(0)==39,or,herox(0)==40),and,heroy(0)==133) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==37,and,(heroy(0)==139,or,heroy(0)==140,or,heroy(0)==141)) then(
	mrleft(0,0,0,0,3)
	if(check tag(497)==false) then(
		set hero direction(0,up)
		jig hero(0)
		tb(7169)
		set tag(496,1)
	)
)
)
do(
if(herox(0)==35,and,(heroy(0)==139,or,heroy(0)==140,or,heroy(0)==141)) then(mrright(0,0,0,0,3))
)
do(
############afternoon2 - pre
if(herox(0)==20,and,heroy(0)==136) then(

alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,125+poff)
set npc direction(1,down)
if(check tag(195),or,check tag(5)) then(
set npc position(1,9,135)
alter npc(1,NPCstat:scriptargument,11)
)
else(
set npc position(1,9,140)
alter npc(1,NPCstat:scriptargument,15)
)
walk hero(0,up,1)
wait for hero(0)
palout(2)
set hero position(0,16,135)
pan camera(left,18,40)
wait for camera
wait(2)
palin(2)
walk hero(0,down,2)
wait for hero(0)
set hero frame(0,0)

)
)
do(
if(herox(0)==16,and,heroy(0)==136) then(
walk hero(0,up,1)
wait for hero(0)
palout(2)
set hero position(0,20,135)
pan camera(right,18,40)
wait for camera
wait(2)
palin(2)
walk hero(0,down,2)
wait for hero(0)
set hero frame(0,0)
)
)
do(
if(herox(0)==9,and,heroy(0)==143) then(
	mrdown(0,0,0,0,6)
	if(check tag(498)==false,and,check tag(499)==false) then(
		shodaspunk
	)
)
)
do(
###########afternoon2 - post
if(herox(0)==9,and,heroy(0)==148) then(

alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,125+poff)
set npc direction(1,down)
set npc position(1,9,140)
alter npc(1,NPCstat:scriptargument,15)
mrup(0,0,0,0,6)

)
)
do(
if(herox(0)==9,and,heroy(0)==155) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==9,and,heroy(0)==157) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==16,and,heroy(0)==162) then(mrright(0,0,0,0,4))
)
do(
if(herox(0)==19,and,heroy(0)==162) then(mrleft(0,0,0,0,4))
)
do(
if(herox(0)==35,and,heroy(0)==162) then(
	if(check tag(498),and,check tag(499)==false) then(
		shodaspunk
	)
	else(
		mrright(0,0,0,0,3)
	)
)
)
do(
if(herox(0)==37,and,heroy(0)==162) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==53,and,heroy(0)==162) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==55,and,heroy(0)==162) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==63,and,heroy(0)==157) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==63,and,heroy(0)==155) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==63,and,heroy(0)==143) then(mrdown(0,0,0,0,3))
)
end
###

#############################
script, shodatombdoor22, begin
if(herox(0)==63,and,heroy(0)==145) then(
	create npc(32,63,137,up)
	mrup(0,0,0,0,3)
	if(check tag(573)==false) then(
		stop song
		wait(10)
		play song(8)
		battleflash(1)
		set tag(573,1)
		destroy npc(npc at spot(63,137))
		ff(545+poff)
		if(check tag(572),and,check tag(573),and,check tag(574),and,check tag(575)) then(set tag(579,1))
		shodatombload(1)
	)
)
end
###

#############################
script, shodatombdoor3, begin

if(herox(0)==99,and,heroy(0)==75) then(mrup(0,0,0,0,6))
else(
if(herox(0)==99,and,heroy(0)==70) then(

alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,9+poff)
set npc direction(1,down)
set npc position(1,99,79)
alter npc(1,NPCstat:scriptargument,5)
mrdown(0,0,0,0,6)

)
)
do(
if(herox(0)==99,and,heroy(0)==64) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==99,and,heroy(0)==59) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==107,and,heroy(0)==78) then(mrright(0,0,0,0,4))
)
do(
if(herox(0)==110,and,heroy(0)==78) then(

alter npc(1,NPCstat:picture,418)
alter npc(1,NPCstat:palette,9+poff)
set npc direction(1,down)
set npc position(1,99,79)
alter npc(1,NPCstat:scriptargument,5)
mrleft(0,0,0,0,4)

)
)
do(
if(herox(0)==117,and,heroy(0)==73) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==117,and,heroy(0)==71) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==117,and,heroy(0)==64) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==117,and,heroy(0)==59) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==117,and,heroy(0)==51) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==117,and,heroy(0)==46) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==125,and,heroy(0)==43) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==127,and,heroy(0)==43) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==135,and,heroy(0)==40) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==135,and,heroy(0)==35) then(mrdown(0,0,0,0,6))
)
do(
############Morning 2 - pre
if(herox(0)==117,and,heroy(0)==40) then(

alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,129+poff)
set npc direction(1,down)
if(check tag(194),or,check tag(3)) then(
set npc position(1,117,32)
alter npc(1,NPCstat:scriptargument,8)
)
else(
set npc position(1,117,28)
alter npc(1,NPCstat:scriptargument,14)
)
mrup(0,0,0,0,6)

)
)
do(
if(herox(0)==117,and,heroy(0)==35) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==117,and,heroy(0)==25) then(mrup(0,0,0,0,3))
)
do(
#############Morning 2 - post
if(herox(0)==117,and,heroy(0)==23) then(

alter npc(1,NPCstat:picture,427)
alter npc(1,NPCstat:palette,129+poff)
set npc direction(1,down)
set npc position(1,117,28)
alter npc(1,NPCstat:scriptargument,14)
mrdown(0,0,0,0,3)

)
)
do(
if(herox(0)==109,and,heroy(0)==18) then(
	mrleft(0,0,0,0,4)
	if(check tag(603)==false) then(
		set tag(603,1)
		show backdrop(7)
		wait(3)
		show map
		tb(7368)
	)
)
)
do(
if(herox(0)==106,and,heroy(0)==18) then(mrright(0,0,0,0,4))
)
do(
if(herox(0)==117,and,heroy(0)==13) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==117,and,heroy(0)==11) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==125,and,heroy(0)==19) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==127,and,heroy(0)==19) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==135,and,heroy(0)==10) then(mrdown(0,0,0,0,6))
)
do(
if(herox(0)==151,and,heroy(0)==85) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==151,and,heroy(0)==83) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==135,and,heroy(0)==73) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==135,and,heroy(0)==71) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==143,and,heroy(0)==66) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==145,and,heroy(0)==66) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==132,and,heroy(0)==61) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==132,and,heroy(0)==59) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==158,and,heroy(0)==61) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==158,and,heroy(0)==59) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==143,and,heroy(0)==54) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==145,and,heroy(0)==54) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==158,and,heroy(0)==53) then(mrstairdown(135,114,140,113))
)
do(
if(herox(0)==150,and,heroy(0)==54) then(mrstairdown(135,114,132,114))
)
do(
if(herox(0)==130,and,heroy(0)==65) then(mrstairdown(117,126,112,125))
)
do(
if(herox(0)==135,and,heroy(0)==78) then(mrstairdown(117,138,117,138))
)
do(
if(herox(0)==149,and,heroy(0)==76) then(mrstairdown(153,114,149,112))
)
do(
if(herox(0)==157,and,heroy(0)==76) then(mrstairdown(153,114,157,112))
)
end
###

#############################
script, shodatombdoor33, begin
if(herox(0)==135,and,heroy(0)==15) then(
	mrup(0,0,0,0,6)
	if(check tag(575)==false) then(
		stop song
		wait(10)
		play song(8)
		battleflash(1)
		set tag(575,1)
		ff(553+poff)
		if(check tag(572),and,check tag(573),and,check tag(574),and,check tag(575)) then(set tag(579,1))
		shodatombload(1)
	)
)
end
###

#############################
script, shodatombdoor4, begin
if(herox(0)==156,and,heroy(0)==97) then(mrup(0,0,0,0,3))
else(
if(herox(0)==156,and,heroy(0)==95) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==107,and,heroy(0)==102) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==109,and,heroy(0)==102) then(

alter npc(1,NPCstat:picture,424)
alter npc(1,NPCstat:palette,81+poff)
set npc direction(1,down)
set npc position(1,99,101)
alter npc(1,NPCstat:scriptargument,7)
mrleft(0,0,0,0,3)

)
)
do(
if(herox(0)==114,and,heroy(0)==107) then(
	mrdown(0,0,0,0,6)
	if(check tag(495)==false) then(
		set hero speed(0,4)
		walk hero(0,down,2)
		wait for hero(0)
		set hero speed(0,2)
		walk hero(0,right,1)
		wait for hero(0)
		set hero frame(0,0)
		set hero speed(0,hspeed)
		wait(7)
		set hero direction(0,up)
		wait(7)
		set hero direction(0,right)
		wait(3)
		set hero direction(0,down)
		wait(3)
		set hero direction(0,left)
		wait(7)
		set hero direction(0,down)
		wait(3)
		set hero direction(0,right)
		jig hero(0)
		tb(7152)
		set tag(494,1)
	)
)
)
do(
if(herox(0)==114,and,heroy(0)==112) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==125,and,heroy(0)==113) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==127,and,heroy(0)==113) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==143,and,heroy(0)==114) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==145,and,heroy(0)==114) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==155,and,heroy(0)==119) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==155,and,heroy(0)==121) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==114,and,heroy(0)==119) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==114,and,heroy(0)==121) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==120,and,heroy(0)==119) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==120,and,heroy(0)==121) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==125,and,heroy(0)==126) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==127,and,heroy(0)==126) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==143,and,heroy(0)==126) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==145,and,heroy(0)==126) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==153,and,heroy(0)==131) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==153,and,heroy(0)==133) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==136,and,heroy(0)==131) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==136,and,heroy(0)==133) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==125,and,heroy(0)==139) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==127,and,heroy(0)==139) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==143,and,heroy(0)==138) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==145,and,heroy(0)==138) then(mrleft(0,0,0,0,3))
)
do(
##########Noon 2 - pre
if(herox(0)==131,and,heroy(0)==142) then(

alter npc(1,NPCstat:picture,421)
alter npc(1,NPCstat:palette,1+poff)
set npc direction(1,down)
if(check tag(196),or,check tag(4)) then(
set npc position(1,131,151)
alter npc(1,NPCstat:scriptargument,10)
)
else(
set npc position(1,139,151)
alter npc(1,NPCstat:scriptargument,16)
)
mrdown(0,0,0,0,6)

)
)
do(
if(herox(0)==131,and,heroy(0)==147) then(mrup(0,0,0,0,6))
)
do(
if(herox(0)==143,and,heroy(0)==151) then(mrright(0,0,0,0,4))
)
do(
##########Noon 2 - post
if(herox(0)==146,and,heroy(0)==151) then(

alter npc(1,NPCstat:picture,421)
alter npc(1,NPCstat:palette,1+poff)
set npc direction(1,down)
set npc position(1,139,151)
alter npc(1,NPCstat:scriptargument,16)
mrleft(0,0,0,0,4)

)
)
do(
if(herox(0)==153,and,heroy(0)==155) then(mrdown(0,0,0,0,3))
)
do(
if(herox(0)==153,and,heroy(0)==157) then(mrup(0,0,0,0,3))
)
do(
if(herox(0)==146,and,heroy(0)==163) then(mrleft(0,0,0,0,4))
)
do(
if(herox(0)==143,and,heroy(0)==163) then(mrright(0,0,0,0,4))
)
do(
if(herox(0)==127,and,heroy(0)==163) then(mrleft(0,0,0,0,3))
)
do(
if(herox(0)==125,and,heroy(0)==163) then(mrright(0,0,0,0,3))
)
do(
if(herox(0)==117,and,heroy(0)==154) then(mrdown(0,0,0,0,7))
)
do(
if(herox(0)==157,and,heroy(0)==101) then(mrstairdown(153,138,157,137))
)
do(
if(herox(0)==157,and,heroy(0)==137) then(mrstairup(153,102,157,101))
)
do(
if(herox(0)==157,and,heroy(0)==112) then(mrstairup(153,78,157,76))
)
do(
if(herox(0)==149,and,heroy(0)==112) then(mrstairup(153,78,149,76))
)
do(
if(herox(0)==132,and,heroy(0)==114) then(mrstairup(153,54,150,54))
)
do(
if(herox(0)==140,and,heroy(0)==113) then(mrstairup(153,54,158,53))
)
do(
if(herox(0)==112,and,heroy(0)==125) then(mrstairup(135,66,130,65))
)
do(
if(herox(0)==117,and,heroy(0)==138) then(mrstairup(135,78,135,78))
)
end
###

##############################
script, shodatombdoor44, begin
if(herox(0)==117,and,heroy(0)==160) then(
	create npc(32,117,150,right)
	mrup(0,0,0,0,7)
	if(check tag(572)==false) then(
		stop song
		wait(10)
		play song(8)
		battleflash(1)
		set tag(572,1)
		destroy npc(npc at spot(117,150))
		ff(541+poff)
		if(check tag(572),and,check tag(573),and,check tag(574),and,check tag(575)) then(set tag(579,1))
		shodatombload(1)
	)
)
end
###

###############################
script, unknowntombdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

unknowntombdoor1
unknowntombdoor2
unknowntombdoor3
unknowntombdoor4

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

###############################
script, unknowntombdoor1, begin
if(herox(0)==115,and,heroy(0)==4) then(
stop song
pan camera(south,0,0)
set hero speed(0,2)
walk hero(0,up,3)
wait for hero(0)
palout(3)
camera follows hero(0)
teleport to map(41+poff,26,128)
wait(1)
pan camera(south,0,0)
set hero position(0,26,123)
set hp
wait(1)
walk hero(0,up,5)
pan camera(up,10,4)
wait(1)
palin(3)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)

#check to end enemy npcs
if(check tag(479),and,check tag(595)==false) then(
	set tag(595,1)
	set tag(433,0)
)

)
else(
if(herox(0)==118,and,heroy(0)==13) then(
write pass block(118,14,0)
write pass block(118,15,128)
write pass block(118,16,128)
pan camera(south,0,0)
walk hero(0,down,3)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,27,4)
wait(1)
pan camera(south,0,0)
set hero position(0,27,0)
wait(1)
palin(3)
walk hero(0,down,4)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
play song(85)
)
)
do(
if(herox(0)==27,and,heroy(0)==3) then(
write pass block(118,14,0)
write pass block(118,15,128)
write pass block(118,16,128)
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,118,12)
wait(1)
pan camera(south,0,0)
set hero position(0,118,16)
wait(1)
palin(3)
walk hero(0,up,4)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
write pass block(118,14,2+4+8)
write pass block(118,15,0)
write pass block(118,16,0)
)
)
do(
if(herox(0)==7,and,heroy(0)==65) then(
write pass block(7,66,0)
write pass block(7,67,128)
write pass block(7,68,128)
pan camera(south,0,0)
walk hero(0,down,3)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,42,74)
wait(1)
pan camera(south,0,0)
set hero position(0,42,70)
wait(1)
palin(3)
walk hero(0,down,4)
wait for hero(0)
camera follows hero(0)
)
)
end
###
###############################
script, unknowntombdoor2, begin
if(herox(0)==42,and,heroy(0)==73) then(
write pass block(7,66,0)
write pass block(7,67,128)
write pass block(7,68,128)
pan camera(south,0,0)
walk hero(0,up,3)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,7,64)
wait(1)
pan camera(south,0,0)
set hero position(0,7,68)
wait(1)
palin(3)
walk hero(0,up,4)
wait for hero(0)
camera follows hero(0)
write pass block(7,66,2+4+8)
write pass block(7,67,0)
write pass block(7,68,0)
if(check tag(479),and,check tag(596)==false) then(
	alter npc(1,NPCstat:picture,0)
	create npc(1,11,60)
	create npc(1,12,60)
	create npc(1,13,60)
	write pass block(7,65,1+2+4+8)
)
)
else(
if(herox(0)==90,and,heroy(0)==33) then(
stop song
set tag(433,1)
pan camera(up,10,10)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero speed(0,hspeed)
set hero frame(0,0)
wait for camera
play song(17)
)
)
do(
if(herox(0)==90,and,heroy(0)==27) then(
stop song
#if haven't confronted her, or have already escaped, set rest back on
if(check tag(479)==false,or,check tag(595)) then(set tag(433,0))
pan camera(down,11,10)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)

#check to animate corpses
#only animate them once, tag 690
if(check tag(479),and,check tag(595)==false,and,check tag(690)==false) then(
	set variable(musicsave,0)
	set tag(690,1)
	set tag(643,1)
	variable(loopy)
	for(loopy,5,7,1) do(
		alter npc(loopy,NPCstat:movetype,NPCmovetype:chaseyou)
		alter npc(loopy,NPCstat:movespeed,2)
		alter npc(loopy,NPCstat:script,303)
	)
	for(loopy,10,16,1) do(
		alter npc(loopy,NPCstat:movetype,NPCmovetype:chaseyou)
		alter npc(loopy,NPCstat:movespeed,2)
		alter npc(loopy,NPCstat:script,303)
	)
	set tag(433,1)
	play song(85)
)
else(play song(85))

)
)
do(
if(herox(0)==90,and,heroy(0)==21) then(
stop song
focus camera(90,14,10)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
play song(98)
)
)
do(
if(herox(0)==90,and,heroy(0)==15) then(
stop song
focus camera(90,23,10)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
play song(17)
)
)
do(
if(herox(0)==90,and,heroy(0)==8) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,136,25)
wait(1)
pan camera(south,0,0)
set hero position(0,136,31)
wait(1)
palin(3)
walk hero(0,up,2)
wait for hero(0)
)
)
do(
if(herox(0)==136,and,heroy(0)==30) then(
walk hero(0,down,1)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,90,9)
wait(1)
pan camera(south,0,0)
set hero position(0,90,7)
wait(1)
palin(3)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0)
)
)
end
###
###############################
script, unknowntombdoor3, begin
if(herox(0)==136,and,heroy(0)==25) then(
write pass block(136,26,0)
write pass block(136,27,128)
write pass block(136,28,128)
walk hero(0,down,3)
wait for hero(0)
palout(6)
camera follows hero(0)
set hero position(0,39,101)
wait(1)
pan camera(south,0,0)
set hero position(0,39,96)
wait(1)
palin(6)
walk hero(0,down,4)
wait for hero(0)
)
else(
if(herox(0)==39,and,heroy(0)==99) then(
write pass block(136,26,0)
write pass block(136,27,128)
write pass block(136,28,128)
walk hero(0,up,3)
wait for hero(0)
palout(6)
camera follows hero(0)
set hero position(0,136,25)
wait(1)
pan camera(south,0,0)
set hero position(0,136,28)
wait(1)
palin(6)
walk hero(0,up,4)
wait for hero(0)
write pass block(136,26,2+4+8)
write pass block(136,27,0)
write pass block(136,28,0)
)
)
do(
if(herox(0)==39,and,heroy(0)==104) then(
focus camera(39,113,20)
set hero speed(0,10)
walk hero(0,down,9)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==39,and,heroy(0)==112) then(
focus camera(39,101,20)
set hero speed(0,10)
walk hero(0,up,9)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
)
)
do(
if(herox(0)==33,and,heroy(0)==112) then(icedoor(32,120))
)
do(
if(herox(0)==32,and,heroy(0)==119) then(icedoor(33,113))
)
do(
if(herox(0)==49,and,heroy(0)==113) then(icedoor(47,120))
)
do(
if(herox(0)==47,and,heroy(0)==119) then(icedoor(49,114))
)
do(
if(herox(0)==56,and,heroy(0)==118) then(icedoor(63,121))
)
do(
if(herox(0)==63,and,heroy(0)==120) then(icedoor(56,119))
)
end
###
###############################
script, unknowntombdoor4, begin
if(herox(0)==69,and,heroy(0)==123) then(icedoor(70,129))
else(
if(herox(0)==70,and,heroy(0)==128) then(icedoor(69,124))
)
do(
if(herox(0)==68,and,heroy(0)==129) then(icedoor(62,127))
)
do(
if(herox(0)==62,and,heroy(0)==126) then(icedoor(68,130))
)
do(
if(herox(0)==78,and,heroy(0)==123) then(icedoor(71,136))
)
do(
if(herox(0)==71,and,heroy(0)==135) then(icedoor(78,124))
)
do(
if(herox(0)==62,and,heroy(0)==134) then(icedoor(47,126))
)
do(
if(herox(0)==47,and,heroy(0)==125) then(icedoor(62,135))
)
do(
if(herox(0)==64,and,heroy(0)==133) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,108,143)
wait(1)
pan camera(south,0,0)
set hero position(0,108,149)
wait(1)
palin(3)
walk hero(0,up,2)
wait for hero(0)
)
)
do(
if(herox(0)==108,and,heroy(0)==148) then(
walk hero(0,down,1)
wait for hero(0)
palout(3)
camera follows hero(0)
set hero position(0,64,134)
wait(1)
pan camera(south,0,0)
set hero position(0,64,132)
wait(1)
palin(3)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0)
)
)
end
###

################################
script, icedoor, xxx, yyy, begin
focus camera(xxx,yyy,4)
walk hero(0,up,1)
wait for hero(0)
wait for camera
set hero position(0,xxx,yyy--2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0)
end
###

#########################
script, scarf1door, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(herox(0)==33,and,heroy(0)==102) then(
pan camera(up,7,10)
walk hero(0,up,7)
wait for hero(0)
wait for camera
camera follows hero(0))
else(
if(herox(0)==33,and,heroy(0)==96) then(
pan camera(down,7,10)
walk hero(0,down,7)
wait for hero(0)
wait for camera
camera follows hero(0))
)
do(
if(herox(0)==4,and,heroy(0)==65) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,7,105)
wait(1)
pan camera(south,0,0)
set hero position(0,7,107)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==7,and,heroy(0)==106) then(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,4,66)
wait(1)
pan camera(south,0,0)
set hero position(0,4,64)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0))
)
do(
if(herox(0)==3,and,heroy(0)==7) then(
walk hero(0,down,1)
wait for hero(0)
palout(2)
if(check tag(527)) then(teleport to map(1+poff,162,57))
else(teleport to map(96,162,57))
set hp
wait(1)
palin(2)
)
)
do(
if(herox(0)==3,and,heroy(0)==2) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,69,54)
wait(1)
pan camera(south,0,0)
set hero position(0,69,56)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0)
)
)
do(
if(herox(0)==69,and,heroy(0)==55) then(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,3,3)
wait(1)
pan camera(south,0,0)
set hero position(0,3,1)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0)
)
)

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

###############################
script, godown, xxx, yyy, begin
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,xxx,yyy)
wait(1)
pan camera(south,0,0)
set hero position(0,xxx,yyy--2)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0)
end
###

###############################
script, goup, xxx, yyy, begin
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,xxx,yyy)
wait(1)
pan camera(south,0,0)
set hero position(0,xxx,yyy+2)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0)
end
###

###############################
script, goupdown, xxx, yyy, begin
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,xxx,yyy)
wait(1)
pan camera(south,0,0)
set hero position(0,xxx,yyy--2)
wait(1)
palin(2)
walk hero(0,down,2)
wait for hero(0)
camera follows hero(0)
end
###

###############################
script, godownup, xxx, yyy, begin
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,xxx,yyy)
wait(1)
pan camera(south,0,0)
set hero position(0,xxx,yyy+2)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
camera follows hero(0)
end
###

#########################
script, scarf2door, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

scarf2door1
scarf2door2
scarf2door3

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

##########################
script, scarf2door1, begin
if(check tag(531)==false,and,(herox(0)==40,or,herox(0)==41,or,herox(0)==42),and,heroy(0)==19) then(
jig horror
tb(4232)
wait(2)
tb(4233)
set tag(531,1)
)
else(
if(check tag(532)==false,and,herox(0)==40,and,heroy(0)==49) then(
jig horror
tb(4234)
wait(2)
tb(4235)
set tag(532,1)
)
)
do(
if(herox(0)==40,and,heroy(0)==6) then(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map(18+poff,4,137)
wait(1)
pan camera(south,0,0)
set hero position(0,4,138)
write pass block(4,137,128)
write pass block(4,138,128)
set hero speed(0,2)
set hp
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
set hero speed(0,hspeed)
write pass block(4,137,0)
write pass block(4,138,0)
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
)
)
do(
if(herox(0)==10,and,heroy(0)==15) then(godown(10,24))
)
do(
if(herox(0)==10,and,heroy(0)==23) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,10,9)
wait(1)
pan camera(south,0,0)
set hero position(0,10,16)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
)
)
do(
if(herox(0)==10,and,heroy(0)==34) then(godown(33,49))
)
do(
if(herox(0)==33,and,heroy(0)==48) then(goup(10,33))
)
do(
if(herox(0)==47,and,heroy(0)==48) then(
	goupdown(47,67)
	if(check tag(534)==false) then(
		wait(2)
		jig horror
		tb(4238)
		wait(2)
		tb(4239)
		set tag(533,1)
	)
)
)
do(
if(herox(0)==47,and,heroy(0)==66) then(goupdown(47,49))
)
do(
if(herox(0)==53,and,heroy(0)==69) then(goup(33,97))
)
do(
if(herox(0)==33,and,heroy(0)==98) then(godown(53,70))
)
do(
if(herox(0)==32,and,heroy(0)==91) then(goup(54,96))
)
do(
if(herox(0)==54,and,heroy(0)==97) then(godown(32,92))
)
do(
if(herox(0)==36,and,heroy(0)==93) then(goup(67,97))
)
do(
if(herox(0)==67,and,heroy(0)==98) then(godown(36,94))
)
do(
if(herox(0)==39,and,heroy(0)==92) then(goup(80,97))
)
do(
if(herox(0)==80,and,heroy(0)==98) then(godown(39,93))
)
do(
if(herox(0)==42,and,heroy(0)==95) then(goup(17,96))
)
do(
if(herox(0)==17,and,heroy(0)==97) then(godown(42,96))
)
do(
if((herox(0)==54,and,heroy(0)==92),or,(herox(0)==67,and,heroy(0)==90),or,(herox(0)==81,and,heroy(0)==90)) then(
	#scripted whisper scene
	whisper
)
)
do(
if(herox(0)==18,and,heroy(0)==92) then(
	goup(51,77)
	if(check tag(535)==false) then(
		wait(2)
		palout(1)
		palin(1)
		tb(4240)
		wait(2)
		tb(4241)
		set tag(534,1)
	)
)
)
do(
if(herox(0)==51,and,heroy(0)==78) then(godown(18,93))
)
do(
if(herox(0)==46,and,heroy(0)==80) then(godown(80,9))
)
do(
if(herox(0)==80,and,heroy(0)==8) then(goup(46,79))
)
do(
if((herox(0)==61,and,heroy(0)==3),or,(herox(0)==101,and,heroy(0)==3),or,(herox(0)==61,and,heroy(0)==21),or,(herox(0)==106,and,heroy(0)==20)) then(
	#scripted whisper scene
	whisper
)
)
end
###
##########################
script, scarf2door2, begin
if(herox(0)==80,and,heroy(0)==40) then(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,65,110)
wait(1)
pan camera(south,0,0)
set hero position(0,68,117)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
)
else(
if(herox(0)==68,and,heroy(0)==116) then(godownup(80,39))
)
do(
if(herox(0)==62,and,heroy(0)==116) then(
	godownup(42,81)
	if(check tag(536)==false) then(
		wait(2)
		palout(1)
		palin(1)
		tb(4242)
		wait(2)
		tb(4243)
		set tag(535,1)
	)
)
)
do(
if(herox(0)==42,and,heroy(0)==82) then(
pan camera(south,0,0)
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
set hero position(0,65,110)
wait(1)
pan camera(south,0,0)
set hero position(0,62,117)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
)
)
do(
if(herox(0)==37,and,heroy(0)==82) then(godown(80,52))
)
do(
if(herox(0)==80,and,heroy(0)==51) then(goup(37,81))
)
do(
if(herox(0)==70,and,heroy(0)==70) then(godown(109,50))
)
do(
if(herox(0)==109,and,heroy(0)==49) then(goup(70,69))
)
do(
if(herox(0)==73,and,heroy(0)==70) then(godown(109,63))
)
do(
if(herox(0)==109,and,heroy(0)==62) then(goup(73,69))
)
do(
if(herox(0)==79,and,heroy(0)==70) then(godown(109,76))
)
do(
if(herox(0)==109,and,heroy(0)==75) then(goup(79,69))
)
do(
if(herox(0)==82,and,heroy(0)==70) then(godown(109,89))
)
do(
if(herox(0)==109,and,heroy(0)==88) then(goup(82,69))
)
do(
if(herox(0)==85,and,heroy(0)==70) then(godown(109,102))
)
do(
if(herox(0)==109,and,heroy(0)==101) then(goup(85,69))
)
do(
if((herox(0)==101,and,heroy(0)==49),or,(herox(0)==101,and,heroy(0)==62),or,(herox(0)==101,and,heroy(0)==75),or,(herox(0)==101,and,heroy(0)==88),or,(herox(0)==101,and,heroy(0)==101)) then(
	#scripted whisper scene
	whisper
)
)
do(
if(herox(0)==76,and,heroy(0)==70) then(godown(109,115))
)
do(
if(herox(0)==109,and,heroy(0)==114) then(goup(76,69))
)
do(
if(herox(0)==33,and,heroy(0)==80) then(godown(101,115))
)
do(
if(herox(0)==101,and,heroy(0)==114) then(
	goup(33,79)
	if(check tag(537)==false) then(
		wait(2)
		palout(1)
		palin(1)
		tb(4244)
		wait(2)
		tb(4245)
		set tag(536,1)
	)
)
)
do(
if(herox(0)==29,and,heroy(0)==78) then(godown(135,14))
)
do(
if(herox(0)==135,and,heroy(0)==13) then(goup(29,77))
)
do(
if(herox(0)==130,and,heroy(0)==13) then(goupdown(120,18))
)
end
###
##########################
script, scarf2door3, begin
if(herox(0)==120,and,heroy(0)==17) then(goupdown(130,14))
else(
if(herox(0)==127,and,heroy(0)==14) then(goup(141,20))
)
do(
if(herox(0)==141,and,heroy(0)==21) then(godown(127,15))
)
do(
if(herox(0)==122,and,heroy(0)==15) then(goup(135,24))
)
do(
if(herox(0)==135,and,heroy(0)==25) then(godown(122,16))
)
do(
if(herox(0)==121,and,heroy(0)==24) then(godown(143,13))
)
do(
if(herox(0)==143,and,heroy(0)==12) then(goup(121,23))
)
do(
if(herox(0)==132,and,heroy(0)==28) then(godown(138,15))
)
do(
if(herox(0)==138,and,heroy(0)==14) then(goup(132,27))
)
do(
if(herox(0)==126,and,heroy(0)==24) then(
palout(3)
set hero position(0,141,47)
wait(1)
pan camera(south,0,0)
set hero position(0,142,47)
wait(1)
palin(3)
walk hero(0,left,1)
wait for hero(0)
camera follows hero(0)
)
)
do(
if(herox(0)==142,and,heroy(0)==47) then(
palout(2)
set hero position(0,129,24)
wait(1)
pan camera(south,0,0)
set hero position(0,128,24)
wait(1)
palin(2)
walk hero(0,right,1)
wait for hero(0)
camera follows hero(0)
)
)
do(
if(herox(0)==135,and,heroy(0)==39) then(
	if(check tag(538)==false) then(
		pan camera(south,0,0)
		walk hero(0,down,1)
		wait for hero(0)
		palout(2)
		camera follows hero(0)
		set hero position(0,35,70)
		wait(1)
		pan camera(south,0,0)
		set hero position(0,29,68)
		set npc direction(5,left)
		wait(1)
		palin(2)
		walk hero(0,down,2)
		wait for hero(0)
		wait(2)
		jig horror
		tb(4246)
		wait(2)
		tb(4247)
		set tag(537,1)
	)
	else(godown(29,70))
)
)
do(
if(herox(0)==29,and,heroy(0)==69) then(goup(135,38))
)
do(
if(herox(0)==33,and,heroy(0)==67) then(goup(12,74))
)
do(
if(herox(0)==12,and,heroy(0)==75) then(godown(33,68))
)
do(
if(herox(0)==19,and,heroy(0)==74) then(
	if(check tag(538)==false) then(set tag(538,1))
	godown(40,67)
)
)
do(
if(herox(0)==40,and,heroy(0)==66) then(goup(19,73))
)
do(
if(herox(0)==11,and,heroy(0)==70,and,check tag(691)==false) then(
	set tag(691,1)
	variable(randla)
	set variable(randla,random(0,3))
	get item(208+randla,1)
	tb(7334+randla)
)
)
end
###

#########################
script, scarf3door, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(herox(0)==27,and,heroy(0)==50) then(
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map(24+poff,84,16)
set hp
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
wait(1)
palin(2)
set hero position(0,84,15)
walk hero(0,down,1)
wait for hero(0)
camera follows hero(0)
)
else(
if(herox(0)==27,and,heroy(0)==42) then(
focus camera(27,28,20)
set hero speed(0,10)
walk hero(0,up,14)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)

if(check tag(540)==false) then(lavascarfintro)

)
)
do(
if(herox(0)==27,and,heroy(0)==29) then(
focus camera(27,45,20)
set hero speed(0,10)
walk hero(0,down,14)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
)
)
do(
if(herox(0)==24,and,heroy(0)==29) then(
	set tag(614,1)
	godownup(19,23)
)
)
do(
if(herox(0)==19,and,heroy(0)==24) then(godownup(24,28))
)
do(
if(herox(0)==19,and,heroy(0)==15) then(goupdown(23,8))
)
do(
if(herox(0)==23,and,heroy(0)==7) then(goupdown(19,16))
)
do(
if(herox(0)==31,and,heroy(0)==7) then(goupdown(35,15))
)
do(
if(herox(0)==35,and,heroy(0)==14) then(goupdown(31,8))
)
do(
if(herox(0)==35,and,heroy(0)==23) then(godownup(30,28))
)
do(
if(herox(0)==30,and,heroy(0)==29) then(
	set tag(614,1)
	godownup(35,22)
)
)

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

#########################
script, scarf4door, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(herox(0)==3,and,heroy(0)==81) then(
	if(check tag(544)) then(exitcave)
	else(
		pan camera(south,0,0)
		walk hero(0,down,1)
		wait for hero(0)
		palout(2)
		camera follows hero(0)
		teleport to map(58+poff,83,96)
		set hp
		wait(1)
		pan camera(south,0,0)
		set hero position(0,83,94)
		wait(1)
		palin(2)
		walk hero(0,down,2)
		wait for hero(0)
		camera follows hero(0)
	)
)
else(
if(herox(0)==37,and,heroy(0)==43) then(
pan camera(up,7,20)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==37,and,heroy(0)==37) then(
pan camera(down,7,20)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==33,and,heroy(0)==30) then(
focus camera(22,29,20)
set hero speed(0,10)
walk hero(0,left,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
)
)
do(
if(herox(0)==27,and,heroy(0)==30) then(
focus camera(34,30,20)
set hero speed(0,10)
walk hero(0,right,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==71,and,heroy(0)==82) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
)
)
do(
if(herox(0)==71,and,heroy(0)==88) then(
focus camera(71,81,20)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==72,and,heroy(0)==76) then(
pan camera(up,7,20)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==72,and,heroy(0)==70) then(
pan camera(down,7,20)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==120,and,heroy(0)==43) then(
pan camera(up,7,20)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==120,and,heroy(0)==37) then(
pan camera(down,7,20)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==152,and,heroy(0)==87) then(
pan camera(down,8,20)
set hero speed(0,10)
walk hero(0,down,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
)
)
do(
if(herox(0)==152,and,heroy(0)==93) then(
focus camera(152,86,20)
set hero speed(0,10)
walk hero(0,up,7)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==152,and,heroy(0)==100) then(
walk hero(0,down,1)
wait for hero(0)
palout(2)
camera follows hero(0)
teleport to map(85+poff,12,75)
set hp
wait(1)
pan camera(south,0,0)
set hero position(0,12,73)
wait(1)
palin(10)
set hero speed(0,2)
wait(4)
walk hero(0,down,2)
wait for hero(0)
set hero speed(0,hspeed)
camera follows hero(0)
)
)
do(
if(herox(0)==4,and,heroy(0)==74,and,check tag(694)) then(
	set tag(694,0)
	play song(2)
)
)

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

########################
script, ruinsdoor, begin
suspend player
suspend npcs
suspend obstruction
set tag (8,1)

if(herox(0)==12,and,heroy(0)==74) then(
if(check tag(547)) then(
pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(10)
camera follows hero(0)
teleport to map(72,152,95)
set pal(noon)
wait(1)
pan camera(south,0,0)
set hero position(0,152,101)
wait(1)
palin(2)
walk hero(0,up,2)
wait for hero(0)
)
else(
set hero direction(0,right)
wait(2)
walk hero(0,down,1)
wait for hero(0)
)
)
else(
if(herox(0)==60,and,heroy(0)==64) then(
pan camera(right,12,20)
set hero speed(0,10)
walk hero(0,right,12)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if(herox(0)==71,and,heroy(0)==64) then(
pan camera(left,12,20)
set hero speed(0,10)
walk hero(0,left,12)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if((herox(0)==99,or,herox(0)==100,or,herox(0)==101),and,heroy(0)==43) then(
stop song
variable(hx)
set variable(hx,herox(0))
pan camera(up,10,10)
set hero speed(0,5)
walk hero(0,up,5)
wait(5)
palout(5)
wait for camera
wait for hero(0)
wait(1)
camera follows hero(0)
set hero position(0,hx,27)
wait(1)
pan camera(south,0,0)
set hero position(0,hx,30)
wait(1)
pan camera(up,2,2)
walk hero(0,up,5)
wait(1)
palin(5)
play song(17)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if((herox(0)==99,or,herox(0)==100,or,herox(0)==101),and,heroy(0)==26) then(
stop song
variable(hxx)
set variable(hxx,herox(0))
pan camera(down,10,10)
set hero speed(0,5)
walk hero(0,down,5)
wait(5)
palout(5)
wait for camera
wait for hero(0)
wait(1)
camera follows hero(0)
set hero position(0,hxx,42)
wait(1)
pan camera(south,0,0)
set hero position(0,hxx,39)
wait(1)
pan camera(down,2,2)
walk hero(0,down,5)
wait(1)
palin(5)
play song(12)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)
do(
if((herox(0)==99,or,herox(0)==100,or,herox(0)==101),and,heroy(0)==18) then(

if(check tag(546)==false) then(set npc position(8,3,1))

focus camera(100,9,10)
set hero speed(0,4)
walk hero(0,up,5)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
if(check tag(546)==false) then(thisisit)

)
)
do(
if((herox(0)==99,or,herox(0)==100,or,herox(0)==101),and,heroy(0)==15) then(
variable(hxxx)
set variable(hxxx,herox(0))
focus camera(hxxx,19,10)
set hero speed(0,4)
walk hero(0,down,4)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
wait for camera
camera follows hero(0)
)
)

set hero frame(0,0)
set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

################################
script, scenefourpointtwo, begin
suspend player
suspend npcs
suspend obstruction

set tag(8,1)

wait(5)
set npc direction(30,down)
wait(5)
set npc direction(30,left)
wait(5)
jig npc(30)
stop song
tb(2426)

walk hero to y(0,41)
wait for hero(0)
set hero direction(0,right)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,down,1)
walk npc(2,up,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)

wait(3)
jig hero(0)
play song(84)
tb(2427)
jig npc(30)
tb(2428)
jig hero(0)
tb(2429)
set npc direction(30,down)
wait(2)
walk npc(30,right,1)
wait for npc(30)
walk npc(30,down,4)
wait(5)
stop song
show text box(2430)
wait for npc(30)
walk npc(30,right,7)
wait for npc(30)
wait for text box
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
wait(3)
alter npc(1,NPCstat:picture,340)
set npc frame(1,1)
wait(3)
set npc frame(1,0)
play song(15)
tb(2431)
jig npc(3)
tb(2432)
alter npc(1,NPCstat:picture,333)
set npc direction(1,down)
wait(2)
walk npc(1,left,1)
show text box(2433)
wait for npc(1)
set npc frame(1,0)
wait for text box
wait(2)
set npc direction(2,down)
wait(2)
jig npc(2)
tb(2434)
jig hero(0)
tb(2435)
wait(2)
set npc direction(2,right)
set npc direction(1,down)
wait(2)
set npc direction(1,right)

create npc(31,43,45)
create npc(32,43,45)
create npc(33,43,45)

walk npc(31,left,1)
wait for npc(31)
walk npc(31,left,1)
walk npc(32,left,1)
wait for npc(32)
walk npc(31,left,1)
walk npc(32,left,1)
walk npc(33,left,1)
wait for npc(33)
walk npc(31,left,5)
walk npc(32,left,5)
walk npc(33,left,5)
wait for npc(33)
walk npc(31,up,1)
walk npc(32,up,1)
walk npc(33,left,1)
wait for npc(33)
walk npc(31,up,3)
walk npc(32,up,3)
walk npc(33,up,3)
wait for npc(33)
walk npc(32,up,1)
set npc frame(31,0)
set npc frame(33,0)
set npc direction(31,left)
set npc direction(33,left)
wait for npc(32)
set npc frame(32,0)
set npc direction(32,left)

wait(5)
jig npc(31)
tb(2436)
jig hero(0)
tb(2437)
set npc direction(32,down)
jig npc(32)
stop song
show text box(2438)
wait(2)
set hero picture(0,332)
wait for text box
set npc direction(33,up)
jig npc(33)
tb(2439)
wait(3)
jig hero(0)
play song(91)
tb(2440)
jig npc(31)
show text box(2441)
wait(2)
set npc direction(32,left)
wait(2)
set npc direction(33,left)
wait for text box
jig npc(2)
tb(2442)
jig npc(31)
tb(2443)
wait(15)
set npc direction(31,up)
wait(20)
jig npc(31)
tb(2444)
wait(5)
set npc direction(31,left)
wait(2)
jig npc(31)
tb(2445)
set npc direction(32,down)
jig npc(32)
tb(2446)
set npc direction(33,up)
jig npc(33)
tb(2447)
jig npc(31)
show text box(2448)
wait(2)
set npc direction(31,down)
set npc direction(33,left)
wait(2)
set npc direction(33,down)
wait for text box
walk npc(31,down,4)
wait(2)
walk npc(32,down,4)
wait(2)
walk npc(33,down,4)
wait(7)

palout(3)
wait for npc(33)
camera follows hero(0)
teleport to map(41+poff,7,96)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,7,100)
set npc position(31,7,100)
set hero picture(0,229)
set hero speed(0,4)
wait(1)
palin(3)

walk npc(31,up,1)
wait for npc(31)
walk hero(0,up,3)
walk npc(31,up,4)
wait for hero(0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,down,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)
wait for npc(31)
set npc position(32,npcx(31),npcy(31))
set npc position(33,npcx(31),npcy(31))
walk npc(31,left,2)
walk npc(33,right,2)
set npc direction(32,down)
wait for npc(31)
set npc frame(31,0)
set npc direction(31,down)
wait for npc(33)
set npc frame(33,0)
set npc direction(33,down)
wait(7)

jig npc(32)
tb(2449)
play song(82)
tb(2450)
wait(2)
set npc direction(32,left)
wait(2)
jig npc(32)
tb(2451)
jig npc(31)
tb(2452)
wait(2)
set npc direction(32,down)
wait(3)
set npc direction(32,right)
wait(2)
jig npc(32)
tb(2453)
jig npc(33)
tb(2454)
jig npc(1)
tb(2455)
wait(2)
set npc direction(32,up)
wait(2)
jig npc(32)
tb(2456)
wait(2)
set npc direction(32,right)
wait(2)
set npc direction(32,down)
tb(2487)
jig hero(0)
tb(2457)
wait(2)
alter npc(32,NPCstat:picture,353)
set npc direction(32,up)
wait(6)
set npc direction(32,down)
wait(4)
set npc frame(32,1)
wait(8)
set npc frame(32,0)
show text box(2458)
wait(4)
set npc direction(32,up)
wait for text box
wait(5)
alter npc(32,NPCstat:picture,274)
set npc direction(32,down)
jig npc(32)
tb(2459)
tb(2460)
wait(10)
jig npc(32)
tb(2461)
wait(2)
tb(2462)
tb(2463)
jig npc(32)
tb(2464)
wait(3)
tb(2465)
wait(3)
tb(2466)

wait(7)
jig npc(32)
tb(2467)

#Yes questions
if(check tag(140)) then(
tb(2468)

#Overseer
if(check tag(141)) then(
	set tag(141,0)
	jig hero(0)
	tb(2469)
	jig npc(32)
	tb(2470)
	tb(2471)
	wait(5)
	tb(2472)
	jig npc(32)
	tb(2478)

	if(check tag(141)) then(
		jig hero(0)
		tb(2473)
		jig npc(32)
		tb(2474)
		tb(2475)
		wait(5)
		tb(2476)
	)
	else(
		jig hero(0)
		tb(2480)
		jig npc(32)
		stop song
		tb(2481)
	)
)
#Rorc
if(check tag(142)) then(
	set tag(142,0)
	jig hero(0)
	tb(2473)
	jig npc(32)
	tb(2474)
	tb(2475)
	wait(5)
	tb(2476)
	jig npc(32)
	tb(2477)

	if(check tag(142)) then(
		jig hero(0)
		tb(2469)
		jig npc(32)
		tb(2470)
		tb(2471)
		wait(5)
		tb(2472)
	)
	else(
		jig hero(0)
		tb(2480)
		jig npc(32)
		tb(2481)
	)
)
#finished with questions
	if(check tag(141),and,check tag(142)) then(
		jig npc(32)
		stop song
		tb(2479)
	)
)
#No questions
else(
jig hero(0)
tb(2480)
jig npc(32)
stop song
tb(2481)
)

palout(3)
camera follows hero(0)
set hero position(0,2,151)
wait(1)
pan camera(south,0,0)
set hero position(0,2,153)
wait(1)
palin(3)

set hero speed(0,2)
#alter npc(31,NPCstat:movespeed,2)
#alter npc(32,NPCstat:movespeed,2)
#alter npc(33,NPCstat:movespeed,2)
#set npc position(31,2,153)
#set npc position(32,2,153)
#set npc position(33,2,153)
#walk npc(31,up,5)
#wait(10)
#walk npc(32,up,5)
#wait(10)
#walk npc(33,up,5)
wait(15)
walk hero(0,up,2)
wait for hero(0)
set hero speed(0,4)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,up,1)
walk npc(1,right,1)
walk npc(3,left,1)
set npc direction(2,up)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)

wait for npc(33)
set npc position(31,0,0)
set npc position(32,0,0)
set npc position(33,0,0)

wait(3)
set hero direction(0,right)
wait(3)
set hero direction(0,down)
wait(5)
jig hero(0)
tb(2482)
jig npc(1)
tb(2483)
jig hero(0)
tb(2484)
jig npc(2)
tb(2485)
jig npc(3)
tb(2486)
jig npc(1)
tb(2488)
wait(5)
jig hero(0)
tb(2489)
jig npc(1)
tb(2490)
tb(2491)
wait(5)
set hero direction(0,right)
wait(10)
jig hero(0)
tb(2492)

walk npc(1,up,1)
walk npc(2,up,1)
walk npc(3,up,1)
wait for npc(1)
walk npc(1,left,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
walk npc(3,right,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(3)
set npc position(3,2,1)
wait(2)
set hero direction(0,up)

write pass block(2,153,1+2+4+8)
set party in
set tag(8,0)
set hero speed(0,hspeed)
set variable(musicsave,1)

save game

resume obstruction
resume npcs
resume player
end
###

#########################
script, katinatalk, begin
suspend player
suspend npcs
suspend obstruction

set variable(musicsave,0)

set tag(143,1)

pan camera(south,0,0)
walk hero(0,up,1)
wait for hero(0)
palout(2)
camera follows hero(0)

#teleport to map(41+poff,4,171)
#stop song
set hero position(0,4,171)

wait(1)
pan camera(south,0,0)
set hero position(0,4,172)
alter npc(28,NPCstat:picture,354)
put npc(28,(4*20),(165*20)+8)
set hero speed(0,4)
wait(1)
palin(2)

walk hero(0,up,3)
wait for hero(0)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,up,1)
walk npc(1,right,1)
walk npc(2,down,1)
walk npc(3,left,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)

wait(2)
pan camera(up,5,2)
wait for camera
wait(10)
play song(15)
jig gahn
tb(2493)
play song(62)
wait(1)
alter npc(28,NPCstat:picture,104)
put npc(28,(4*20),(166*20)--18)
set npc frame(28,0)
wait(2)
put npc(28,(4*20),(166*20)--16)
set npc frame(28,1)
wait(2)
put npc(28,(4*20),(166*20)--14)
set npc frame(28,0)
wait(2)
put npc(28,(4*20),(166*20)--12)
set npc frame(28,1)
wait(2)
put npc(28,(4*20),(166*20)--10)
set npc frame(28,0)
wait(2)
put npc(28,(4*20),(166*20)--8)
set npc frame(28,1)
wait(2)
set npc frame(28,0)

#using global var 31-text1 for rage counter
set variable(text1,0)
#using global var 32-text2 for continue ze loop
set variable(text2,0)

#katina's tb, dog, rdog, mi, rmi, jo, rjo, py, rpy
#1
ktalk(2499,2500,2501,2502,2503,2504,0,2505,0)

#2
ktalk(2506,2507,2508,2509,0,2510,0,2511,0)

#3 Brick - Pyrus
pyrusbrick

#4
ktalk(2521,2522,0,2523,0,2524,0,2525,0)

#5
ktalk(2526,2527,0,2528,0,2529,0,2530,0)

#6 Brick - Mila
milabrick

#7
ktalk(2543,2544,2545,2546,0,2547,0,2548,2549)

#8
ktalk(2550,2551,2552,2553,2554,2555,0,2556,0)

#9 Brick - Johan
johanbrick

#10
ktalk(2567,2568,0,2569,2570,2571,0,2572,0)

#11
ktalk(2573,2574,2575,2576,0,2577,0,2578,2579)

#12 Brick - No response
noresponsebrick

#13
ktalk(2588,2589,0,2590,0,2591,0,2592,0)

#14
ktalk(2593,2594,0,2595,0,2596,0,2597,0)

#15 Brick - Dogero
dogerobrick

katinatalkend

resume obstruction
resume npcs
resume player
end
###

##############################################################
script, ktalk, kt, dog, rdog, mi, rmi, jo, rjo, py, rpy, begin
variable(loop)
set variable(loop,true)
suspend box advance
jig npc(28)
show text box(kt)
variable(i)
variable(arup)
variable(arright)
variable(ardown)
variable(arleft)
set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
wait(1)
while(loop==true) do(
if(keyispressed(28),or,keyispressed(29),or,keyispressed(57)) then(
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	set variable(loop,false)
)
if(keyispressed(72)) then(
	for(i,1,5,1) do(
		set npc frame(arup,1)
		wait(1)
		set npc frame(arup,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig hero(0)
	tb(dog)
	if(rdog<>0) then(
		jig npc(28)
		tb(rdog))
	else(katinarage)
	set variable(loop,false)
)
if(keyispressed(77)) then(
	for(i,1,5,1) do(
		set npc frame(arright,1)
		wait(1)
		set npc frame(arright,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(1)
	tb(mi)
	if(rmi<>0) then(
		jig npc(28)
		tb(rmi))
	else(katinarage)
	set variable(loop,false)
)
if(keyispressed(80)) then(
	for(i,1,5,1) do(
		set npc frame(ardown,1)
		wait(1)
		set npc frame(ardown,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(2)
	tb(jo)
	if(rjo<>0) then(
		jig npc(28)
		tb(rjo))
	else(katinarage)
	set variable(loop,false)
)
if(keyispressed(75)) then(
	for(i,1,5,1) do(
		set npc frame(arleft,1)
		wait(1)
		set npc frame(arleft,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(3)
	tb(py)
	if(rpy<>0) then(
		jig npc(28)
		tb(rpy))
	else(katinarage)
	set variable(loop,false)
)
wait(2)
)
end
###

#########################
script, pyrusbrick, begin
variable(net)
set variable(net,0)
variable(dognet)
set variable(dognet,0)
variable(minet)
set variable(minet,0)
variable(jonet)
set variable(jonet,0)
variable(loop)
set variable(loop,true)
suspend box advance
jig npc(28)
show text box(2512)
variable(i)
variable(arup)
variable(arright)
variable(ardown)
variable(arleft)
set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
wait(1)
while(loop==true) do(
if(keyispressed(28),or,keyispressed(29),or,keyispressed(57)) then(
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	if(net==0) then(
		set variable(net,1)
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(72)) then(
	for(i,1,5,1) do(
		set npc frame(arup,1)
		wait(1)
		set npc frame(arup,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig hero(0)
	tb(2514)
	if(dognet==0) then(
		set variable(dognet,1)
		jig npc(28)
		resume box advance
		tb(2515)
		suspend box advance
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(77)) then(
	for(i,1,5,1) do(
		set npc frame(arright,1)
		wait(1)
		set npc frame(arright,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(1)
	tb(2516)
	if(minet==0) then(
		set variable(minet,1)
		suspend box advance
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(80)) then(
	for(i,1,5,1) do(
		set npc frame(ardown,1)
		wait(1)
		set npc frame(ardown,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(2)
	tb(2517)
	if(jonet==0) then(
		set variable(jonet,1)
		suspend box advance
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2513)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(75)) then(
	for(i,1,5,1) do(
		set npc frame(arleft,1)
		wait(1)
		set npc frame(arleft,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(3)
	tb(2518)
	tb(2519)
	jig npc(28)
	tb(2520)
	set variable(loop,false)
)
wait(2)
)
end
###

########################
script, milabrick, begin
variable(net)
set variable(net,0)
variable(dognet)
set variable(dognet,0)
variable(jonet)
set variable(jonet,0)
variable(pynet)
set variable(pynet,0)
variable(loop)
set variable(loop,true)
suspend box advance
jig npc(28)
show text box(2531)
variable(i)
variable(arup)
variable(arright)
variable(ardown)
variable(arleft)
set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
wait(1)
while(loop==true) do(
if(keyispressed(28),or,keyispressed(29),or,keyispressed(57)) then(
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	if(net==0) then(
		set variable(net,1)
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(72)) then(
	for(i,1,5,1) do(
		set npc frame(arup,1)
		wait(1)
		set npc frame(arup,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig hero(0)
	tb(2533)
	if(dognet==0) then(
		set variable(dognet,1)
		jig npc(28)
		resume box advance
		tb(2534)
		suspend box advance
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(77)) then(
	for(i,1,5,1) do(
		set npc frame(arright,1)
		wait(1)
		set npc frame(arright,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(1)
	tb(2535)
	jig npc(28)
	tb(2536)
	jig npc(1)
	tb(2537)
	jig npc(28)
	tb(2538)
	set variable(loop,false)
)
if(keyispressed(80)) then(
	for(i,1,5,1) do(
		set npc frame(ardown,1)
		wait(1)
		set npc frame(ardown,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(2)
	tb(2539)
	if(jonet==0) then(
		set variable(jonet,1)
		jig npc(28)
		tb(2540)
		suspend box advance
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(75)) then(
	for(i,1,5,1) do(
		set npc frame(arleft,1)
		wait(1)
		set npc frame(arleft,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(3)
	tb(2541)
	if(pynet==0) then(
		set variable(pynet,1)
		jig npc(28)
		tb(2542)
		suspend box advance
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2532)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
wait(2)
)
end
###

#########################
script, johanbrick, begin
variable(net)
set variable(net,0)
variable(dognet)
set variable(dognet,0)
variable(minet)
set variable(minet,0)
variable(pynet)
set variable(pynet,0)
variable(loop)
set variable(loop,true)
suspend box advance
jig npc(28)
show text box(2557)
variable(i)
variable(arup)
variable(arright)
variable(ardown)
variable(arleft)
set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
wait(1)
while(loop==true) do(
if(keyispressed(28),or,keyispressed(29),or,keyispressed(57)) then(
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	if(net==0) then(
		set variable(net,1)
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(72)) then(
	for(i,1,5,1) do(
		set npc frame(arup,1)
		wait(1)
		set npc frame(arup,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig hero(0)
	tb(2559)
	if(dognet==0) then(
		set variable(dognet,1)
		jig npc(28)
		resume box advance
		tb(2560)
		suspend box advance
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(77)) then(
	for(i,1,5,1) do(
		set npc frame(arright,1)
		wait(1)
		set npc frame(arright,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(1)
	tb(2561)
	if(minet==0) then(
		set variable(minet,1)
		jig npc(28)
		resume box advance
		tb(2562)
		suspend box advance
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(80)) then(
	for(i,1,5,1) do(
		set npc frame(ardown,1)
		wait(1)
		set npc frame(ardown,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(2)
	tb(2563)
	alter npc(28,NPCstat:picture,355)
	wait(8)
	jig npc(28)
	tb(2564)
	wait(5)
	alter npc(28,NPCstat:picture,104)
	set variable(loop,false)
)
if(keyispressed(75)) then(
	for(i,1,5,1) do(
		set npc frame(arleft,1)
		wait(1)
		set npc frame(arleft,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(3)
	tb(2565)
	if(pynet==0) then(
		set variable(pynet,1)
		jig npc(28)
		tb(2566)
		suspend box advance
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2558)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
wait(2)
)
end
###

##############################
script, noresponsebrick, begin
variable(net)
set variable(net,0)
variable(dognet)
set variable(dognet,0)
variable(minet)
set variable(minet,0)
variable(jonet)
set variable(jonet,0)
variable(pynet)
set variable(pynet,0)
variable(loop)
set variable(loop,true)
suspend box advance
jig npc(28)
show text box(2580)
variable(i)
variable(arup)
variable(arright)
variable(ardown)
variable(arleft)
set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
wait(1)
while(loop==true) do(
if(keyispressed(28),or,keyispressed(29),or,keyispressed(57)) then(
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	if(net==3) then(
		wait(1)
		set variable(loop,false)
	)
	if(net==2) then(
		set variable(net,3)
		jig npc(28)
		show text box(2583)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	if(net==1) then(
		set variable(net,2)
		jig npc(28)
		show text box(2582)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	if(net==0) then(
		set variable(net,1)
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(72)) then(
	for(i,1,5,1) do(
		set npc frame(arup,1)
		wait(1)
		set npc frame(arup,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig hero(0)
	tb(2584)
	if(dognet==0) then(
		set variable(dognet,1)
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(77)) then(
	for(i,1,5,1) do(
		set npc frame(arright,1)
		wait(1)
		set npc frame(arright,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(1)
	tb(2585)
	if(minet==0) then(
		set variable(minet,1)
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(80)) then(
	for(i,1,5,1) do(
		set npc frame(ardown,1)
		wait(1)
		set npc frame(ardown,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(2)
	tb(2586)
	if(jonet==0) then(
		set variable(jonet,1)
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
if(keyispressed(75)) then(
	for(i,1,5,1) do(
		set npc frame(arleft,1)
		wait(1)
		set npc frame(arleft,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(3)
	tb(2587)
	if(pynet==0) then(
		set variable(pynet,1)
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
	else(
		katinarage
		suspend box advance
		jig npc(28)
		show text box(2581)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
	)
)
wait(2)
)
end
###

##########################
script, dogerobrick, begin
variable(loop)
set variable(loop,true)
suspend box advance
jig npc(28)
show text box(2598)
variable(i)
variable(arup)
variable(arright)
variable(ardown)
variable(arleft)
set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
wait(1)
while(loop==true) do(
if(keyispressed(28),or,keyispressed(29),or,keyispressed(57)) then(
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
		jig npc(28)
		show text box(2598)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
)
if(keyispressed(72)) then(
	for(i,1,5,1) do(
		set npc frame(arup,1)
		wait(1)
		set npc frame(arup,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
		wait(1)
		set variable(loop,false)
)
if(keyispressed(77)) then(
	for(i,1,5,1) do(
		set npc frame(arright,1)
		wait(1)
		set npc frame(arright,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(1)
	tb(2599)
	jig npc(28)
	tb(2600)
		suspend box advance
		jig npc(28)
		show text box(2598)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
)
if(keyispressed(80)) then(
	for(i,1,5,1) do(
		set npc frame(ardown,1)
		wait(1)
		set npc frame(ardown,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(2)
	tb(2601)
	jig npc(28)
	tb(2602)
		suspend box advance
		jig npc(28)
		show text box(2598)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
)
if(keyispressed(75)) then(
	for(i,1,5,1) do(
		set npc frame(arleft,1)
		wait(1)
		set npc frame(arleft,0)
		wait(1)
	)
	destroy npc(arup)
	destroy npc(arright)
	destroy npc(ardown)
	destroy npc(arleft)
	advance text box
	resume box advance
	jig npc(3)
	tb(2603)
	jig npc(28)
	tb(2604)
		suspend box advance
		jig npc(28)
		show text box(2598)
		set variable(arup,create npc(27,herox(0),heroy(0)--1,up))
		set variable(arright,create npc(27,herox(0)+1,heroy(0),right))
		set variable(ardown,create npc(27,herox(0),heroy(0)+1,down))
		set variable(arleft,create npc(27,herox(0)--1,heroy(0),left))
		wait(1)
)
wait(2)
)
end
###

#########################
script, katinarage, begin
resume box advance
if(text1==4) then(
	jig npc(28)
	tb(2498)
#	create npc(29,3,171)
#	create npc(30,5,171)
#	create npc(31,4,172)
#	create npc(32,3,172)
#	create npc(33,5,172)
set npc position(29,3,171)
set npc position(30,5,171)
set npc position(31,4,172)
set npc position(32,3,172)
set npc position(33,5,172)

	set hero direction(0,right)
	set npc direction(1,left)
	set npc direction(2,left)
	set npc direction(3,right)
	walk npc(29,up,1)
	walk npc(30,up,1)
	walk npc(31,up,1)
	walk npc(32,up,1)
	walk npc(33,up,1)
	wait(2)
	set hero direction(0,down)
	set npc direction(1,down)
	set npc direction(2,down)
	set npc direction(3,down)
	wait for npc(33)
	walk npc(29,up,1)
	walk npc(30,up,1)
	walk npc(31,up,1)
	walk npc(32,up,1)
	walk npc(33,up,1)
	walk npc(1,up,1)
	set npc direction(1,down)
	walk npc(2,up,1)
	set npc direction(2,down)
	walk npc(3,up,1)
	set npc direction(3,down)
	wait for npc(3)
	over game
)
if(text1==3) then(
	jig npc(28)
	tb(2497)
	set variable(text1,4)
)
if(text1==2) then(
	jig npc(28)
	tb(2496)
	set variable(text1,3)
)
if(text1==1) then(
	jig npc(28)
	tb(2495)
	set variable(text1,2)
)
if(text1==0) then(
	jig npc(28)
	tb(2494)
	set variable(text1,1)
)
suspend box advance
end
###

############################
script, katinatalkend, begin

katinatalkend1
katinatalkend2
katinatalkend3

stop song
save game
play song(76)

end
###
#############################
script, katinatalkend1, begin
stop song
pan camera(up,2,2)
set hero speed(0,1)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
wait for camera
jig hero(0)
tb(2605)
tb(2606)
wait(5)
jig hero(0)
tb(2607)
tb(2608)
jig npc(28)
play song(59)
tb(2609)
jig hero(0)
tb(2610)
jig npc(28)
tb(2611)
jig hero(0)
tb(2612)
jig npc(28)
tb(2613)
wait(10)
jig hero(0)
tb(2614)
tb(2615)
jig npc(28)
tb(2616)
set hero picture(0,331)
wait(5)
set hero direction(0,right)
wait(5)
set hero direction(0,down)
wait(5)
set hero speed(0,2)
pan camera(down,2,4)
walk hero(0,down,2)
wait for hero(0)
set hero frame(0,0)
set hero picture(0,356)
wait for camera
wait(10)
set hero frame(0,1)
tb(2617)
jig npc(28)
tb(2618)
set hero speed(0,4)
set hero frame(0,0)
set npc direction(1,left)
set npc direction(2,left)
set npc direction(3,right)
wait(2)
set hero picture(0,331)
walk npc(2,down,2)
walk hero(0,down,1)
walk npc(1,left,1)
walk npc(28,down,1)
show text box(2619)
wait for hero(0)
walk hero(0,down,1)
walk npc(1,down,1)
walk npc(3,right,1)
wait for hero(0)
walk hero(0,down,1)
walk npc(1,down,2)
walk npc(3,down,3)
wait for text box
jig npc(28)
tb(2620)

palout(3)
camera follows hero(0)
teleport to map(45+poff,55,60)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
wait(1)
pan camera(down,7,2)
palin(5)
end
###
#############################
script, katinatalkend2, begin
wait for camera
wait(10)
set hero position(0,55,63)
walk hero(0,down,4)
wait for hero(0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,up,1)
walk npc(1,right,1)
walk npc(2,down,1)
walk npc(3,left,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
wait for npc(3)
set npc frame(3,0)
set hero direction(0,right)
set npc direction(1,down)
set npc direction(2,left)
set npc direction(3,up)
wait(3)
set hero direction(0,down)
set npc direction(1,left)
set npc direction(2,up)
set npc direction(3,right)

jig npc(2)
play song(82)
tb(2621)
jig npc(3)
tb(2622)
jig hero(0)
tb(2623)
jig npc(3)
tb(2624)
jig npc(1)
tb(2625)
jig npc(3)
tb(2626)
jig npc(1)
tb(2627)
jig npc(2)
tb(2628)
wait(4)
set hero picture(0,356)
set hero direction(0,up)
wait(20)
set hero frame(0,1)
wait(5)
set hero direction(0,left)
wait(10)
stop song
tb(775)
jig npc(2)
tb(2629)
set hero frame(0,1)
wait(10)
tb(2630)
wait(15)
jig npc(2)
tb(2631)
set hero direction(0,up)
wait(4)
set hero picture(0,332)
set hero direction(0,down)
jig hero(0)
tb(2632)
show text box(2633)
wait(2)
alter npc(1,NPCstat:picture,333)
wait for text box
set npc direction(1,up)
jig npc(1)
play song(91)
tb(2634)
jig hero(0)
tb(2635)
tb(2636)
jig npc(1)
tb(2637)
set hero picture(0,356)
set hero direction(0,up)
wait(4)
set hero direction(0,left)
show text box(2638)
wait(4)
set hero frame(0,1)
wait for text box
end
###
#############################
script, katinatalkend3, begin
walk npc(1,up,1)
wait(2)
set npc direction(3,up)
wait for npc(1)
set npc direction(1,left)
set npc frame(1,0)
jig npc(1)
tb(2639)
jig npc(1)
tb(2640)
tb(2641)
tb(2642)
wait(5)
jig npc(1)
tb(2643)
wait(2)
set hero frame(0,0)
wait(4)
set hero direction(0,up)
wait(5)
set hero picture(0,229)
set hero direction(0,right)
wait(10)
jig hero(0)
tb(2644)
alter npc(1,NPCstat:picture,340)
set npc direction(1,up)
wait(3)
set npc frame(1,1)
tb(2645)
set hero direction(0,down)
wait(5)
jig hero(0)
tb(2646)
jig npc(3)
tb(2647)
jig hero(0)
tb(2648)

alter npc(1,NPCstat:picture,232)
walk npc(1,down,1)
wait for npc(1)
walk hero(0,down,1)
walk npc(1,left,1)
walk npc(2,up,1)
walk npc(3,right,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)

set tag(649,1)
set tag(433,0)
set party in
camera follows hero(0)
set tag(8,0)
set hero speed(0,hspeed)
set variable(isrunning,true)
set variable(hour,noontime)
set tag(3,0)
set tag(4,1)
set tag(5,0)
set tag(6,0)
create npc(34,herox(0),heroy(0)--1)
create npc(34,herox(0)+1,heroy(0))
create npc(34,herox(0),heroy(0)+1)
create npc(34,herox(0)--1,heroy(0))
end
###

######################
script, stapler, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236)
)

if(check tag(149)) then(tb(2715))

if(check tag(144)==false) then(
stop song
focus camera(69,46,2)
set npc direction(29,down)
walk hero to y(0,46)
wait for hero(0)
walk hero to x(0,69)
wait for hero(0)
set hero direction(0,up)
set party out
swap by position(find hero(0),0)
set npc position(2,herox(0),heroy(0))
walk npc(2,down,1)
wait for npc(2)
set npc frame(2,0)
set npc position(1,npcx(2),npcy(2))
set npc position(3,npcx(2),npcy(2))
walk npc(1,right,1)
walk npc(3,left,1)
set npc direction(2,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)
jig npc(29)
tb(2649)
tb(2650)
wait(6)
jig npc(29)
tb(2651)
)

if(check tag(144)==false) then(
jig hero(0)
tb(2652)
jig npc(29)
tb(2653)
walk npc(3,right,1)
walk npc(1,left,1)
set npc direction(2,left)
wait for npc(3)
set npc position(3,2,1)
wait for npc(1)
set npc position(1,0,1)
walk npc(2,up,1)
wait for npc(2)
set npc position(2,1,1)
set party in
camera follows hero(0)
play song(78)
)

if(check tag(145),and,check tag(147)==false) then(
stop song
focus camera(69,46,2)
set npc direction(29,down)
walk hero to y(0,46)
wait for hero(0)
walk hero to x(0,69)
wait for hero(0)
set hero direction(0,up)
set party out
swap by position(find hero(0),0)
set npc position(2,herox(0),heroy(0))
walk npc(2,down,1)
wait for npc(2)
set npc frame(2,0)
set npc position(1,npcx(2),npcy(2))
set npc position(3,npcx(2),npcy(2))
walk npc(1,right,1)
walk npc(3,left,1)
set npc direction(2,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)
play song(91)
jig npc(29)
tb(2660)
)

if(check tag(144),and,check tag(145)==false) then(
play song(91)
set tag(145,1)
jig hero(0)
tb(2654)
jig npc(29)
tb(2655)
tb(2656)
wait(5)
jig npc(29)
tb(2657)
tb(2658)
jig npc(29)
tb(2659)
wait(3)
jig npc(29)
tb(2660)
)

if(check tag(147),and,check tag(148)==false) then(
jig npc(29)
tb(2666)
)

if(check tag(144),and,check tag(146)==false) then(
stop song
jig hero(0)
tb(2661)
jig npc(29)
tb(2662)
walk npc(3,right,1)
walk npc(1,left,1)
set npc direction(2,left)
wait for npc(3)
set npc position(3,2,1)
wait for npc(1)
set npc position(1,0,1)
walk npc(2,up,1)
wait for npc(2)
set npc position(2,1,1)
set party in
camera follows hero(0)
play song(78)
)
if(check tag(146),and,check tag(147)==false) then(
set tag(147,1)
jig hero(0)
tb(2663)
jig npc(29)
tb(2664)
walk npc(3,right,1)
walk npc(1,left,1)
set npc direction(2,left)
wait for npc(3)
set npc position(3,2,1)
wait for npc(1)
set npc position(1,0,1)
walk npc(2,up,1)
wait for npc(2)
set npc position(2,1,1)
set party in
camera follows hero(0)
jig npc(29)
tb(2665)
set variable(isrunning,false)
write pass block(56,45,1+2+4+8)
write pass block(56,46,1+2+4+8)
write pass block(56,47,1+2+4+8)
write pass block(56,48,1+2+4+8)
write pass block(56,51,1+2+4+8)
write pass block(62,52,1+2+4+8)
write pass block(63,52,1+2+4+8)
write pass block(64,52,1+2+4+8)
write pass block(73,45,1+2+4+8)
alter npc(25,NPCstat:script,117)
alter npc(26,NPCstat:script,117)
alter npc(27,NPCstat:script,117)
alter npc(28,NPCstat:script,117)
alter npc(25,NPCstat:scriptargument,25)
alter npc(26,NPCstat:scriptargument,26)
alter npc(27,NPCstat:scriptargument,27)
alter npc(28,NPCstat:scriptargument,28)
alter npc(25,NPCstat:whenactivated,npcwhenactivated:faceplayer)
alter npc(26,NPCstat:whenactivated,npcwhenactivated:faceplayer)
alter npc(27,NPCstat:whenactivated,npcwhenactivated:faceplayer)
alter npc(28,NPCstat:whenactivated,npcwhenactivated:faceplayer)
)

if(check tag(148),and,check tag(149)==false) then(
jig npc(29)
tb(2667)

palout(3)
camera follows hero(0)
teleport to map(37,70,51)
stop song
wait(1)
if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))
pan camera(south,0,0)
set party out
swap by position(find hero(0),0)
set hero direction(0,down)
set hero position(0,71,50)
set npc position(1,72,49)
set npc position(3,71,49)
set npc position(2,70,49)
set npc position(29,72,51)
set tag(3,0)
set tag(4,1)
set tag(5,0)
set tag(6,0)
set hp
wait(10)
palin(3)

wait(15)
set npc direction(29,right)
wait(3)
set npc direction(29,up)
jig npc(29)
tb(2668)
wait(2)
create npc(23,62,50)
walk npc(23,right,4)
wait(6)
set npc direction(29,left)
play song(15)
wait(2)
jig npc(29)
show text box(2669)
wait(2)
set hero direction(0,left)
set npc direction(2,left)
set npc direction(3,left)
walk npc(1,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(23)
variable(goon1)
variable(goon2)
variable(goon3)
set variable(goon1,create npc(24,npcx(23),npcy(23)))
set variable(goon2,create npc(24,npcx(23),npcy(23),right))
set variable(goon3,create npc(24,npcx(23),npcy(23)))
walk npc(23,right,1)
walk npc(goon1,up,1)
walk npc(goon3,down,1)
wait for npc(23)
set npc frame(23,0)
wait for npc(goon1)
set npc frame(goon1,0)
set npc direction(goon1,right)
wait for npc(goon3)
set npc frame(goon3,0)
set npc direction(goon3,right)
wait for text box

jig npc(23)
tb(2670)
jig npc(goon3)
tb(2671)
walk npc(29,left,2)
wait for npc(29)
set npc frame(29,0)
jig npc(29)
tb(2672)
jig npc(goon3)
tb(2673)
wait(3)
set npc direction(29,down)
wait(3)
walk npc(29,right,2)
wait for npc(29)
set npc frame(29,0)
wait(10)
jig npc(29)
tb(2674)
jig npc(23)
tb(2675)
set hero speed(0,4)
walk hero(0,left,1)
walk npc(3,down,1)
wait for hero(0)
wait for npc(3)
walk hero(0,left,1)
walk npc(1,left,1)
walk npc(3,left,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(3)
walk npc(3,down,1)
walk npc(1,left,1)
wait for npc(1)
walk npc(3,left,1)
walk npc(1,down,1)
walk npc(2,down,1)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait(15)
jig npc(23)
show text box(2676)
wait(2)
set npc direction(29,down)
wait(2)
set npc direction(29,left)
wait for text box
jig hero(0)
stop song
tb(2677)
alter npc(23,NPCstat:movespeed,10)
walk npc(23,right,1)
wait for npc(23)
set npc frame(23,0)
tb(2678)
jig npc(1)
tb(2679)
jig npc(23)
tb(2680)
jig npc(3)
tb(2681)
jig npc(2)
tb(2682)
jig npc(23)
tb(2683)

battleflash
destroy npc(23)
destroy npc(goon1)
destroy npc(goon2)
destroy npc(goon3)
ff(289)
stop song

wait(5)
jig npc(29)
show text box(2684)
wait(3)
set hero direction(0,down)
set npc direction(1,down)
wait(2)
set hero direction(0,right)
set npc direction(1,right)
set npc direction(2,down)
set npc direction(3,down)
wait(2)
set npc direction(2,right)
set npc direction(3,right)
wait for text box

palout(3)
camera follows hero(0)
teleport to map(41,4,168)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
alter npc(28,NPCstat:picture,354)
set npc position(28,4,165)
put npc(28,4*20,(165*20)+8)
set npc position(31,4,169)
set npc direction(31,up)
wait(15)
palin(3)

play song(59)
wait(4)
jig npc(28)
jig npc(28)
tb(2685)
jig npc(31)
tb(2686)
jig npc(28)
tb(2687)
wait(10)
set npc direction(31,left)
wait(3)
jig npc(31)
tb(2688)
alter npc(28,NPCstat:movespeed,10)
alter npc(28,NPCstat:picture,104)
walk npc(28,down,1)
show text box(2689)
wait for npc(28)
set npc frame(28,0)
set npc direction(31,up)
wait for text box
jig npc(31)
tb(2690)
wait(3)
set npc direction(31,left)
wait(3)
alter npc(31,NPCstat:movespeed,2)
walk npc(31,down,3)
wait(7)

palout(3)
camera follows hero(0)
teleport to map(38,64,46)
play song(59)
wait(1)
if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))
pan camera(south,0,0)
set hero position(0,65,46)
set npc position(1,65,45)
set npc position(2,64,46)
set npc position(3,65,47)
set npc position(29,67,45)
set npc direction(29,left)
set npc direction(1,right)
set npc direction(2,right)
set npc direction(3,right)
set hero direction(0,right)
set tag(3,0)
set tag(4,0)
set tag(5,1)
set tag(6,0)
set hp
wait(15)
palin(3)

wait(3)
jig npc(29)
tb(2691)
create npc(31,73,45)
walk npc(31,left,4)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
show text box(2692)
stop song
wait(2)
set npc direction(29,down)
wait(2)
set npc direction(29,right)
wait for text box
jig npc(31)
tb(2693)
wait(5)
jig npc(29)
tb(2694)
walk npc(31,down,1)
wait(2)
set npc direction(29,down)
wait for npc(31)
set npc frame(31,0)
set npc direction(31,left)
jig npc(31)
tb(2695)
jig hero(0)
play song(91)
tb(2696)
jig npc(31)
tb(2697)
jig npc(29)
tb(2698)
wait(5)
set npc direction(31,up)
wait(10)
jig npc(31)
tb(2699)
jig npc(29)
tb(2700)
wait(7)
jig npc(31)
tb(2701)
jig npc(1)
tb(2702)
wait(3)
set npc direction(31,left)
wait(3)
jig npc(31)
tb(2703)
stop song
wait(15)
jig npc(2)
tb(2704)
wait(6)
jig npc(31)
tb(2705)
wait(2)
set npc direction(31,down)
wait(2)
set npc direction(31,right)
wait(6)
jig npc(31)
tb(2706)
walk npc(31,right,2)
wait for npc(31)
walk npc(31,up,1)
wait for npc(31)
walk npc(31,right,2)
wait for npc(31)
destroy npc(31)
jig npc(3)
tb(2707)
wait(4)
set npc direction(2,down)
wait(4)
jig npc(2)
tb(2708)
wait(2)
set npc direction(3,up)
jig npc(3)
tb(2709)
jig npc(2)
tb(2710)
jig npc(3)
show text box(2711)
wait(2)
set npc direction(3,right)
wait for text box
jig npc(1)
tb(2712)
wait(2)
set npc direction(29,left)
wait(2)
walk npc(29,left,1)
set npc direction(2,right)
wait for npc(29)
set npc frame(29)
jig npc(29)
play song(82)
tb(2713)
wait(2)
tb(2714)
alter npc(29,NPCstat:displaytext,2715)

focus camera(herox(0),heroy(0),2)
walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,up,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
wait for camera

camera follows hero(0)
set tag(149,1)
set party in
set hero speed(0,hspeed)
set variable(isrunning,true)
set variable(hour,afternoontime)
create npc(24,herox(0)+1,heroy(0))
create npc(24,herox(0)--1,heroy(0))
create npc(24,herox(0),heroy(0)+1)
create npc(24,herox(0),heroy(0)--1)
wait(2)
jadeup(2,1)
wait(2)
save game
)

resume obstruction
resume npcs
resume player
end
###

####################################
script, dockworkers, whichone, begin
suspend player
suspend npcs
if(whichone==25) then(
tb(3822)
tb(3826)
palout(2)
set npc position(whichone,0,0)
if(npcx(25)==0,and,npcx(26)==0,and,npcx(27)==0,and,npcx(28)==0) then(set tag(148,1))
wait(1)
palin(2)
)
if(whichone==26) then(
tb(3822)
stop song
tb(3829)
battle flash
ff(288)
play song(91)
write pass block(56,45,1+2+4+8)
write pass block(56,46,1+2+4+8)
write pass block(56,47,1+2+4+8)
write pass block(56,48,1+2+4+8)
write pass block(56,51,1+2+4+8)
write pass block(62,52,1+2+4+8)
write pass block(63,52,1+2+4+8)
write pass block(64,52,1+2+4+8)
write pass block(73,45,1+2+4+8)
set npc position(whichone,0,0)
if(npcx(25)==0,and,npcx(26)==0,and,npcx(27)==0,and,npcx(28)==0) then(set tag(148,1))
)
if(whichone==27) then(
tb(3822)
tb(3827)
palout(2)
set npc position(whichone,0,0)
if(npcx(25)==0,and,npcx(26)==0,and,npcx(27)==0,and,npcx(28)==0) then(set tag(148,1))
wait(1)
palin(2)
)
if(whichone==28) then(
tb(3822)
tb(3828)
palout(2)
set npc position(whichone,0,0)
if(npcx(25)==0,and,npcx(26)==0,and,npcx(27)==0,and,npcx(28)==0) then(set tag(148,1))
wait(1)
palin(2)
)
resume npcs
resume player
end
###

####################
script, gruff, begin
suspend player
suspend npcs
suspend obstruction

hero clothes
variable(dir)

#after init, have yet to visit school
if(check tag(150),and,check tag(151)==false) then(
jig npc(33)
tb(2722)
)

#init conversation
if(check tag(150)==false) then(
	stop song
	jig npc(33)
	tb(2716)
	if(herox(0)==npcx(33),and,heroy(0)<<npcy(33)) then(
		pup
		set variable(dir,up))
	if(herox(0)==npcx(33),and,heroy(0)>>npcy(33)) then(
		pdown
		set variable(dir,down))
	if(herox(0)>>npcx(33),and,heroy(0)==npcy(33)) then(
		pright
		set variable(dir,right))
	if(herox(0)<<npcx(33),and,heroy(0)==npcy(33)) then(
		pleft
		set variable(dir,left))
	jig hero(0)
	tb(2717)
	jig npc(33)
	tb(2718)
	tb(2719)
	tb(2720)
	jig npc(33)
	tb(2721)

	#already visited school
	if(check tag(151)) then(
		jig hero(0)
		tb(2723))
	else(
		if(dir==up) then(ppup)
		if(dir==down) then(ppdown)
		if(dir==right) then(ppright)
		if(dir==left) then(ppleft)

		if(check tag(3)) then(play song(76))
		if(check tag(4)) then(play song(76))
		if(check tag(5)) then(play song(76))
		if(check tag(6)) then(play song(4))
	)
)

set tag(150,1)

#ask if school was okay or horrible
if(check tag(151),and,check tag(152)==false) then(
	if(npcx(1)<<5) then(
		if(herox(0)==npcx(33),and,heroy(0)<<npcy(33)) then(
			pup
			set variable(dir,up))
		if(herox(0)==npcx(33),and,heroy(0)>>npcy(33)) then(
			pdown
			set variable(dir,down))
		if(herox(0)>>npcx(33),and,heroy(0)==npcy(33)) then(
			pright
			set variable(dir,right))
		if(herox(0)<<npcx(33),and,heroy(0)==npcy(33)) then(
			pleft
			set variable(dir,left))
	)
	jig npc(33)
	tb(2737)
)

#choose it was okay--wrong answer!
if(check tag(151),and,check tag(152)==false) then(
	jig hero(0)
	tb(2738)
	jig npc(33)
	tb(2739)
)

#after init, help him get his school back?
if(check tag(151),and,check tag(152),and,check tag(155),and,check tag(154)==false) then(
	if(herox(0)==npcx(33),and,heroy(0)<<npcy(33)) then(
		pup
		set variable(dir,up))
	if(herox(0)==npcx(33),and,heroy(0)>>npcy(33)) then(
		pdown
		set variable(dir,down))
	if(herox(0)>>npcx(33),and,heroy(0)==npcy(33)) then(
		pright
		set variable(dir,right))
	if(herox(0)<<npcx(33),and,heroy(0)==npcy(33)) then(
		pleft
		set variable(dir,left))
	jig npc(33)
	stop song
	tb(2746)
)

#init, help him get his school back?
if(check tag(151),and,check tag(152),and,check tag(155)==false) then(
	jig hero(0)
	tb(2740)
	jig npc(33)
	tb(2741)
	jig npc(2)
	tb(2742)
	jig npc(33)
	tb(2743)
	jig npc(1)
	tb(2744)
	jig npc(33)
	tb(2745)
	jig npc(33)
	stop song
	tb(2746)
	set tag(155,1)
)

#don't help him
if(check tag(152),and,check tag(153)==false) then(
jig hero(0)
tb(2749)
jig npc(33)
tb(2750)
	if(dir==up) then(ppup)
	if(dir==down) then(ppdown)
	if(dir==right) then(ppright)
	if(dir==left) then(ppleft)

	if(check tag(3)) then(play song(76))
	if(check tag(4)) then(play song(76))
	if(check tag(5)) then(play song(76))
	if(check tag(6)) then(play song(4))
)

#chose to help him
if(check tag(153),and,check tag(154)) then(
	jig npc(33)
	tb(2748)
)

#choose to help him
if(check tag(152),and,check tag(153),and,check tag(154)==false) then(
	jig hero(0)
	tb(2747)
	jig npc(33)
	tb(2748)
	if(dir==up) then(ppup)
	if(dir==down) then(ppdown)
	if(dir==right) then(ppright)
	if(dir==left) then(ppleft)
	if(check tag(4)) then(
		palout(2)
		set tag(154,1)
		wait(1)
		palin(2)
	)
	set tag(154,1)
	if(check tag(3)) then(play song(76))
	if(check tag(4)) then(play song(76))
	if(check tag(5)) then(play song(76))
	if(check tag(6)) then(play song(4))
)

#if party is out, move them in
if(npcx(1)>>5) then(
	if(dir==up) then(ppup)
	if(dir==down) then(ppdown)
	if(dir==right) then(ppright)
	if(dir==left) then(ppleft)
)

resume obstruction
resume npcs
resume player
end
###

#########################
script, plugschool, begin
suspend player

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

if(check tag(151)) then(
jig npc(33)
tb(2736)
)

if(check tag(151)==false) then(
set tag(151,1)
set npc direction(33,down)
jig npc(33)
play song(84)
tb(2724)
focus camera(33,39,2)
set hero speed(0,4)
walk hero to y(0,41)
wait for hero(0)
walk hero to x(0,33)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
suspend npcs
suspend obstruction
pdown
resume obstruction
resume npcs
wait for camera
jig hero(0)
tb(2725)
jig npc(33)
tb(2726)
jig hero(0)
tb(2727)
wait(4)
jig npc(33)
tb(2728)
tb(2729)
wait(10)
jig npc(1)
tb(2730)
jig npc(33)
set npc direction(33,left)
tb(2731)
tb(2732)
wait(2)
jig npc(1)
tb(2733)
jig hero(0)
tb(2734)
wait(3)
set npc direction(33,left)
stop song
wait(8)
jig npc(33)
tb(2735)
suspend npcs
suspend obstruction
focus camera(herox(0),heroy(0),2)
ppdown
wait for camera
camera follows hero(0)
set hero speed(0,hspeed)

if(check tag(3)) then(play song(76))
if(check tag(4)) then(play song(76))
if(check tag(5)) then(play song(76))
if(check tag(6)) then(play song(4))

resume obstruction
resume npcs
)

resume player
end
###

#####################
script, gruff2, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

set tag(8,1)

jig npc(34)
stop song
tb(2751)
set hero speed(0,4)

focus camera(53,50,2)
set npc direction(34,right)
walk hero to x(0,53)
wait for hero(0)
walk hero to y(0,50)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,right,1)
walk npc(3,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(2)
walk npc(2,down,1)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for camera
jig hero(0)
tb(2752)
jig npc(34)
tb(2753)
jig npc(2)
play song(84)
tb(2754)
wait(4)
jig npc(34)
tb(2755)
jig hero(0)
tb(2756)
jig npc(34)
set npc direction(34,down)
tb(2757)
walk npc(34,down,3)
wait(7)

palout(3)
camera follows hero(0)
teleport to map(49+poff,31,42)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,31,46)
set npc position(34,31,46)
alter npc(34,NPCstat:movespeed,4)
set hero direction(0,up)
wait(1)
palin(3)

wait(5)
walk npc(34,up,1)
wait for npc(34)
walk npc(34,up,2)
walk hero(0,up,2)
wait for npc(34)
walk npc(34,right,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(34)
set npc frame(34,0)
set npc direction(34,up)
alter npc(34,NPCstat:movespeed,2)
pdown

jig npc(34)
tb(2758)
wait(2)
set npc direction(33,down)
wait(2)
set npc direction(npc at spot(24,37),down)
set npc direction(npc at spot(26,37),down)
set npc direction(npc at spot(28,37),down)
set npc direction(npc at spot(30,37),down)
set npc direction(npc at spot(24,39),down)
set npc direction(npc at spot(26,39),down)
set npc direction(npc at spot(28,39),down)
set npc direction(npc at spot(30,39),down)
set npc direction(npc at spot(24,41),down)
set npc direction(npc at spot(26,41),down)
set npc direction(npc at spot(28,41),down)
set npc direction(npc at spot(30,41),down)
wait(5)
focus camera(32,44,2)
walk npc(33,down,2)
wait for npc(33)
walk npc(33,left,1)
wait for npc(33)
set npc frame(33,0)
set npc direction(33,down)
wait for camera
jig npc(33)
play song(91)
tb(2759)
wait(10)
jig npc(34)
tb(2760)
jig npc(33)
tb(2761)
wait(3)
alter npc(33,NPCstat:picture,357)
wait(3)
set npc frame(33,1)
wait(3)
set npc direction(33,up)
set npc frame(33,0)
wait(3)
set npc frame(33,1)
wait(8)
tb(2762)
wait(5)
jig npc(34)
tb(2763)
wait(12)
tb(2764)
wait(3)
set npc frame(33,0)
wait(3)
set npc direction(33,down)
set npc frame(33,1)
wait(3)
set npc frame(33,0)
wait(12)
alter npc(33,NPCstat:picture,275)
jig npc(33)
tb(2765)
wait(5)
jig npc(34)
tb(2766)
jig npc(33)
tb(2767)
jig npc(34)
tb(2768)
tb(2769)
wait(3)
jig npc(33)
show text box(2770)
wait(4)
set npc direction(33,left)
wait for text box
wait(15)
jig npc(33)
tb(2771)
set npc direction(33,down)
jig npc(33)
tb(2772)
alter npc(33,NPCstat:movespeed,5)
walk npc(33,left,1)
wait for npc(33)
walk npc(33,down,1)
wait for npc(33)
walk npc(33,left,1)
wait for npc(33)
walk npc(33,down,3)
set npc direction(34,left)
wait(2)
set hero direction(0,left)
set npc direction(1,left)
wait(2)
set npc direction(2,left)
wait for npc(33)
walk npc(33,right,1)
set npc direction(34,down)
set hero direction(0,down)
set npc direction(1,down)
set npc direction(2,down)
set npc direction(3,down)
wait for npc(33)
walk npc(33,down,1)
wait for npc(33)
set npc position(33,0,0)
wait(15)
set npc direction(2,left)
wait(3)
set npc direction(2,up)
jig npc(2)
show text box(2773)
wait(2)
set hero direction(0,right)
wait(2)
set hero direction(0,up)
set npc direction(1,right)
set npc direction(3,right)
wait(2)
set npc direction(1,up)
set npc direction(3,up)
wait for text box
jig npc(3)
tb(2774)
jig npc(34)
tb(2775)
tb(2800)
jig npc(3)
tb(2776)
walk npc(34,left,1)
wait for npc(34)
set npc direction(34,down)
set npc frame(34,0)
jig npc(34)
tb(2777)
tb(2778)
jig npc(2)
tb(2779)
jig npc(34)
tb(2780)
wait(3)
tb(2781)
wait(3)
jig npc(34)
tb(2782)
wait(2)
jadeup(2,1)
wait(2)

palout(3)
camera follows hero(0)
teleport to map(41,4,168)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
alter npc(28,NPCstat:picture,354)
set npc position(28,4,165)
put npc(28,4*20,(165*20)+8)
set npc position(33,4,169)
set npc direction(33,up)
wait(15)
palin(3)

wait(5)
jig npc(28)
tb(2783)
wait(20)
jig npc(28)
tb(2784)
wait(5)
set npc direction(33,right)
wait(5)
jig npc(33)
tb(2785)
play song(59)
alter npc(28,NPCstat:movespeed,10)
alter npc(28,NPCstat:picture,104)
walk npc(28,down,1)
wait for npc(28)
set npc frame(28,0)
tb(2786)
jig npc(33)
tb(2787)
jig npc(28)
tb(2788)
set npc direction(33,down)
wait(2)
walk npc(33,down,3)
show text box(2789)
wait for npc(33)
set npc position(33,0,0)
wait for text box
alter npc(28,NPCstat:movespeed,2)
alter npc(28,NPCstat:picture,358)
tb(2790)
wait(15)
alter npc(28,NPCstat:picture,104)
jig npc(28)
tb(2791)
tb(2792)
walk npc(28,right,1)
wait for npc(28)
set npc frame(28,0)
wait(7)
alter npc(28,NPCstat:picture,358)
tb(2793)
wait(5)
tb(2794)
tb(2795)
wait(15)
alter npc(28,NPCstat:picture,104)
jig npc(28)
tb(2796)
wait(4)
alter npc(28,NPCstat:picture,355)
walk npc(28,left,1)
show text box(2797)
wait for npc(28)
set npc frame(28,0)
alter npc(28,NPCstat:picture,358)
wait for text box
tb(2798)
wait(10)
alter npc(28,NPCstat:picture,355)
tb(2799)

palout(3)
set party in
set hero speed(0,hspeed)
camera follows hero(0)
teleport to map(53+poff,50,53)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
set tag(156,1)
wait(1)
palin(3)

set hero position(0,50,52)
walk hero(0,down,1)
wait for hero(0)
camera follows hero(0)

set tag(8,0)

save game

play song(76)

resume obstruction
resume npcs
resume player
end
###

#######################
script, keeltalk, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

set hero speed(0,4)

jig npc(30)
tb(2801)

focus camera(3,96,2)
walk hero to y(0,96)
wait for hero(0)
walk hero to x(0,3)
wait for hero(0)
set npc direction(30,down)
set hero frame(0,0)
set hero direction(0,up)
wait for camera
pdown
jig npc(30)
tb(2802)
tb(2803)
jig npc(1)
tb(2804)
jig npc(30)
tb(2805)
jig npc(3)
tb(2806)
jig npc(30)
tb(2807)
jig npc(2)
tb(2808)
jig npc(30)
tb(2809)
jig hero(0)
tb(233)

ppdown

walk npc(30,left,1)
wait for npc(30)
set npc frame(30,0)
wait(3)
set npc direction(30,down)
wait(3)
set tag(157,1)

set hero speed(0,hspeed)

camera follows hero(0)

resume obstruction
resume npcs
resume player
end
###

###################
script, jack, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

if(check tag(167)) then(
alter npc(29,NPCstat:script,121)
use npc(29)
)

if(check tag(167)==false) then(
set tag(167,1)
set hero speed(0,4)

if(heroy(0)<<npcy(29)) then(
walk hero(0,right,1)
wait for hero(0)
walk hero(0,down,1)
set npc direction(29,right)
wait for hero(0))
if(herox(0)>>npcx(29)) then(
walk hero(0,down,1)
wait for hero(0)
walk hero(0,left,1)
set npc direction(29,down)
wait for hero(0))

set hero frame(0,0)
set hero direction(0,up)

pdown

jig npc(29)
tb(2810)
jig hero(0)
tb(2811)
jig npc(29)
tb(2812)
jig hero(0)
tb(2813)
wait(2)
set npc direction(29,left)
wait(5)
jig npc(29)
tb(2814)
jig npc(3)
tb(2815)
wait(7)
jig npc(29)
tb(2816)
wait(5)
jig npc(2)
tb(2817)
set npc direction(29,down)
jig npc(29)
tb(2818)
stop song
wait(15)
set npc direction(29,left)
wait(4)
set npc direction(29,down)
wait(4)
set npc direction(29,left)
wait(4)
set npc direction(29,down)
wait(8)
jig npc(29)
play song(84)
tb(2819)
set npc direction(29,left)

set tag(169,1)
write pass block(16,99,1+2+4+8)
set hero speed(0,hspeed)
alter npc(29,NPCstat:script,121)
focus camera(20,96,2)
ppdown
wait for camera
set variable(isrunning,false)
)

set hero speed(0,hspeed)

resume obstruction
resume npcs
resume player
end
###

####################
script, jack2, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

if(herox(0)>>21,and,check tag(164)==false,and,check tag(166)==false) then(
jig npc(29)
tb(2820)
set npc direction(29,left)
)
if(herox(0)>>21,and,check tag(164)==false,and,check tag(166)) then(
jig npc(29)
tb(3833)
	if(check tag(165)) then(
	play song(84)
	set tag(169,1)
	set tag(166,0)
	set tag(158,0)
	set tag(159,0)
	set tag(160,0)
	set tag(161,0)
	write pass block(16,99,1+2+4+8)
	set npc direction(29,left)
	focus camera(20,96,2)
	wait for camera
	set variable(isrunning,false)
	jig npc(29)
	tb(2820)
	set npc direction(29,left)
	)
)
if(herox(0)==17,and,heroy(0)==95,and,check tag(164)==false) then(
jig npc(29)
tb(2822)
tb(2825)
set hero direction(0,right)
jig hero(0)
	if(check tag(165)) then(
	tb(3834)
	jig npc(29)
	stop song
	tb(3832)
	focus camera(herox(0),heroy(0),2)
	set tag(166,1)
	set tag(169,0)
	alter npc(29,NPCstat:display text,3832)
	alter npc(29,NPCstat:script,0)
	write pass block(16,99,0)
	wait for camera
	camera follows hero(0)
	set tag(139,0)
	set variable(isrunning,true)
	create npc(27,herox(0)--1,heroy(0))
	create npc(27,herox(0)+1,heroy(0))
	create npc(27,herox(0),heroy(0)--1)
	create npc(27,herox(0),heroy(0)+1)
	if(check tag(3)) then(play song(76))
	if(check tag(4)) then(play song(76))
	if(check tag(5)) then(play song(76))
	if(check tag(6)) then(play song(4))
	)
	else(
	tb(3835)
	set tag(158,1)
		if((check tag(159)==false,or,check tag(160)==false,or,check tag(161)==false)) then(
		jig npc(29)
		tb(2832)
		)
	)
)
if(herox(0)==18,and,heroy(0)==95,and,check tag(164)==false) then(
jig npc(29)
tb(2821)
tb(2825)
set hero direction(0,right)
jig hero(0)
	if(check tag(165)) then(
	tb(3834)
	jig npc(29)
	stop song
	tb(3832)
	focus camera(herox(0),heroy(0),2)
	set tag(166,1)
	set tag(169,0)
	alter npc(29,NPCstat:display text,3832)
	alter npc(29,NPCstat:script,0)
	write pass block(16,99,0)
	wait for camera
	camera follows hero(0)
	set tag(139,0)
	set variable(isrunning,true)
	create npc(27,herox(0)--1,heroy(0))
	create npc(27,herox(0)+1,heroy(0))
	create npc(27,herox(0),heroy(0)--1)
	create npc(27,herox(0),heroy(0)+1)
	if(check tag(3)) then(play song(76))
	if(check tag(4)) then(play song(76))
	if(check tag(5)) then(play song(76))
	if(check tag(6)) then(play song(4))
	)
	else(
	tb(3835)
	set tag(159,1)
		if((check tag(158)==false,or,check tag(160)==false,or,check tag(161)==false)) then(
		jig npc(29)
		tb(2832)
		)
	)
)
if(herox(0)==19,and,heroy(0)==95,and,check tag(164)==false) then(
jig npc(29)
tb(2823)
tb(2825)
set hero direction(0,right)
jig hero(0)
	if(check tag(165)) then(
	tb(3834)
	jig npc(29)
	stop song
	tb(3832)
	focus camera(herox(0),heroy(0),2)
	set tag(166,1)
	set tag(169,0)
	alter npc(29,NPCstat:display text,3832)
	alter npc(29,NPCstat:script,0)
	write pass block(16,99,0)
	wait for camera
	camera follows hero(0)
	set tag(139,0)
	set variable(isrunning,true)
	create npc(27,herox(0)--1,heroy(0))
	create npc(27,herox(0)+1,heroy(0))
	create npc(27,herox(0),heroy(0)--1)
	create npc(27,herox(0),heroy(0)+1)
	if(check tag(3)) then(play song(76))
	if(check tag(4)) then(play song(76))
	if(check tag(5)) then(play song(76))
	if(check tag(6)) then(play song(4))
	)
	else(
	tb(3835)
	set tag(160,1)
		if((check tag(158)==false,or,check tag(159)==false,or,check tag(161)==false)) then(
		jig npc(29)
		tb(2832)
		)
)
)
if(herox(0)==20,and,heroy(0)==95,and,check tag(164)==false) then(
jig npc(29)
tb(2824)
tb(2825)
set hero direction(0,right)
jig hero(0)
	if(check tag(165)) then(
	tb(3834)
	jig npc(29)
	stop song
	tb(3832)
	focus camera(herox(0),heroy(0),2)
	set tag(166,1)
	set tag(169,0)
	alter npc(29,NPCstat:display text,3832)
	alter npc(29,NPCstat:script,0)
	write pass block(16,99,0)
	wait for camera
	camera follows hero(0)
	set tag(139,0)
	set variable(isrunning,true)
	create npc(27,herox(0)--1,heroy(0))
	create npc(27,herox(0)+1,heroy(0))
	create npc(27,herox(0),heroy(0)--1)
	create npc(27,herox(0),heroy(0)+1)
	if(check tag(3)) then(play song(76))
	if(check tag(4)) then(play song(76))
	if(check tag(5)) then(play song(76))
	if(check tag(6)) then(play song(4))
	)
	else(
	tb(3835)
	set tag(161,1)
		if((check tag(158)==false,or,check tag(159)==false,or,check tag(160)==false)) then(
		jig npc(29)
		tb(2832)
		)
	)
)
if(check tag(158),and,check tag(159),and,check tag(160),and,check tag(161),and,check tag(164)==false) then(
jig npc(29)
tb(2833)

#turn painting NPCs off
set tag(169,0)

set hero speed(0,4)

walk hero to y(0,96)
wait for hero(0)
walk hero to x(0,19)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)

pleft

jig npc(2)
stop song
tb(2834)
jig npc(3)
tb(2835)
wait(5)
jig npc(29)
tb(2836)
wait(2)
jig npc(1)
play song(69)
tb(2837)
tb(2838)
wait(15)
tb(2839)
wait(10)
jig hero(0)
tb(2840)
wait(2)
if(check tag(174)) then(alter npc(1,NPCstat:picture,390))
else(alter npc(1,NPCstat:picture,340))
set npc direction(1,up)
wait(4)
set npc direction(1,left)
jig npc(1)
show text box(2841)
wait(3)
set hero direction(0,up)
if(check tag(174)) then(set hero picture(0,374))
else(set hero picture(0,331))
wait(2)
set npc direction(2,up)
wait(2)
set npc direction(3,up)
wait for text box
walk hero(0,right,1)
wait for hero(0)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
jig hero(0)
tb(2842)
jig npc(1)
tb(2843)
jig hero(0)
show text box(2844)
wait(3)
if(check tag(174)) then(alter npc(1,NPCstat:picture,389))
else(alter npc(1,NPCstat:picture,83))
set npc direction(1,up)
wait for text box
variable(i)
for(i,1,6,1) do(
set npc frame(1,1)
wait(1)
set npc frame(1,0)
wait(1)
)
show text box(2845)
for(i,1,3,1) do(
set npc frame(1,1)
wait(2)
set npc frame(1,0)
wait(2)
)
wait for text box
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
wait(8)
jig hero(0)
tb(2846)
jig npc(1)
tb(2847)
set hero direction(0,down)
wait(2)
set hero direction(0,left)
jig hero(0)
tb(2848)
wait(15)
tb(2849)
wait(5)
jig hero(0)
tb(2850)
if(check tag(174)) then(alter npc(1,NPCstat:picture,233))
else(alter npc(1,NPCstat:picture,232))
set npc direction(1,right)
wait(6)
jig npc(1)
tb(2851)
jig npc(3)
tb(2852)
set npc direction(1,down)
jig npc(1)
tb(2853)
wait(15)
tb(2854)
wait(4)
set npc direction(2,right)
jig npc(2)
show text box(2855)
wait(2)
if(check tag(174)) then(alter npc(1,NPCstat:picture,382))
else(alter npc(1,NPCstat:picture,333))
wait for text box
jig npc(1)
tb(2856)
wait(5)
jig npc(29)
show text box(2857)
wait(2)
set hero direction(0,down)
set npc direction(1,right)
wait(2)
set hero direction(0,right)
set npc direction(3,right)
wait for text box
wait(4)
jig npc(2)
tb(2858)
jig npc(29)
stop song
tb(2859)
write pass block(16,99,0)
set tag(164,1)
)

if(check tag(163),and,check tag(164)) then(
set hero speed(0,4)
if(npcx(1)<<5) then(
	if(heroy(0)<<npcy(29)) then(
	walk hero(0,right,1)
	wait for hero(0)
	walk hero(0,down,1)
	set npc direction(29,right)
	wait for hero(0))
	if(herox(0)>>npcx(29)) then(
	walk hero(0,down,1)
	wait for hero(0)
	walk hero(0,left,1)
	set npc direction(29,down)
	wait for hero(0))
	set hero frame(0,0)
	set hero direction(0,up)
	pdown
)
jig npc(29)
stop song
tb(2864)
)


if(check tag(162)==false,and,check tag(164)) then(
set tag(163,1)
jig hero(0)
tb(2862)
jig npc(29)
tb(2863)

if(herox(0)==20) then(
	walk hero(0,down,1)
	wait for hero(0)
	walk hero(0,left,1)
	wait for hero(0)
	focus camera(herox(0),heroy(0),2)
	set hero frame(0,0)
	if(check tag(174)) then(set hero picture(0,230))
	else(set hero picture(0,229))
	set hero speed(0,hspeed)
	set hero direction(0,down)
	ppleft
	if(check tag(174)) then(alter npc(1,NPCstat:picture,233))
	else(alter npc(1,NPCstat:picture,232))
	wait for camera
	camera follows hero(0)
)
if(herox(0)==22,or,herox(0)==23) then(
ppdown
)
if(isrunning==false) then(
set tag(139,0)
set variable(isrunning,true)
create npc(27,herox(0)--1,heroy(0))
create npc(27,herox(0)+1,heroy(0))
create npc(27,herox(0),heroy(0)--1)
create npc(27,herox(0),heroy(0)+1)
)
if(check tag(3)) then(play song(76))
if(check tag(4)) then(play song(76))
if(check tag(5)) then(play song(76))
if(check tag(6)) then(play song(4))
)

if(check tag(162),and,check tag(164)) then(
jig hero(0)
tb(2860)
jig npc(29)
suspend box advance
show text box(2861)
wait for key(use key)
palout(8)
wait(1)
advance text box
resume box advance
if(check tag(174)) then(alter npc(1,NPCstat:picture,233))
else(alter npc(1,NPCstat:picture,232))
if(check tag(174)) then(set hero picture(0,230))
else(set hero picture(0,229))
set hero position(0,19,96)
set npc position(1,18,95)
set npc position(2,17,96)
set npc position(3,18,97)
set npc position(29,22,96)
set hero direction(0,right)
set npc direction(1,right)
set npc direction(2,right)
set npc direction(3,right)
set npc direction(29,left)

wait(15)
palin(8)

wait(5)
jig npc(29)
tb(2865)
walk npc(29,down,2)
wait for npc(29)
walk npc(29,left,3)
wait for npc(29)
walk npc(29,left,3)
set hero direction(0,down)
set npc direction(1,down)
wait(2)
set npc direction(2,down)
set npc direction(3,down)
wait for npc(29)
walk npc(29,down,1)
wait for npc(29)
set npc position(29,0,0)
set npc frame(29,0)
wait(8)
jig npc(2)
tb(2866)
set hero direction(0,left)
jig hero(0)
show text box(2867)
wait(3)
set npc direction(2,right)
wait for text box
wait(2)
set npc direction(3,right)
wait(2)
set npc direction(3,up)
jig npc(3)
tb(2868)
set hero direction(0,down)
jig hero(0)
tb(2869)
wait(5)
jig npc(3)
tb(2870)
jig npc(1)
show text box(2871)
wait(4)
set npc direction(1,right)
set hero direction(0,right)
wait(2)
set hero direction(0,up)
set npc direction(2,up)
wait for text box
show text box(2872)
wait(2)
set hero direction(0,left)
set npc direction(1,down)
set npc direction(2,down)
set npc direction(3,left)
wait(3)
set hero direction(0,down)
set npc direction(3,down)
wait(3)
set npc direction(29,up)
set npc position(29,16,99)
walk npc(29,up,1)
wait for npc(29)
set npc frame(29,0)
wait for text box
set npc position(31,16,99)
walk npc(29,right,1)
walk npc(31,up,1)
wait for npc(29)
set npc frame(29,0)
set npc direction(29,down)
wait for npc(31)
set npc frame(31,0)
set npc direction(31,right)
set npc direction(29,left)
jig npc(31)
tb(2873)
set npc direction(29,down)
wait(2)
walk npc(29,right,5)
walk npc(31,right,5)
wait(8)
set hero direction(0,right)
set npc direction(1,right)
set npc direction(2,right)
set npc direction(3,right)
wait for npc(31)
walk npc(29,up,1)
walk npc(31,right,1)
wait for npc(31)
walk npc(29,up,1)
walk npc(31,up,1)
wait for npc(29)
set npc frame(29,0)
set npc direction(29,left)
wait for npc(31)
set npc frame(31,0)
wait(3)
set npc direction(29,down)
jig npc(29)
tb(2874)
alter npc(29,NPCstat:movespeed,2)
alter npc(31,NPCstat:movespeed,2)
walk npc(29,up,1)
wait for npc(29)
set npc frame(29,0)
set npc direction(29,left)
wait(3)
set npc direction(29,down)
wait(2)
jig npc(29)
show text box(2875)
wait(2)
walk npc(31,up,1)
wait for npc(31)
set npc frame(31,0)
set npc direction(31,left)
play song(91)
wait for text box
wait(20)
tb(2876)
jig npc(29)
tb(2877)
wait(10)
set npc frame(31,1)
wait(5)
set npc frame(31,0)
tb(2878)
jig npc(29)
tb(2879)
wait(8)
jig npc(31)
tb(2880)
wait(15)
jig npc(31)
tb(2881)
wait(10)
jig npc(29)
tb(2882)
wait(6)
set npc direction(31,up)
wait(3)
jig npc(31)
tb(2883)
jig npc(29)
tb(2884)
jig npc(31)
tb(2885)
jig npc(29)
tb(2886)
wait(10)
set npc direction(31,left)
wait(10)
tb(2887)
jig npc(31)
tb(2888)
alter npc(31,NPCstat:picture,361)
wait(4)
alter npc(31,NPCstat:picture,360)
wait(4)
tb(2889)
wait(4)
jig npc(29)
tb(2890)
wait(4)
alter npc(31,NPCstat:picture,361)
wait(8)
set npc direction(31,up)
jig npc(31)
tb(2891)
wait(2)
set npc direction(31,left)
wait(10)
jig npc(31)
stop song
tb(2892)
alter npc(29,NPCstat:movespeed,10)
alter npc(31,NPCstat:movespeed,10)
walk npc(31,down,2)
wait for npc(31)
walk npc(31,left,6)
show text box(2893)
wait(2)
set hero direction(0,down)
set npc direction(1,down)
wait(2)
set npc direction(2,down)
set npc direction(3,down)
wait for npc(31)
walk npc(29,down,3)
walk npc(31,down,1)
wait for npc(31)
set npc position(31,0,0)
wait for npc(29)
walk npc(29,left,6)
wait for npc(29)
walk npc(29,down,1)
wait for npc(29)
set npc position(29,0,0)
wait for text box
wait(15)
jig npc(2)
tb(2894)
wait(3)
jig npc(3)
tb(2895)
jig npc(1)
tb(2896)
set hero direction(0,left)
jig hero(0)
tb(2897)

focus camera(18,96,2)
walk hero(0,left,1)
walk npc(1,down,1)
walk npc(2,right,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for npc(3)
set npc position(3,0,0)
set party in
wait for camera
camera follows hero(0)
set tag(168,1)

if(isrunning==false) then(
set tag(139,0)
set variable(isrunning,true)
create npc(27,herox(0)--1,heroy(0))
create npc(27,herox(0)+1,heroy(0))
create npc(27,herox(0),heroy(0)--1)
create npc(27,herox(0),heroy(0)+1)
)

wait(2)
jadeup(2,1)
wait(2)

set hero speed(0,hspeed)
save game

if(check tag(3)) then(play song(76))
if(check tag(4)) then(play song(76))
if(check tag(5)) then(play song(76))
if(check tag(6)) then(play song(4))
)

set hero speed(0,hspeed)

resume obstruction
resume npcs
resume player
end
###

########################
script, leukocyte, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

set hero speed(0,4)

jig npc(30)
stop song
tb(2898)
play song(61)

focus camera(7,95,2)
walk hero to y(0,96)
wait for hero(0)
walk hero to x(0,7)
set npc direction(29,down)
set npc direction(30,down)
wait for hero(0)
set hero direction(0,up)
set hero frame(0,0)
pdown
wait for camera

variable(evil)
set variable(evil,true)

set tag(170,0)

jig npc(29)
tb(2899)
jig npc(30)
tb(2900)
jig npc(29)
tb(2901)
jig npc(30)
tb(2902)

if(check tag(170)) then(
stop song
jig hero(0)
tb(2903)
jig npc(29)
tb(2904)
palout(2)
camera follows hero(0)
set hero position(0,3,99)
set hero direction(0,up)
set npc position(1,0,1)
set npc position(2,1,1)
set npc position(3,2,1)
set party in
wait(6)
palin(2)

if(check tag(3)) then(play song(77))
if(check tag(4)) then(play song(77))
if(check tag(5)) then(play song(77))
if(check tag(6)) then(play song(4))

set variable(evil,false)
)

if(evil==true) then(
jig hero(0)
tb(2905)
jig npc(29)
tb(2906)
jig npc(30)
tb(2907)
jig npc(29)
tb(2908)
jig npc(30)
tb(2909)

if(check tag(170)) then(
jig hero(0)
tb(2910)
jig npc(29)
tb(2911)
palout(2)
camera follows hero(0)
set hero position(0,11,93)
set hero direction(0,up)
set npc position(1,0,1)
set npc position(2,1,1)
set npc position(3,2,1)
set party in
wait(6)
palin(2)
set variable(evil,false)
)

if(evil==true) then(
jig hero(0)
tb(2912)
jig npc(29)
tb(2913)
jig npc(30)
tb(2914)
jig npc(29)
tb(2915)
jig npc(30)
tb(2916)

if(check tag(170)) then(
jig hero(0)
tb(2917)
jig npc(29)
tb(2918)
palout(2)
camera follows hero(0)
set hero position(0,3,92)
set hero direction(0,down)
set npc position(1,0,1)
set npc position(2,1,1)
set npc position(3,2,1)
set party in
wait(6)
palin(2)
set variable(evil,false)
)

if(evil==true) then(
jig hero(0)
tb(2919)
jig npc(29)
tb(2920)
jig npc(30)
tb(2921)
jig npc(29)
tb(2922)
jig npc(30)
tb(2923)

if(check tag(170)) then(
jig hero(0)
tb(2924)
jig npc(29)
tb(2925)
palout(2)
camera follows hero(0)
set hero position(0,11,97)
set hero direction(0,down)
set npc position(1,0,1)
set npc position(2,1,1)
set npc position(3,2,1)
set party in
wait(6)
palin(2)
set variable(evil,false)
)

if(evil==true) then(
jig hero(0)
tb(2926)
jig npc(29)
play song(15)
tb(2927)
jig npc(30)
tb(2928)
jig npc(29)
tb(2929)
jig npc(30)
tb(2930)
jig npc(29)
tb(2931)
jig npc(30)
tb(2932)

battleflash
ff(290+poff)
stop song

alter npc(29,NPCstat:movespeed,10)
alter npc(30,NPCstat:movespeed,10)

walk npc(29,down,1)
walk npc(30,down,1)
wait for npc(30)
walk npc(29,left,1)
walk npc(30,right,1)
wait for npc(30)
walk npc(29,down,2)
walk npc(30,down,2)
set hero direction(0,left)
set npc direction(1,right)
set npc direction(2,right)
set npc direction(3,left)
wait for npc(30)
walk npc(29,right,1)
walk npc(30,left,1)
set hero direction(0,down)
set npc direction(1,down)
set npc direction(2,down)
set npc direction(3,down)
wait for npc(30)
walk npc(29,down,2)
walk npc(30,down,2)
wait for npc(29)
set npc position(29,0,0)
wait for npc(30)
set npc position(30,0,0)

jig npc(2)
play song(82)
tb(2933)
jig npc(3)
tb(2934)
set npc direction(1,left)
jig npc(1)
tb(2935)
set npc direction(3,right)
jig npc(3)
tb(2936)
wait(2)
set npc direction(2,left)
wait(2)
set npc direction(2,up)
jig npc(2)
tb(2937)
jig hero(0)
tb(2938)
if(check tag(174)) then(alter npc(2,NPCstat:picture,389))
else(alter npc(2,NPCstat:picture,330))
set npc direction(2,right)
variable(i)
for(i,1,6,1) do(
set npc frame(2,1)
wait(1)
set npc frame(2,0)
wait(1)
)
show text box(2939)
for(i,1,3,1) do(
set npc frame(2,1)
wait(2)
set npc frame(2,0)
wait(2)
)
wait for text box
jig hero(0)
tb(2940)
if(check tag(174)) then(alter npc(2,NPCstat:picture,235))
else(alter npc(2,NPCstat:picture,234))
set npc direction(2,up)

focus camera(herox(0),heroy(0),2)
ppdown
wait for camera
camera follows hero(0)
set tag(171,1)
set hero speed(0,hspeed)
wait(2)
jadeup(2,1)
wait(2)
save game
))))

set hero speed(0,hspeed)

resume obstruction
resume npcs
resume player
end
###

##########################
script, katinafight, begin
suspend player
suspend npcs
suspend obstruction

katinafightD
katinafightDD

resume obstruction
resume npcs
resume player
end
###
###########################
script, katinafightD, begin
if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))

stop song

set hero direction(0,left)
wait(2)
walk hero(0,down,1)
wait for hero(0)

pdown
set npc direction(1,left)
set npc direction(3,right)

jig npc(2)
tb(2941)
end
###
############################
script, katinafightDD, begin
if(check tag(173)==false) then(
jig hero(0)
tb(2943)
ppdown
if(check tag(3)) then(play song(77))
if(check tag(4)) then(play song(77))
if(check tag(5)) then(play song(77))
if(check tag(6)) then(play song(4))
)
else(
katinafightA
katinafightAA
katinafightAAA
katinafightAAAA
katinafightB
katinafightBB
katinafightC
katinafightCC
)
end
###
###########################
script, katinafightA, begin
play song(88)
jig hero(0)
tb(2942)

ppdown

set hero direction(0,right)
wait(2)
pan camera(south,0,0)
walk hero(0,up,2)
wait for hero(0)
palout(5)
camera follows hero(0)
set hero position(0,4,171)
wait(1)
pan camera(south,0,0)
set hero position(0,4,172)
alter npc(28,NPCstat:picture,354)
set npc position(28,4,165)
put npc(28,4*20,(165*20)+8)
set hero speed(0,4)
pan camera(up,3,2)
walk hero(0,up,3)
wait(1)
palin(5)

wait for hero(0)
set hero frame(0,0)
pdown
wait for camera

wait(10)
jig hero(0)
tb(2944)
set hero speed(0,2)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(2945)
wait(2)
alter npc(28,NPCstat:picture,104)
#put npc(28,4*20,(166*20)--4)
#set npc frame(28,0)
#wait(2)
#put npc(28,4*20,(166*20))
#set npc frame(28,1)
#wait(2)
put npc(28,4*20,(166*20)--8)
set npc frame(28,0)
wait(2)
put npc(28,4*20,(166*20)--4)
set npc frame(28,1)
wait(2)
put npc(28,4*20,(166*20))
set npc frame(28,0)
wait(2)
jig npc(28)
tb(2946)
jig hero(0)
tb(2947)
jig npc(28)
tb(2948)
end
###
############################
script, katinafightAA, begin
if(check tag(149)==false,and,check tag(156)==false,and,check tag(168)==false,and,check tag(171)==false) then(
play song(15)
jig npc(28)
tb(2949)
stop song
battle flash(1)
ff(294+poff)
stop song
)
end
###
#############################
script, katinafightAAA, begin
if(check tag(149)) then(
jig hero(0)
tb(2950)
)
if(check tag(156)) then(
jig hero(0)
tb(2951)
)
if(check tag(168)) then(
jig hero(0)
tb(2952)
)
if(check tag(171)) then(
jig hero(0)
tb(2953)
)
end
###
##############################
script, katinafightAAAA, begin
if(check tag(149),or,check tag(156),or,check tag(168),or,check tag(171)) then(
alter npc(28,NPCstat:picture,362)
jig npc(28)
play song(8)
tb(2954)
wait(15)
alter npc(28,NPCstat:picture,104)
jig npc(28)
tb(2955)
jig npc(28)
play song(15)
tb(2956)
stop song
battle flash(1)
ff(298+poff)
stop song
)
end
###
###########################
script, katinafightB, begin
if(check tag(174)) then(set hero picture(0,374))
else(set hero picture(0,331))
alter npc(28,NPCstat:picture,363)
wait(5)
pan camera(up,2,2)
wait(5)
set npc direction(28,up)
wait(4)
jig npc(28)
wait(4)
jig npc(28)
wait for camera
#play song(91)
tb(2957)
set hero speed(0,2)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
wait(6)
jig hero(0)
play song(87)
tb(2958)
set npc direction(28,left)
jig npc(28)
jig npc(28)
tb(2959)
wait(2)
set hero direction(0,right)
wait(2)
jig hero(0)
tb(2960)
wait(2)
set npc direction(28,up)
wait(10)
jig npc(28)
wait(5)
set npc direction(28,right)
wait(2)
set npc frame(28,1)
wait(4)
tb(2961)
jig hero(0)
tb(2962)
jig npc(28)
jig npc(28)
set npc frame(28,1)
tb(2963)
wait(5)
set npc direction(28,up)
wait(3)
set npc frame(28,0)
wait(3)
set npc direction(28,left)
wait(3)
tb(2964)
wait(12)
set npc direction(28,up)
wait(4)
set npc direction(28,down)
wait(3)
alter npc(28,NPCstat:picture,104)
jig npc(28)
stop song
tb(2965)
wait(8)
set hero direction(0,up)
wait(14)
jig npc(28)
tb(2966)
tb(2967)
wait(3)
alter npc(28,NPCstat:picture,358)
tb(2968)
jig hero(0)
tb(2969)
alter npc(28,NPCstat:picture,355)
jig npc(28)
play song(59)
tb(2970)
jig npc(28)
tb(2971)
tb(2972)
wait(2)
set hero direction(0,right)
wait(2)
end
###
############################
script, katinafightBB, begin
alter npc(1,NPCstat:movespeed,2)
alter npc(2,NPCstat:movespeed,2)
alter npc(3,NPCstat:movespeed,2)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,down,1)
walk npc(2,down,2)
wait(2)
set npc direction(1,left)
set npc direction(3,right)
wait for hero(0)
walk hero(0,down,3)
walk npc(1,left,1)
wait for npc(1)
walk npc(3,right,1)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,down,2)
walk npc(3,down,3)
wait for npc(3)
wait(10)

alter npc(28,NPCstat:picture,363)
wait(3)
set npc direction(28,up)
wait(10)
tb(2973)
#stop song
wait(4)
set npc direction(28,left)
wait(4)
jig npc(28)
jig npc(28)
jig npc(28)
set npc direction(28,right)
jig npc(28)
jig npc(28)
set npc frame(28,1)
tb(2974)

palout(8)
camera follows hero(0)
teleport to map(45+poff,70,46)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,61,49)
if(check tag(174)) then(
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236))
wait(1)
palin(8)

wait(20)
jig npc(6)
tb(2975)
jig npc(7)
tb(2976)
wait(20)
set npc direction(7,left)
wait(5)
jig npc(7)
tb(2977)
set npc direction(6,left)

set hero speed(0,4)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,right,1)
wait for hero(0)
walk npc(1,right,1)
walk hero(0,right,1)
wait for hero(0)
walk npc(2,right,1)
walk npc(1,right,1)
walk hero(0,right,1)
wait for hero(0)
walk npc(3,right,9)
walk npc(2,right,9)
walk npc(1,right,9)
walk hero(0,right,9)
wait(5)
set npc direction(7,down)
set npc direction(6,down)
wait for hero(0)
set hero frame(0,0)
walk npc(1,up,1)
walk npc(2,right,1)
walk npc(3,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(3)
set npc frame(3,0)
walk npc(2,down,1)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
set npc direction(6,right)
play song(17)
wait(12)
end
###
###########################
script, katinafightC, begin
jig npc(6)
tb(2978)
wait(3)
walk npc(1,right,2)
wait for npc(1)
set npc frame(1,0)
wait(4)
jig npc(1)
jig npc(1)
wait(4)
jig npc(1)
wait(5)
jig npc(1)
wait(3)
set npc direction(1,down)
wait(3)
walk npc(1,left,2)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait(10)
jig npc(6)
tb(2979)
wait(5)
set hero direction(0,down)
wait(2)
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
wait(12)
variable(i)
variable(cx)
variable(cy)
set variable(cx,camera pixel x)
set variable(cy,camera pixel y)
if(check tag(174)) then(set hero picture(0,373))
else(set hero picture(0,332))
set hero speed(0,10)
walk hero(0,right,2)
wait for hero(0)
tweak palette(63,63,63)
update palette
if(check tag(174)) then(set hero picture(0,230))
else(set hero picture(0,229))
wait(2)
reset palette
update palette
for(i,1,7,1) do(
put camera(cx+random(-2,2),cy+random(-2,2))
wait(1)
)
put camera(cx,cy)
set hero speed(0,2)
walk hero(0,left,1)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,left)
wait(2)
set hero direction(0,up)
wait(2)
set hero direction(0,right)
wait for hero(0)
set hero frame(0,0)
jig npc(6)
tb(2980)
set hero speed(0,4)
wait(5)
jig npc(3)
set hero direction(0,down)
set npc direction(1,left)
set npc direction(2,up)
wait(2)
set hero direction(0,left)
set npc direction(2,left)
wait(8)
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
wait(4)
alter npc(3,NPCstat:movespeed,2)
set npc direction(3,down)
wait(3)
walk npc(3,left,1)
wait for npc(3)
set npc frame(3,0)
wait(2)
set npc direction(3,down)
wait(2)
set npc direction(3,right)
wait(12)
alter npc(3,NPCstat:movespeed,10)
walk npc(3,right,2)
wait for npc(3)
walk npc(3,right,2)
set hero direction(0,up)
set npc direction(1,down)
set npc direction(2,up)
wait for npc(3)
stop song
tweak palette(63,63,63)
update palette
fade screen out(63,63,63)
wait(1)
set tag(172,1)
if(check tag(174)) then(alter npc(3,NPCstat:picture,391))
else(alter npc(3,NPCstat:picture,200))
alter npc(3,NPCstat:movespeed,4)
set hero direction(0,right)
set npc direction(1,right)
set npc direction(2,right)
set npc direction(6,up)
alter npc(6,NPCstat:whenactivated,NPCwhenactivated:donotfaceplayer)
alter npc(6,NPCstat:displaytext,7277)
wait(6)
reset palette
fade screen in
wait(3)
if(check tag(174)) then(alter npc(3,NPCstat:picture,236))
else(alter npc(3,NPCstat:picture,138))
wait(15)
tb(2981)
end
###
############################
script, katinafightCC, begin
wait(3)
focus camera(73,49,2)
wait(3)
set npc direction(1,down)
wait(2)
set npc direction(2,up)
set npc direction(3,down)
wait(2)
set hero direction(0,up)
set npc direction(3,left)
wait for camera

wait(6)
jig hero(0)
play song(69)
tb(2982)
tb(2983)
jig hero(0)
tb(2984)
jig npc(1)
tb(2985)
jig npc(2)
tb(2986)
if(check tag(174)) then(alter npc(1,NPCstat:picture,381))
else(alter npc(1,NPCstat:picture,334))
jig npc(1)
tb(2987)
wait(4)
jig hero(0)
tb(2988)
if(check tag(174)) then(alter npc(1,NPCstat:picture,233))
else(alter npc(1,NPCstat:picture,232))
wait(2)
jig npc(3)
show text box(2989)
wait(2)
set npc direction(2,right)
set npc direction(1,right)
set hero direction(0,right)
wait for text box
jig npc(2)
tb(2990)
jig npc(3)
tb(2991)
jig npc(2)
tb(2992)
wait(4)
jig npc(3)
tb(2993)
if(check tag(174)) then(set hero picture(0,378)
set hero frame(0,1))
else(set hero picture(0,344))
wait(4)
stop song
show text box(2994)
wait(2)
set npc direction(1,down)
wait for text box
jig npc(1)
tb(2995)
if(check tag(174)) then(set hero picture(0,373)
set hero frame(0,0))
else(set hero picture(0,332))
jig hero(0)
tb(2996)
jig npc(1)
tb(2997)
wait(7)
set hero direction(0,up)
if(check tag(174)) then(set hero picture(0,230))
else(set hero picture(0,229))
wait(4)
jig hero(0)
play song(69)
tb(2998)
walk hero(0,up,1)
walk npc(3,left,1)
walk npc(2,up,1)
walk npc(1,right,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(3)
set npc position(3,2,1)
wait for npc(1)
walk npc(2,right,1)
walk npc(1,down,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(1)
set npc position(1,0,1)
set party in
set hero speed(0,hspeed)
camera follows hero(0)
#cyport lockdown over, can go to fralin
set tag(296,1)
#andd!!
#clear all core scene sub quests!
#stapler
if(check tag(149)==false) then(
set tag(553,1)
set tag(149,1)
)
#gruff
set tag(156,1)
#jack
set tag(168,1)
#leukocyte
set tag(171,1)
set tag(8,0)
save game
end
###
############################
script, cyportrezload, begin
#variable(hatred)
#variable(annoyance)
#variable(rage)
#set variable(hatred,create npc(4))
#set variable(annoyance,create npc(4))
#set variable(rage,create npc(4))
#put npc(hatred,1*20,(97*20)+2)
#put npc(annoyance,5*20,(98*20)+2)
#put npc(rage,21*20,(96*20)+2)

if(check tag(430)) then(
write map block(3,36,read map block(48,15))
write map block(3,37,read map block(48,16))
)

if(check tag(486),and,currentmap<>51) then(
alter npc(18,NPCstat:picture,515)
alter npc(18,NPCstat:movespeed,1)
)

if(check tag(4),and,check tag(156)==false) then(
#alter npc(,NPCstat:movespeed,4)  #FIXME: the NPC id is missing!
#alter npc(,NPCstat:movespeed,4)  #FIXME: the NPC id is missing!
)

if(check tag(156),and,check tag(6)==false) then(
set npc position(34,33,39)
set npc direction(34,left)
)

#classroom kids activate
if(check tag(156)==false) then(
alter npc(24,NPCstat:movespeed,4)
alter npc(25,NPCstat:movespeed,4)
)
end
###

#########################
script, cyclothes1, begin
suspend player
#afterward have
if(check tag(174)) then(
jig npc(npc at spot(2,112))
tb(6428)
)

#completed tasks
if(check tag(174)==false,and,check tag(149),and,check tag(177),and,check tag(178),and,check tag(179),and,check tag(180)) then(
walk npc(6,right,1)
wait for npc(6)
walk npc(6,down,3)
wait for npc(6)
walk npc(6,left,4)
wait for npc(6)
set npc frame(6,0)
set npc direction(6,up)
wait(3)
set hero direction(0,left)
wait(3)
set hero direction(0,down)
wait(3)
jig npc(6)
tb(6424)
tb(6425)
palout(2)
set npc position(6,5,112)
set npc direction(6,left)
wait(5)
show backdrop(0)
wait(1)
palin(2)
play song(69)
tb(6429)
palout(2)
show map
set hero picture(find hero(0),230,outside battle)
set hero picture(find hero(0),8,inside battle)
set hero picture(find hero(1),233,outside battle)
set hero picture(find hero(1),18,inside battle)
set hero picture(find hero(2),235,outside battle)
set hero picture(find hero(2),21,inside battle)
set hero picture(find hero(3),236,outside battle)
set hero picture(find hero(3),24,inside battle)
set tag(174,1)
wait(5)
palin(10)
)

#afterward do not have
if(check tag(174)==false,and,check tag(175)) then(
set variable(text1,500)
if(check tag(149)) then(
set variable(text1,text1--100))
if(check tag(177)) then(
set variable(text1,text1--100))
if(check tag(178),and,check tag(179),and,check tag(180)) then(
set variable(text1,text1--200))
jig npc(npc at spot(2,112))
tb(6427)
if(check tag(176)) then(
if(pay money(text1)) then(
	jig npc(npc at spot(2,112))
	tb(7293)
	palout(2)
	wait(5)
	show backdrop(0)
	wait(1)
	palin(2)
	play song(69)
	tb(6429)
	palout(2)
	show map
	set hero picture(find hero(0),230,outside battle)
	set hero picture(find hero(0),8,inside battle)
	set hero picture(find hero(1),233,outside battle)
	set hero picture(find hero(1),18,inside battle)
	set hero picture(find hero(2),235,outside battle)
	set hero picture(find hero(2),21,inside battle)
	set hero picture(find hero(3),236,outside battle)
	set hero picture(find hero(3),24,inside battle)
	wait(5)
	palin(10)
	wait(4)
	set hero direction(0,right)
	wait(4)
	set hero direction(0,down)
	set tag(174,1)
)
else(
jig npc(npc at spot(2,112))
tb(7292)
)
)
)

#initial
if(check tag(174)==false,and,check tag(175)==false) then(
jig npc(npc at spot(2,112))
tb(6380)
jig hero(0)
tb(6381)
jig npc(npc at spot(2,112))
tb(6385)
palout(2)
wait(30)
show backdrop(0)
wait(1)
palin(2)
tb(6386)
tb(6387)
wait(5)
tb(6388)
wait(5)
tb(6392)
#check if have enough money
if(check tag(176)) then(
	#chose to pay
	if(pay money(500))then(
		wait(3)
		tb(6393)
		play song(69)
		tb(6429)
		palout(2)
		show map
		set hero picture(find hero(0),230,outside battle)
		set hero picture(find hero(0),8,inside battle)
		set hero picture(find hero(1),233,outside battle)
		set hero picture(find hero(1),18,inside battle)
		set hero picture(find hero(2),235,outside battle)
		set hero picture(find hero(2),21,inside battle)
		set hero picture(find hero(3),236,outside battle)
		set hero picture(find hero(3),24,inside battle)
		wait(5)
		palin(10)
		wait(4)
		set hero direction(0,right)
		wait(4)
		set hero direction(0,down)
		set tag(174,1)
	)
	#not enough
	else(
		tb(6394)
		wait(5)
		tb(6395)
		palout(1)
		show map
		wait(1)
		walk npc(6,right,1)
		wait for npc(6)
		walk npc(6,down,2)
		palin(2)
		wait for npc(6)
		walk npc(6,left,3)
		wait for npc(6)
		set npc frame(6,0)
		set hero direction(0,right)
		wait(4)
		jig npc(6)
		tb(6396)
		jig hero(0)
		tb(6397)
		wait(5)
		jig npc(6)
		tb(6401)
		wait(4)
		if(check tag(149)==false) then(tb(6402))
		tb(6403)
		wait(6)
		jig npc(6)
		tb(6404)
		if(check tag(181)) then(
			jig hero(0)
			tb(6410)
			jig npc(6)
			tb(6414)
			tb(6415)
			wait(3)
			tb(6416)
			get item(15,3)
			jig npc(6)
			tb(6417)
		)
		else(
			jig hero(0)
			tb(6405)
			jig npc(6)
			tb(6409)
			walk npc(6,right,2)
			wait for npc(6)
			walk npc(6,up,2)
			wait for npc(6)
			set npc frame(6,0)
			set npc direction(6,left)
		)
		set tag(175,1)
	)
)
#chose not to pay
else(
	tb(6395)
	palout(1)
	show map
	wait(1)
	walk npc(6,right,1)
	wait for npc(6)
	walk npc(6,down,2)
	palin(2)
	wait for npc(6)
	walk npc(6,left,3)
	wait for npc(6)
	set npc frame(6,0)
	set hero direction(0,right)
	wait(4)
	jig npc(6)
	tb(6396)
	jig hero(0)
	tb(6397)
	wait(5)
	jig npc(6)
	tb(6401)
	wait(4)
	if(check tag(149)==false) then(tb(6402))
	tb(6403)
	wait(6)
	jig npc(6)
	tb(6404)
	if(check tag(181)) then(
		jig hero(0)
		tb(6410)
		jig npc(6)
		tb(6414)
		tb(6415)
		wait(3)
		tb(6416)
		get item(15,3)
		jig npc(6)
		tb(6417)
	)
	else(
		jig hero(0)
		tb(6405)
		jig npc(6)
		tb(6409)
		walk npc(6,right,2)
		wait for npc(6)
		walk npc(6,up,2)
		wait for npc(6)
		set npc frame(6,0)
		set npc direction(6,left)
	)
	set tag(175,1)
)
)
resume player
end
###
#########################
script, cyclothes2, begin
suspend player
#initial / have clothes before 3 tasks complete
if(check tag(174),or,(check tag(175)==false,and,check tag(181)==false)) then(
	#tasks completed
	if(check tag(182)) then(
		jig npc(6)
		tb(6426)
	)
	#before tasks
	if(check tag(182)==false) then(
		jig npc(6)
		tb(6418)
		tb(6420)
	)
)

#completed tasks
if(check tag(174)==false,and,check tag(149),and,check tag(177),and,check tag(178),and,check tag(179),and,check tag(180)) then(
	jig npc(6)
	tb(6424)
	tb(6425)
	palout(2)
	set npc position(6,5,112)
	set npc direction(6,left)
	wait(5)
	show backdrop(0)
	wait(1)
	palin(2)
	play song(69)
	tb(6429)
	palout(2)
	show map
	set hero picture(find hero(0),230,outside battle)
	set hero picture(find hero(0),8,inside battle)
	set hero picture(find hero(1),233,outside battle)
	set hero picture(find hero(1),18,inside battle)
	set hero picture(find hero(2),235,outside battle)
	set hero picture(find hero(2),21,inside battle)
	set hero picture(find hero(3),236,outside battle)
	set hero picture(find hero(3),24,inside battle)
	set hero position(0,2,114)
	set hero direction(0,up)
	wait(5)
	palin(10)
	wait(4)
	set hero direction(0,right)
	wait(4)
	set hero direction(0,down)
	set tag(174,1)
	set tag(182,1)
)

#do not pay--salesman accepted
if(check tag(174)==false,and,check tag(181)) then(
	jig npc(6)
	tb(6418)
	tb(6420)
	if(inventory(15)>>0) then(tb(6422))
	else(tb(6423))
)

#do not pay--ask salesman
if(check tag(174)==false,and,check tag(181)==false,and,check tag(175)) then(
jig npc(6)
tb(6401)
wait(5)
jig npc(6)
tb(6404)
if(check tag(181)) then(
jig hero(0)
tb(6410)
jig npc(6)
tb(6414)
tb(6415)
wait(3)
tb(6416)
get item(15,3)
jig npc(6)
tb(6417)
)
else(
jig hero(0)
tb(6405)
jig npc(6)
tb(6409)
wait(2)
set npc direction(6,down)
wait(3)
set npc direction(6,left)
)
)
resume player
end
###

######################
script, snowout, xxx, begin
suspend npc walls
variable(i)

if(xxx==0) then(set variable(xxx,3))

variable(time)
set variable(time,3)

#first wave
variable(j)
variable(k)
variable(l)
#second wave
variable(m)
variable(n)
variable(o)
#third wave
variable(p)
variable(q)
variable(r)

#initialize rotation
set variable(j,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(j,right,4)
walk npc(j,down,4)
wait(time)
set variable(k,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(k,right,4)
walk npc(k,down,4)
wait(time)
set variable(l,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(l,right,4)
walk npc(l,down,4)
wait(time)
set variable(m,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(m,right,4)
walk npc(m,down,4)
wait(time)
set variable(n,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(n,right,4)
walk npc(n,down,4)
wait(time)
set variable(o,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(o,right,4)
walk npc(o,down,4)
wait(time)
set variable(p,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(p,right,4)
walk npc(p,down,4)
wait(time)
set variable(q,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(q,right,4)
walk npc(q,down,4)
wait(time)
set variable(r,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(r,right,4)
walk npc(r,down,4)
wait(time)

#loop
for(i,1,xxx,1) do(
destroy npc(j)
set variable(j,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(j,right,4)
walk npc(j,down,4)
wait(time)
destroy npc(k)
set variable(k,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(k,right,4)
walk npc(k,down,4)
wait(time)
destroy npc(l)
set variable(l,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(l,right,4)
walk npc(l,down,4)
wait(time)
destroy npc(m)
set variable(m,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(m,right,4)
walk npc(m,down,4)
wait(time)
destroy npc(n)
set variable(n,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(n,right,4)
walk npc(n,down,4)
wait(time)
destroy npc(o)
set variable(o,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(o,right,4)
walk npc(o,down,4)
wait(time)
destroy npc(p)
set variable(p,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(p,right,4)
walk npc(p,down,4)
wait(time)
destroy npc(q)
set variable(q,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(q,right,4)
walk npc(q,down,4)
wait(time)
destroy npc(r)
set variable(r,create npc(4, (camera pixel x/20)+random(0,16), (camera pixel y/20)+random(0,10)))
walk npc(r,right,4)
walk npc(r,down,4)
wait(time)
)
destroy npc(j)
wait(time)
destroy npc(k)
wait(time)
destroy npc(l)
wait(time)
destroy npc(m)
wait(time)
destroy npc(n)
wait(time)
destroy npc(o)
wait(time)
destroy npc(p)
wait(time)
destroy npc(q)
wait(time)
destroy npc(r)

resume npc walls
end
###

##############################################
script, clothescheck, xcor, ycor, ycor2, begin
suspend npcs
suspend obstruction

if(check tag(174),and,(heroy(0)>>55,or,check tag(183))) then( clothescheck1(xcor,ycor) )

#Have clothes
if(check tag(174),and,check tag(183)==false,and,heroy(0)<<55) then( clothescheck2 )

#Do not have clothes
if(check tag(174)==false) then( clothescheck3(xcor,ycor,ycor2) )

end
###

########################################
script, clothescheck1, xcor, ycor, begin
pan camera(south,0,0)
walk hero(0,right,7)
wait(7)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(58+poff,xcor,ycor)
wait(1)
pan camera(south,0,0)
set hero position(0,xcor--9,ycor)
wait(1)
palin(2)
snowout(1)
walk hero(0,right,9)
wait for hero(0)
camera follows hero(0)
end
###

########################################
script, clothescheck2, begin
pan camera(south,0,0)
walk hero(0,right,7)
wait(7)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(58+poff,13,74)
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
wait(1)
palin(2)
play song(17)
focus camera(23,74,2)
snowout
wait for camera
set hero position(0,23--9,74)
set hero speed(0,4)
set party out
swap by position(find hero(0),0)
set hero picture(0,373)
walk hero(0,right,7)
wait for hero(0)
set hero frame(0,0)

set npc position(1,herox(0),heroy(0))
walk npc(1,right,3)
wait for npc(1)
set npc frame(1,0)
set npc position(2,npcx(1),npcy(1))
set npc position(3,npcx(1),npcy(1))
walk npc(2,up,1)
walk npc(3,down,1)
set npc direction(1,down)
wait for npc(2)
set npc direction(1,left)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)

jig npc(1)
tb(3002)
wait(7)
set hero frame(0,1)
wait(4)
set hero frame(0,0)
tb(3003)
jig npc(1)
tb(3004)
wait(20)
jig npc(1)
tb(3005)
wait(7)
set hero picture(0,379)
wait(4)
jig hero(0)
stop song
tb(3006)
jig npc(2)
tb(3007)
wait(2)
set hero picture(0,373)
wait(2)
set hero direction(0,up)
wait(4)
set hero direction(0,left)
wait(4)
jig hero(0)
tb(3008)
wait(4)
set hero picture(0,378)
wait(2)
set hero frame(0,1)
tb(3009)
wait(7)
set hero frame(0,0)
tb(3010)
tb(3011)
set hero picture(0,373)
wait(3)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
wait(3)
jig hero(0)
tb(3012)
jig npc(1)
play song(82)
show text box(3013)
wait(3)
set hero picture(0,374)
wait for text box
jig hero(0)
tb(3014)
jig npc(1)
tb(3015)
wait(2)
set hero direction(0,down)
set hero picture(0,375)
set hero frame(0,1)
wait(3)
set hero picture(0,377)
tb(3016)
wait(3)
alter npc(1,NPCstat:picture,383)
set npc direction(1,down)
wait(3)
alter npc(1,NPCstat:picture,387)
jig npc(1)
tb(3017)
wait(25)
set hero picture(0,378)
set hero frame(0,0)
wait(4)
set hero picture(0,379)
wait(10)
jig npc(2)
tb(3018)
tb(3019)
alter npc(2,NPCstat:movespeed,2)
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
jig npc(2)
tb(3020)
wait(5)
jig npc(3)
tb(3021)
tb(3022)
alter npc(3,NPCstat:movespeed,2)
walk npc(3,left,1)
wait for npc(3)
set npc frame(3,0)
tb(3023)
jig npc(1)
show text box(3024)
wait(3)
set hero picture(0,378)
wait(4)
set hero picture(0,380)
wait for text box
wait(3)
alter npc(1,NPCstat:picture,390)
set npc direction(1,up)
wait(4)
set npc direction(1,right)
tb(3025)
tb(3026)
wait(5)
set npc direction(1,left)
jig npc(1)
tb(3027)
wait(2)
set hero picture(0,373)
set hero direction(0,right)
wait(4)
set hero frame(0,1)
wait(4)
set hero frame(0,0)
tb(6435)
jig npc(1)
tb(3028)
wait(2)
set npc direction(1,up)
wait(3)
alter npc(1,NPCstat:picture,383)
set npc direction(1,down)
set npc frame(1,1)
wait(3)
alter npc(1,NPCstat:picture,382)
set npc direction(1,left)
set npc frame(1,0)
jig npc(1)
tb(3029)

alter npc(1,NPCstat:movespeed,4)
alter npc(2,NPCstat:movespeed,4)
alter npc(3,NPCstat:movespeed,4)

walk hero(0,right,1)
wait for hero(0)
walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
alter npc(1,NPCstat:picture,233)
set hero picture(0,230)
set party in
set tag(183,1)
set hero speed(0,hspeed)
camera follows hero(0)
end
###

###############################################
script, clothescheck3, xcor, ycor, ycor2, begin
pan camera(south,0,0)
walk hero(0,right,7)
wait(7)
palout(2)
wait for hero(0)
camera follows hero(0)
teleport to map(58+poff,xcor,ycor)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,xcor--9,ycor)
wait(1)
palin(2)
play song(17)
snowout
walk hero(0,right,9)
wait for hero(0)
if(heroy(0)<<80) then(walk hero to y(0,74))
else(walk hero to y(0,88))
wait for hero(0)
set party out
swap by position(find hero(0),0)
alter npc(1,NPCstat:picture,232)
alter npc(2,NPCstat:picture,234)
alter npc(3,NPCstat:picture,138)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,left,1)
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)
wait(2)
set hero direction(0,right)
set npc direction(1,left)
set npc direction(2,down)
set npc direction(3,up)

jig npc(1)
tb(2999)
jig npc(2)
tb(3000)
jig hero(0)
tb(3001)

walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for npc(3)
set npc position(3,0,0)
set hero speed(0,hspeed)
set party in

if(heroy(0)<<80) then(
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,ycor2)
wait(1)
pan camera(south,0,0)
set hero position(0,79,ycor2)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0))
else(
pan camera(south,0,0)
walk hero(0,left,7)
wait(7)
palout(3)
wait for hero(0)
camera follows hero(0)
teleport to map(45+poff,74,ycor2)
wait(1)
pan camera(south,0,0)
set hero position(0,79,ycor2)
wait(1)
walk hero(0,left,5)
palin(3)
wait for hero(0)
camera follows hero(0)
)
end
###

###########################
script, prebigscene1, begin
suspend player
suspend npcs
suspend obstruction

stop song
tb(3030)

set hero speed(0,4)

if(heroy(0)<<72) then(walk hero to y(0,70))
else(walk hero to y(0,75))
wait for hero(0)
set hero frame(0,0)
pan camera(south,0,0)

set party out
swap by position(find hero(0),0)

set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,left,1)
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)
wait(2)
set npc direction(2,down)
set npc direction(3,up)

jig npc(2)
play song(85)
tb(3031)
jig npc(3)
tb(3032)
wait(14)
jig npc(3)
tb(3033)
jig hero(0)
tb(3034)
wait(4)
jig npc(3)
tb(3035)
jig hero(0)
tb(3036)
jig npc(3)
tb(3037)
jig npc(2)
tb(3038)
wait(4)
jig npc(3)
tb(3039)
set hero direction(0,right)
jig hero(0)
show text box(3040)
wait(3)
set npc direction(1,left)
wait for text box
jig npc(2)
tb(3041)
alter npc(2,NPCstat:picture,392)
wait(7)
set npc direction(2,right)
wait(2)
jig npc(2)
tb(3042)
wait(10)
set npc frame(1,1)
wait(4)
set npc frame(1,0)
tb(3043)
jig npc(2)
alter npc(2,NPCstat:picture,235)
set npc direction(2,down)
jig npc(2)
show text box(3044)
wait(3)
alter npc(1,NPCstat:picture,381)
wait for text box
jig npc(1)
tb(3045)

walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)

alter npc(1,NPCstat:picture,233)
set hero speed(0,hspeed)
set party in
camera follows hero(0)

play song(17)

resume obstruction
resume npcs
resume player
end
###

###########################
script, prebigscene2, begin
suspend player
suspend npcs
suspend obstruction

stop song

set hero speed(0,4)
if(herox(0)<<100) then(walk hero to x(0,96))
else(walk hero to x(0,112))
wait for hero(0)
set hero frame(0,0)
pan camera(south,0,0)
set party out
swap by position(find hero(0),0)

set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,left,1)
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)
wait(2)
set hero direction(0,right)
set npc direction(1,left)
set npc direction(2,down)
set npc direction(3,up)

jig hero(0)
play song(85)
tb(3046)
jig npc(2)
tb(3047)
jig npc(3)
tb(3048)
wait(8)
set hero picture(0,377)
wait(6)
set hero picture(0,375)
wait(3)
set hero picture(0,376)
wait(6)
set hero picture(0,230)
jig hero(0)
show text box(3049)
wait(3)
alter npc(1,NPCstat:picture,386)
wait for text box
jig npc(3)
tb(3050)
set npc frame(1,1)
stop song
tb(3051)
set npc direction(2,right)
wait(2)
set npc direction(3,right)
wait(4)
jig npc(2)
tb(3052)
wait(2)
set npc frame(1,0)
wait(2)
jig npc(1)
play song(91)
tb(3053)
jig npc(2)
tb(3054)
jig hero(0)
show text box(3055)
wait(3)
set npc direction(2,down)
set npc direction(3,up)
wait for text box
tb(3056)
tb(3057)
jig hero(0)
tb(3058)
jig npc(1)
tb(3059)

walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set hero direction(0,down)
set party in
alter npc(1,NPCstat:picture,233)
set hero speed(0,hspeed)
camera follows hero(0)

save game

resume obstruction
resume npcs
resume player
end
###

#################################
script, scenefourpointfour, begin
suspend player
suspend npcs
suspend obstruction

stop song

set hero speed(0,10)
focus camera(168,111,20)
walk hero to x(0,162)
wait for hero(0)
walk hero to y(0,110)
wait for hero(0)
set hero speed(0,4)
set hero direction(0,right)
set hero frame(0,0)
pleft
wait for camera

jig npc(2)
tb(3060)
wait(4)
set hero direction(0,down)
wait(3)
set hero direction(0,left)
jig hero(0)
tb(3061)
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
ppleft

set tag(184,1)
set variable(isrunning,false)
set hero speed(0,hspeed)

write pass block(160,108,1+2+4+8)
write pass block(160,109,1+2+4+8)
write pass block(160,110,1+2+4+8)
write pass block(160,111,1+2+4+8)

write pass block(172,106,1+2+4+8)
write pass block(173,106,1+2+4+8)
write pass block(174,106,1+2+4+8)
write pass block(175,106,1+2+4+8)

play song(17)

resume obstruction
resume npcs
resume player
end
###

##########################
script, onceaminion, begin
suspend player
suspend npcs
suspend obstruction

set tag(185,1)

set hero speed(0,4)

set variable(isrunning,false)
palout(1)
camera follows hero(0)
teleport to map(89,4,36)
stop song
wait(2)
load tileset(95+poff)
pan camera(south,0,0)
set hero position(0,0,0)
alter npc(1,NPCstat:palette,29+poff)
alter npc(2,NPCstat:palette,33+poff)
alter npc(3,NPCstat:palette,65+poff)
alter npc(4,NPCstat:palette,1+poff)
wait(1)
palin(2)
wait(15)
set hero position(0,5,39)
walk hero(0,up,2)
wait for hero(0)
walk hero(0,right,1)
set npc direction(4,right)
play song(15)
show text box(3062)
wait for hero(0)
walk hero(0,up,1)
wait for hero(0)

set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,left,1)
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,down,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait(2)
set npc direction(1,left)

wait for text box

jig hero(0)
tb(3063)
alter npc(4,NPCstat:picture,393)
walk npc(4,down,1)
wait(2)
show text box(3064)
wait for npc(4)
set npc frame(4,0)
wait for text box
wait(2)
alter npc(4,NPCstat:picture,394)
set npc direction(4,right)
wait(6)
jig npc(4)
jig npc(4)
set npc frame(4,1)
tb(3065)
wait(3)
set npc direction(4,down)
set npc direction(2,down)
jig npc(2)
tb(3066)
wait(5)
jig npc(4)
set npc direction(2,left)
set npc frame(4,1)
set npc direction(4,right)
tb(3067)
jig npc(3)
tb(3068)
play song(15)
walk npc(4,left,1)
wait(2)
show text box(3069)
wait for npc(4)
set npc frame(4,0)
wait for text box
wait(2)
set npc direction(4,right)
wait(5)
jig npc(4)
set npc frame(4,1)
tb(3070)
jig hero(0)
tb(3071)
jig npc(1)
tb(3072)
wait(2)
set npc frame(4,0)
wait(3)
alter npc(4,NPCstat:picture,395)
jig npc(4)
stop song
tb(3073)
wait(2)
alter npc(4,NPCstat:picture,284)
jig npc(4)
tb(3074)
jig hero(0)
tb(3075)
wait(2)
set npc direction(4,down)
wait(4)
set npc direction(4,left)
play song(84)
tb(3076)
walk npc(4,left,1)
wait(3)
show text box(3077)
wait for npc(4)
set npc frame(4,0)
wait for text box
wait(6)
set npc direction(4,down,)
wait(4)
walk npc(4,right,1)
show text box(3078)
wait for npc(4)
set npc frame(4,0)
wait for text box
wait(5)
jig npc(3)
tb(3079)
jig npc(4)
jig npc(4)
tb(3080)
tb(3081)
jig hero(0)
tb(3082)
jig npc(4)
tb(3083)
tb(3084)
jig hero(0)
tb(3085)
jig npc(4)
tb(3086)
tb(3087)
jig npc(4)
tb(6436)
wait(5)
jig npc(4)
tb(3088)
wait(2)
set npc direction(4,down)
wait(4)
set npc direction(4,left)
wait(4)
jig npc(4)
tb(3089)

stop song
palout(6)
show backdrop(0)
wait(10)
palin(1)

tb(3090)
wait(5)
tb(3091)

palout(1)
show map
set hero picture(0,376)
set npc direction(4,right)
load tileset(95+poff)
wait(10)
palin(6)

wait(12)
play song(91)
tb(3092)
set hero picture(0,230)
walk hero(0,up,1)
wait for hero(0)
walk hero(0,left,2)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
set hero picture(0,375)
wait(2)
set npc direction(4,up)
wait(5)
jig npc(4)
tb(3093)
wait(2)
set npc direction(4,right)
wait(4)
jig npc(4)
tb(3094)
wait(15)
set npc direction(4,up)
wait(5)
jig npc(4)
tb(3095)
set hero picture(0,396)
jig hero(0)
tb(3096)
walk hero(0,right,2)
set npc direction(4,right)
jig npc(4)
show text box(3097)
wait for hero(0)
walk hero(0,down,4)
wait for hero(0)
set hero position(0,0,0)
wait for text box

palout(4)
stop song
show backdrop(0)
wait(5)
suspend box advance
show text box(3098)
palin(3)
wait for key(use key)
palout(3)
advance text box
resume box advance
show map
camera follows hero(0)
teleport to map(58+poff,164,112)
wait(1)
pan camera(south,0,0)
set hero position(0,170,112)
set hero speed(0,2)
walk hero(0,right,3)
wait(1)
palin(4)
wait for hero(0)
set hero frame(0,0)
set hero position(0,173,108)

set npc position(1,169,111)
walk npc(1,down,1)
wait for npc(1)
set npc position(2,169,111)
walk npc(1,right,1)
walk npc(2,down,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc position(3,169,111)
walk npc(2,left,1)
walk npc(3,down,1)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait for npc(3)
walk npc(3,down,1)
set npc direction(2,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait(2)
set npc direction(3,up)

jig npc(1)
tb(3099)
wait(4)
set npc direction(1,down)
wait(3)
set npc direction(1,right)
jig npc(1)
stop song
show text box(3100)
wait(3)
set npc direction(3,right)
wait for text box
wait(2)

suspend hero walls
set hero speed(0,4)
walk hero(0,up,4)
focus camera(173,103,5)
wait for hero(0)
set hero speed(0,2)
walk hero(0,up,4)
wait for camera
focus camera(173,99,1)
wait for hero(0)
set hero speed(0,1)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
set hero picture(0,397)
set hero direction(0,up)
wait(20)
set hero direction(0,right)
wait(5)
set hero direction(0,down)
wait(10)
set hero direction(0,left)
wait for camera
resume hero walls

walk npc(1,right,4)
walk npc(2,right,4)
walk npc(3,right,4)
wait for npc(3)
walk npc(1,up,12)
walk npc(2,up,12)
walk npc(3,up,13)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
wait for npc(3)
set npc frame(3,0)

jig npc(2)
tb(3101)
jig npc(3)
tb(3102)
wait(15)
variable(hx)
variable(hy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
variable(j)
for(j,1,5,1) do(
put hero(0,hx+random(-1,1),hy+random(-1,1))
wait(1)
)
put hero(0,hx,hy)
wait(5)
tb(3103)
wait(8)
jig npc(1)
tb(3104)
alter npc(2,NPCstat:movespeed,2)
walk npc(2,up,2)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait(5)
jig npc(2)
tb(3105)
wait(20)
tb(3106)
jig npc(3)
tb(3107)
set npc direction(2,down)
jig npc(2)
tb(3108)
wait(2)
set npc direction(1,left)
wait(2)
jig npc(1)
tb(3109)
wait(3)
set npc direction(3,right)
wait(3)
jig npc(3)
tb(3110)

dreamsequenceprefinal

resume obstruction
resume npcs
resume player
end
###

####################################
script, dreamsequenceprefinal, begin
palout(10)
wait(40)

variable(k)
for(k,103,114,1) do(
set tag(k,0))

set hero speed(0,hspeed)
set hero frame(0,0)
set tag(8,0)
camera follows hero(0)
teleport to map(89,1,3)
stop song
wait(1)
load tileset(95)
alter NPC(35,NPCstat:script argument,95)
set hero picture(find hero(0),198)
set hero palette(find hero(0),1)
set hero direction(0,down)
set hero frame(0,0)
swap out hero(1)
swap out hero(2)
swap out hero(3)
lock hero(1)
lock hero(2)
lock hero(3)
wait(15)

play song(31)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (10)
reset palette
greyscale palette
update palette

wait(30)
fade screen out(63,63,63)
reset palette
wait(1)
fade screen in

wait(15)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)

set variable(isrunning,0)
swap out hero(find hero(1))
lock hero(find hero(1))
swap out hero(find hero(2))
lock hero(find hero(2))
swap out hero(find hero(3))
lock hero(find hero(3))
wait(1)

reset palette
tweak palette (-3,-3,0)
update palette
wait (1)
reset palette
tweak palette (-2,-2,0)
update palette
wait (1)
reset palette
tweak palette (-1,-1,0)
update palette
wait (1)
reset palette
update palette
end
###

########################
script, dodgeball, begin
suspend player
suspend npcs
suspend obstruction

set tag(186,1)
stop song

focus camera(43,17,20)
palout(5)
wait for camera
set hero position(0,43,23)
alter npc(1,NPCstat:movespeed,4)
alter npc(10,NPCstat:movespeed,2)
alter npc(11,NPCstat:movespeed,2)
alter npc(12,NPCstat:movespeed,2)
set npc position(1,43,17)
set npc position(10,42,20)
set npc position(11,44,20)
set npc position(12,43,20)
set npc direction(1,up)
wait(5)
walk npc(10,up,2)
walk npc(11,up,2)
walk npc(12,up,1)
wait(1)
play song(33)
palin(5)
wait for npc(12)
set npc frame(12,0)
wait for npc(10)
set npc frame(10,0)
wait for npc(11)
set npc frame(11,0)

jig npc(10)
tb(3111)
jig npc(11)
tb(3112)
jig npc(10)
tb(3113)
set npc direction(1,right)
wait(3)
set npc direction(1,down)
jig npc(1)
tb(3114)
walk npc(10,up,1)
walk npc(11,up,1)
wait for npc(10)
set npc frame(10,0)
set npc direction(10,right)
wait for npc(11)
set npc frame(11,0)
set npc direction(11,left)
jig npc(11)
tb(3115)
jig npc(10)
tb(3116)
jig npc(11)
tb(3117)
jig npc(10)
tb(3118)
jig npc(11)
tb(3119)
set npc direction(1,right)
jig npc(1)
tb(3120)
jig npc(11)
tb(3121)
jig npc(10)
tb(3122)
jig npc(12)
show text box(3123)
wait(2)
set npc direction(1,down)
wait(3)
set npc direction(10,down)
set npc direction(11,down)
wait for text box

set npc frame(12,0)
jig npc(12)
wait(2)
set npc frame(12,1)
alter npc(8,NPCstat:picture,401)
alter npc(8,NPCstat:palette,9)
alter npc(8,NPCstat:movespeed,10)
set npc position(8,npcx(12),npcy(12))
walk npc(8,up,2)
set npc frame(12,0)
wait for npc(8)

stop song
tweak palette(63,63,63)
update palette
wait(2)
set npc direction(10,up)
set npc direction(11,up)
alter npc(1,NPCstat:picture,402)
walk npc(1,up)
reset palette
alter npc(8,NPCstat:movespeed,4)
walk npc(8,right,1)
walk npc(8,down,1)
wait(1)
update palette

alter npc(10,NPCstat:movespeed,10)
alter npc(11,NPCstat:movespeed,10)
alter npc(12,NPCstat:movespeed,10)
tb(3124)

pan camera(up,10,1)

walk hero(0,up,6)
walk npc(10,right,3)
walk npc(11,right,3)
walk npc(12,right,3)
wait for npc(12)
walk npc(10,right,1)
walk npc(11,up,1)
walk npc(12,right,1)
wait for npc(12)
walk npc(10,right,1)
walk npc(11,right,5)
walk npc(12,up,1)
wait for npc(12)
walk npc(10,up,1)
walk npc(12,up,1)
wait for npc(12)
walk npc(10,right,5)
walk npc(12,up,1)
wait for npc(12)
walk npc(12,right,5)

palout(10)
wait for camera
variable(k)
for(k,103,114,1) do(
set tag(k,0))
set hero speed(0,hspeed)
set tag(8,0)
camera follows hero(0)
teleport to map(89,1,3)
stop song
wait(1)
load tileset(97)
alter NPC(35,NPCstat:script argument,97)
set hero picture(find hero(0),198)
set hero palette(find hero(0),3)
set hero direction(0,down)
set hero frame(0,0)
wait(30)
palin(10)

wait(15)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)

resume obstruction
resume npcs
resume player
end
###

#########################
script, endfourpointfour, begin
suspend player
suspend npcs
suspend obstruction

mastermila

snowfire

resume obstruction
resume npcs
resume player
end
###

#########################
script, mastermila, begin
suspend npc walls

set tag(187,1)
stop song

focus camera(43,17,20)
palout(5)
wait for camera
set hero position(0,43,23)
alter npc(1,NPCstat:picture,402)
alter npc(1,NPCstat:palette,31)
alter npc(1,NPCstat:movespeed,2)
alter npc(6,NPCstat:palette,155)
alter npc(7,NPCstat:palette,155)
alter npc(8,NPCstat:palette,155)
alter npc(6,NPCstat:movespeed,2)
alter npc(7,NPCstat:movespeed,2)
set npc position(6,52,15)
set npc position(7,52,16)
set npc position(1,43,18)
set npc direction(1,down)
wait(5)
play song(33)
palin(5)

wait(20)
set npc direction(1,right)
wait(8)
set npc direction(1,down)
wait(11)
set npc direction(1,right)
wait(9)
set npc direction(1,down)
wait(11)
set npc direction(1,right)
wait(8)
set npc direction(1,left)
wait(4)
set npc direction(1,down)
wait(2)

walk npc(6,left,5)
walk npc(7,left,5)
wait(5)
alter npc(1,NPCstat:picture,101)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
wait for npc(7)
wait(3)
set npc frame(6,0)
set npc frame(7,0)
wait(3)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
set npc frame(6,0)
set npc frame(7,0)
tb(3125)
jig npc(1)
tb(3126)
wait(3)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
set npc frame(6,0)
set npc frame(7,0)
tb(3127)
walk npc(6,down,3)
walk npc(7,down,3)
wait for npc(7)
walk npc(6,left,1)
walk npc(7,left,1)
wait for npc(7)
set npc frame(6,0)
set npc frame(7,0)

variable(nx)
variable(ny)
set variable(nx,npc pixel x(6))
set variable(ny,npc pixel y(6))

set npc direction(6,up)
set npc direction(7,up)
wait(3)
put npc(6,nx,(ny)--2)
put npc(7,nx,(ny+20)--2)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
put npc(6,nx,(ny)--4)
put npc(7,nx,(ny+20)--4)
set npc frame(6,0)
set npc frame(7,0)
wait(4)
set npc position(6,46,17)
set npc position(7,46,18)
set npc position(8,46,19)
alter npc(6,NPCstat:picture,351)
alter npc(7,NPCstat:picture,351)
alter npc(8,NPCstat:picture,351)
set npc direction(6,down)
set npc direction(7,right)
set npc direction(8,up)
jig npc(7)
tb(3128)
walk npc(1,right,1)
wait(2)
show text box(3129)
wait for npc(1)
set npc frame(1,0)
wait for text box
jig npc(7)
tb(3130)
wait(3)
tb(3131)
set npc direction(1,down)
wait(3)
walk npc(1,left,1)
wait for npc(1)
set npc frame(1,0)
wait(4)
jig npc(1)
tb(3132)
wait(7)
jig npc(7)
tb(3133)
set npc direction(1,down)
wait(3)
set npc direction(1,right)
jig npc(1)
tb(3134)
wait(5)
jig npc(7)
tb(3135)
wait(4)
tb(3136)
jig npc(1)
tb(3137)
wait(7)
jig npc(7)
tb(3138)
jig npc(1)
tb(3139)
wait(25)
jig npc(7)
tb(3140)
wait(2)
set npc direction(1,down)
wait(3)
set npc direction(1,left)
wait(6)
jig npc(1)
tb(3141)
wait(5)
jig npc(7)
tb(3142)
wait(2)
set npc direction(1,down)
wait(3)
set npc direction(1,right)
jig npc(1)
tb(3143)
tb(3144)
wait(4)
jig npc(7)
tb(3145)
wait(15)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
wait(10)
jig npc(1)
tb(3146)
jig npc(7)
tb(3147)
wait(25)
tb(3148)
jig npc(7)
tb(3149)
jig npc(1)
tb(3150)
jig npc(7)
tb(3151)
tb(3152)
jig npc(1)
tb(3153)
jig npc(7)
tb(3154)
alter npc(1,NPCstat:movespeed,5)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
tb(3155)
jig npc(7)
tb(3156)
wait(5)
suspend box advance
show text box(3157)
wait for key(use key)

stop song

palout(5)
show backdrop(0)
advance text box
resume box advance
wait(5)
palin(1)

tb(3158)
wait(4)
tb(3159)
wait(12)
tb(3160)
tb(3161)

palout(1)
resume npc walls
show map
camera follows hero(0)
teleport to map(60,9,36)
stop song
wait(1)
pan camera(south,0,0)
put hero(0,7*20,(37*20)+5)
set npc position(1,6,34)
set npc position(2,9,35)
set npc position(3,10,36)
set npc position(5,9,36)
set hero picture(0,406)
set hero direction(0,down)
alter npc(1,NPCstat:picture,403)
alter npc(2,NPCstat:picture,413)
alter npc(3,NPCstat:picture,415)
alter npc(2,NPCstat:movetype,NPCmovetype:rightturns)
alter npc(3,NPCstat:movetype,NPCmovetype:rightturns)
alter npc(7,NPCstat:picture,404)
alter npc(9,NPCstat:picture,405)
alter npc(5,NPCstat:picture,190)
set hero palette(0,4)
alter npc(1,NPCstat:palette,32)
alter npc(7,NPCstat:palette,36)
alter npc(9,NPCstat:palette,68)
alter npc(5,NPCstat:palette,9)
put npc(3,(10*20)+6,(36*20))
put npc(8,(11*20)+6,(36*20))
set npc direction(1,left)
resume npcs
load tileset(106)
wait(40)
play song(17)
palin(20)

end
###

#######################
script, snowfire, begin

wait(120)
jig npc(7)
tb(3162)
wait(5)
jig npc(9)
tb(3163)
wait(4)
set npc direction(1,down)
wait(4)
jig npc(1)
tb(3164)
wait(20)
jig npc(7)
tb(3165)
wait(4)
set npc direction(1,left)
wait(4)
jig npc(1)
tb(3166)
wait(5)
jig npc(9)
tb(3167)
wait(5)
jig npc(7)
tb(3168)
wait(20)
jig npc(1)
tb(3169)
wait(5)
jig npc(7)
tb(3170)
set npc direction(1,left)

wait(80)
set npc direction(1,down)
wait(4)
set npc direction(1,right)
wait(10)
tb(3171)
tb(3172)
wait(2)
set npc direction(7,left)
wait(2)
jig npc(7)
tb(3173)
tb(3174)
wait(4)
set npc direction(1,down)
wait(4)
jig npc(1)
tb(3175)
wait(10)
jig npc(9)
tb(3176)
wait(2)
set npc direction(7,down)
wait(4)
set npc direction(7,right)
wait(18)
jig npc(7)
tb(3177)
jig npc(9)
tb(3178)
wait(4)
set npc direction(7,down)
wait(14)
jig npc(7)
tb(3179)
jig npc(9)
tb(3180)
wait(5)
suspend box advance
stop song
show text box(3181)
wait for key(use key)
palout(15)
show backdrop(0)
advance text box
wait(1)

play song(19)
show text box(3182)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(4051)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3183)
wait(15)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3184)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3185)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3186)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3187)
wait(15)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3188)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3189)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3190)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3191)
wait(15)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3192)
wait(1)
palin(1)
wait for key(use key)
palout(1)
advance text box
show text box(3193)
wait(1)
palin(1)
wait for key(use key)
stop song
palout(1)
advance text box
resume box advance
show map
camera follows npc(5)
set npc position(5,173,99)
alter npc(2,NPCstat:movetype,NPCmovetype:standstill)
alter npc(3,NPCstat:movetype,NPCmovetype:standstill)
wait(1)
put hero (0,(171*20),(100*20)+5)
set npc position(1,149,49)
set npc position(2,173,98)
set npc position(3,174,99)
alter npc(1,NPCstat:picture,407)
set npc direction(1,down)
set npc direction(2,right)
set hero palette(0,3)
alter npc(1,NPCstat:palette,31)
alter npc(2,NPCstat:palette,35)
alter npc(3,NPCstat:palette,67)
alter npc(5,NPCstat:palette,11)
alter npc(2,NPCstat:picture,404)
alter npc(3,NPCstat:picture,405)
set npc direction(2,down)
set npc direction(3,down)
alter npc(5,NPCstat:picture,410)
load tileset(59)
set npc frame(2,1)
set npc frame(3,1)
wait(2)
palin(15)

play song(17)
wait(20)
jig npc(3)
tb(3194)
wait(5)
jig npc(2)
show text box(3195)
wait(3)
set npc direction(2,down)
wait for text box
wait(10)
jig npc(2)
tb(3196)
stop song
wait(4)
set npc direction(2,left)
wait(14)
set npc direction(2,down)
wait(4)
set npc direction(2,right)
wait(14)
set npc direction(2,down)
wait(4)
jig npc(2)
show text box(3197)
wait(3)
alter npc(2,NPCstat:picture,235)
wait for text box
walk npc(2,left,1)
wait for npc(2)
walk npc(2,down,2)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
jig npc(2)
tb(3198)
wait(20)
jig hero(0)
jig hero(0)
set hero frame(0,1)
wait(10)
tb(3199)
jig npc(2)
tb(3200)
wait(3)
set hero position(0,171,100)
set hero direction(0,up)
set hero frame(0,0)
wait(4)
set hero picture(0,374)
set hero direction(0,right)
wait(2)
tb(3201)
walk hero(0,up,1)
wait for hero(0)
walk hero(0,left,2)
wait(2)
jig npc(2)
show text box(3202)
wait for hero(0)
set hero frame(0,0)
wait for text box
jig hero(0)
tb(3203)
wait(2)
set hero picture(0,377)
set hero frame(0,1)
wait(2)
tb(3204)
wait(3)
set hero picture(0,374)
set hero frame(0,0)
wait(3)
walk hero(0,left,5)
wait(2)
show text box(3205)
wait for hero(0)
set hero frame(0,0)
set hero position(0,160,96)
wait for text box
wait(15)
jig npc(3)
tb(3206)
wait(3)
set npc direction(2,down)
wait(3)
set npc direction(2,right)
wait(15)
jig npc(3)
tb(3207)
alter npc(2,NPCstat:movespeed,2)
walk npc(2,up,2)
wait(3)
wait for npc(2)
walk npc(2,right,1)
wait(2)
show text box(3208)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
wait(4)
alter npc(2,NPCstat:picture,404)
wait for text box
wait(10)
jig npc(3)
tb(3209)

set tag(556,1)

innrest
wait(2)

play song(80)

set hero speed(0,hspeed)
focus camera(herox(0),heroy(0),4)
wait for camera
camera follows hero(0)

write pass block(171,103,1+2+4+8)
write pass block(172,103,1+2+4+8)
write pass block(173,103,1+2+4+8)
write pass block(174,103,1+2+4+8)
write pass block(175,103,1+2+4+8)

end
###

########################
script, lovestone, begin
suspend player
suspend npcs
suspend obstruction

stop song

set hero speed(0,2)
focus camera(148,49,1)
wait(5)
walk hero to x(0,148)
wait for hero(0)
walk hero(0,up,5)
wait for hero(0)
set hero frame(0,0)
wait for camera

wait(30)

jig hero(0)
tb(3210)
wait(25)
play song(83)
tb(3211)
wait(3)
pan camera(up,3,1)
wait(3)
walk hero(0,up,3)
wait for hero(0)
set hero frame(0,0)
wait for camera
wait(20)
jig hero(0)
set hero picture(0,375)
tb(3212)
wait(4)
set npc direction(1,left)
wait(3)
tb(3213)
wait(10)
set npc direction(1,down)
wait(15)
tb(3214)
wait(15)
tb(3215)
wait(25)
set hero picture(0,376)
wait(5)
tb(3216)
wait(3)
set npc direction(1,left)
wait(3)
tb(3217)
set hero picture(0,230)
set hero direction(0,up)
wait(3)
set hero direction(0,right)
jig hero(0)
tb(3218)
wait(5)
set npc direction(1,down)
wait(20)
tb(3219)
wait(5)
jig hero(0)
tb(3220)
wait(4)
set npc direction(1,up)
wait(4)
alter npc(1,NPCstat:picture,381)
wait(6)
set npc direction(1,left)
wait(3)
jig npc(1)
tb(3221)
wait(5)
jig hero(0)
tb(3222)
wait(4)
pan camera(right,1,1)
alter npc(1,NPCstat:movespeed,2)
set npc direction(1,down)
wait(4)
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
wait for camera
wait(25)
jig npc(1)
tb(3223)
wait(5)
jig hero(0)
tb(3224)
wait(10)
jig npc(1)
tb(3225)
wait(5)
jig hero(0)
tb(3226)
wait(15)
set npc direction(1,down)
wait(4)
set npc direction(1,left)
wait(7)
jig npc(1)
tb(3227)
wait(5)
jig hero(0)
tb(3228)
wait(4)
alter npc(1,NPCstat:picture,386)
set npc direction(1,down)
wait(10)
jig npc(1)
show text box(3229)
wait(3)
set npc frame(1,1)
wait(4)
set npc direction(1,right)
wait for text box
wait(5)
jig hero(0)
tb(3230)
wait(20)
set npc frame(1,0)
wait(6)
alter npc(1,NPCstat:picture,386)
wait(4)
alter npc(1,NPCstat:picture,387)
wait(10)
jig npc(1)
tb(3231)
set hero speed(0,2)
wait(3)
walk hero(0,right,1)
pan camera(down,1,1)
wait for hero(0)
set hero frame(0,0)
wait for camera
wait(5)
jig hero(0)
show text box(3232)
wait(2)
set npc frame(1,1)
wait for text box
wait(2)
alter npc(1,NPCstat:picture,407)
set npc direction(1,right)
wait(3)
alter npc(1,NPCstat:picture,408)
set npc direction(1,up)
jig npc(1)
set npc frame(1,1)
tb(3233)
wait(20)
jig npc(1)
set npc direction(1,down)
jig npc(1)
show text box(3234)
wait(3)
set npc direction(1,left)
wait for text box
wait(8)
show text box(3235)
wait(3)
set npc direction(1,down)
jig npc(1)
set npc frame(1,1)
wait for text box
wait(3)
jig npc(1)
jig npc(1)
set npc direction(1,up)
jig npc(1)
set npc frame(1,1)
tb(3236)
wait(15)
set hero picture(0,374)
jig hero(0)
tb(3237)
jig npc(1)
jig npc(1)
set npc frame(1,1)
tb(3238)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(1))
set variable(ny,npc pixel y(1))
wait(3)
set hero frame(0,1)
put npc(1,nx+1,ny)
wait(1)
put npc(1,nx--1,ny)
wait(1)
put npc(1,nx+1,ny)
wait(1)
set hero frame(0,0)
focus camera(herox(0),heroy(0),5)
stop song
show text box(3239)
put npc(1,nx--1,ny)
wait(1)
put npc(1,nx,ny)
wait for text box
wait for camera
tb(3240)
wait(25)
set npc direction(1,right)
wait(10)
tb(3241)
play song(33)
wait(5)
set hero direction(0,down)
set hero speed(0,2)
wait(3)
walk hero(0,left,1)
wait for hero(0)
set hero frame(0,0)
wait(45)
set hero picture(0,375)
set hero frame(0,1)
tb(3242)
wait(3)
set hero picture(0,377)
tb(3243)
wait(10)
set npc frame(1,0)
set npc direction(1,down)
wait(5)
set npc direction(1,left)
wait(8)
jig npc(1)
tb(3244)
wait(2)
set hero picture(0,374)
set hero frame(0,0)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
tb(3245)
tb(3246)
jig hero(0)
tb(3247)
jig hero(0)
tb(3248)
jig hero(0)
tb(3249)
wait(20)
set hero picture(0,377)
wait(5)
tb(3250)
wait(10)
jig npc(1)
tb(3251)
wait(2)
set hero picture(0,230)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
wait(16)
jig hero(0)
stop song
tb(3252)
jig npc(1)
set npc direction(1,down)
jig npc(1)
set npc frame(1,1)
set npc direction(1,up)
tb(3253)
wait(10)
jig hero(0)
tb(3254)
wait(5)
set npc direction(1,down)
set npc frame(1,0)
wait(15)
alter npc(1,NPCstat:picture,407)
set npc direction(1,right)
wait(4)
alter npc(1,NPCstat:picture,386)
set npc direction(1,down)
wait(8)
alter npc(1,NPCstat:picture,387)
wait(3)
alter npc(1,NPCstat:picture,386)
set npc direction(1,left)
wait(50)
set hero picture(0,375)
set hero direction(0,up)
wait(20)
set npc direction(1,up)
wait(10)
pan camera(up,2,1)
wait for camera
wait(40)

#ULTRAAA! Never give up again, Dogero!! Go for your dreams, make your destiny! Enjoy life!!
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(5)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(5)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(5)
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(5)

variable(seizure)
for(seizure,1,10,1) do(
tweak palette(0,63,0)
update palette
wait(1)
reset palette
update palette
wait(1)
)

tweak palette (0,2,0)
update palette
wait (1)
tweak palette (0,4,0)
update palette
wait (1)
tweak palette (0,8,0)
update palette
reset palette
wait (1)
tweak palette (0,16,0)
update palette
reset palette
wait (1)
tweak palette (0,63,0)
update palette

suspend box advance
play song(34)
show text box(3255)
wait (2)

reset palette
tweak palette (0,16,0)
update palette
wait (1)
reset palette
tweak palette (0,8,0)
update palette
wait (1)
reset palette
tweak palette (0,4,0)
update palette
wait (1)
reset palette
tweak palette (0,2,0)
update palette
wait (1)
reset palette
update palette

wait for key(use key)
advance text box
resume box advance

alter npc(1,NPCstat:picture,388)
wait(4)
alter npc(1,NPCstat:picture,383)
set npc direction(1,left)
tb(3256)
wait(4)
set hero direction(0,right)
wait(5)
tb(3257)
alter npc(1,NPCstat:picture,409)
set npc direction(1,down)
jig npc(1)
show text box(3258)
jig npc(1)
jig npc(1)
jig npc(1)
wait for text box

pan camera(down,1,1)
set hero picture(0,230)
variable(hx)
variable(hy)
set variable(hx,herox(0))
set variable(hy,heroy(0))
wait(3)
put hero(0,(hx*20)+2,hy*20)
set hero frame(0,1)
wait(3)
put hero(0,(hx*20)+4,hy*20)
set hero frame(0,0)
jig hero(0)
show text box(3259)
wait(3)
set npc direction(1,right)
wait for camera
wait for text box
tb(3260)
wait(20)
set hero picture(0,373)
put hero(0,(hx*20)+6,hy*20)
set hero frame(0,1)
wait(3)
put hero(0,(hx*20)+8,hy*20)
set hero frame(0,0)
jig hero(0)
show text box(3261)
wait(3)
set npc direction(1,up)
wait for text box
wait(15)
jig npc(1)
set npc frame(1,1)
tb(3262)
wait(10)
set hero picture(0,378)
set hero frame(0,1)
tb(3263)
wait(15)
palout(15)
stop song
suspend npcs
camera follows hero(0)
teleport to map(61,173,99)
stop song
wait(1)
pan camera(south,0,0)
set hero speed(0,2)
alter npc(1,NPCstat:movespeed,2)
set hero picture(0,230)
set hero position(0,173,93)
set npc position(1,173,92)
set npc position(2,172,99)
set npc position(3,174,99)
set npc position(5,173,99)
alter npc(5,NPCstat:picture,411)
set npc direction(2,left)
set npc direction(3,down)
unlock hero(find hero(1))
swap in hero(find hero(1))
unlock hero(find hero(2))
swap in hero(find hero(2))
unlock hero(find hero(3))
swap in hero(find hero(3))
set tag(3,1)
set tag(4,0)
set tag(5,0)
set tag(6,0)
set hp
wait(30)
palin(15)

wait(40)
set npc direction(2,down)
wait(4)
set npc direction(2,right)
jig npc(2)
show text box(3264)
wait(3)
set npc direction(3,left)
wait for text box
wait(3)
jig npc(3)
tb(3265)
wait(25)
jig npc(2)
tb(3266)
jig npc(3)
tb(3267)
wait(10)
set npc direction(2,down)
wait(3)
alter npc(2,NPCstat:movespeed,2)
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
wait(50)
set hero speed(0,2)
walk hero(0,down,3)
walk npc(1,down,3)
wait for hero(0)
wait for npc(1)
walk hero(0,down,2)
walk npc(1,down,2)
set npc direction(2,up)
jig npc(2)
play song(82)
show text box(3268)
wait for hero(0)
wait for npc(1)
walk hero(0,left,1)
walk npc(1,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
wait for npc(1)
set npc frame(1,0)
wait for text box
wait(10)
jig npc(2)
tb(3269)
wait(2)
alter npc(1,NPCstat:picture,390)
set npc direction(1,up)
wait(4)
jig npc(1)
show text box(3270)
wait(3)
set npc direction(1,right)
wait for text box
wait(1)
set npc direction(2,right)
wait(2)
variable(k)
alter npc(2,NPCstat:picture,389)
for(k,1,4,1) do(
wait(1)
set npc frame(2,1)
wait(1)
set npc frame(2,0)
)
show text box(3271)
for(k,1,4,1) do(
wait(2)
set npc frame(2,1)
wait(2)
set npc frame(2,0)
)
set npc direction(1,up)
wait for text box
jig npc(1)
tb(3272)
alter npc(2,NPCstat:picture,235)
set npc direction(2,left)
wait(2)
set npc direction(2,up)
jig npc(2)
tb(3273)
jig hero(0)
tb(3274)
wait(2)
set npc direction(2,right)
wait(2)
alter npc(2,NPCstat:picture,389)
set npc direction(2,right)
jig npc(2)
show text box(3275)
wait(2)
set hero picture(0,374)
wait for text box
jig npc(1)
tb(3276)
jig hero(0)
tb(3277)
wait(4)
set hero picture(0,377)
set hero frame(0,1)
tb(3278)
jig npc(3)
show text box(3279)
wait(3)
set hero frame(0,0)
wait(2)
alter npc(1,NPCstat:picture,233)
set npc direction(1,down)
wait(2)
alter npc(2,NPCstat:picture,235)
set npc direction(2,right)
wait for text box
stop song
jig npc(1)
tb(3280)
wait(3)
set npc direction(2,up)
wait(4)
jig npc(2)
tb(3281)
wait(10)
set npc direction(3,up)
wait(5)
jig npc(3)
tb(3282)
set hero picture(0,230)
jig hero(0)
tb(3283)
wait(15)
jig npc(3)
show text box(3284)
wait(3)
set hero picture(0,375)
wait for text box
wait(10)
set hero picture(0,378)
wait(3)
set hero frame(0,1)
tb(3285)
wait(20)
set hero frame(0,0)
wait(2)
set hero picture(0,230)
jig hero(0)
play song(69)
tb(3286)

alter npc(1,NPCstat:movespeed,4)
alter npc(2,NPCstat:movespeed,4)
alter npc(3,NPCstat:movespeed,4)

focus camera (herox(0),heroy(0),2)

walk npc(1,left,1)
walk npc(2,up,1)
walk npc(3,up,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
wait for npc(3)
walk npc(2,right,1)
walk npc(3,left,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
walk npc(3,left,1)
wait for npc(3)
set npc position(3,2,1)

wait for camera
camera follows hero(0)

set hero speed(0,hspeed)
set party in
set tag(8,0)
set tag(139,0)

#non jaded!
set tag(188,1)
set victory music(34+1)
write spell(find hero(0),0,21,1789+1)

set variable(isrunning,true)
set variable(hour,morningtime)
wait(1)
create npc(34,herox(0)--1,heroy(0))
create npc(34,herox(0)+1,heroy(0))
create npc(34,herox(0),heroy(0)--1)
create npc(34,herox(0),heroy(0)+1)
innrest
wait(1)
save game

resume obstruction
resume npcs
resume player
end
###

#########################
script, beforedun4, begin
suspend player
suspend npcs
suspend obstruction

stop song

set hero speed(0,1)
focus camera(121,6,2)
wait(5)
walk hero to x(0,npcx(5))
wait for hero(0)
walk hero(0,up,2)
wait for camera
wait for hero(0)
set hero frame(0,0)
pdown

wait(30)
jig hero(0)
play song(15)
tb(3288)
wait(5)
jig npc(1)
tb(3289)
wait(10)
jig npc(2)
tb(3290)
set hero picture(0,374)
wait(4)
set hero direction(0,right)
wait(4)
set hero direction(0,down)
wait(3)
jig hero(0)
tb(3291)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(5))
set variable(ny,npc pixel y(5))
wait(10)
put npc(5,nx+1,ny)
wait(4)
put npc(5,nx,ny)
wait(2)
jig npc(3)
tb(3292)
wait(2)
set hero direction(0,left)
wait(2)
set hero direction(0,up)
wait(20)
variable(i)
for(i,1,5,1) do(
put npc(5,nx+random(-1,1),ny+random(-1,1))
wait(2)
)
put npc(5,nx,ny)
tb(3293)
jig hero(0)
tb(3294)
for(i,1,5,1) do(
put npc(5,nx+random(-1,1),ny+random(-1,1))
wait(2)
)
put npc(5,nx,ny)
tb(3295)
for(i,1,2,1) do(
put npc(5,nx+random(-1,1),ny+random(-1,1))
wait(2)
)
put npc(5,nx,ny)
tb(3296)
jig hero(0)
tb(3297)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
wait(3)
set npc direction(2,left)
set npc direction(1,right)
set npc direction(3,left)
pan camera(down,2,2)
wait(3)
set hero speed(0,4)
walk hero(0,down,2)
walk npc(1,down,2)
walk npc(2,down,2)
walk npc(3,down,2)
wait(4)
for(i,1,2,1) do(
put npc(5,nx+random(-1,1),ny+random(-1,1))
wait(2)
)
put npc(5,nx,ny)
set npc frame(5,1)
show text box(3298)
wait for hero(0)
wait for npc(3)
set hero frame(0,0)
set npc frame(1,0)
set npc frame(2,0)
set npc frame(3,0)
set hero direction(0,left)
set npc direction(1,left)
set npc direction(2,right)
set npc direction(3,right)
wait for camera
wait(3)
set hero direction(0,up)
set npc direction(1,up)
set npc direction(2,up)
set npc direction(3,up)
wait for text box
for(i,1,2,1) do(
put npc(5,nx+random(-1,1),ny+random(-1,1))
wait(2)
)
put npc(5,nx,ny)
tb(3299)
for(i,1,3,1) do(
put npc(5,nx+random(-1,1),ny+random(-1,1))
wait(3)
)
put npc(5,nx,ny)
set npc frame(5,0)
tb(3300)
jig hero(0)
tb(3301)

focus camera(herox(0),heroy(0),2)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
ppdown
wait for camera
camera follows hero(0)
set tag(189,1)
set hero speed(0,hspeed)
save game

resume obstruction
resume npcs
resume player
end
###

##############################
script, humbleprotector, begin
suspend player
suspend npcs
suspend obstruction

if(check tag(189)==false) then(
	jig npc(8)
	tb(3302)
)
if(check tag(189)) then(
	humbleprotectorA
	humbleprotectorB
	humbleprotectorC
)

resume obstruction
resume npcs
resume player
end
###

###############################
script, humbleprotectorA, begin
focus camera(6,32,2)
walk hero to y(0,32)
wait for hero(0)
walk hero to x(0,6)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
set npc direction(8,down)
jig npc(8)
tb(3302)
stop song

set hero speed(0,4)

set npc position(10,3,10)
set npc position(9,7,12)
set npc position(7,8,8)
set npc direction(10,up)
set npc direction(9,up)
set npc direction(7,up)

set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,1)
walk npc(2,down,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,up)
wait(2)
set npc direction(2,up)

wait(3)
play song(15)
walk hero(0,up,5)
walk npc(8,right,1)
set npc direction(8,left)
show text box(3303)
wait for npc(8)
set npc frame(8,0)
wait for text box
walk npc(3,right,1)
wait for npc(3)
walk npc(3,up,5)
walk npc(2,up,2)
wait for npc(2)
walk npc(2,up,4)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
jig npc(1)
tb(3304)

set hero speed(0,10)
alter npc(2,NPCstat:movespeed,10)
alter npc(3,NPCstat:movespeed,10)
wait for hero(0)
set hero position(0,6,25)
set npc position(2,6,26)
set npc position(3,6,27)
pan camera(up,14,10)

walk hero(0,up,9)
walk npc(2,up,9)
walk npc(3,up,9)
wait for hero(0)
wait for npc(3)
set hero speed(0,2)
alter npc(2,NPCstat:movespeed,2)
alter npc(3,NPCstat:movespeed,2)
walk hero(0,up,10)
walk npc(2,up,10)
walk npc(3,up,10)

wait for camera
pan camera(up,12,5)


wait for hero(0)
set hero frame(0,0)
wait for npc(2)
set npc frame(2,0)
wait for npc(3)
walk npc(3,right,1)
wait for npc(3)
walk npc(3,up,2)
wait for npc(3)
set npc frame(3,0)
wait for camera
set npc position(1,6,14)
walk npc(1,up,6)
wait for npc(1)
walk npc(1,left,1)
wait for npc(1)
walk npc(1,up,2)
wait for npc(1)
set npc frame(1,0)

wait(10)
jig npc(2)
tb(3305)
jig npc(3)
tb(3306)
stop song
jig npc(4)
jig npc(4)
tb(3307)
wait(20)
jig npc(4)
wait(2)
jig npc(4)
tb(3308)
jig hero(0)
tb(3309)
wait(10)
jig npc(4)
jig npc(4)
play song(57)
tb(3310)
jig hero(0)
tb(3311)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(4))
set variable(ny,npc pixel y(4))
variable(i)
wait(10)
pan camera(up,1,1)
for(i,1,5,1) do(
put npc(4,nx+random(-1,1),ny+random(1,-1))
wait(2)
)
put npc(4,nx,ny)
set npc direction(5,down)
set npc direction(4,right)
set npc position(5,npcx(4),npcy(4)--1)
wait(6)
set npc direction(5,left)
set npc frame(4,2)
wait for camera
walk npc(10,up,4)
walk npc(6,up,1)
walk npc(12,up,4)
walk npc(9,up,4)
walk npc(7,up,1)
walk npc(11,up,4)

wait(15)
tb(3312)
jig hero(0)
tb(3313)
wait(10)
jig npc(5)
tb(3314)
jig hero(0)
tb(3315)
tb(3316)
wait(5)
jig npc(5)
wait(20)
jig npc(5)
tb(3317)
jig hero(0)
tb(3318)
tb(3319)
set hero speed(0,5)
walk hero(0,up,1)
show text box(3320)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
wait for text box
wait(5)
jig npc(5)
wait(5)
jig npc(5)
wait(20)
jig npc(5)
tb(3321)
wait(3)
jig hero(0)
tb(3322)
tb(3323)
jig hero(0)
tb(3324)
wait(5)
jig npc(5)
wait(5)
jig npc(5)
tb(3325)
show text box(3326)
jig npc(1)
wait for text box
jig npc(5)
jig npc(5)
wait(5)
jig npc(5)
tb(3327)
show text box(3328)
jig npc(1)
wait(3)
set npc direction(10,right)
wait(3)
set npc direction(11,left)
wait for text box
jig npc(5)
wait(5)
jig npc(5)
wait(30)
jig npc(5)
tb(3329)
play song(15)
tb(3330)
end
###

###############################
script, humbleprotectorB, begin
battleflash(1)
set tag(190,1)
ff(437+poff)
stop song
end
###

###############################
script, humbleprotectorC, begin
set tag(506,1)
pan camera(down,2,1)
walk npc(10,right,1)
#walk npc(12,up,1)
#walk npc(9,up,1)
walk npc(11,left,1)
set hero speed(0,4)
walk hero(0,down,1)
set npc direction(1,right)
set npc direction(3,left)
wait for hero(0)
set hero frame(0,0)
wait(3)
set hero direction(0,down)
set npc direction(1,down)
set npc direction(3,down)
wait for npc(10)
set npc frame(10,0)
#wait for npc(12)
#set npc frame(12,0)
#wait for npc(9)
#set npc frame(9,0)
wait for npc(11)
set npc frame(11,0)
wait for camera

wait(15)
jig npc(2)
play song(19)
tb(3331)
jig npc(3)
tb(3332)
tb(3333)
wait(5)
jig npc(2)
tb(3334)
jig npc(3)
tb(3335)
wait(40)
alter npc(1,NPCstat:picture,383)
set npc frame(1,1)
wait(4)
alter npc(1,NPCstat:picture,384)
wait(16)
alter npc(1,NPCstat:picture,383)
wait(4)
alter npc(1,NPCstat:picture,385)
wait(16)
alter npc(1,NPCstat:picture,383)
wait(4)
alter npc(1,NPCstat:picture,382)
set npc frame(1,0)
set npc direction(1,left)
jig npc(1)
stop song
show text box(3336)
alter npc(10,NPCstat:movespeed,4)
alter npc(10,NPCstat:movetype,NPCmovetype:avoidyou)
alter npc(10,NPCstat:script,0)
alter npc(10,NPCstat:whenactivated,npcwhenactivated:donotfaceplayer)
alter npc(6,NPCstat:movetype,NPCmovetype:avoidyou)
alter npc(6,NPCstat:displaytext,0)
alter npc(6,NPCstat:whenactivated,npcwhenactivated:donotfaceplayer)
alter npc(12,NPCstat:movetype,NPCmovetype:avoidyou)
alter npc(12,NPCstat:displaytext,0)
alter npc(12,NPCstat:whenactivated,npcwhenactivated:donotfaceplayer)
alter npc(9,NPCstat:movetype,NPCmovetype:avoidyou)
alter npc(9,NPCstat:displaytext,0)
alter npc(9,NPCstat:whenactivated,npcwhenactivated:donotfaceplayer)
alter npc(11,NPCstat:movetype,NPCmovetype:avoidyou)
alter npc(11,NPCstat:displaytext,0)
alter npc(11,NPCstat:whenactivated,npcwhenactivated:donotfaceplayer)
alter npc(7,NPCstat:movetype,NPCmovetype:avoidyou)
alter npc(7,NPCstat:displaytext,0)
alter npc(7,NPCstat:whenactivated,npcwhenactivated:donotfaceplayer)
set hero picture(0,376)
set npc direction(2,left)
wait for text box
resume obstruction
resume npcs
wait(5)
set npc direction(1,down)
wait(5)
set npc direction(2,down)
wait(10)
set hero picture(0,230)
wait(45)
jig hero(0)
show text box(3337)
wait(2)
set npc direction(2,right)
wait(2)
set npc direction(2,up)
wait for text box
focus camera(herox(0),heroy(0))
alter npc(10,NPCstat:movespeed,4)
alter npc(2,NPCstat:movespeed,4)
alter npc(3,NPCstat:movespeed,4)
suspend npcs
suspend obstruction
walk npc(1,right,1)
walk npc(3,left,1)
walk npc(2,up,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in
set hero speed(0,hspeed)
alter npc(1,NPCstat:picture,233)
wait for camera
camera follows hero(0)
end
###

########################
script, preenterdun4, begin
suspend player
suspend npcs
suspend obstruction

stop song

set hero speed(0,1)
focus camera(121,7,2)
wait(5)
walk hero to x(0,npcx(5))
wait for hero(0)
walk hero(0,up,2)
wait for camera
wait for hero(0)
set hero frame(0,0)
pdown

wait(10)
palout(10)
set tag(191,1)
wait(1)
set npc position(6,121,7)
set npc direction(6,down)
set hero position(0,121,8)
set npc position(1,120,8)
set npc position(2,121,9)
set npc position(3,122,8)
wait(10)
play song(91)
palin(10)

wait(10)
jig npc(6)
tb(3338)
jig hero(0)
tb(3339)
wait(3)
set npc direction(6,right)
wait(5)
set npc direction(6,up)
wait(10)
jig npc(6)
show text box(3340)
wait(5)
set npc direction(6,right)
wait(3)
set npc direction(6,down)
wait for text box
jig npc(1)
tb(3341)
jig npc(6)
tb(3342)
wait(3)
set npc direction(6,right)
wait(5)
set npc direction(6,up)
wait(30)
jig npc(6)
tb(3343)
wait(5)
set npc direction(6,right)
wait(3)
set npc direction(6,down)
jig npc(6)
tb(3344)
jig hero(0)
tb(3345)
wait(7)
jig npc(6)
tb(3346)
wait(8)
jig npc(6)
tb(3347)
set npc direction(3,left)
jig npc(3)
tb(3348)
jig npc(2)
tb(3349)
wait(3)
set hero direction(0,right)
wait(3)
jig hero(0)
tb(3350)
jig npc(6)
set hero direction(0,up)
tb(3351)

walk npc(6,left,1)
wait for npc(6)
set npc frame(6,0)
set npc direction(6,down)
wait(3)
focus camera(herox(0),heroy(0),2)
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,left,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set party in
wait for camera
#set tag(506,1)
camera follows hero(0)
set hero speed(0,hspeed)
save game

resume obstruction
resume npcs
resume player
end
###

#################################
script, dartjadefirstscene, begin

dartjadefirstscene1
dartjadefirstscene2

end
###
##################################
script, dartjadefirstscene1, begin
walk hero(0,up,1)
wait for hero(0)
palout(3)
put camera( (45*20)--(9*20)+30, (18*20)--(6*20)+30 )
set hero position(0,37,11)
set npc direction(18,up)
wait(20)
palin(10)

wait(50)

jig gahn
tb(3352)
wait(20)
jig npc(18)
tb(3353)
wait(10)
set npc direction(18,left)
jig npc(18)
tb(3354)
stop song
wait(5)
set npc direction(18,up)
wait(10)
play song(57)
jig gahn
tb(3355)
jig gahn
tb(3356)
wait(10)
set npc direction(18,left)
wait(3)
set npc direction(18,down)
wait(3)
jig npc(18)
tb(3357)
jig gahn
tb(3358)
wait(20)
set npc direction(18,right)
wait(4)
set npc direction(18,up)
wait(10)
jig npc(18)
tb(3359)
jig gahn
tb(3360)
wait(10)
jig gahn
tb(3361)
jig gahn
tb(3362)
end
###
##################################
script, dartjadefirstscene2, begin
pan camera(up,6,2)
wait for camera
wait(15)
jig gahn
tb(3363)
jig gahn
tb(3364)
wait(15)
jig gahn
suspend box advance
show text box(3365)
wait for key(use key)
palout(10)
stop song
advance text box
resume box advance

camera follows hero(0)
set hero position(0,27,66)
wait(1)
pan camera(south,0,0)
set hero position(0,27,60)
set hero speed(0,20)
wait(1)
walk hero(0,up,38)
pan camera(up,48,20)
play song(95)
palin(10)
wait for camera
set hero frame(0,0)
set hero speed(0,hspeed)
set tag(198,1)

set tag(712,1)

set variable(jadedart,28)
#create npc(19,26,21)
#create npc(19,27,22)
#create npc(19,28,21)
end
###


########################
script, dartjade1, begin
suspend player
suspend npcs
stop song
palout(2)
set variable(saveherox,herox(0))
set variable(saveheroy,heroy(0))
set variable(text1,camera pixel x)
set variable(text2,camera pixel y)
variable(mappy)
set variable(mappy,currentmap)

dartjade1A

teleport to map(mappy,saveherox,saveheroy)

dartjade1B

end
###

#########################
script, dartjade1A, begin
wait(1)
camera follows hero(0)
teleport to map(92,45,18)
stop song
wait(1)

load tileset(100+poff)
alter npc(18,NPCstat:palette,45+poff)
variable(j)
for(j,13,17,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
for(j,20,24,1) do(
alter npc(j,NPCstat:palette,65+poff)
)

pan camera(south,0,0)
set hero position(0,37,11)
set npc position(18,47,16)
wait(1)
alter npc(18,NPCstat:movespeed,1)
walk npc(18,left,4)
palin(10)
play song(17)
wait for npc(18)
wait(10)
set npc direction(18,down)
wait(4)
set npc direction(18,right)
wait(4)
walk npc(18,right,4)
wait for npc(18)
wait(10)
set npc direction(18,down)
wait(4)
set npc direction(18,left)
wait(4)
walk npc(18,left,4)

stop song
palout(10)
wait for npc(18)
camera follows hero(0)
end
###
#########################
script, dartjade1B, begin
suspend player
suspend npcs
wait(1)
put camera(text1,text2)

if(current map==92) then(
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
load tileset(100+poff)
)
if(current map==13,or,current map==22,or,current map==23,or,current map==36,or,current map==57,or,current map==67,or,current map==68,or,current map==89,or,current map==91,or,current map==92,or,current map==62,or,current map==63,or,current map==64,or,current map==65,or,current map==0) then()
else(camera follows hero(0))

wait(1)
palin(2)
end
###

########################
script, dartjade2, begin
suspend player
suspend npcs
stop song
palout(2)
set variable(saveherox,herox(0))
set variable(saveheroy,heroy(0))
set variable(text1,camera pixel x)
set variable(text2,camera pixel y)
variable(mappy)
set variable(mappy,currentmap)

dartjade2A

teleport to map(mappy,saveherox,saveheroy)

dartjade2B

end
###

#########################
script, dartjade2A, begin
wait(1)
alter npc(18,NPCstat:palette,45+poff)
variable(j)
for(j,13,17,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
for(j,20,24,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
camera follows hero(0)
teleport to map(92,45,18)
wait(1)
load tileset(100+poff)
pan camera(south,0,0)
set hero position(0,37,11)
set npc position(18,45,15)
set npc direction(18,up)
wait(1)
palin(10)
play song(17)

wait(40)
jig npc(18)
tb(3366)
wait(10)

stop song
palout(10)
camera follows hero(0)
end
###
#########################
script, dartjade2B, begin
suspend player
suspend npcs
wait(1)
put camera(text1,text2)

if(current map==92) then(
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
load tileset(100+poff)
)
if(current map==13,or,current map==22,or,current map==23,or,current map==36,or,current map==57,or,current map==67,or,current map==68,or,current map==89,or,current map==91,or,current map==92,or,current map==62,or,current map==63,or,current map==64,or,current map==65,or,current map==0) then()
else(camera follows hero(0))

wait(1)
palin(2)
end
###

########################
script, dartjade3, begin
suspend player
suspend npcs
stop song
palout(2)
set variable(saveherox,herox(0))
set variable(saveheroy,heroy(0))
set variable(text1,camera pixel x)
set variable(text2,camera pixel y)
variable(mappy)
set variable(mappy,currentmap)

dartjade3A

teleport to map(mappy,saveherox,saveheroy)

dartjade3B

end
###

#########################
script, dartjade3A, begin
wait(1)
camera follows hero(0)
teleport to map(92,45,18)
wait(1)
load tileset(100+poff)
alter npc(18,NPCstat:palette,45+poff)
variable(j)
for(j,13,17,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
for(j,20,24,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
pan camera(south,0,0)
set hero position(0,37,11)
set npc position(18,43,16)
set npc direction(18,left)
wait(1)
palin(10)
play song(17)

wait(30)
alter npc(18,NPCstat:movespeed,1)
set npc direction(18,down)
wait(4)
walk npc(18,right,2)
wait for npc(18)
wait(20)
jig npc(18)
tb(3367)
wait(10)
set npc direction(18,up)
wait(4)
walk npc(18,up,1)
wait for npc(18)
wait(20)
jig npc(18)
tb(3368)
wait(10)

palout(10)
camera follows hero(0)
end
###
#########################
script, dartjade3B, begin
suspend player
suspend npcs
wait(1)
put camera(text1,text2)

if(current map==92) then(
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
load tileset(100+poff)
)
if(current map==13,or,current map==22,or,current map==23,or,current map==36,or,current map==57,or,current map==67,or,current map==68,or,current map==89,or,current map==91,or,current map==92,or,current map==62,or,current map==63,or,current map==64,or,current map==65,or,current map==0) then()
else(camera follows hero(0))
wait(1)
palin(2)
end
###

########################
script, dartjade4, begin
suspend player
suspend npcs
stop song
palout(2)
set variable(saveherox,herox(0))
set variable(saveheroy,heroy(0))
set variable(text1,camera pixel x)
set variable(text2,camera pixel y)
variable(mappy)
set variable(mappy,currentmap)

dartjade4A

teleport to map(mappy,saveherox,saveheroy)

dartjade4B

end
###

#########################
script, dartjade4A, begin
wait(1)
camera follows hero(0)
teleport to map(92,45,18)
wait(1)
load tileset(100+poff)
alter npc(18,NPCstat:palette,45+poff)
variable(j)
for(j,13,17,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
for(j,20,24,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
pan camera(south,0,0)
set hero position(0,37,11)
set npc position(18,46,16)
set npc direction(18,right)
alter npc(18,NPCstat:movespeed,1)
wait(1)
palin(10)
play song(17)

wait(20)
set npc direction(18,down)
wait(4)
set npc direction(18,left)
wait(4)
walk npc(18,left,2)
wait for npc(18)
wait(15)
set npc direction(18,down)
wait(4)
set npc direction(18,right)
wait(4)
walk npc(18,right,2)
wait for npc(18)
wait(15)
set npc direction(18,down)
wait(4)
set npc direction(18,left)
wait(4)
walk npc(18,left,1)
wait for npc(18)
wait(4)
set npc direction(18,up)
wait(25)
jig npc(18)
tb(3369)
wait(10)

palout(10)
camera follows hero(0)
end
###
#########################
script, dartjade4B, begin
suspend player
suspend npcs
wait(1)
put camera(text1,text2)

if(current map==92) then(
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
load tileset(100+poff)
)
if(current map==13,or,current map==22,or,current map==23,or,current map==36,or,current map==57,or,current map==67,or,current map==68,or,current map==89,or,current map==91,or,current map==92,or,current map==62,or,current map==63,or,current map==64,or,current map==65,or,current map==0) then()
else(camera follows hero(0))

wait(1)
palin(2)
end
###

########################
script, dartjade5, begin
suspend player
suspend npcs
suspend obstruction
suspend npc walls

stop song
palout(2)
set variable(saveherox,herox(0))
set variable(saveheroy,heroy(0))
set variable(text1,camera pixel x)
set variable(text2,camera pixel y)
variable(mappy)
set variable(mappy,currentmap)

dartjade5A

teleport to map(mappy,saveherox,saveheroy)

dartjade5B

end
###

#########################
script, dartjade5A, begin
wait(1)
camera follows hero(0)
teleport to map(92,45,18)
wait(1)
load tileset(100+poff)
alter npc(18,NPCstat:palette,45+poff)
variable(j)
for(j,13,17,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
for(j,20,24,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
pan camera(south,0,0)
set hero position(0,37,11)
set npc position(18,45,15)
set npc direction(18,up)
wait(1)
palin(10)
play song(17)

wait(50)
set npc direction(18,left)
wait(5)
jig npc(18)
tb(3370)
stop song
wait(5)
set npc direction(18,down)
wait(5)
walk npc(18,down,3)
wait for npc(18)
wait(15)

variable(i)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(18))
set variable(ny,npc pixel y(18))

write pass block(45,19,128)
write pass block(45,20,128)

for(i,1,5,1) do(
put npc(18,nx--1,ny)
put npc(13,nx--1,ny)
put npc(20,nx--1,ny+20)
wait(1)
put npc(18,nx+1,ny)
put npc(13,nx+1,ny)
put npc(20,nx+1,ny+20)
wait(1)
)
put npc(18,nx,ny)
put npc(13,nx,ny)
put npc(20,nx,ny+20)
wait(1)
for(i,1,40,1) do(
put npc(18,nx,ny+i)
put npc(13,nx,ny+i)
put npc(20,nx,ny+20+i)
wait(1)
)
wait(10)

palout(10)
write pass block(45,19,0)
write pass block(45,20,0)
camera follows hero(0)
end
###
#########################
script, dartjade5B, begin
suspend player
suspend npcs
wait(1)
put camera(text1,text2)

if(current map==92) then(
alter npc(4,NPCstat:palette,25+poff)
alter npc(5,NPCstat:palette,9+poff)
alter npc(6,NPCstat:palette,41+poff)
alter npc(7,NPCstat:palette,81+poff)
alter npc(8,NPCstat:palette,129+poff)
alter npc(9,NPCstat:palette,149+poff)
alter npc(10,NPCstat:palette,1+poff)
alter npc(11,NPCstat:palette,125+poff)
alter npc(12,NPCstat:palette,105+poff)
load tileset(100+poff)
)

if(current map==13,or,current map==22,or,current map==23,or,current map==36,or,current map==57,or,current map==67,or,current map==68,or,current map==89,or,current map==91,or,current map==92,or,current map==62,or,current map==63,or,current map==64,or,current map==65,or,current map==0) then()
else(camera follows hero(0))

set tag(198,0)
set tag(199,1)
wait(1)
palin(2)

resume npc walls
resume obstruction
end
###

########################
script, finalbird, begin
suspend player
suspend npcs
suspend obstruction

set variable(isrunning,false)

finalbirdgo

if(check tag(199)) then(darttoolate)
else(dartintime)

resume obstruction
resume npcs
resume player
end
###

##########################
script, finalbirdgo, begin
suspend npc walls
suspend hero walls
suspend overlay

stop song

walk hero to x(0,npcx(12))
walk hero to y(0,npcy(12))
set variable(saveherox,get hero picture(0))
set variable(saveheroy,get hero palette(0))
wait for hero(0)
set hero direction(0,down)

set hero picture(0,433)
set hero palette(0,105+poff)
set npc position(12,0,0)
set hero speed(0,2)
set hero frame(0,0)
walk hero(0,up,1)
wait for hero(0)
set hero speed(0,5)

set hero picture(0,435)
set hero frame(0,0)
walk hero(0,up,17)
pan camera(up,12,4)
wait(30)

palout(5)
wait for hero(0)
wait for camera
wait(1)
camera follows hero(0)
set hero position(0,45,18)
wait(1)
pan camera(south,0,0)

variable(j)
for(j,13,17,1) do(
alter npc(j,NPCstat:palette,65+poff)
)
for(j,20,24,1) do(
alter npc(j,NPCstat:palette,65+poff)
)

wait(1)

set hero position(0,45,24)
set hero frame(0,0)
alter npc(18,NPCstat:palette,45+poff)
set npc position(18,45,15)
set npc direction(18,up)
wait(1)
palin(15)

play song(17)

set hero speed(0,hspeed)
alter npc(25,NPCstat:picture,433)
alter npc(25,NPCstat:palette,105+poff)
alter npc(25,NPCstat:movespeed,2)

wait(30)

#setting NPC hero palettes
alter npc(1,NPCstat:palette,29+poff)
alter npc(2,NPCstat:palette,33+poff)
alter npc(3,NPCstat:palette,65+poff)

walk hero(0,up,3)
wait for hero(0)
set hero picture(0,saveherox)
set hero palette(0,saveheroy)
set hero direction(0,up)
set npc position(25,herox(0),heroy(0))

walk npc(25,up,1)
walk npc(25,right,1)
set npc direction(25,up)
wait for npc(25)
alter npc(25,NPCstat:picture,434)
alter npc(25,NPCstat:movespeed,4)
walk npc(25,right,2)
walk npc(25,down,5)
set npc direction(25,down)
wait(4)
pdown
wait for npc(25)

#setting time to noon
set tag(3,0)
set tag(4,1)
set tag(5,0)
set tag(6,0)
set variable(hour,noontime)
set variable(currenttime,hour+minute)

#setting battle palettes too noon
set hero palette(find hero(0),1,insidebattle)
set hero palette(find hero(1),29,insidebattle)
set hero palette(find hero(2),33,insidebattle)
set hero palette(find hero(3),65,insidebattle)

resume overlay
resume hero walls
resume npc walls
end
###
##########################
script, darttoolate, begin

set hero speed(0,4)
walk hero(0,up,2)
walk npc(1,up,2)
walk npc(2,up,2)
walk npc(3,up,2)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
wait for npc(3)
set npc frame(3,0)
wait(35)
jig npc(2)
tb(3448)
wait(3)
set npc direction(1,left)
jig npc(1)
tb(3449)
wait(5)
set npc direction(3,right)
wait(4)
jig npc(3)
tb(3450)
wait(5)
set hero direction(0,left)
wait(3)
set hero direction(0,down)
wait(3)
jig hero(0)
tb(3451)

set hero speed(0,hspeed)
ppdown
set party out
save game

end
###
#########################
script, dartintime, begin
suspend npc walls

wait(5)
stop song
jig npc(18)
play song(82)
tb(3371)
wait(5)
set npc direction(18,right)
wait(3)
set npc direction(18,down)
wait(2)
walk npc(18,down,1)
wait for npc(18)
set npc frame(18,0)
jig npc(18)
tb(3372)
wait(5)
jig hero(0)
tb(3373)
wait(4)
walk npc(18,down,2)
wait for npc(18)
set npc frame(18,0)
wait(15)
jig npc(18)
tb(3374)
wait(6)
show text box(3375)
set npc direction(18,left)
wait(3)
set npc direction(18,up)
wait for text box

variable(i)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(18))
set variable(ny,npc pixel y(18))

write pass block(45,19,128)
#write pass block(45,20,128)

for(i,1,5,1) do(
put npc(18,nx--1,ny)
put npc(13,nx--1,ny)
put npc(20,nx--1,ny+20)
wait(1)
put npc(18,nx+1,ny)
put npc(13,nx+1,ny)
put npc(20,nx+1,ny+20)
wait(1)
)
put npc(18,nx,ny)
put npc(13,nx,ny)
put npc(20,nx,ny+20)
wait(1)
for(i,1,8,1) do(
put npc(18,nx,ny+i)
put npc(13,nx,ny+i)
put npc(20,nx,ny+20+i)
wait(1)
)
set npc position(20,0,0)
for(i,1,20,1) do(
put npc(18,nx,ny+8+i)
put npc(13,nx,ny+8+i)
wait(1)
)
set npc position(18,0,0)
set npc position(13,0,0)
wait(10)

write pass block(45,19,0)
#write pass block(45,20,0)

set hero speed(0,2)
walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
set hero picture(0,375)
wait(35)

jig npc(2)
tb(3376)
wait(8)
set npc direction(1,left)
jig npc(1)
show text box(3377)
wait(3)
set npc direction(3,right)
wait for text box
walk npc(2,up,1)
wait for npc(2)
set npc frame(2,0)
jig npc(2)
tb(3378)
wait(3)
set hero picture(0,377)
show text box(3379)
wait(2)
set npc direction(1,up)
wait(2)
set npc direction(3,up)
wait for text box
wait(5)
jig npc(3)
tb(3380)
wait(10)
set hero picture(0,375)
wait(3)
tb(3381)
wait(20)
set hero picture(0,374)
jig hero(0)
tb(3382)
wait(10)
set hero direction(0,right)
wait(3)
set hero direction(0,down)
wait(3)
jig hero(0)
tb(3383)
wait(10)
jig hero(0)
tb(3384)
tb(3385)
wait(5)
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
wait(10)
jig hero(0)
tb(3386)
tb(3387)
wait(10)
jig hero(0)
show text box(3388)
set hero picture(0,375)
set hero frame(0,1)
wait for text box
wait(20)
jig npc(3)
tb(3389)
set hero picture(0,374)
set hero frame(0,0)
set hero direction(0,left)
wait(3)
set hero direction(0,up)
wait(3)
jig hero(0)
tb(3390)
set hero picture(0,230)

walk npc(1,up,1)
walk npc(3,up,1)
walk npc(2,up,1)
wait for npc(1)
walk npc(1,left,1)
wait for npc(3)
walk npc(3,right,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(1)
set npc position(1,0,1)
wait for npc(3)
set npc position(3,2,1)

set tag(201,1)
set hero speed(0,hspeed)
set party in
set party out
resume npc walls
stop song
set variable(musicsave,17)

save game

play song(17)

end
###

###############################
script, shodafinalloader, num, begin
suspend player
suspend npcs
suspend obstruction
suspend hero walls
suspend npc walls

variable(h)
variable(i)
variable(nx)
variable(ny)

if(room in active party<>3) then(
	if(num==1) then(
		wait(2)
		set variable(h,hero by slot(pick hero))

		#if player does not pick a hero in a feeble attempt to annoy me
		if(h==0,or,h==1,or,h==2,or,h==3) then(

		if(herox(0)==42,and,heroy(0)==18) then(
			walk hero(0,right,1)
			wait for hero(0)
			walk hero(0,up,1)
			wait for hero(0)
			set hero direction(0,left)
		)

		alter npc(25,NPCstat:movespeed,2)
		alter npc(25,NPCstat:picture,get hero picture(find hero(h)))
		alter npc(25,NPCstat:palette,get hero palette(find hero(h)))
		set variable(h1,h)
		swap out hero(h)
		variable(hpal1)
		if(h==0) then(set variable(hpal1,1))
		if(h==1) then(set variable(hpal1,29))
		if(h==2) then(set variable(hpal1,33))
		if(h==3) then(set variable(hpal1,65))
		set hero palette(findhero(h),hpal1)
		lock hero(h)
		set npc position(25,herox(0),heroy(0))
		walk npc to x(25,42)
		wait for npc(25)
		walk npc to y(25,17)
		wait for npc(25)
		set npc direction(25,down)

		set variable(nx,npc pixel x(25))
		set variable(ny,npc pixel y(25))
		write pass block(42,18,128)
		write pass block(42,19,128)
		for(i,1,5,1) do(
			put npc(25,nx--1,ny)
			put npc(14,nx--1,ny)
			put npc(21,nx--1,ny+20)
			wait(1)
			put npc(25,nx+1,ny)
			put npc(14,nx+1,ny)
			put npc(21,nx+1,ny+20)
			wait(1)
		)
		put npc(25,nx,ny)
		put npc(14,nx,ny)
		put npc(21,nx,ny+20)
		wait(1)
		for(i,1,30,1) do(
			put npc(25,nx,ny+i)
			put npc(14,nx,ny+i)
			put npc(21,nx,ny+20+i)
			wait(1)
		)
		set npc position(25,0,0)
		set npc position(14,0,0)
		set npc position(21,0,0)
		wait(10)
		write pass block(42,18,0)
		write pass block(42,19,0)
		)
	)

	if(num==2) then(
		wait(2)
		set variable(h,hero by slot(pick hero))
		#if player does not pick a hero in a feeble attempt to annoy me
		if(h==0,or,h==1,or,h==2,or,h==3) then(
		if(herox(0)==43,and,heroy(0)==20) then(
			walk hero(0,right,1)
			wait for hero(0)
			walk hero(0,up,1)
			wait for hero(0)
			set hero direction(0,left)
		)
		alter npc(25,NPCstat:movespeed,2)
		alter npc(25,NPCstat:picture,get hero picture(find hero(h)))
		alter npc(25,NPCstat:palette,get hero palette(find hero(h)))
		set variable(h2,h)
		swap out hero(h)
		variable(hpal2)
		if(h==0) then(set variable(hpal2,1))
		if(h==1) then(set variable(hpal2,29))
		if(h==2) then(set variable(hpal2,33))
		if(h==3) then(set variable(hpal2,65))
		set hero palette(findhero(h),hpal2)
		lock hero(h)
		set npc position(25,herox(0),heroy(0))
		walk npc to x(25,43)
		wait for npc(25)
		walk npc to y(25,19)
		wait for npc(25)
		set npc direction(25,down)

		set variable(nx,npc pixel x(25))
		set variable(ny,npc pixel y(25))
		write pass block(43,20,128)
		write pass block(43,21,128)
		for(i,1,5,1) do(
			put npc(25,nx--1,ny)
			put npc(15,nx--1,ny)
			put npc(22,nx--1,ny+20)
			wait(1)
			put npc(25,nx+1,ny)
			put npc(15,nx+1,ny)
			put npc(22,nx+1,ny+20)
			wait(1)
		)
		put npc(25,nx,ny)
		put npc(15,nx,ny)
		put npc(22,nx,ny+20)
		wait(1)
		for(i,1,30,1) do(
			put npc(25,nx,ny+i)
			put npc(15,nx,ny+i)
			put npc(22,nx,ny+20+i)
			wait(1)
		)
		set npc position(25,0,0)
		set npc position(15,0,0)
		set npc position(22,0,0)
		wait(10)
		write pass block(43,20,0)
		write pass block(43,21,1+2+4+8)
		)
	)

	if(num==3) then(
		wait(2)
		set variable(h,hero by slot(pick hero))
		#if player does not pick a hero in a feeble attempt to annoy me
		if(h==0,or,h==1,or,h==2,or,h==3) then(
		if(herox(0)==48,and,heroy(0)==18) then(
			walk hero(0,left,1)
			wait for hero(0)
			walk hero(0,up,1)
			wait for hero(0)
			set hero direction(0,right)
		)
		alter npc(25,NPCstat:movespeed,2)
		alter npc(25,NPCstat:picture,get hero picture(find hero(h)))
		alter npc(25,NPCstat:palette,get hero palette(find hero(h)))
		set variable(h3,h)
		swap out hero(h)
		variable(hpal3)
		if(h==0) then(set variable(hpal3,1))
		if(h==1) then(set variable(hpal3,29))
		if(h==2) then(set variable(hpal3,33))
		if(h==3) then(set variable(hpal3,65))
		set hero palette(findhero(h),hpal3)
		lock hero(h)
		set npc position(25,herox(0),heroy(0))
		walk npc to x(25,48)
		wait for npc(25)
		walk npc to y(25,17)
		wait for npc(25)
		set npc direction(25,down)

		set variable(nx,npc pixel x(25))
		set variable(ny,npc pixel y(25))
		write pass block(48,18,128)
		write pass block(48,19,128)
		for(i,1,5,1) do(
			put npc(25,nx--1,ny)
			put npc(16,nx--1,ny)
			put npc(23,nx--1,ny+20)
			wait(1)
			put npc(25,nx+1,ny)
			put npc(16,nx+1,ny)
			put npc(23,nx+1,ny+20)
			wait(1)
		)
		put npc(25,nx,ny)
		put npc(16,nx,ny)
		put npc(23,nx,ny+20)
		wait(1)
		for(i,1,30,1) do(
			put npc(25,nx,ny+i)
			put npc(16,nx,ny+i)
			put npc(23,nx,ny+20+i)
			wait(1)
		)
		set npc position(25,0,0)
		set npc position(16,0,0)
		set npc position(23,0,0)
		wait(10)
		write pass block(48,18,0)
		write pass block(48,19,0)
		)
	)

	if(num==4) then(
		wait(2)
		set variable(h,hero by slot(pick hero))
		#if player does not pick a hero in a feeble attempt to annoy me
		if(h==0,or,h==1,or,h==2,or,h==3) then(
		if(herox(0)==47,and,heroy(0)==20) then(
			walk hero(0,left,1)
			wait for hero(0)
			walk hero(0,up,1)
			wait for hero(0)
			set hero direction(0,right)
		)
		alter npc(25,NPCstat:movespeed,2)
		alter npc(25,NPCstat:picture,get hero picture(find hero(h)))
		alter npc(25,NPCstat:palette,get hero palette(find hero(h)))
		set variable(h4,h)
		swap out hero(h)
		variable(hpal4)
		if(h==0) then(set variable(hpal4,1))
		if(h==1) then(set variable(hpal4,29))
		if(h==2) then(set variable(hpal4,33))
		if(h==3) then(set variable(hpal4,65))
		set hero palette(findhero(h),hpal4)
		lock hero(h)
		set npc position(25,herox(0),heroy(0))
		walk npc to x(25,47)
		wait for npc(25)
		walk npc to y(25,19)
		wait for npc(25)
		set npc direction(25,down)

		set variable(nx,npc pixel x(25))
		set variable(ny,npc pixel y(25))
		write pass block(47,20,128)
		write pass block(47,21,128)
		for(i,1,5,1) do(
			put npc(25,nx--1,ny)
			put npc(17,nx--1,ny)
			put npc(24,nx--1,ny+20)
			wait(1)
			put npc(25,nx+1,ny)
			put npc(17,nx+1,ny)
			put npc(24,nx+1,ny+20)
			wait(1)
		)
		put npc(25,nx,ny)
		put npc(17,nx,ny)
		put npc(24,nx,ny+20)
		wait(1)
		for(i,1,30,1) do(
			put npc(25,nx,ny+i)
			put npc(17,nx,ny+i)
			put npc(24,nx,ny+20+i)
			wait(1)
		)
		set npc position(25,0,0)
		set npc position(17,0,0)
		set npc position(24,0,0)
		wait(10)
		write pass block(47,20,0)
		write pass block(47,21,1+2+4+8)
		)
	)
)

else(
	wait(2)
	variable(hpal5)
	if(find hero(0)<<4) then(
		set variable(h,0)
		set variable(hpal5,1)
	)
	if(find hero(1)<<4) then(
		set variable(h,1)
		set variable(hpal5,29)
	)
	if(find hero(2)<<4) then(
		set variable(h,2)
		set variable(hpal5,33)
	)
	if(find hero(3)<<4) then(
		set variable(h,3)
		set variable(hpal5,65)
	)

	alter npc(25,NPCstat:movespeed,2)
	alter npc(25,NPCstat:picture,get hero picture(find hero(h)))
	alter npc(25,NPCstat:palette,get hero palette(find hero(h)))

	variable(platform)

	if(num==1) then(
		walk hero to x(0,42)
		wait for hero(0)
		walk hero to y(0,17)
		wait for hero(0)
		set variable(h1,h)
		set variable(platform,14)
	)
	if(num==2) then(
		walk hero to x(0,43)
		wait for hero(0)
		walk hero to y(0,19)
		wait for hero(0)
		set variable(h2,h)
		set variable(platform,15)
	)
	if(num==3) then(
		walk hero to x(0,48)
		wait for hero(0)
		walk hero to y(0,17)
		wait for hero(0)
		set variable(h3,h)
		set variable(platform,16)
	)
	if(num==4) then(
		walk hero to x(0,47)
		wait for hero(0)
		walk hero to y(0,19)
		wait for hero(0)
		set variable(h4,h)
		set variable(platform,17)
	)

	set hero direction(0,down)

	set variable(nx,hero pixel x(0))
	set variable(ny,hero pixel y(0))
	write pass block(nx/20,(ny/20)+1,128)
	write pass block(nx/20,(ny/20)+2,128)
	for(i,1,5,1) do(
		put hero(0,nx--1,ny)
		put npc(platform,nx--1,ny)
		put npc(platform+7,nx--1,ny+20)
		wait(1)
		put hero(0,nx+1,ny)
		put npc(platform,nx+1,ny)
		put npc(platform+7,nx+1,ny+20)
		wait(1)
	)
	put hero(0,nx,ny)
	put npc(platform,nx,ny)
	put npc(platform+7,nx,ny+20)
	wait(1)
	for(i,1,40,1) do(
		put hero(0,nx,ny+i)
		put npc(platform,nx,ny+i)
		put npc(platform+7,nx,ny+20+i)
		wait(1)
	)
	set hero position(0,0,0)
	set npc position(platform,0,0)
	set npc position(platform+7,0,0)
	wait(10)
	write pass block(nx/20,(ny/20)+1,0)
	write pass block(nx/20,(ny/20)+2,0)

	stop song
	wait(10)
	palout(15)

	#setting last hero palette
	if(hpal5==1) then(set hero palette(find hero(0),1))
	if(hpal5==29) then(set hero palette(find hero(1),29))
	if(hpal5==33) then(set hero palette(find hero(2),33))
	if(hpal5==65) then(set hero palette(find hero(3),65))

	wait(1)
	camera follows hero(0)
	teleport to map(91,45,6)
	stop song
	if(check tag(199)==false) then(
		set tag(3,0)
		set tag(4,1)
		set tag(5,0)
		set tag(6,0)
		set variable(hour,noontime))
	wait(1)
	#load tileset(100+poff)
	pan camera(south,0,0)
	set hero position(0,45,8)
	unlock hero(h3)
	swap in hero(h3)
	swap out hero(h1)
	lock hero(h1)
	swap out hero(h2)
	lock hero(h2)
	swap out hero(h4)
	lock hero(h4)
	swap by position(find hero(h3),1)
	wait(1)
	set hero direction(0,down)
	wait(10)
	play song(79)
	palin(15)
)

resume npc walls
resume hero walls
resume obstruction
resume player
end
###

################################
script, dartconfrontation, begin
suspend player
suspend npcs
suspend obstruction

set tag(198,0)

if(check tag(199)) then(dcjaded)
else(dcnonjaded)

endactfour

dreamsequencefinal

resume obstruction
resume npcs
resume player
end
###

#########################
script, dcnonjaded, begin

dcnonjaded1
dcnonjaded2
dcnonjaded3
dcnonjaded4

end
###
##########################
script, dcnonjaded1, begin
variable(i)
variable(dog)
variable(jo)

for(i,0,3,1) do(
if(h1==i) then(
alter npc(1,NPCstat:picture,get hero picture(find hero(i)))
alter npc(1,NPCstat:palette,get hero palette(find hero(i)))
if(i==0) then(set variable(dog,1))
if(i==2) then(set variable(jo,1))
))
for(i,0,3,1) do(
if(h2==i) then(
alter npc(2,NPCstat:picture,get hero picture(find hero(i)))
alter npc(2,NPCstat:palette,get hero palette(find hero(i)))
if(i==0) then(set variable(dog,2))
if(i==2) then(set variable(jo,2))
))
for(i,0,3,1) do(
if(h3==i) then(
alter npc(3,NPCstat:picture,get hero picture(find hero(i)))
alter npc(3,NPCstat:palette,get hero palette(find hero(i)))
if(i==0) then(set variable(dog,3))
if(i==2) then(set variable(jo,3))
))
for(i,0,3,1) do(
if(findhero(i)<<4) then(
alter npc(6,NPCstat:picture,get hero picture(find hero(i)))
alter npc(6,NPCstat:palette,get hero palette(find hero(i)))
if(i==0) then(set variable(dog,6))
if(i==2) then(set variable(jo,6))
))

set npc position(1,38,31)
set npc position(2,45,39)
set npc position(3,45,25)
set npc position(6,54,31)

alter npc(5,NPCstat:palette,45+poff)

pan camera (left,18,10)
alter npc(1,NPCstat:movespeed,5)
alter npc(2,NPCstat:movespeed,5)
alter npc(3,NPCstat:movespeed,5)
alter npc(6,NPCstat:movespeed,5)
wait for camera

wait(15)
walk npc(3,down,4)
walk npc(1,right,5)
walk npc(2,up,6)
walk npc(6,left,7)
wait for npc(3)
wait for npc(1)
wait for npc(2)
wait for npc(6)

wait(30)
set npc direction(5,down)
wait(3)
set npc direction(5,up)
wait(6)
set npc direction(5,down)
wait(8)
set npc direction(5,up)
wait(3)
set npc direction(5,down)
wait(10)
set npc direction(5,right)
wait(15)
set npc direction(5,down)
wait(3)
set npc direction(5,left)
wait(15)
play song(59)
tb(3391)
tb(3392)
jig npc(dog)
tb(3393)
wait(5)
set npc direction(5,down)
tb(3394)
jig npc(dog)
tb(3395)
wait(3)
jig npc(5)
tb(3396)
wait(5)
set npc direction(5,right)
tb(3397)
tb(3398)
jig npc(dog)
tb(3399)
wait(15)
jig npc(5)
set npc direction(5,down)
tb(3400)
wait(3)
jig npc(5)
tb(3401)
tb(3402)
jig npc(jo)
tb(3403)
wait(3)
set npc direction(5,left)
jig npc(5)
tb(3404)
alter npc(dog,NPCstat:picture,374)
jig npc(dog)
tb(3405)

alter npc(5,NPCstat:picture,15)
if(npcx(dog)==43) then(set npc direction(5,left))
if(npcy(dog)==29) then(set npc direction(5,up))
if(npcy(dog)==33) then(set npc direction(5,down))
if(npcx(dog)==47) then(set npc direction(5,right))

play song(64)
show text box(3406)
jig npc(5)
wait for text box
tb(3407)
alter npc(5,NPCstat:picture,436)
set npc direction(5,down)
jig npc(5)
tb(3408)
wait(3)
if(npcx(dog)==43) then(set npc direction(5,left))
if(npcy(dog)==29) then(set npc direction(5,up))
if(npcy(dog)==33) then(set npc direction(5,down))
if(npcx(dog)==47) then(set npc direction(5,right))
set npc frame(5,1)
wait(3)
tb(3409)
wait(4)
set npc frame(5,0)
wait(4)
tb(3410)
wait(5)
jig npc(dog)
tb(3411)
wait(5)
jig npc(5)
tb(3412)
play song(8)
end
###
##########################
script, dcnonjaded2, begin
battleflash(1)
fade screen out(63,63,63)

unlock hero(h1)
unlock hero(h2)
unlock hero(h3)
set party in
set hero position(0,47,31)
set npc position(1,48,30)
set npc position(2,48,31)
set npc position(3,48,32)
set npc position(5,44,31)
alter npc(6,NPCstat:picture,374)
alter npc(6,NPCstat:palette,get hero palette(find hero(0)))
alter npc(1,NPCstat:picture,get hero picture(find hero(1)))
alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
alter npc(2,NPCstat:picture,get hero picture(find hero(2)))
alter npc(2,NPCstat:palette,get hero palette(find hero(2)))
alter npc(3,NPCstat:picture,get hero picture(find hero(3)))
alter npc(3,NPCstat:palette,get hero palette(find hero(3)))
alter npc(5,NPCstat:picture,15)
set npc direction(6,left)
set npc direction(1,left)
set npc direction(2,left)
set npc direction(3,left)
set npc direction(5,right)

wait(1)
ff(569)

#palout(1)
variable(hpic)
set variable(hpic,get hero picture(0))
set hero picture(0,0)
set npc position(1,30,54)
set npc position(2,30,55)
set npc position(3,30,56)
set npc position(5,27,55)
set npc position(6,29,55)
camera follows hero(0)
set hero position(0,27,54)
load tileset(107)
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
resume npcs
play song(65)
set hero picture(0,hpic)
#palin(1)

set tag(200,1)
resume npcs
set party out
swap by position(find hero(0),0)
end
###
##########################
script, dcnonjaded3, begin
walk npc(5,left,1)
set npc direction(5,right)
show text box(3413)
wait for npc(5)
set npc frame(5,0)
wait for text box
alter npc(1,NPCstat:movespeed,5)
alter npc(2,NPCstat:movespeed,5)
alter npc(3,NPCstat:movespeed,5)
alter npc(6,NPCstat:movespeed,5)
walk npc(2,right,2)
wait for npc(2)
set npc direction(2,down)
wait(2)
set npc direction(2,left)
jig npc(2)
show text box(3414)
wait(2)
set npc direction(1,down)
set npc direction(3,up)
wait(2)
set npc direction(3,right)
wait for text box
walk npc(2,right,2)
walk npc(3,up,1)
wait for npc(3)
walk npc(3,right,4)
wait(3)
set npc direction(1,left)
wait(3)
walk npc(1,left,3)
wait for npc(1)
walk npc(1,down,1)
wait for npc(1)
set npc direction(1,left)
jig npc(1)
tb(3415)
wait(3)
jig npc(5)
tb(3416)
set npc frame(5,1)
wait(3)
set npc frame(1,1)
wait(5)
set npc frame(5,0)
wait(3)
set npc frame(1,0)
tb(3417)
walk npc(1,down,1)
wait for npc(1)
walk npc(1,right,4)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
wait(3)
set npc direction(1,left)
jig npc(1)
tb(3418)
alter npc(5,NPCstat:picture,436)
set npc direction(5,down)
wait(4)
jig npc(5)
set npc direction(5,left)
tb(3419)
jig npc(1)
show text box(3420)
set npc direction(1,down)
wait(3)
walk npc(1,right,3)
wait for npc(1)
wait for text box
wait(2)
set npc direction(5,down)
wait(2)
alter npc(5,NPCstat:picture,15)
walk npc(5,right,1)
show text box(3421)
wait for npc(5)
set npc frame(5,0)
wait for text box
jig npc(5)
tb(3422)
walk npc(5,right,1)
show text box(3423)
wait for npc(5)
set npc frame(5,0)
jig npc(5)
wait for text box
jig npc(6)
tb(3424)
wait(2)
jig npc(5)
show text box(3425)
alter npc(5,NPCstat:picture,440)
jig npc(5)
wait for text box
jig npc(6)
tb(3426)
tb(3427)
set npc direction(6,down)
wait(3)
walk npc(6,right,2)
wait for npc(6)
alter npc(6,NPCstat:picture,376)
set npc frame(6,1)
show text box(3428)
wait(3)
set npc direction(5,down)
wait for text box
alter npc(6,NPCstat:picture,374)
set npc frame(6,0)
walk npc(6,right,3)
wait(4)
set npc frame(5,1)
wait for npc(6)
wait(20)
tb(3429)
play song(17)

palout(15)
set tag(200,0)
load tileset(100)
suspend npcs
camera follows hero(0)
set hero position(0,63,30)
wait(1)
pan camera(south,0,0)
set hero position(0,54,31)
set npc position(1,79,31)
set npc position(2,81,31)
set npc position(3,80,30)
set npc direction(1,left)
set npc direction(2,down)
set npc direction(3,down)
alter npc(1,NPCstat:picture,382)
set hero picture(0,230)
suspend npc walls
wait(15)
palin(2)

variable(j)
for(j,1,18,1) do(
walk hero(0,right,1)
wait for hero(0)
walk npc(npc at spot(herox(0),heroy(0)),down,5)
walk npc(npc at spot(herox(0),heroy(0)+1),down,5)
)
end
###
##########################
script, dcnonjaded4, begin
stop song
pan camera(right,18,10)
walk hero(0,right,4)
wait for hero(0)
walk hero(0,right,1)
walk npc(1,left,1)
set npc direction(2,left)
wait(3)
set npc direction(3,left)
wait for npc(1)
wait for hero(0)
wait for camera
jig npc(1)
play song(97)
tb(3430)
set hero picture(378)
wait(2)
jig hero(0)
set hero picture(379)
tb(3431)
wait(8)
jig npc(2)
tb(3432)
jig npc(3)
tb(3433)
set hero picture(0,230)
jig hero(0)
tb(3434)
wait(15)
set npc direction(2,down)
wait(25)
jig npc(2)
show text box(3435)
wait(3)
set npc direction(2,left)
wait for text box
set npc direction(1,down)
wait(2)
set npc direction(3,down)
wait(2)
set npc direction(1,right)
wait(10)
jig npc(2)
tb(3436)
alter npc(1,NPCstat:picture,390)
set npc direction(1,up)
wait(3)
jig npc(1)
show text box(3437)
wait(2)
set npc direction(1,left)
wait(2)
jig npc(1)
wait for text box
wait(15)
jig npc(2)
tb(3438)
wait(5)
jig hero(0)
tb(3439)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(2))
set variable(ny,npc pixel y(2))
put npc(2,nx,ny--2)
wait(3)
put npc(2,nx,ny)
jig npc(2)
tb(3440)
wait(2)
jig npc(1)
set npc direction(1,up)
wait(3)
set npc direction(1,right)
tb(3441)
jig npc(2)
tb(3442)
wait(2)
alter npc(1,NPCstat:picture,233)
set npc direction(1,right)
jig npc(1)
tb(3443)
wait(2)
jig npc(2)
jig npc(2)
show text box(3444)
wait(2)
alter npc(1,NPCstat:picture,383)
set npc direction(1,down)
set npc frame(1,1)
wait for text box
alter npc(1,NPCstat:picture,386)
wait(2)
alter npc(1,NPCstat:picture,383)
wait(2)
alter npc(1,NPCstat:picture,386)
wait(2)
alter npc(1,NPCstat:picture,383)
wait(2)
alter npc(1,NPCstat:picture,386)
wait(2)
alter npc(1,NPCstat:picture,383)
wait(2)
stop song
show text box(3445)
wait(3)
alter npc(2,NPCstat:picture,389)
set npc direction(2,right)
wait for text box
jig npc(2)
jig npc(2)
play song(84)
tb(3446)
alter npc(1,NPCstat:picture,382)
set npc direction(1,right)
jig npc(1)
show text box(3447)
alter npc(1,NPCstat:movespeed,10)
alter npc(2,NPCstat:movespeed,10)
wait for text box
alter npc(2,NPCstat:picture,235)
set npc direction(2,down)
walk npc(2,down,1)
walk npc(1,right,1)
wait for npc(2)
alter npc(2,NPCstat:movespeed,4)
walk npc(2,down,5)
set npc direction(2,up)
wait for npc(1)
walk npc(1,right,2)
wait for npc(1)
set hero direction(0,down)
walk npc(1,down,1)
wait for npc(1)
alter npc(1,NPCstat:movespeed,4)
walk npc(1,down,5)
set npc direction(1,up)
wait(4)
walk npc(3,down,1)
wait for npc(3)
wait for npc(1)
wait(40)
set hero direction(0,right)
set npc direction(3,left)
wait(20)
resume npc walls
end
###

######################
script, dcjaded, begin

dcjaded1
dcjaded2
dcjaded3

end
###
#######################
script, dcjaded1, begin
variable(i)
variable(dog)
variable(mi)

for(i,0,3,1) do(
	if(h1==i) then(
		alter npc(1,NPCstat:picture,get hero picture(find hero(i)))
		alter npc(1,NPCstat:palette,get hero palette(find hero(i)))
		if(i==0) then(set variable(dog,1))
		if(i==1) then(set variable(mi,1))
	)
)
for(i,0,3,1) do(
	if(h2==i) then(
		alter npc(2,NPCstat:picture,get hero picture(find hero(i)))
		alter npc(2,NPCstat:palette,get hero palette(find hero(i)))
		if(i==0) then(set variable(dog,2))
		if(i==1) then(set variable(mi,2))
	)
)
for(i,0,3,1) do(
	if(h3==i) then(
		alter npc(3,NPCstat:picture,get hero picture(find hero(i)))
		alter npc(3,NPCstat:palette,get hero palette(find hero(i)))
		if(i==0) then(set variable(dog,3))
		if(i==1) then(set variable(mi,3))
	)
)
for(i,0,3,1) do(
	if(findhero(i)<<4) then(
		alter npc(6,NPCstat:picture,get hero picture(find hero(i)))
		alter npc(6,NPCstat:palette,get hero palette(find hero(i)))
		if(i==0) then(set variable(dog,6))
		if(i==1) then(set variable(mi,6))
	)
)

stop song

set npc position(1,38,31)
set npc position(2,45,39)
set npc position(3,45,25)
set npc position(6,54,31)

alter npc(5,NPCstat:palette,45+poff)

pan camera (left,18,10)
alter npc(1,NPCstat:movespeed,5)
alter npc(2,NPCstat:movespeed,5)
alter npc(3,NPCstat:movespeed,5)
alter npc(6,NPCstat:movespeed,5)
wait for camera

wait(15)
walk npc(3,down,4)
walk npc(1,right,5)
walk npc(2,up,6)
walk npc(6,left,7)
wait for npc(3)
wait for npc(1)
wait for npc(2)
wait for npc(6)

wait(45)
jig npc(dog)
tb(3452)
wait(25)
tb(3453)
wait(5)
jig npc(mi)
tb(3454)
wait(3)
set npc direction(5,down)
play song(15)
tb(3455)
end
###

#######################
script, dcjaded2, begin

dcjaded2A

ff(573)

dcjaded2B

end
###

########################
script, dcjaded2A, begin
battleflash(1)
fade screen out(63,63,63)
set hero position(0,47,31)
unlock hero(h1)
unlock hero(h2)
unlock hero(h3)
set party in
set npc position(6,0,0)
set npc position(1,48,30)
set npc position(2,49,31)
set npc position(3,48,32)
set npc position(5,45,31)
set hero picture(0,374)
alter npc(1,NPCstat:picture,get hero picture(find hero(1)))
alter npc(1,NPCstat:palette,get hero palette(find hero(1)))
alter npc(2,NPCstat:picture,get hero picture(find hero(2)))
alter npc(2,NPCstat:palette,get hero palette(find hero(2)))
alter npc(3,NPCstat:picture,get hero picture(find hero(3)))
alter npc(3,NPCstat:palette,get hero palette(find hero(3)))
alter npc(5,NPCstat:picture,15)
set hero direction(0,left)
set npc direction(1,left)
set npc direction(2,left)
set npc direction(3,left)
set npc direction(5,right)
resume npcs
wait(1)
end
###

########################
script, dcjaded2B, begin
stop song
#load tileset(100+poff)
set tag(200,1)
resume npcs
set party out
swap by position(find hero(0),0)

alter npc(5,NPCstat:movespeed,2)
walk npc(5,left,2)
set npc direction(5,right)
wait for npc(5)
set npc frame(5,0)
jig npc(5)
play song(64)
tb(3456)
alter npc(5,NPCstat:movespeed,5)
set npc direction(5,down)
wait(3)
walk npc(5,left,2)
wait for npc(5)
set npc direction(5,down)
wait(3)
alter npc(5,NPCstat:picture,444)
wait(5)
walk npc(2,left,1)
wait for npc(2)
set npc frame(2,0)
jig npc(2)
tb(3457)
jig npc(1)
tb(3458)
jig hero(0)
set hero picture(0,443)
set hero direction(0,down)
tb(3459)
set npc direction(1,down)
jig npc(1)
tb(3460)
variable(cx)
variable(cy)
set variable(cx, camera pixel x)
set variable(cy, camera pixel y)
play song(65)
show text box(3461)
put camera(cx+2,cy)
wait(2)
put camera(cx--2,cy)
wait(2)
put camera(cx+2,cy)
wait(2)
put camera(cx--2,cy)
wait(2)
set npc direction(3,up)
put camera(cx,cy)
wait for text box
wait(3)
walk npc(3,right,1)
wait for npc(3)
set npc direction(3,up)
jig npc(3)
show text box(3462)
wait(3)
set npc direction(2,down)
wait for text box
walk npc(2,right,2)
wait(3)
set npc direction(1,left)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait(3)
set npc direction(2,left)
wait(10)
set npc direction(1,down)
wait(3)
walk npc(1,right,1)
set npc direction(3,left)
wait for npc(1)
set npc direction(1,down)
wait(3)
set npc direction(1,left)
wait(45)
jig npc(5)
set npc direction(5,up)
create npc(5,42,31,left)
tb(3463)
tb(3464)
wait(20)
set npc direction(5,down)
destroy npc(npc at spot(42,31))
wait(15)
tb(3465)
tb(3466)
wait(6)
jig hero(0)
tb(3467)
tb(3468)
stop song
end
###

#######################
script, dcjaded3, begin
set hero speed(0,10)
alter npc(5,NPCstat:movespeed,10)
alter npc(5,NPCstat:picture,444)
walk npc(5,right,3)
walk hero(0,left,3)
wait for hero(0)
tweak palette(63,63,63)
update palette
variable(hx)
variable(hy)
variable(nx)
variable(ny)
set variable(hx, hero pixel x(0))
set variable(hy, hero pixel y(0))
set variable(nx, npc pixel x(5))
set variable(ny, npc pixel y(5))
put hero(0,hx--5,hy)
put npc(5,nx+5,ny)
wait(5)
reset palette
tweak palette(20,20,20)
update palette
wait(6)
put hero(0,hx--6,hy)
wait(3)
put npc(5,nx+6,ny)
wait(6)
put hero(0,hx--7,hy)
wait(3)
put npc(5,nx+7,ny)
reset palette
tweak palette(10,10,10)
update palette
wait(6)
put hero(0,hx--8,hy)
wait(3)
put npc(5,nx+8,ny)
wait(6)
put hero(0,hx--9,hy)
wait(3)
put npc(5,nx+9,ny)
reset palette
tweak palette(10,10,10)
update palette
wait(6)
put hero(0,hx--10,hy)
wait(3)
put npc(5,nx+10,ny)
wait(6)
put hero(0,hx--11,hy)
wait(3)
put npc(5,nx+11,ny)
wait(6)
palout(5)
put hero(0,hx,hy)
put npc(5,nx,ny)
wait(1)
set hero position(0,42,31)
set hero direction(0,down)
set npc position(5,46,31)
set npc direction(5,down)
set hero frame(0,0)
set npc frame(5,0)
wait(10)
palin(1)

wait(70)
set variable(hx, hero pixel x(0))
set variable(hy, hero pixel y(0))
set variable(nx, npc pixel x(5))
set variable(ny, npc pixel y(5))
play song(8)
put hero(0,hx+1,hy)
wait(2)
put hero(0,hx--1,hy)
wait(2)
put hero(0,hx+1,hy)
wait(2)
put hero(0,hx--1,hy)
wait(2)
put hero(0,hx,hy)
walk npc(1,left,1)
show text box(3469)
wait for npc(1)
set npc frame(1,0)
wait for text box

wait(30)
jig npc(5)
tb(3470)
wait(15)
jig hero(0)
tb(3471)
wait(25)
jig npc(5)
wait(4)
jig npc(5)
wait(10)
tb(3472)
wait(5)
jig hero(0)
tb(3473)
tb(3474)
wait(20)
jig hero(0)
tb(3475)
set hero picture(0,374)
set hero direction(0,left)
set hero frame(0,1)
wait(3)
set hero frame(0,0)
wait(30)
set hero direction(0,up)
wait(4)
set hero direction(0,right)
wait(10)
jig hero(0)
tb(3476)
stop song

wait(20)
put npc(5,nx+1,ny)
wait(2)
put npc(5,nx--1,ny)
wait(2)
put npc(5,nx+1,ny)
wait(2)
put npc(5,nx--1,ny)
wait(2)
put npc(5,nx,ny)
alter npc(5,NPCstat:picture,445)
wait(10)
set npc direction(5,right)
wait(5)
jig npc(5)
wait(2)
jig npc(5)
set npc direction(5,up)
jig npc(5)
wait(40)
variable(i)
for(i,1,4,1) do(
alter npc(5,NPCstat:picture,0)
wait(1)
alter npc(5,NPCstat:picture,445)
wait(1)
)
for(i,1,2,1) do(
alter npc(5,NPCstat:picture,0)
wait(2)
alter npc(5,NPCstat:picture,445)
wait(2)
)
set npc direction(5,left)
alter npc(5,NPCstat:palette,141)

walk npc(1,left,5)
wait for npc(1)
walk npc(1,down,1)
wait for npc(1)
set npc direction(1,left)
set npc frame(1,0)
jig npc(1)
play song(97)
tb(3477)
set hero picture(0,378)
set hero frame(0,1)
wait(10)
set hero picture(0,230)
set hero frame(0,0)
wait(3)
tb(3478)

alter npc(2,NPCstat:movespeed,2)
walk npc(2,left,3)
wait for npc(2)
set npc frame(2,0)
wait(10)
set npc frame(2,1)
wait(4)
set npc position(5,0,0)
set npc frame(2,0)
tb(3479)
wait(10)
jig npc(2)
show text box(3480)
wait(2)
set npc direction(1,down)
wait(3)
set npc direction(1,right)
wait for text box
jig hero(0)
tb(3481)
wait(3)
jig npc(2)
tb(3482)
jig hero(0)
tb(3483)

alter npc(2,NPCstat:movespeed,4)
set hero speed(0,4)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,right,5)
wait(5)
set npc direction(2,down)
wait(3)
walk npc(2,right,5)
wait for hero(0)
walk hero(0,up,1)
walk npc(1,right,5)
wait for hero(0)
walk hero(0,right,5)
wait for npc(1)
set npc frame(1,0)
alter npc(1,NPCstat:picture,381)
wait(20)
set npc direction(1,down)
wait(4)
set npc direction(1,left)
wait(30)
alter npc(3,NPCstat:movespeed,2)
walk npc(3,up,1)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait for hero(0)

jig npc(3)
tb(3484)
wait(4)
jig npc(1)
show text box(3485)
wait(10)
set npc direction(1,down)
wait(3)
set npc direction(1,right)
wait for text box
wait(15)
jig npc(3)
tb(3486)
end
###

#########################
script, endactfour, begin
palout(5)
camera follows hero(0)
teleport to map(73+poff,121,10)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
set npc position(6,119,10)
wait(25)
walk npc(6,right,4)
wait(3)
play song(17)
palin(15)
wait for npc(6)
wait(15)
set npc direction(6,down)
wait(3)
set npc direction(6,left)
wait(5)
walk npc(6,left,4)
wait for npc(6)
wait(20)

set hero position(0,121,6)
walk hero(0,down,4)
wait(6)
set npc direction(6,right)
play song(92)
jig npc(6)
show text box(3487)
wait for hero(0)

set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,right,2)
walk npc(3,up,1)
walk npc(2,down,1)
set hero direction(0,left)
wait for npc(3)
walk npc(3,right,1)
wait for npc(2)
walk npc(2,right,1)
wait for npc(1)
set npc direction(1,down)
set npc frame(1,0)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,down)
wait(2)
set npc direction(1,left)
wait(2)
set npc direction(2,left)
wait(2)
set npc direction(3,left)
wait for text box
jig hero(0)
tb(3488)
jig npc(6)
tb(3489)
wait(4)
tb(3490)
wait(15)
jig npc(6)
tb(3491)
wait(3)
alter npc(1,NPCstat:picture,390)
set npc direction(1,up)
wait(4)
set npc direction(1,right)
wait(5)
jig hero(0)
tb(3492)
wait(3)
jig npc(2)
tb(3493)
wait(3)
jig npc(3)
tb(3494)
wait(3)
set npc direction(1,up)
wait(4)
jig npc(1)
set npc direction(1,left)
tb(3495)
jig npc(2)
tb(3496)
wait(20)
jig hero(0)
tb(3497)
wait(4)
jig npc(6)
set npc direction(6,down)
tb(3498)
wait(3)
jig npc(2)
tb(3499)
wait(2)
set npc direction(6,right)
jig npc(6)
tb(3500)
wait(4)
jig npc(2)
tb(3501)
jig npc(6)
jig npc(6)
tb(3502)
wait(5)
play song(17)

#palout(1)
add hero(10)
lock hero(10)
#wait(1)
#palin(1)

stop song
jig npc(6)
tb(3503)
wait(3)
jig npc(2)
tb(3504)
wait(5)
jig npc(6)
play song(69)
tb(3505)
alter npc(1,NPCstat:picture,233)
set npc direction(1,left)
jig npc(1)
tb(3506)
wait(3)
set npc direction(2,up)
wait(7)
jig npc(2)
show text box(3507)
wait(3)
set npc direction(3,down)
wait for text box
wait(10)
set hero direction(0,down)
wait(20)
jig hero(0)
tb(3508)
jig npc(3)
tb(3509)
wait(3)
set hero direction(0,right)
wait(3)
jig hero(0)
show text box(3510)
wait(2)
alter npc(1,NPCstat:picture,381)
wait for text box
wait(5)
jig npc(2)
tb(3511)
wait(2)
alter npc(1,NPCstat:picture,386)
jig npc(1)
wait(2)
alter npc(1,NPCstat:picture,388)
tb(3512)
wait(7)
jig npc(3)
tb(3513)
tb(3514)
wait(5)
jig npc(3)
tb(3515)
wait(3)
alter npc(1,NPCstat:picture,386)
jig npc(1)
wait(2)
alter npc(1,NPCstat:picture,387)
tb(3516)
jig hero(0)
show text box(3517)
alter npc(1,NPCstat:picture,386)
wait for text box
wait(8)
jig npc(6)
show text box(3518)
wait(2)
set hero direction(0,down)
set npc direction(2,left)
wait(2)
set hero direction(0,left)
set npc direction(3,left)
wait for text box
wait(8)
jig npc(6)
tb(3519)
wait(5)
jig hero(0)
stop song
tb(3520)

set tag(202,1)
wait(10)
end
###

#################################
script, dreamsequencefinal, begin
palout(10)
wait(40)

variable(k)
for(k,103,114,1) do(
set tag(k,0))

set hero speed(0,hspeed)
set hero frame(0,0)
set tag(8,0)
camera follows hero(0)
teleport to map(89,1,3)
stop song
wait(1)
load tileset(98)
alter NPC(35,NPCstat:script argument,98)
set hero picture(find hero(0),198)
set hero palette(find hero(0),4)
set hero direction(0,down)
set hero frame(0,0)
swap out hero(1)
swap out hero(2)
swap out hero(3)
lock hero(1)
lock hero(2)
lock hero(3)
wait(15)

play song(31)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (10)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (10)
reset palette
greyscale palette
update palette

wait(30)
fade screen out(63,63,63)
reset palette
wait(1)
fade screen in

wait(15)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)
wait(2)
set hero picture(find hero(0),198)
wait(2)
set hero picture(find hero(0),194)

set variable(isrunning,0)
wait(1)

reset palette
tweak palette (-3,-3,0)
update palette
wait (1)
reset palette
tweak palette (-2,-2,0)
update palette
wait (1)
reset palette
tweak palette (-1,-1,0)
update palette
wait (1)
reset palette
update palette
end
###

###########################
script, setkidkatina, begin
suspend player
suspend npcs

palout(2)
set npc position(2,14,46)
set npc direction(2,left)
alter npc(2,NPCstat:displaytext,0)
alter npc(2,NPCstat:move type,NPCmovetype:standstill)
alter npc(2,NPCstat:whenactivated,NPCwhenactivated:donotfaceplayer)
alter npc(2,NPCstat:script,137)
set npc frame(2,0)
set tag(203,1)
wait(1)
palin(2)

resume npcs
resume player
end
###

#############################
script, finalflashback, begin
suspend player
suspend npcs
suspend obstruction

preactfive1
preactfive2
preactfive3
preactfive4
preactfive5

resume obstruction
resume npcs
resume player
end
###
##########################
script, preactfive1, begin
set npc position(1,0,0)
set npc position(3,0,0)
set npc position(4,0,0)
set npc position(5,0,0)
set npc position(6,0,0)
set npc position(7,0,0)

play song(33)

set hero speed(0,2)
walk hero to x(0,15)
wait for hero(0)
walk hero to y(0,46)
wait for hero(0)
set hero direction(0,left)
wait(30)
set npc direction(2,down)
wait(4)
set npc direction(2,right)
jig npc(2)
tb(3536)
wait(4)
show text box(3537)
wait(2)
set npc direction(2,down)
wait(3)
set npc direction(2,left)
wait for text box

suspend npc walls
write pass block(13,48,1+2+4+8)
write pass block(12,42,1+2+4+8)
write pass block(13,43,1+2+4+8)
write pass block(13,44,1+2+4+8)

play song(15)

tweak palette(63,63,63)
update palette
wait(2)
reset palette
update palette
wait(2)

reset palette
tweak palette(5,5,5)
tweak palette(10,0,10)
update palette
wait(5)
reset palette
tweak palette(0,0,0)
tweak palette(10,0,10)
update palette
wait(5)
reset palette
tweak palette(-5,-5,-5)
tweak palette(10,0,10)
update palette
wait(5)
reset palette
tweak palette(-10,-10,-10)
tweak palette(10,0,10)
update palette

wait(5)
set hero direction(0,up)
wait(7)
set hero direction(0,left)
wait(3)
set hero direction(0,down)
wait(7)
set hero direction(0,left)
jig hero(0)
tb(3538)
wait(5)
set npc direction(2,down)
wait(4)
set npc direction(2,right)
wait(10)
jig npc(2)
tb(3539)

tweak palette(63,63,63)
update palette
wait(2)
reset palette
tweak palette(-10,-10,-10)
tweak palette(10,0,10)
update palette
wait(2)
tweak palette(63,63,63)
update palette
wait(2)
reset palette
tweak palette(-10,-10,-10)
tweak palette(10,0,10)
update palette
wait(2)

play song(8)

walk npc(13,right,2)
walk npc(14,right,2)
walk npc(15,up,2)
wait for npc(15)
alter npc(13,NPCstat:movetype,npcmovetype:wander)
alter npc(14,NPCstat:movetype,npcmovetype:wander)
alter npc(15,NPCstat:movetype,npcmovetype:wander)
resume npc walls
resume npcs


set npc direction(2,down)
wait(2)
set npc direction(2,left)
jig npc(2)
tb(3540)
jig hero(0)
show text box(3541)
wait(3)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
set hero picture(0,448)
alter npc(2,NPCstat:picture,448)
alter npc(2,NPCstat:movespeed,4)
set hero speed(0,4)
set npc direction(2,up)
wait(4)
set tag(8,1)
walk hero(0,right,9)
walk npc(2,right,9)
set npc direction(2,up)
wait for text box
wait for hero(0)
wait for npc(2)
set hero position(0,26,44)
set hero direction(0,left)
set hero picture(0,194)
set hero frame(0,0)
set npc position(2,38,45)
alter npc(2,NPCstat:picture,341)
set npc direction(2,up)
set npc frame(2,0)

focus camera(25,45,10)
wait for camera
set hero position(0,39,45)
focus camera(38,45,10)
wait(15)
show backdrop(1)
#tweak palette(63,0,0)
#update palette
wait(2)
reset palette
tweak palette(-10,-10,-10)
tweak palette(10,0,10)
update palette
show map
load tileset(94)
wait(2)
show backdrop(1)
#tweak palette(63,0,0)
#update palette
wait(2)
reset palette
tweak palette(-10,-10,-10)
tweak palette(10,0,10)
update palette
show map
load tileset(94)
wait(15)
show backdrop(1)
#tweak palette(63,0,0)
#update palette
wait(2)
reset palette
tweak palette(-10,-10,-10)
tweak palette(10,0,10)
update palette
show map
load tileset(94)
wait(2)
wait for camera

stop song

wait(20)
jig npc(2)
set npc direction(2,down)
tb(3542)
wait(15)
tb(3543)
tb(3544)
jig npc(2)
show text box(3545)
wait(3)
set npc direction(2,up)
jig npc(2)
jig npc(2)
wait for text box

suspend npcs
suspend npc walls
wait(25)
set npc position(1,49,46)
set npc position(3,51,46)
set npc position(4,48,46)
set npc position(5,50,45)
set npc position(6,49,44)
set npc position(7,49,45)
alter npc(6,NPCstat:palette,154)
alter npc(7,NPCstat:palette,154)
alter npc(1,NPCstat:movespeed,5)
alter npc(3,NPCstat:movespeed,5)
alter npc(4,NPCstat:movespeed,5)
alter npc(5,NPCstat:movespeed,5)
alter npc(6,NPCstat:movespeed,5)
alter npc(7,NPCstat:movespeed,5)
alter npc(1,NPCstat:movetype,npcmovetype:standstill)
alter npc(3,NPCstat:movetype,npcmovetype:standstill)
alter npc(4,NPCstat:movetype,npcmovetype:standstill)
alter npc(5,NPCstat:movetype,npcmovetype:standstill)
wait(1)

tb(3546)

play song(15)

set hero direction(0,down)
wait(2)
set hero direction(0,right)

walk npc(1,left,8)
walk npc(3,left,8)
walk npc(4,left,8)
walk npc(5,left,8)
walk npc(6,left,8)
walk npc(7,left,8)
wait for npc(1)
set npc frame(1,0)
wait for npc(3)
set npc frame(3,0)
wait for npc(4)
set npc frame(4,0)
wait for npc(5)
set npc frame(5,0)
wait for npc(6)
set npc frame(6,0)
wait for npc(7)
set npc frame(7,0)
end
###
##########################
script, preactfive2, begin
wait(5)
write pass block(35,45,1+2+4+8)
write pass block(35,46,1+2+4+8)
write pass block(32,44,1+2+4+8)
write pass block(33,44,1+2+4+8)
write pass block(34,44,1+2+4+8)
write pass block(31,45,1+2+4+8)
write pass block(31,46,1+2+4+8)
write pass block(32,47,1+2+4+8)
set npc position(13,29,46)
set npc position(14,28,46)
set npc position(15,27,46)
walk npc(13,right,5)
walk npc(14,right,5)
walk npc(15,right,5)
wait for npc(15)
resume obstruction
resume npc walls
resume npcs

set hero direction(0,down)
wait(3)
set hero direction(0,left)
wait(5)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
set npc frame(6,0)
set npc frame(7,0)
tb(3547)
wait(4)
suspend npcs
suspend npc walls
suspend obstruction
walk npc(13,right,4)
walk npc(14,right,4)
walk npc(15,right,4)
palout(3)
alter npc(13,NPCstat:movetype,npcmovetype:standstill)
alter npc(14,NPCstat:movetype,npcmovetype:standstill)
alter npc(15,NPCstat:movetype,npcmovetype:standstill)
show backdrop(0)
wait(10)
palin(1)
show backdrop(1)
wait(2)
show backdrop(0)
wait(4)
show backdrop(1)
wait(2)
show backdrop(0)
wait(8)
show backdrop(1)
wait(2)
stop song
show backdrop(0)
palout(1)
suspend box advance
show text box(3548)
wait(20)
palin(2)
wait for key(use key)
palout(2)
show map
advance text box
resume box advance
camera follows hero(0)
set hero position(0,43,17)
load tileset(92)
wait(1)
pan camera(south,0,0)
alter npc(2,NPCstat:picture,102)
set hero palette(0,2)
alter npc(1,NPCstat:palette,30)
alter npc(2,NPCstat:palette,102)
alter npc(3,NPCstat:palette,46)
alter npc(4,NPCstat:palette,106)
alter npc(5,NPCstat:palette,110)
alter npc(6,NPCstat:palette,154)
alter npc(7,NPCstat:palette,154)
set hero position(0,43,17)
set npc position(1,42,19)
set npc position(2,44,17)
set npc position(3,42,17)
set npc position(4,44,18)
set npc position(5,43,18)
set npc position(6,43,15)
set npc position(7,43,16)
set hero direction(0,up)
set npc direction(1,up)
set npc direction(2,up)
set npc direction(3,up)
set npc direction(4,up)
set npc direction(5,up)
set npc direction(6,down)
set npc direction(7,down)
wait(15)
play song(17)
palin(15)

wait(20)
jig npc(5)
tb(3549)
wait(8)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
set npc frame(6,0)
set npc frame(7,0)
tb(3550)
wait(7)
tb(3551)
wait(15)
jig npc(3)
tb(3552)
stop song
wait(5)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
set npc frame(6,0)
set npc frame(7,0)
tb(3553)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(6))
set variable(ny,npc pixel y(6))
wait(10)
set npc direction(6,left)
set npc direction(7,left)
wait(5)
set npc direction(6,up)
set npc direction(7,up)
wait(4)
put npc(6,nx,ny--2)
put npc(7,nx,ny+18)
set npc frame(6,1)
set npc frame(7,1)
wait(3)
put npc(6,nx,ny--4)
put npc(7,nx,ny+16)
set npc frame(6,0)
set npc frame(7,0)
wait(3)
set npc position(6,43,14)
set npc position(7,43,15)
set npc position(8,43,16)
alter npc(6,NPCstat:picture,351)
alter npc(7,NPCstat:picture,351)
alter npc(8,NPCstat:picture,351)
alter npc(8,NPCstat:palette,154)
set npc direction(6,down)
set npc direction(7,right)
set npc direction(8,up)
wait(25)
jig npc(7)
play song(19)
tb(3554)
wait(10)
jig npc(7)
tb(3555)
wait(4)
jig npc(7)
tb(3556)
jig npc(7)
tb(3557)
wait(10)
jig npc(7)
tb(3558)

wait(10)
jig npc(7)
suspend box advance
show text box(3559)
wait for key(use key)
palout(10)
stop song
advance text box
show backdrop(0)
show text box(3560)
wait(10)
palin(2)
wait for key(use key)
palout(2)
advance text box
show text box(3561)
wait(2)
palin(2)
wait for key(use key)
palout(2)
advance text box
show text box(3562)
wait(10)
palin(2)
wait for key(use key)
palout(2)
advance text box
show text box(3563)
wait(5)
palin(2)
wait for key(use key)
palout(2)
advance text box
show text box(3564)
wait(15)
palin(2)
wait for key(use key)
palout(2)
advance text box
resume box advance

show map
camera follows hero(0)
teleport to map(5,5,254)
wait(1)
pan camera(south,0,0)
set hero position(0,6,256)
set hero picture(0,378)
set hero palette(0,1)
set hero frame(0,1)
set hero direction(0,down)
alter npc(1,NPCstat:picture,233)
alter npc(1,NPCstat:palette,29)
set npc position(1,5,256)
set npc direction(1,right)
wait(30)
palin(20)
end
###
##########################
script, preactfive3, begin
wait(60)
jig npc(1)
tb(3565)
play song(32)
wait(10)
jig hero(0)
jig hero(0)
set hero picture(0,379)
jig hero(0)
wait(20)
jig npc(1)
tb(3566)
wait(10)
jig hero(0)
tb(3567)
jig npc(1)
tb(3568)
tb(3569)
wait(2)
set hero picture(0,378)
wait(3)
set hero picture(0,380)
wait(3)
set hero picture(0,373)
set hero direction(0,right)
set hero speed(0,2)
walk hero(0,right,1)
wait for hero(0)
wait(5)
set hero picture(0,378)
set hero frame(0,1)
wait(2)
set hero frame(0,0)
wait(2)
set hero frame(0,1)
wait(2)
set hero frame(0,0)
wait(2)
set hero picture(0,230)
wait(4)
set hero direction(0,down)
wait(3)
set hero direction(0,left)
wait(2)
jig hero(0)
tb(3570)
wait(12)
jig npc(1)
tb(3571)
wait(3)
jig hero(0)
tb(3572)
jig npc(1)
tb(3573)
alter npc(1,NPCstat:movespeed,2)
wait(12)
jig npc(1)
tb(3574)

palout(2)
camera follows hero(0)
set hero position(0,5,236)
wait(1)
pan camera(south,0,0)
set hero position(0,1,231)
alter npc(2,NPCstat:picture,235)
alter npc(2,NPCstat:palette,33)
alter npc(3,NPCstat:picture,236)
alter npc(3,NPCstat:palette,65)
set npc position(2,9,237)
set npc position(3,9,236)
set npc position(4,7,235)
set npc direction(2,left)
set npc direction(3,left)
set npc direction(4,down)
create npc(33,7,237)
create npc(34,7,236)
set npc direction(33,left)
set npc direction(34,up)
wait(10)
palin(2)
end
###
##########################
script, preactfive4, begin
set npc position(1,1,231)
walk hero(0,down,2)
wait for hero(0)
walk hero(0,down,5)
walk npc(1,down,5)
wait for hero(0)
walk hero(0,right,2)
walk npc(1,down,2)
wait for hero(0)
walk hero(0,right,2)
walk npc(1,right,2)
jig npc(4)
set npc direction(4,left)
stop song
show text box(3575)
wait for hero(0)
walk hero(0,up,2)
walk npc(1,right,2)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
wait for npc(1)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for text box

jig npc(2)
tb(3576)
jig npc(1)
play song(82)
tb(3577)
wait(5)
jig npc(3)
show text box(3578)
wait(2)
set npc direction(4,down)
wait for text box
wait(3)
jig hero(0)
tb(3579)
wait(5)
jig npc(3)
tb(3580)
jig npc(1)
tb(3581)
jig npc(2)
tb(3582)
jig hero(0)
tb(3583)
wait(6)
jig npc(3)
tb(3584)
tb(3585)
wait(8)
jig hero(0)
tb(3586)
wait(5)
jig npc(2)
tb(3587)
jig hero(0)
tb(3588)
wait(3)
jig npc(3)
tb(3589)
wait(5)
jig npc(2)
tb(3590)
wait(5)
jig npc(1)
tb(3591)
wait(8)
jig hero(0)
tb(3592)
jig npc(2)
tb(3593)
wait(7)
jig npc(4)
tb(3594)
wait(3)
set npc direction(1,up)
wait(3)
jig npc(1)
show text box(3595)
wait(2)
set hero direction(0,up)
set npc direction(2,up)
wait(2)
set npc direction(3,up)
wait for text box
jig hero(0)
tb(3596)
jig npc(4)
tb(3597)
stop song
tb(3598)

palout(2)
camera follows hero(0)
teleport to map(1,162,79)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,0,0)
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236)
set hero speed(0,4)
wait(1)
palin(7)
end
###
##########################
script, preactfive5, begin
wait(20)
set npc position(3,162,77)
walk npc(3,down,1)
wait for npc(3)
set hero position(0,162,77)
walk npc(3,down,1)
walk hero(0,down,1)
wait for hero(0)
set npc position(1,162,77)
walk npc(3,down,1)
walk hero(0,down,1)
walk npc(1,down,1)
wait for hero(0)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
set npc position(2,162,77)
walk hero(0,left,1)
walk npc(1,down,1)
walk npc(2,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)
set npc direction(3,up)
wait for npc(1)
walk npc(1,right,1)
wait for npc(2)
set npc frame(2,0)
set hero direction(0,right)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait(3)
set npc direction(1,left)

wait(20)
jig npc(2)
tb(3599)
wait(3)
jig hero(0)
suspend box advance
show text box(3600)
wait for key(use key)
palout(2)
advance text box
alter npc(1,NPCstat:picture,0)
camera follows npc(1)
set npc position(1,93,56)
wait(1)
alter npc(1,NPCstat:movespeed,2)
suspend npc walls
#walk npc(1,down,7)
pan camera(down,8,2)
wait(1)
play song(17)
palin(10)
write color (175,0,-111)
write color (175,1,-111)
write color (175,2,-111)
update palette
show text box(3601)
textin(2)
wait for key(usekey)
textout(2)
advance text box
#wait for npc(1)
wait(5)
palout(10)
teleport to map(9,3,0)
stop song

#camera follows npc(1)
#set npc position(1,96,26)
variable(hpic)
set variable(hpic,get hero picture(0,outsidebattle))
set hero picture(0,0)
camera follows hero(0)
set hero position(0,96,26)

#alter npc(1,NPCstat:picture,0)
#alter npc(1,NPCstat:movespeed,2)
#walk npc(1,down,7)
wait(1)
pan camera(south,8,2)
wait(1)
play song(17)
palin(10)
write color (175,0,-111)
write color (175,1,-111)
write color (175,2,-111)
update palette
show text box(3602)
textin(2)
wait for key(usekey)
textout(2)
advance text box
wait(5)
palout(10)
stop song
#wait for npc(1)

#camera follows npc(1)
#set npc position(1,75,128)
camera follows hero(0)
set hero position(0,75,128)

#walk npc(1,left,10)
wait(1)
pan camera(left,10,2)
wait(1)
play song(17)
palin(10)
#wait for npc(1)
wait for camera
#walk npc(1,left,7)
pan camera(left,8,2)
write color (175,0,-111)
write color (175,1,-111)
write color (175,2,-111)
update palette
show text box(3603)
textin(2)
wait for key(usekey)
textout(2)
advance text box
wait(5)
palout(10)
#wait for npc(1)

set hero picture(0,hpic)

teleport to map(1,5,0)
stop song
wait(1)
alter npc(1,NPCstat:picture,0)
alter npc(1,NPCstat:movespeed,2)
camera follows npc(1)
set npc position(1,55,81)
#walk npc(1,left,10)
wait(1)
pan camera(left,10,2)
wait(1)
play song(17)
palin(10)
#wait for npc(1)
wait for camera
#walk npc(1,left,10)
pan camera(left,10,2)
write color (175,0,-111)
write color (175,1,-111)
write color (175,2,-111)
update palette
show text box(3604)
textin(2)
wait for key(usekey)
textout(2)
advance text box
wait(5)
palout(10)
stop song
#wait for npc(1)
resume box advance
camera follows npc(1)
set npc position(1,162,79)
wait(1)
pan camera(south,0,0)
set npc position(1,163,79)
set npc direction(1,left)
set hero position(0,161,79)
set hero direction(0,right)
set npc position(2,162,78)
set npc direction(2,down)
set npc position(3,162,80)
set npc direction(3,up)
alter npc(1,NPCstat:picture,233)
alter npc(1,NPCstat:movespeed,4)
alter npc(2,NPCstat:picture,235)
alter npc(2,NPCstat:movespeed,4)
alter npc(3,NPCstat:picture,236)
alter npc(3,NPCstat:movespeed,4)
set hero picture(0,378)
set hero frame(0,1)
wait(10)
palin(15)

wait(30)
jig npc(1)
tb(3605)
wait(3)
set hero frame(0,0)
wait(2)
set hero picture(0,230)
wait(5)
tb(3606)
wait(3)
jig hero(0)
play song(82)
tb(3607)

walk hero(0,right,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,up,1)
wait for hero(0)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,1,0)
wait for npc(3)
set npc position(3,2,0)
set hero frame(0,0)
set hero direction(0,down)

#determine if the fralin npcs are still alive
if(check tag(277)==false) then(set tag(297,1))

set tag(204,1)
set tag(205,1)
set tag(8,0)
set hero speed(0,hspeed)
unlock hero(1)
unlock hero(2)
unlock hero(3)
set party in
set variable(isrunning,true)
set variable(hour,noontime)
set tag(3,0)
set tag(4,1)
set tag(5,0)
set tag(6,0)
set hp

#now in act 5
actadvance(5)

camera follows hero(0)

#rts place
create npc(33,herox(0)--1,heroy(0))
create npc(33,herox(0)+1,heroy(0))
create npc(33,herox(0),heroy(0)--1)
create npc(33,herox(0),heroy(0)+1)

innrest
resume npc walls
set variable(musicsave,0)
wait(1)
save game
end
###

#########################
script, meetskyler, begin
suspend player
suspend npcs
suspend obstruction

stop song

tb(3608)
wait(3)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
set hero speed(0,2)
wait(5)
pan camera(right,7,4)
walk hero to y(0,81)
wait for hero(0)
walk hero to x(0,18)
wait(10)
create npc(4,25,79,south)
walk npc(4,down,2)
wait for npc(4)
walk npc(4,left,5)

wait for hero(0)
set hero frame(0,0)
wait for npc(4)
set npc frame(4,0)
wait for camera

wait(15)
alter npc(4,NPCstat:movespeed,10)
walk npc(4,left,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
play song(69)
show text box(3609)
walk npc(4,up,1)
wait for npc(4)
walk npc(4,left,1)
wait for npc(4)
set npc direction(4,down)
set npc frame(4,0)
wait(3)
jig npc(4)
walk npc(4,right,1)
wait for npc(4)
walk npc(4,down,2)
wait for npc(4)
walk npc(4,left,1)
set npc direction(4,up)
set npc frame(4,0)
wait(3)
jig npc(4)
walk npc(4,left,1)
wait for npc(4)
walk npc(4,up,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,right)
wait(3)
jig npc(4)
walk npc(4,down,1)
wait for npc(4)
walk npc(4,right,2)
wait for npc(4)
walk npc(4,up,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,left)
wait for text box

set npc direction(4,down)
wait(3)
alter npc(4,NPCstat:movespeed,2)
walk npc(4,right,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,down)
wait(3)
set npc direction(4,left)
wait(7)
jig npc(4)
tb(3610)

alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk npc(1,down,1)
walk npc(2,up,1)
walk npc(3,left,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,down)
wait(3)
set npc direction(3,right)

wait(5)
jig npc(1)
tb(3611)
jig npc(4)
tb(3612)
wait(3)
tb(3613)
wait(15)
jig hero(0)
tb(3614)
wait(4)
jig npc(4)
tb(3615)
wait(3)
tb(3616)
walk npc(4,left,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(3617)
jig npc(1)
tb(3618)
set npc direction(4,down)
jig npc(4)
tb(3619)
walk npc(4,right,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,down)
wait(3)
set npc direction(4,left)
wait(3)
jig npc(4)
tb(3620)
wait(10)
jig npc(2)
tb(3621)
jig npc(4)
tb(3622)
wait(3)
tb(3623)
wait(4)
set npc frame(4,1)
wait(4)
set npc frame(4,0)
tb(3624)
wait(5)
jig hero(0)
tb(3625)

walk npc(1,up,1)
walk npc(2,down,1)
walk npc(3,right,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,0,0)
wait for npc(3)
set npc position(3,0,0)
set hero direction(0,down)
wait(3)
walk hero(0,left,10)
wait(4)
jig npc(4)
show text box(3626)
wait for hero(0)
wait for text box
wait(10)
set npc direction(4,down)
wait(4)
set npc direction(4,right)
wait(3)
walk npc(4,right,1)
wait for npc(4)
set npc frame(4,0)
wait(20)
alter npc(4,NPCstat:movespeed,10)
jig npc(4)
stop song
show text box(3627)
set npc direction(4,down)
wait(2)
walk npc(4,left,13)
wait for text box
wait(10)
palout(5)

set party in
set hero speed(0,hspeed)
camera follows hero(0)
teleport to map (66,86,211)
set pal(night)
wait(1)
pan camera(right,10,20)
wait for camera
pan camera(left,15,10)
wait(5)
walk hero(0,left,5)
palin(5)
wait for camera
set npc position(4,0,0)
wait for hero(0)
camera follows hero

set tag(205,0)
set tag(207,1)

resume obstruction
resume npcs
resume player
end
###

#############################
script, farewellskyler, begin
suspend player
suspend npcs
suspend obstruction

stop song

tb(3628)

play song(68)

set hero speed(0,2)
alter npc(4,NPCstat:movespeed,10)
wait(3)
focus camera(56,202,4)
set hero direction(0,right)
wait(3)
set hero direction(0,down)
walk hero(0,down,3)
set npc position(4,64,208)
walk npc(4,left,5)
wait for npc(4)
walk npc(4,up,3)
wait for npc(4)
walk npc(4,left,3)
wait for npc(4)
walk npc(4,up,2)
wait for npc(4)
set npc frame(4,0)
wait for hero(0)
set hero frame(0,0)
wait for camera

set party out
swap by position(find hero(0),0)
set npc position(5,herox(0),heroy(0))
set npc position(6,herox(0),heroy(0))
set npc position(7,herox(0),heroy(0))
walk npc(5,right,1)
walk npc(6,up,1)
walk npc(7,left,1)
wait for npc(5)
set npc frame(5,0)
set npc direction(5,down)
wait for npc(6)
set npc frame(6,0)
set npc direction(6,right)
wait for npc(7)
set npc frame(7,0)
set npc direction(7,down)
wait(3)
set npc direction(6,down)

walk npc(4,up,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
tb(3629)
wait(5)
jig hero(0)
tb(3630)
walk npc(4,right,2)
wait for npc(4)
walk npc(4,up,2)
pan camera(up,2,10)
set hero direction(0,right)
set npc direction(5,right)
set npc direction(3,right)
wait for npc(4)
walk npc(4,left,1)
set npc direction(2,right)
wait for npc(4)
walk npc(4,up,1)
set hero direction(0,up)
set npc direction(5,up)
wait for npc(4)
walk npc(4,left,1)
set npc direction(6,up)
set npc direction(7,up)
wait for npc(4)
walk npc(4,up,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,left)
wait(2)
set npc direction(4,down)
wait for camera

jig npc(4)
tb(3631)
alter npc(5,NPCstat:movespeed,5)
walk npc(5,up,1)
wait for npc(5)
set npc frame(5,0)
jig npc(5)
tb(3632)
wait(4)
jig npc(4)
tb(3633)
jig hero(0)
tb(3634)
wait(4)
jig npc(4)
tb(3635)
jig npc(4)
jig npc(4)
tb(3636)
wait(15)
jig npc(4)
tb(3637)
set hero speed(0,4)
alter npc(6,NPCstat:movespeed,2)
walk hero(0,up,1)
walk npc(6,left,1)
set npc direction(6,right)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
show text box(3638)
wait for npc(6)
set npc frame(6,0)
wait(3)
set npc direction(6,up)
wait(2)
alter npc(7,NPCstat:movespeed,2)
walk npc(7,right,1)
wait for npc(7)
set npc frame(7,0)
set npc direction(7,up)
wait for text box
walk npc(4,down,1)
wait for npc(4)
set npc frame(4,0)
jig npc(4)
jig npc(4)
tb(3639)
wait(4)
jig hero(0)
tb(3640)
wait(3)
tb(3641)
set npc direction(4,left)
wait(2)
walk npc(4,up,1)
wait for npc(4)
set npc frame(4,0)
set npc direction(4,right)
wait(2)
set npc direction(4,down)
jig npc(4)
stop song
tb(3642)
wait(5)
set hero speed(0,1)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
set hero picture(0,375)
wait(5)
show text box(3643)
wait(3)
set hero palette(0,2)
wait(3)
set hero palette(0,1)
wait(2)
set hero palette(0,4)
wait(1)
set hero palette(0,1)
wait(2)
set hero palette(0,2)
wait(3)
set hero palette(0,3)
wait for text box
pan camera(up,1,2)
alter npc(4,NPCstat:movespeed,1)
walk npc(4,up,1)
set npc direction(4,down)
wait for npc(4)
set npc frame(4,0)
wait for camera
tb(3644)
alter npc(4,NPCstat:movespeed,10)
set npc direction(4,left)
wait(2)
walk npc(4,up,10)
wait(5)
pan camera(down,1,2)
wait for camera

wait(25)
jig npc(6)
tb(3645)
set hero direction(0,left)
wait(4)
set hero direction(0,down)
wait(4)
play song(91)
tb(3646)
wait(3)
set hero picture(0,378)
wait(3)
set hero frame(0,1)
wait(6)
tb(3647)
wait(10)
set hero frame(0,0)
wait(3)
set hero picture(0,375)
tb(3648)
wait(12)
set hero picture(0,230)
jig hero(0)
tb(3649)
wait(4)
jig npc(6)
show text box(3650)
wait(3)
set npc direction(6,right)
wait(4)
set npc direction(5,left)
wait for text box
wait(3)
tb(3651)
wait(10)
jig npc(7)
show text box(3652)
wait(3)
set npc direction(7,right)
wait for text box
wait(10)
tb(3653)
wait(4)
set npc direction(7,up)
jig npc(7)
tb(3654)
jig npc(5)
tb(3655)
wait(3)
alter npc(5,NPCstat:picture,386)
wait(4)
alter npc(5,NPCstat:picture,385)
set npc frame(5,1)
wait(15)
tb(3656)
wait(3)
set npc frame(5,0)
alter npc(5,NPCstat:picture,386)
wait(4)
alter npc(5,NPCstat:picture,387)
wait(2)
tb(3657)
wait(5)
pan camera(up,1,1)
set hero direction(0,left)
wait(3)
set hero direction(0,up)
wait(3)
set hero speed(0,2)
walk hero(0,up,1)
set npc direction(6,up)
alter npc(5,NPCstat:picture,233)
set npc direction(5,up)
wait for hero(0)
set hero frame(0,0)
wait for camera
wait(30)
jig hero(0)
tb(3658)
wait(20)
tb(3659)
wait(5)
set hero direction(0,right)
wait(3)
set hero direction(0,down)
wait(10)
jig hero(0)
tb(3660)
wait(5)
jig hero(0)
stop song
tb(3661)

set hero speed(0,4)
alter npc(5,NPCstat:movespeed,4)
alter npc(6,NPCstat:movespeed,4)
alter npc(7,NPCstat:movespeed,4)
focus camera(56,200,2)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,down,1)
walk npc(5,left,1)
walk npc(6,right,1)
walk npc(7,up,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(5)
set npc position(5,0,0)
wait for npc(6)
set npc position(6,0,0)
wait for npc(7)
set npc position(7,0,0)
wait for camera
camera follows hero(0)
set party in
set tag(206,1)
set hero speed(0,hspeed)

play song(88)

resume obstruction
resume npcs
resume player
end
###

#################################
script, beforegrinlowfinal, begin
suspend player
suspend npcs
suspend obstruction

beforegrinlowfinal1
beforegrinlowfinal2
beforegrinlowfinal3

resume obstruction
resume npcs
resume player
end
###
##################################
script, beforegrinlowfinal1, begin
variable(cx)
variable(cy)
set variable(cx,camera pixel x)
set variable(cy,camera pixel y)

play song(15)

variable(i)
for(i,1,20) do(
put camera(cx+random(-1,1),cy+random(-1,1))
wait(1)
)
for(i,1,5) do(
put camera(cx+random(-1,1),cy+random(-1,1))
wait(2)
)
put camera(cx,cy)

jig gahn
tb(3662)

for (i,0,10,1) do, begin
put camera (cx+(random(-5,5)),cy+(random(-5,5)))
wait (1)
end
put camera (cx,cy)

load tileset (66)
write map block (55,130,54)
write map block (56,130,55)
write map block (57,130,56)
write map block (55,131,45)
write map block (56,131,46)
write map block (57,131,47)
write map block (55,132,73)
write map block (56,132,74)
write map block (57,132,75)

wait (25)
for (i,0,10,1) do, begin
put camera (cx+(random(-10,10)),cy+(random(-10,10)))
wait (1)
end
put camera (cx,cy)

write map block (55,130,70)
write map block (56,130,71)
write map block (57,130,72)
write map block (55,131,57)
write map block (56,131,58)
write map block (57,131,59)

wait (25)
for (i,0,30,1) do(
put camera (cx+(random(-10,10)),cy+(random(-10,10)))
wait (1)
)
put camera (cx,cy)

write map block (55,130,38)
write map block (56,130,39)
write map block (57,130,40)
wait(10)

palout(2)
load tileset(108)
camera follows hero(0)
set hero position(0,9,18)
set party out
swap by position(find hero(0),0)
wait(1)
pan camera(south,0,0)
set hero position(0,9,21)
set npc position(5,9,19)
set npc position(6,8,20)
set npc position(7,10,20)
set hero frame(0,0)
set npc frame(5,0)
set npc frame(6,0)
set npc frame(7,0)
set npc direction(5,up)
set npc direction(6,up)
set npc direction(7,up)
set hero speed(0,1)
alter npc(5,NPCstat:movespeed,1)
alter npc(6,NPCstat:movespeed,1)
alter npc(7,NPCstat:movespeed,1)
set hero palette(0,2)
alter npc(5,NPCstat:palette,30)
alter npc(6,NPCstat:palette,34)
alter npc(7,NPCstat:palette,66)
wait(1)
palin(5)
end
###
##################################
script, beforegrinlowfinal2, begin
variable(nn1)
variable(num)
variable(dir1)
variable(dir2)
walk hero(0,down,1)
set hero direction(0,up)
walk npc(5,down,1)
set npc direction(5,up)
walk npc(6,left,1)
walk npc(6,down,1)
set npc direction(6,up)
walk npc(7,right,1)
walk npc(7,down,1)
set npc direction(7,up)
variable(i)
for(i,1,15,1) do(
set variable(nn1,create npc(8,9,16,down))
wait(1)
walk npc(nn1,down,1)
set variable(num,random(1,4))
if(num==1) then(
set variable(dir1,left)
set variable(dir2,up)
)
if(num==2) then(
set variable(dir1,right)
set variable(dir2,up)
)
if(num==3) then(
set variable(dir1,left)
set variable(dir2,down)
)
if(num==4) then(
set variable(dir1,right)
set variable(dir2,down)
)
wait for npc(nn1)
walk npc(nn1,dir1,9)
walk npc(nn1,dir2,random(0,6))
set npc direction(nn1,down)
wait(1)
)

set hero frame(0,0)
set hero picture(0,397)
set hero direction(0,up)
wait(3)
set hero direction(0,right)
wait(2)
set hero direction(0,down)
wait(4)
set hero direction(0,left)
wait(5)
set npc direction(5,left)
set npc frame(5,0)
set npc direction(6,right)
set npc frame(6,0)
wait(3)
set npc direction(5,down)
set npc direction(6,down)
set npc direction(7,left)
set npc frame(7,0)
wait(2)
set npc direction(7,down)

stop song
wait(14)

jig npc(6)
tb(3663)
wait(20)
set hero direction(0,down)
wait(7)
set hero direction(0,right)
wait(3)
tb(3664)
wait(4)
jig npc(5)
tb(3665)
play song(17)
wait(20)
set npc direction(5,right)
wait(3)
set npc direction(5,up)
alter npc(5,NPCstat:picture,383)
wait(30)
set npc direction(7,left)
wait(3)
set npc direction(7,up)
wait(13)
jig npc(7)
tb(3666)
wait(2)
set npc direction(6,right)
wait(2)
jig npc(6)
tb(3667)
wait(5)
set npc direction(7,left)
wait(18)
jig npc(7)
stop song
tb(3668)
play song(91)
tb(3669)
wait(2)
set npc direction(7,up)
wait(3)
jig npc(7)
tb(3670)
wait(3)
tb(3671)
jig npc(7)
tb(3672)
wait(2)
set npc direction(7,left)
#wait(3)
#set npc direction(7,down)
wait(10)
jig npc(7)
tb(3673)
tb(3674)
wait(10)
set npc direction(7,left)
wait(4)
jig npc(7)
tb(3675)
wait(10)
jig npc(6)
tb(3676)
wait(60)
alter npc(5,NPCstat:picture,387)
wait(3)
show text box(3677)
wait(3)
set npc direction(6,up)
wait(2)
set npc direction(7,up)
wait for text box
wait(6)
alter npc(5,NPCstat:picture,383)
wait(3)
tb(3678)
stop song

wait(15)
palout(5)
camera follows hero(0)
set hero position(0,56,10)
load tileset(65)
suspend box advance
wait(1)
play song(17)
palin(15)
textout(1)
show text box(3679)
wait(20)
textin(3)
wait for key(usekey)
textout(3)
advance text box
wait(15)
pan camera(south,40,1)
show text box(3680)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3681)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3682)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box
resume box advance
wait(10)
palout(15)
camera follows hero(0)
set hero position(0,9,18)
load tileset(108)
wait(1)
pan camera(south,0,0)
set hero position(0,9,22)
set hero direction(0,left)
wait(1)
palin(15)
end
###
##################################
script, beforegrinlowfinal3, begin
wait(25)
alter npc(5,NPCstat:picture,233)
set npc direction(5,right)
wait(3)
set npc direction(5,down)
wait(10)
jig npc(5)
stop song
tb(3683)
wait(4)
tb(3684)
wait(7)
walk npc(5,down,1)
wait(2)
set npc direction(6,right)
wait(2)
set npc direction(7,left)
wait for npc(5)
set npc frame(5,0)
wait(15)
jig npc(5)
tb(3685)
wait(5)
set hero direction(0,down)
wait(20)
variable(hx)
variable(hy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
put hero(0,hx--1,hy)
wait(1)
put hero(0,hx+1,hy)
wait(1)
put hero(0,hx--1,hy)
wait(1)
put hero(0,hx+1,hy)
wait(1)
put hero(0,hx,hy)
set hero direction(0,right)
wait(3)
set hero direction(0,up)
wait(30)
set hero picture(0,230)
jig hero(0)
tb(3686)
wait(5)
tb(3687)

palout(15)
camera follows hero(0)
teleport to map (98,45,69)
stop song
wait(1)
pan camera(south,0,0)
set pal(noon)
pan camera (up,3,20)
wait for camera
set hero speed(0,hspeed)
set party in
set hero speed(0,2)
#making npc statues appear
set npc frame(npc at spot(39,45),1)
set npc frame(npc at spot(41,46),1)
set npc frame(npc at spot(49,46),1)
set npc frame(npc at spot(51,45),1)
set npc frame(npc at spot(39,49),1)
set npc frame(npc at spot(41,50),1)
set npc frame(npc at spot(50,50),1)
set npc frame(npc at spot(52,49),1)
set npc frame(npc at spot(49,56),1)
set npc frame(npc at spot(38,55),1)
set npc frame(npc at spot(52,63),1)
set npc frame(npc at spot(51,66),1)
set npc frame(npc at spot(39,61),1)
set npc frame(npc at spot(37,63),1)

#turn off rest and avis
set tag(433,1)
set tag(280,1)

wait(20)
palin(15)

walk hero(0,up,2)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)
set tag(8,0)
save game

play song(79)

end
###

#########################
script, gahntaunts, begin
suspend player
suspend npcs
suspend obstruction

if(heroy(0)==57) then(
relocate npc(2)
jig gahn
tb(3688))
else(
if(heroy(0)==55) then(
relocate npc(1)
jig gahn
tb(3689))
)
do(
if(heroy(0)==54) then(
relocate npc(1)
jig gahn
tb(3690))
)
do(
if(heroy(0)==53) then(
relocate npc(1)
jig gahn
tb(3691))
)
do(
if(heroy(0)==52) then(
relocate npc(1)
jig gahn
tb(3692))
)
do(
if(heroy(0)==51) then(
relocate npc(1)
jig gahn
tb(3693))
)
do(
if(heroy(0)==50) then(
relocate npc(5)
jig gahn2(2)
tb(3694))
)
do(
if(heroy(0)==45) then(
relocate npc(1)
jig gahn2(3)
tb(3695))
)
do(
if(heroy(0)==44) then(
relocate npc(1)
jig gahn2(4)
tb(3696))
)
do(
if(heroy(0)==43) then(
relocate npc(43)
jig gahn
stop song
tb(3697)
play song(57)

wait(3)
walk hero to x(0,45)
wait for hero(0)
set party out
set hero speed(0,4)
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,left,1)
walk npc(1,up,1)
walk npc(2,down,1)
walk npc(3,right,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,right)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,down)
wait(2)
set hero direction(0,right)
set npc direction(1,down)
set npc direction(2,up)
set npc direction(3,left)
wait(20)

jig gahn
wait(10)
jig gahn
wait(5)
jig gahn2(2)
wait(2)
jig gahn2(3)
set hero picture(0,450)
alter npc(3,NPCstat:picture,450)
wait(2)
jig gahn2(4)
wait(10)


variable(i)
for(i,1,6,1) do(
show backdrop(7)
wait(2)
show map
wait(2)
)

variable(hx)
variable(hy)
variable(nx)
variable(ny)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
set variable(nx,npc pixel x(3))
set variable(ny,npc pixel y(3))
for(i,1,7,1) do(
put npc(3,nx+1,ny)
wait(1)
put npc(3,nx--1,ny)
wait(1)
)
for(i,1,2,1) do(
put npc(3,nx+1,ny)
wait(2)
put npc(3,nx--1,ny)
wait(2)
)
put npc(3,nx,ny)
wait(10)
for(i,1,3,1) do(
put hero(0,hx+1,hy)
wait(2)
put hero(0,hx--1,hy)
wait(2)
)
put hero(0,hx,hy)
wait(10)

write color (0,1,50)
write color (28,1,50)
write color (44,1,50)
write color (60,1,50)
write color (76,1,50)
write color (188,1,50)
write color (239,1,50)
write color (252,1,50)
write color (240,1,50)
update palette
wait (1)
reset palette
update palette
tweak palette (0,30,0)
update palette
wait (1)
reset palette
update palette
show backdrop (7)
wait (1)
show map
write color (0,1,50)
write color (28,1,50)
write color (44,1,50)
write color (60,1,50)
write color (76,1,50)
write color (188,1,50)
write color (239,1,50)
write color (252,1,50)
write color (240,1,50)
update palette
wait (1)
reset palette
update palette
tweak palette (0,30,0)
update palette
wait (1)
reset palette
update palette
show backdrop (7)
wait (1)
show map

for(i,1,3,1) do(
put npc(3,nx+1,ny)
wait(1)
put npc(3,nx--1,ny)
wait(1)
)

tb(3698)

for(i,1,6,1) do(
show backdrop(7)
wait(2)
show map
wait(2)
)

jig gahn2(3)
jig gahn2(3)
wait(10)
jig gahn
stop song
wait(40)

set hero direction(0,up)
jig hero(0)
jig hero(0)
wait(15)
set hero picture(0,230)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
wait(15)
jig hero(0)
tb(3699)
wait(8)
alter npc(3,NPCstat:picture,236)
set npc direction(3,down)
wait(10)
set npc direction(3,left)
wait(10)
jig npc(3)
tb(3700)
wait(5)
jig npc(1)
tb(3701)
wait(2)
set npc direction(3,up)
wait(4)
jig npc(3)
tb(3702)
wait(3)
jig hero(0)
show text box(3703)
wait(2)
set npc direction(3,left)
wait for text box

walk hero(0,right,1)
walk npc(1,down,1)
walk npc(2,up,1)
walk npc(3,left,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,1,0)
wait for npc(3)
set npc position(3,2,0)
set party in
set hero speed(0,hspeed)

play song(79)

#turn on gahn taunts
set tag(208,2)
))

resume obstruction
resume npcs
resume player
end
###

############################
script, jiggahn2, pow, begin
tweak palette (0,2*pow,0)
update palette
wait (1)
tweak palette (0,3*pow,0)
update palette
wait (1)
tweak palette (0,5*pow,0)
update palette
reset palette
wait (1)
tweak palette (0,3*pow,0)
update palette
reset palette
wait (1)
tweak palette (0,2*pow,0)
update palette
wait (1)
reset palette
update palette
end
###

##################################
script, relocatenpc, locate, begin
variable(f)
for(f,43,47,1) do(
set npc position(npc at spot(f,heroy(0)),f,heroy(0)--locate)
)
end
###

##################################
script, grinlowexteriordoor, begin
suspend player
suspend npcs
set tag(8,1)

if( herox(0)==87,and, (heroy(0)==211,or,heroy(0)==212,or,heroy(0)==213) ) then(
variable(ooo)
if( heroy(0)==212,or,heroy(0)==213 ) then( set variable(ooo,1) )
else( set variable(ooo,0) )
pan camera(south,0,0)
walk hero(0,right,5)
wait(5)
palout(5)
wait for hero(0)
camera follows hero(0)
teleport to map(1+poff,13,80+ooo)
set hp
wait(1)
pan camera(south,0,0)
set hero position(0,8,80+ooo)
walk hero(0,right,5)
wait(5)
palin(5)
wait for hero(0)
set hero frame(0,0)
camera follows hero(0)
)
else(
if(herox(0)==56,and,heroy(0)==198) then(

if(check tag(207)==false,or,check tag(206)) then(
pan camera(up,15,10)
walk hero(0,up,5)
wait(5)
palout(5)
wait for hero(0)
set hero position(0,57,183)
pan camera(up,5,20)
wait for camera
set hero position(0,56,168)
pan camera(up,15,10)
wait(5)
walk hero(0,up,5)
palin(5)
wait for hero(0)
set hero frame(0,0)
wait for camera
camera follows hero(0))
else(farewellskyler)

)
)
do(
if(herox(0)==56,and,heroy(0)==164) then(
pan camera(down,15,10)
walk hero(0,down,5)
wait(5)
palout(5)
wait for hero(0)
set hero position(0,57,184)
pan camera(down,5,20)
wait for camera
set hero position(0,56,194)
pan camera(down,15,10)
wait(5)
walk hero(0,down,5)
palin(5)
wait for hero(0)
set hero frame(0,0)
wait for camera
camera follows hero(0)
)
)

set tag(8,0)
resume npcs
resume player
end
###

############################
script, grinfinaldoor, begin
suspend player
suspend npcs
suspend obstruction
set tag(8,1)
set hero speed(0,4)

if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==61) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0)
)else(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==59) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==49) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==47) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0))
)
do(
if ((herox(0)==43,or,herox(0)==44,or,herox(0)==45,or,herox(0)==46,or,herox(0)==47),and,heroy(0)==41) then(
palout(10)
camera follows hero(0)
wait(1)
set hero position (0,(herox(0)--36),36)
focus camera (9,30,40)
alter npc(19,NPCstat:picture,113)
alter npc(19,NPCstat:palette,70)
wait for camera
palin(10)
walk hero(0,up,2)
wait for hero(0))
)
do(
if (herox(0)==9,and,heroy(0)==13) then(
alter npc(18,NPCstat:picture,0)
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)
wait for camera
wait for hero(0)
set hero position (0,18,7)
wait(1)
walk hero (0,right,2)
wait for hero(0)
write pass block(19,7,1+2+4+8))
)
do(
if (herox(0)==35,and,heroy(0)==7) then(
walk hero (0,right,1)
pan camera (right,18,10)
alter npc(4,NPCstat:picture,0)
alter npc(4,NPCstat:script,158)
set tag(37,0)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,45,12)
wait(1)
walk hero (0,down,2)
wait for hero(0)
write pass block(45,13,1+2+4+8))
)
do(
if (herox(0)==45,and,heroy(0)==23) then(
walk hero (0,down,2)
pan camera (down,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,31)
wait(1)
walk hero (0,left,2)
wait for hero(0)
write pass block(27,25,1)
write pass block(35,31,1+2+4+8))
)
do(
if (herox(0)==9,and,heroy(0)==49) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)
wait for camera
set hero position (0,18,43)
wait(1)
walk hero (0,right,2)
wait for hero(0)
write pass block(19,43,1+2+4+8))
)
do(
if ((herox(0)==26,or,herox(0)==27,or,herox(0)==28),and,heroy(0)==47) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0)
write pass block(26,49,1+2+4+8)
write pass block(27,49,1+2+4+8)
write pass block(28,49,1+2+4+8))
)
do(
if ((herox(0)==26,or,herox(0)==27,or,herox(0)==28),and,heroy(0)==59) then(
pan camera (down,12,10)
walk hero (0,down,3)
wait for camera
wait for hero (0)
write pass block(26,61,1+2+4+8)
write pass block(27,61,1+2+4+8)
write pass block(28,61,1+2+4+8))
)
do(
if (herox(0)==9,and,heroy(0)==85) then(
walk hero (0,up,1)
pan camera (up,12,10)
wait for camera
pan camera (right,18,10)
wait for camera
set hero position (0,18,79)
wait(1)
walk hero (0,right,2)
wait for hero(0)
write pass block(19,79,1+2+4+8))
)
do(
if (herox(0)==35,and,heroy(0)==79) then(
walk hero (0,right,1)
pan camera (right,18,10)
wait for camera
pan camera (down,12,10)
wait for camera
set hero position (0,45,84)
wait(1)
walk hero (0,down,2)
wait for hero(0)
write pass block(45,85,1+2+4+8))
)
do(
if (herox(0)==45,and,heroy(0)==95) then(
walk hero (0,down,2)
pan camera (down,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,103)
wait(1)
walk hero (0,left,2)
wait for hero(0)
write pass block(35,103,1+2+4+8))
)
do(
if (herox(0)==21,and,(heroy(0)==102,or,heroy(0)==103,or,heroy(0)==104)) then(
walk hero (0,up,3)
walk hero (0,left,3)
wait for hero(0)
palout(3)
camera follows hero (0)
teleport to map (66,56,60)
wait(1)
pan camera (north,0,0)
wait(1)
set hero position (0,51,64)
wait(10)
palin(3)
set hero speed (0,2)
walk hero (0,up,5)
wait for hero (0)
set hero speed (0,4)
wait (25)
write map block (51,59,79)
wait (15)
palout(3)
camera follows hero (0)
teleport to map (98,9,132)
wait(1)
pan camera (up,6,20)
wait for camera
wait (5)
palin(3)
walk hero (0,up,3)
wait for hero (0)
write pass block(8,130,1+2+4+8)
write pass block(9,130,1+2+4+8)
write pass block(10,130,1+2+4+8)
)
)
do(
if (herox(0)==9,and,heroy(0)==121) then(
alter npc(18,NPCstat:picture,0)
walk hero(0,up,1)
wait for hero(0)
stop song
wait(10)
palout(10)
camera follows hero(0)
set hero position(0,9,174)
wait(1)
pan camera(south,0,0)
set hero position(0,9,180)
load tileset(109)
wait(1)
palin(10)
play song(17)
walk hero(0,up,2)
wait for hero(0)
write pass block(9,179,1+2+4+8)
)
)
do(
if (herox(0)==45,and,heroy(0)==131) then(
walk hero (0,down,2)
pan camera (down,12,10)
wait for camera
pan camera (left,18,10)
wait for camera
set hero position (0,36,140)
wait(1)
walk hero (0,left,2)
wait for hero(0)
write pass block(35,140,1+2+4+8))
)
do(
if (herox(0)==27,and,heroy(0)==133) then(
pan camera (up,12,10)
walk hero (0,up,3)
wait for camera
wait for hero (0)
write pass block(27,131,1+2+4+8))
)
do(
if (herox(0)==27,and,heroy(0)==121) then(
walk hero (0,up,1)
wait for hero (0)
stop song
palout(20)
camera follows hero(0)
teleport to map (68,21,50)
wait(1)
pan camera (up,1,20)
wait for camera
write pass block (21,50,128)
write pass block (21,49,128)
set hero palette(findhero(0),getheropalette(findhero(0))+3)
set hero palette(findhero(7),getheropalette(findhero(7))+3)
set hero palette(findhero(0),120,inside battle)
set hero palette(findhero(7),get hero palette(findhero(7)),inside battle)

wait (20)
palin(20)
set hero speed (0,2)
walk hero (0,up,3)
alter npc(35,NPCstat:script,159)
wait for hero (0)
write pass block (21,49,1+4)
write pass block (21,48,1+2+4+8))
)


set hero speed (0,hspeed)
if(current map==68) then(set hero speed(0,2))
set hero frame (0,0)

set tag(8,0)
resume obstruction
resume npcs
resume player
end
###

##############################
script, hugemonsterhype, begin
suspend player
suspend npcs
suspend obstruction

stop song
tb(3724)

play song(15)

set hero speed(0,4)
set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
walk hero(0,up,1)
walk npc(1,right,1)
walk npc(2,left,1)
walk npc(3,down,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,down)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,up)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,left)
wait(2)
set hero direction(0,down)
set npc direction(1,left)
set npc direction(2,right)
set npc direction(3,up)

wait(5)
jig npc(1)
tb(3725)
jig npc(2)
tb(3726)
wait(3)
tb(3727)
wait(15)
jig npc(3)
tb(3728)
wait(3)
jig hero(0)
tb(3729)

walk hero(0,down,1)
walk npc(1,left,1)
walk npc(2,right,1)
walk npc(3,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,1,0)
wait for npc(3)
set npc position(3,2,0)
set party in
set hero speed(0,hspeed)

resume obstruction
resume npcs
resume player
end
###

##########################
script, hugemonster, begin
suspend player
walk hero (0,up,3)
wait for hero (0)
battleflash(1)
fade screen out(63,0,0)
wait(3)
fade screen out(63,63,63)
pan camera (up,12,10)
wait for camera
wait(1)
ff(589)
#play song(79)
alter npc(19,NPCstat:picture,113)
alter npc(19,NPCstat:palette,70)
write pass block(9,23,1+2+4+8)
resume player
end
###

##############################
script, skeletoncrumble, skeleton, begin
suspend player

variable(skel)
if(hero direction(0)==up) then(
set variable(skel,npc at spot(herox(0),heroy(0)--1))
)
if(hero direction(0)==down) then(
set variable(skel,npc at spot(herox(0),heroy(0)+1))
)
if(hero direction(0)==left) then(
set variable(skel,npc at spot(herox(0)--1,heroy(0)))
)
if(hero direction(0)==right) then(
set variable(skel,npc at spot(herox(0)+1,heroy(0)))
)

if(read pass block(npcx(skel),npcy(skel))<>0,and,read pass block(npcx(skel),npcy(skel))<>128) then(

if(npcy(skel)<>22) then(write pass block(npcx(skel),npcy(skel),0))
else(write pass block(npcx(skel),npcy(skel),128))

variable(sx)
variable(sy)
set variable(sx, npc pixel x(skel))
set variable(sy, npc pixel y(skel))
variable(ss)
for(ss,1,4,1) do(
put npc(skel,sx--1,sy)
wait(1)
put npc(skel,sx+1,sy)
wait(1)
)
put npc(skel,sx,sy)
wait(1)

variable(osk)
if(skeleton==4) then(set variable(osk,0))
if(skeleton==5) then(set variable(osk,1))
if(skeleton==6) then(set variable(osk,2))

destroy npc(npc at spot(sx/20,sy/20))
alter npc(14,NPCstat:picture,458+osk)
set npc direction(14,down)
set npc position(14,sx/20,sy/20)
set npc position(skel,0,0)
wait(2)
set npc direction(14,right)
wait(2)
set npc direction(14,up)
wait(3)
set npc position(skel,npcx(14),npcy(14))
set npc direction(skel,left)
set npc position(14,0,3)
create npc(skeleton,sx/20,sy/20)

)

resume player
end
###

#############################
script, riftfinalfight, begin
suspend player
suspend npcs
suspend obstruction

riftfinalfight1
riftfinalfight2


set party in
camera follows hero (0)
teleport to map (66,56,96)
wait(1)
pan camera (north,0,0)
wait(1)
set hero position (0,55,102)
wait(10)
palin(3)
set hero speed (0,2)
walk hero (0,up,1)
wait for hero(0)
walk hero (0,right,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,right,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,right,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,2)
wait for hero (0)
walk hero (0,up,1)
walk hero (0,right,1)
wait for hero (0)
set hero speed (0,4)
wait(10)
palout(3)
camera follows hero (0)
wait(1)
teleport to map (98,9,59)
wait(1)
pan camera (up,5,20)
wait for camera
wait (10)
palin(3)
walk hero (0,up,3)
wait for hero(0)
set hero frame(0,0)
set hero speed(0,hspeed)

set tag(8,0)
save game

resume obstruction
resume npcs
resume player
end
###
##############################
script, riftfinalfight1, begin
stop song
wait(10)
palout(1)
palin(1)
wait(2)
set hero direction(0,up)
wait(6)
set hero direction(0,left)
wait(2)
set hero direction(0,down)
wait(7)
set hero direction(0,left)
wait(2)
palout(1)
palin(1)
walk hero(0,left,1)
wait for hero(0)
pright
wait(10)
palout(1)
set npc position(7,20,29)
walk npc(7,down,1)
walk npc(7,right,1)
set npc direction(7,right)
wait(1)
palin(1)
wait(12)
palout(1)
wait for npc(7)
set npc position(7,23,31)
wait(1)
palin(1)
wait(25)
jig horror
play song(56)
tb(3730)
palout(1)
set npc direction(7,up)
wait(1)
palin(1)
wait(10)
alter npc(7,NPCstat:picture,451)
wait(4)
set npc direction(7,right)
wait(2)
set npc direction(7,down)
wait(6)
palout(1)
set npc direction(7,left)
wait(1)
palin(1)
tb(3731)
wait(10)
jig npc(7)
tb(3732)
jig npc(7)
tb(3733)
wait(2)
tb(3734)
wait(10)
jig horror
tb(3735)

battleflash(1)
fade screen out(63,63,63)
set hero position(0,23,29)
set npc position(1,22,29)
set npc position(2,23,28)
set npc position(3,24,29)
set npc position(7,23,32)
set hero direction(0,down)
set npc direction(1,down)
set npc direction(2,down)
set npc direction(3,down)
alter npc(7,NPCstat:picture,166)
set npc direction(7,up)
set party in
ff(591)
play song(96)
end
###
##############################
script, riftfinalfight2, begin
walk npc(7,down,1)
set npc direction(7,up)
wait for npc(7)
tb(3736)

palout(2)
set npc direction(7,right)
wait(1)
palin(2)
wait(10)
palout(2)
alter npc(7,NPCstat:picture,452)
wait(1)
palin(2)
wait(3)
jig npc(7)
tb(3737)
wait(15)
jig npc(7)
wait(5)
jig npc(7)
jig npc(7)
tb(3738)
wait(5)
palout(1)
wait(1)
palin(1)
wait(15)
palout(1)
set npc direction(7,left)
wait(1)
palin(1)
wait(15)
palout(1)
alter npc(7,NPCstat:movespeed,10)
wait(1)
palin(1)
walk npc(7,up,2)
wait for npc(7)

tweak palette (5,5,5)
update palette
wait (1)
tweak palette (10,10,10)
update palette
wait (1)
tweak palette (20,20,20)
update palette
wait (1)
tweak palette (40,40,40)
update palette
wait (1)
tweak palette (111,111,111)
update palette
wait (1)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(7))
set variable(ny,npc pixel y(7))
set npc direction(7,down)
alter npc(9,NPCstat:picture,453)
#using hero 1 instead of npc 7
#ARGELKGJ:SLDKJH: JG:LSKDJF:LKDSJF:LKS
#ANGRY EXPLICATIVE
#RAGE!
variable(mipic)
variable(jopic)
variable(pypic)
set variable(mipic,get hero picture(find hero(1)))
set variable(jopic,get hero picture(find hero(2)))
set variable(pypic,get hero picture(find hero(3)))
variable(mipal)
variable(jopal)
variable(pypal)
set variable(mipal,get hero palette(find hero(1)))
set variable(jopal,get hero palette(find hero(2)))
set variable(pypal,get hero palette(find hero(3)))
set hero picture(find hero(1),0)
set hero picture(find hero(2),0)
set hero picture(find hero(3),0)
set hero picture(1,452)
set hero palette(1,73)
set hero direction(1,down)
put hero(1,nx,ny)
wait(1)
#switching npc away
set npc position(7,0,0)
set caterpillar mode(ON)
suspend caterpillar
put npc(9,nx+12,ny--8)
play song(92)
wait(10)
reset palette
tweak palette (40,40,40)
update palette
wait (10)
reset palette
tweak palette (20,20,20)
update palette
wait (10)
reset palette
tweak palette (10,10,10)
update palette
wait (10)
reset palette
tweak palette (5,5,5)
update palette
wait (10)
reset palette
update palette
wait(5)
variable(i)
for(i,1,4,1) do(
put hero(1,nx+random(-1,1),ny+random(-1,1))
put npc(9,nx+12,ny--8)
wait(1)
)
put hero(1,nx,ny)
put npc(9,nx+12,ny--8)
wait(3)

jig hero(0)
tb(3739)
wait(3)
jig npc(9)
tb(3740)
set npc direction(9,up)
for(i,1,4,1) do(
put npc(9,nx+12+random(-1,1),ny--8+random(-1,1))
wait(1)
)
put npc(9,nx+12,ny--8)
jig npc(9)
tb(3741)
tb(3742)
wait(6)
jig hero(0)
tb(3743)
wait(3)
for(i,1,3,1) do(
put hero(1,nx+random(-1,1),ny+random(-1,1))
wait(1)
)
put hero(1,nx,ny)
#alter npc(7,NPCstat:picture,166)
set hero picture(1,166)
#alter npc(7,NPCstat:movespeed,4)
set hero speed(1,4)
set hero direction(1,up)
walk hero(1,down,1)
wait(2)
show text box(3744)
wait for hero(1)
set hero frame(1,0)
#alter npc(7,NPCstat:picture,451)
set hero picture(1,451)
set hero direction(1,down)
wait for text box
tb(3745)
set npc direction(9,left)
tb(3746)

walk npc(1,right,1)
walk npc(2,down,1)
walk npc(3,left,1)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,1,0)
wait for npc(3)
set npc position(3,2,0)
set hero speed(0,hspeed)
walk hero(0,left,1)
wait for hero(0)
walk hero(0,down,1)
wait for hero(0)
walk hero(0,left,1)
wait for hero(0)

walk hero (0,up,3)
walk hero (0,left,3)
wait for hero(0)
palout(3)

#setting hero pictures back
resume caterpillar
set caterpillar mode(OFF)
set hero picture(find hero(1),mipic)
set hero picture(find hero(2),jopic)
set hero picture(find hero(3),pypic)
set hero palette(find hero(1),mipal)
set hero palette(find hero(2),jopal)
set hero palette(find hero(3),pypal)

end
###

#############################
script, lycantnonsense, begin
suspend player
suspend npcs
suspend obstruction

stop song

set hero speed(0,4)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
pleft

wait(15)
jig npc(12)
tb(3747)
wait(3)
set npc direction(12,left)
wait(3)
jig npc(12)
tb(3748)
wait(5)
set npc direction(12,down)
wait(2)
alter npc(12,NPCstat:picture,14)
wait(6)
set npc direction(12,left)
wait(4)
jig npc(12)
play song(15)
show text box(3749)
wait(3)
set hero picture(0,374)
wait for text box
wait(4)
jig hero(0)
tb(3750)
walk npc(12,left,1)
wait for npc(12)
set npc frame(12,0)
jig npc(12)
tb(3751)
jig hero(0)
tb(3752)
walk npc(12,left,1)
wait for npc(12)
set npc frame(12,0)
jig npc(12)
tb(3753)
tb(3754)
jig npc(12)
tb(3755)
jig hero(0)
tb(3756)
tb(3757)
set hero speed(0,5)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
show text box(3758)
wait(2)
alter npc(12,NPCstat:picture,153)
set npc direction(12,up)
wait for text box
wait(2)
jig npc(12)
tb(3759)
wait(5)
jig hero(0)
tb(3760)
wait(2)
jig npc(12)
tb(3761)
wait(7)
jig hero(0)
tb(3762)
jig npc(12)
jig npc(12)
jig npc(12)
tb(3763)
wait(5)
jig hero(0)
tb(3764)

stop song
battleflash(1)
set party in
ff(592)
swap by position(find hero(0),0)

wait(3)
alter npc(12,NPCstat:picture,151)
set npc direction(12,right)
wait(3)
set npc direction(12,up)
wait(10)
variable(j)
for(j,1,4,1) do(
alter npc(12,NPCstat:picture,0)
wait(2)
alter npc(12,NPCstat:picture,151)
wait(2)
)
for(j,1,2,1) do(
alter npc(12,NPCstat:picture,0)
wait(3)
alter npc(12,NPCstat:picture,151)
wait(3)
)
set npc position(12,0,3)

set hero speed(0,4)
wait(5)
walk hero(0,left,1)
wait for hero(0)
ppleft
set hero direction(0,down)
set hero speed(0,hspeed)
write pass block(19,43,1+2+4+8)

resume obstruction
resume npcs
resume player
end
###

#############################
script, talvasillusion, begin
suspend player
suspend npcs
suspend obstruction

variable(ta1)
variable(ta2)
variable(ta3)
variable(ta4)

wait(10)
play song(61)
set variable(ta1,create npc(13,27,69,up))
wait(2)
variable(i)
for(i,1,3,1) do(
set npc position(ta1,0,0)
wait(2)
set npc position(ta1,27,69)
wait(2)
)
for(i,1,2,1) do(
set npc position(ta1,0,0)
wait(3)
set npc position(ta1,27,69)
wait(3)
)
tb(3765)
set hero speed(0,4)
walk hero to x(0,27)
wait for hero(0)
walk hero(0,down,2)
wait for hero(0)
set hero frame(0,0)

set variable(ta2,create npc(13,24,66,right))
wait(2)
set hero direction(0,left)
for(i,1,3,1) do(
set npc position(ta2,0,0)
wait(2)
set npc position(ta2,24,66)
wait(2)
)
for(i,1,2,1) do(
set npc position(ta2,0,0)
wait(3)
set npc position(ta2,24,66)
wait(3)
)
tb(3766)

set variable(ta3,create npc(13,27,63,down))
wait(2)
set hero direction(0,up)
for(i,1,3,1) do(
set npc position(ta3,0,0)
wait(2)
set npc position(ta3,27,63)
wait(2)
)
for(i,1,2,1) do(
set npc position(ta3,0,0)
wait(3)
set npc position(ta3,27,63)
wait(3)
)
tb(3767)

set variable(ta4,create npc(13,30,66,left))
wait(2)
set hero direction(0,right)
for(i,1,3,1) do(
set npc position(ta4,0,0)
wait(2)
set npc position(ta4,30,66)
wait(2)
)
for(i,1,2,1) do(
set npc position(ta4,0,0)
wait(3)
set npc position(ta4,30,66)
wait(3)
)
tb(3768)

talvasillusion1(ta2,ta3,ta4)
talvasillusion2(ta1,ta2,ta3,ta4)
talvasillusion3(ta1)

resume obstruction
resume npcs
resume player
end
###
##############################
script, talvasillusion1, ta2, ta3, ta4, begin
jig npc(ta2)
show text box(3769)
wait(2)
set hero direction(0,down)
wait(2)
set hero direction(0,left)
wait for text box

set party out
swap by position(find hero(0),0)
set npc position(1,herox(0),heroy(0))
set npc position(2,herox(0),heroy(0))
set npc position(3,herox(0),heroy(0))
set hero picture(0,374)
walk hero(0,down,1)
walk npc(1,right,1)
walk npc(2,up,1)
walk npc(3,left,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
wait for npc(3)
set npc frame(3,0)
wait(10)

jig npc(ta4)
tb(3770)
wait(5)
jig npc(ta3)
tb(3771)
wait(2)
set npc frame(ta2,1)
set npc frame(ta3,1)
set npc frame(ta4,1)
wait(2)
set npc frame(ta2,0)
set npc frame(ta3,0)
set npc frame(ta4,0)
tb(3772)

#alter johan's gauge skills, if he has them
set tag(695,1)
#Gauge HP: 276, 278, 279, 280 VS 
if(read spell(find hero(2),0,7)==276+1) then(
	set tag(696,1)
	write spell(find hero(2),0,7,2017+1)
)
if(read spell(find hero(2),0,7)==278+1) then(
	set tag(697,1)
	write spell(find hero(2),0,7,2019+1)
)
if(read spell(find hero(2),0,7)==279+1) then(
	set tag(698,1)
	write spell(find hero(2),0,7,2020+1)
)
if(read spell(find hero(2),0,7)==280+1) then(
	set tag(699,1)
	write spell(find hero(2),0,7,2021+1)
)
#Gauge SD: 282, 285, 286, 287
if(read spell(find hero(2),0,8)==282+1) then(
	set tag(700,1)
	write spell(find hero(2),0,8,2023+1)
)
if(read spell(find hero(2),0,8)==285+1) then(
	set tag(701,1)
	write spell(find hero(2),0,8,2026+1)
)
if(read spell(find hero(2),0,8)==286+1) then(
	set tag(702,1)
	write spell(find hero(2),0,8,2027+1)
)
if(read spell(find hero(2),0,8)==287+1) then(
	set tag(703,1)
	write spell(find hero(2),0,8,2028+1)
)

play song(8)
battleflash(1)
set party in
ff(597)
play song(82)
swap by position(find hero(0),0)
end
###
##############################
script, talvasillusion2, ta1, ta2, ta3, ta4, begin
wait(3)
set npc position(ta2,0,0)
set npc position(ta3,0,0)
set npc position(ta4,0,0)
wait(2)
set npc position(ta2,24,66)
set npc position(ta3,27,63)
set npc position(ta4,30,66)
wait(2)
set npc position(ta2,0,0)
set npc position(ta3,0,0)
set npc position(ta4,0,0)
wait(2)
set npc position(ta2,24,66)
set npc position(ta3,27,63)
set npc position(ta4,30,66)
wait(2)
set npc position(ta2,0,0)
set npc position(ta3,0,0)
set npc position(ta4,0,0)
wait(2)
set npc position(ta2,24,66)
set npc position(ta3,27,63)
set npc position(ta4,30,66)
wait(2)
set npc position(ta2,0,0)
set npc position(ta3,0,0)
set npc position(ta4,0,0)
wait(3)
set npc position(ta2,24,66)
set npc position(ta3,27,63)
set npc position(ta4,30,66)
wait(3)
set npc position(ta2,0,0)
set npc position(ta3,0,0)
set npc position(ta4,0,0)
wait(3)
set npc position(ta2,24,66)
set npc position(ta3,27,63)
set npc position(ta4,30,66)
wait(3)
destroy npc(ta2)
destroy npc(ta3)
destroy npc(ta4)

wait(5)
set npc direction(2,left)
set npc direction(1,down)
set npc direction(3,down)
wait(2)
set npc direction(2,down)
wait(10)

alter npc(ta1,NPCstat:picture,454)
set npc direction(ta1,down)
wait(3)
set npc direction(ta1,right)
wait(15)

jig npc(2)
show text box(3773)
set hero direction(0,right)
wait(3)
set hero direction(0,up)
set npc direction(1,up)
set npc direction(3,up)
wait for text box
jig npc(1)
tb(3774)
wait(8)
jig npc(2)
tb(3775)
end
###
##############################
script, talvasillusion3, ta1, begin
tb(3776)
jig npc(2)
tb(3777)
wait(2)
set npc direction(ta1,down)
wait(2)
tb(3778)
wait(2)
set npc direction(ta1,up)
wait(2)
jig npc(2)
tb(3779)
wait(4)
walk npc(ta1,up,1)
wait for npc(ta1)
wait(2)
set npc direction(ta1,left)
jig npc(2)
stop song
tb(3780)
wait(1)
alter npc(2,NPCstat:picture,457)
set hero speed(0,10)
set npc direction(1,down)
set npc direction(3,down)
walk hero(0,right,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,down)

tweak palette(63,63,0)
update palette
set npc frame(2,1)
alter npc(ta1,NPCstat:picture,455)
set npc direction(ta1,up)
wait(2)
reset palette
update palette
wait(2)
set npc frame(2,0)
wait(2)

tweak palette(63,63,0)
update palette
set npc frame(2,1)
set npc direction(ta1,right)
wait(2)
reset palette
update palette
wait(2)
set npc frame(2,0)
wait(2)

tweak palette(63,63,0)
update palette
set npc frame(2,1)
set npc direction(ta1,down)
wait(2)
reset palette
update palette
wait(2)
set npc frame(2,0)
wait(20)
alter npc(ta1,NPCstat:picture,456)
set npc direction(ta1,up)
wait(3)
set npc direction(ta1,right)
wait(10)
alter npc(2,NPCstat:picture,235)
wait(15)
jig npc(1)
tb(3781)

set hero speed(0,4)
walk hero(0,left,1)
wait for hero(0)
walk hero(0,up,1)
walk npc(1,left,1)
walk npc(2,down,1)
walk npc(3,right,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,0)
wait for npc(2)
set npc position(2,1,0)
wait for npc(3)
set npc position(3,2,0)
set hero direction(0,down)
set party in
set hero speed(0,hspeed)
write pass block(26,61,1+2+4+8)
write pass block(27,61,1+2+4+8)
write pass block(28,61,1+2+4+8)
set variable(isrunning,false)
end
###

#########################
script, talvashaha, begin
suspend player
suspend npcs
suspend obstruction

talvashaha1
gahnsaysgoodbye
gahnsaysgoodbye2

resume obstruction
resume npcs
resume player
end
###

##########################
script, talvashaha1, begin
variable(j)
variable(nx)
variable(ny)
set variable(nx,npc pixel x(13))
set variable(ny,npc pixel y(13))
for(j,1,7,1) do(
put npc(13,nx+random(-1,1),ny+random(-1,1))
wait(random(1,3))
)
put npc(13,nx,ny)

play song(61)
tb(3782)

set hero direction(0,down)
wait(2)
set hero direction(0,right)
wait(3)
walk hero to y(0,69)
wait for hero(0)
walk hero(0,right,2)
wait for hero(0)

pleft

for(j,1,3,1) do(
put npc(13,nx+random(-1,1),ny+random(-1,1))
wait(random(1,3))
)
put npc(13,nx,ny)
tb(3783)
wait(10)
tb(3784)

stop song

alter npc(1,NPCstat:movespeed,10)
walk npc(1,right,3)
wait for npc(1)
set npc frame(1,0)
tweak palette(63,63,63)
update palette
alter npc(1,NPCstat:picture,152)
set npc direction(1,down)
wait(2)
reset palette
update palette
wait(4)
show backdrop(1)
set npc frame(1,1)
set npc direction(13,down)
variable(ta)
set variable(ta,create npc(13,27,68,left))
set npc direction(ta,left)
wait(2)
show map

wait(15)
alter npc(1,NPCstat:picture,233)
set npc direction(1,right)
set npc frame(1,0)
wait(10)
show backdrop(1)
wait(2)
show map

set hero picture(0,230)

put npc(ta,nx--1,ny)
for(j,1,4,1) do(
alter npc(13,NPCstat:picture,0)
wait(3)
put npc(ta,nx--1--j,ny+j)
alter npc(13,NPCstat:picture,456)
wait(3)
)
for(j,5,7,1) do(
alter npc(13,NPCstat:picture,0)
wait(4)
put npc(ta,nx--1--j,ny+j)
alter npc(13,NPCstat:picture,456)
wait(4)
)
alter npc(13,NPCstat:picture,0)

wait(35)
set hero speed(0,2)
walk hero(0,right,2)
wait for hero(0)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,right)
alter npc(1,NPCstat:movespeed,4)
wait(30)
jig hero(0)
tb(3785)
wait(5)
alter npc(1,NPCstat:picture,387)
wait(10)
set npc direction(1,down)
wait(15)

palout(15)
alter npc(NPCstat:picture,233)
set party in
camera follows hero(0)
teleport to map (66,56,88)
wait(1)
pan camera(north,0,0)
wait(1)
set hero position (0,59,87)
wait (10)
palin(3)
set hero speed (0,2)
walk hero (0,up,1)
walk hero (0,left,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
pan camera (up,12,10)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,left,1)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
wait for hero (0)
walk hero (0,up,1)
walk hero (0,left,1)
wait for hero (0)
set hero speed (0,4)
wait (10)
palout(3)
camera follows hero(0)
teleport to map (98,9,95)
wait (1)
pan camera (up,5,20)
wait for camera
set party out
swap by position(find hero(0),0)
wait (10)
palin(3)
end
###


##############################
script, gahnsaysgoodbye, begin
suspend player
suspend npcs
suspend obstruction

alter npc(1,NPCstat:movespeed,10)
alter npc(2,NPCstat:movespeed,10)
alter npc(3,NPCstat:movespeed,10)
walk hero(0,up,3)
wait for hero(0)

play song(65)
jig hero(0)
show text box(3786)
pdown
set hero speed(0,10)
set hero picture(0,461)
alter npc(7,NPCstat:picture,71)
wait for text box

walk hero(0,up,2)
wait for hero(0)
variable(hx)
variable(hy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
set hero direction(0,right)
put hero(0,hx,hy--3)
put npc(7,hx,hy)
wait(1)
put hero(0,hx,hy--6)
put npc(7,hx,hy--2)
wait(1)
put hero(0,hx,hy--10)
put npc(7,hx,hy--4)
wait(1)
put hero(0,hx,hy--15)
put npc(7,hx,hy--7)
wait(1)
put hero(0,hx,hy--21)
put npc(7,hx,hy--11)
wait(1)
put hero(0,hx,hy--28)
put npc(7,hx,hy--15)
wait(2)
put hero(0,hx,hy--37)
put npc(7,hx,hy--20)
wait(2)
put hero(0,hx,hy--47)
put npc(7,hx,hy--26)
wait(3)
stop song
tweak palette(63,63,63)
update palette
put npc(7,0,0)
put hero(0,hx,hy--20)
set hero speed(0,4)
set hero direction(0,down)
wait(1)
alter npc(7,NPCstat:picture,155)
alter npc(7,NPCstat:palette,189)
alter npc(7,NPCstat:movespeed,2)
alter npc(9,NPCstat:picture,155)
alter npc(9,NPCstat:palette,193)
alter npc(9,NPCstat:movespeed,2)
alter npc(13,NPCstat:picture,155)
alter npc(13,NPCstat:palette,97)
alter npc(13,NPCstat:movespeed,2)
alter npc(14,NPCstat:picture,155)
alter npc(14,NPCstat:palette,201)
alter npc(14,NPCstat:movespeed,2)
wait(3)
walk hero(0,down,1)
reset palette
update palette
wait for hero(0)
walk hero(0,down,2)
set npc position(7,herox(0),heroy(0))
set npc position(9,herox(0),heroy(0))
set npc position(14,herox(0),heroy(0))
create npc(13,herox(0),heroy(0))
walk npc(9,down,1)
walk npc(13,right,1)
walk npc(13,down,1)
walk npc(14,left,1)
walk npc(14,down,1)

wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
wait for npc(7)
set npc frame(7,0)
wait for npc(9)
set npc frame(9,0)
wait for npc(13)
set npc frame(13,0)
wait for npc(14)
set npc frame(14,0)
set npc direction(7,up)
set npc direction(9,right)
set npc direction(13,down)
set npc direction(14,left)
wait(15)

variable(i)
for(i,1,3) do(
alter npc(7,NPCstat:picture,464)
alter npc(9,NPCstat:picture,464)
alter npc(13,NPCstat:picture,464)
alter npc(13,NPCstat:palette,197)
alter npc(14,NPCstat:picture,464)
wait(1)
alter npc(7,NPCstat:picture,155)
alter npc(9,NPCstat:picture,155)
alter npc(13,NPCstat:picture,155)
alter npc(13,NPCstat:palette,97)
alter npc(14,NPCstat:picture,155)
wait(1)
)
for(i,1,1) do(
alter npc(7,NPCstat:picture,464)
alter npc(9,NPCstat:picture,464)
alter npc(13,NPCstat:picture,464)
alter npc(13,NPCstat:palette,197)
alter npc(14,NPCstat:picture,464)
wait(2)
alter npc(7,NPCstat:picture,155)
alter npc(9,NPCstat:picture,155)
alter npc(13,NPCstat:picture,155)
alter npc(13,NPCstat:palette,97)
alter npc(14,NPCstat:picture,155)
wait(2)
)

fade screen out(63,63,63)
alter npc(7,NPCstat:picture,464)
alter npc(9,NPCstat:picture,464)
alter npc(13,NPCstat:picture,464)
alter npc(13,NPCstat:palette,197)
alter npc(14,NPCstat:picture,464)
wait(3)
fade screen in

play song(75)
wait(5)

jig valorian(6)
tb(3787)
jig valorian(6)
tb(3788)
jig valorian(6)
tb(3789)
jig hero(0)
tb(3790)
tb(3791)
set npc direction(3,right)
wait(3)
jig npc(3)
tb(3792)
tb(3793)
wait(5)
set hero frame(0,1)
set hero picture(0,230)
set hero direction(0,up)
wait(2)
set hero frame(0,0)
wait(5)
jig valorian(6)
show text box(3794)
wait(2)
set npc direction(3,up)
wait for text box
jig valorian(6)
tb(3795)
walk npc(14,up,1)
set npc direction(14,left)
wait for npc(14)
jig valorian(1)
tb(3796)
walk npc(13,up,1)
set npc direction(13,down)
wait for npc(13)
jig valorian(4)
tb(3797)
wait(3)
jig valorian(5)
tb(3798)
wait(3)
end
###
###############################
script, gahnsaysgoodbye2, begin
jig gahn
play song(15)
tb(3799)
jig hero(0)
tb(3800)
wait(3)
jig valorian(6)
tb(3801)
jig valorian(1)
tb(3802)
jig valorian(4)
tb(3803)
jig valorian(5)
tb(3804)
wait(5)
play song(57)
show backdrop(7)
wait(4)
show map
tb(3805)
show backdrop(7)
wait(4)
show map
tb(3806)
show backdrop(7)
wait(4)
show map
tb(3807)

#taking away up, up+, and up++
set variable(text1,inventory(55))
set variable(text2,inventory(56))
set variable(hm,inventory(57))
delete item(55,text1)
delete item(56,text2)
delete item(57,hm)

set tag(560,1)
play song(8)
battleflash(1)
fade screen out(0,63,0)
add hero(11)
add hero(12)
add hero(13)
add hero(14)
swap by position(find hero(11),0)
swap by position(find hero(12),1)
swap by position(find hero(13),2)
swap by position(find hero(14),3)
set death script(153)
camera follows hero(0)
set hero position(0,9,150)
wait(1)
fight formation(598)
set tag(560,0)
end
###

#############################
script, valoriandefeat, begin
suspend player
suspend npcs
suspend obstruction
swap by position(find hero(0),0)

stop song

#give back up, up+, and, up++
get item(55,text1)
get item(56,text2)
get item(57,hm)

valoriandefeat1
valoriandefeat2

set tag(209,1)

resume obstruction
resume npcs
resume player
end
###
##############################
script, valoriandefeat1, begin
variable(i)
for (i,1,5,1) do(
show backdrop(1)
wait(1)
show map
wait(1))
fade screen out(63,0,0)
wait(3)
fade screen in
play song(98)
wait(20)

suspend box advance
palout(1)
show text box(3841)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3842)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3843)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3844)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3845)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3846)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3847)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box
show text box(3848)
wait(1)
palin(2)
wait for key(usekey)
palout(2)
advance text box

resume box advance
wait(1)
camera follows hero(0)
teleport to map(66,2,1)
wait(1)
teleport to map(98,9,90)
wait(1)
pan camera(south,0,0)
set hero position(0,9,92)
set npc position(1,10,92)
set npc position(2,9,93)
set npc position(3,8,92)
set hero direction(0,up)
set npc direction(1,up)
set npc direction(2,up)
set npc direction(3,up)
wait(1)
palin(10)

wait(30)
jig gahn
tb(3849)
jig gahn
tb(3850)
jig gahn
tb(3851)
stop song
end
###
##############################
script, valoriandefeat2, begin
wait(10)
show backdrop(7)
wait(4)
show map
wait(7)
show backdrop(7)
wait(4)
show map
wait(7)
show backdrop(7)
set npc position(npc at spot(9,87),0,0)
set npc position(20,0,0)
wait(4)
show map
wait(7)
jig gahn
tb(3852)
jig gahn
tb(3853)

play song(79)
wait(50)
set hero speed(0,4)
alter npc(1,NPCstat:movespeed,2)
alter npc(3,NPCstat:movespeed,2)
alter npc(2,NPCstat:movespeed,1)

walk hero(0,up,1)
wait for hero(0)
walk hero(0,up,2)
walk npc(1,up,2)
walk npc(2,up,2)
walk npc(3,up,2)
wait for hero(0)
set hero picture(0,375)
set hero direction(0,left)
set hero frame(0,0)
wait(3)
set hero direction(0,down)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,left)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)
wait for npc(2)
set npc frame(2,0)

wait(15)
jig npc(2)
tb(3854)
tb(3855)
wait(4)
jig npc(3)
show text box(3856)
wait(2)
alter npc(1,NPCstat:picture,382)
wait for text box
jig npc(1)
tb(3857)
wait(2)
set npc frame(3,1)
wait(3)
set npc frame(3,0)
tb(3858)
wait(15)
set hero picture(0,230)
jig hero(0)
tb(3859)
wait(2)
alter npc(1,NPCstat:picture,384)
wait(2)
tb(3860)
set npc direction(2,right)
jig npc(2)
tb(3861)
wait(3)
set npc direction(3,up)
wait(2)
jig npc(3)
show text box(3862)
wait(2)
alter npc(1,NPCstat:picture,233)
set npc direction(1,up)
set npc direction(2,up)
wait for text box
jig npc(1)
tb(3863)
wait(7)
jig hero(0)
tb(3864)

alter npc(1,NPCstat:movespeed,4)
alter npc(3,NPCstat:movespeed,4)
alter npc(2,NPCstat:movespeed,4)
walk hero(0,down,1)
walk npc(1,left,1)
walk npc(2,up,1)
walk npc(3,right,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc position(1,0,1)
wait for npc(2)
set npc position(2,1,1)
wait for npc(3)
set npc position(3,2,1)
set hero speed(0,hspeed)
set party in
end
###

#############################
script, horribleending, begin
suspend player
suspend npcs
suspend obstruction

set hero speed(0,2)
wait(15)
set hero direction(0,right)
wait(4)
set hero direction(0,up)
wait(20)
set hero direction(0,left)
wait(3)
walk hero(0,down,2)
wait for hero(0)

stop song
palout(10)
show backdrop(0)
wait(1)
palin(1)

wait(20)
suspend box advance
palout(1)
show text box(3865)
wait(1)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show text box(3866)
wait(3)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show text box(3867)
wait(6)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show text box(3868)
wait(3)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show text box(3869)
wait(15)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show text box(3870)
wait(3)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show text box(3871)
wait(3)
palin(3)
wait for key(usekey)
palout(3)
advance text box
show backdrop(39)
wait(15)
palin(4)
wait(15)
text out(1)
show text box(3872)
text in(3)
wait for key(usekey)
text out(3)
advance text box
show text box(3873)
wait(1)
text in(3)
wait for key(usekey)
text out(3)
advance text box
wait(3)
fade screen out(63,63,63)
show backdrop(2)
wait(4)
fade screen in
game over
end
###

########################
script, omegasave, begin
suspend player
suspend npcs
suspend obstruction

suspend box advance

stop song
set variable(musicsave,17)

fade screen out(0,63,0)
show backdrop(0)
wait(4)
fade screen in
fade screen out(0,0,0)
show map
set tag(7,0)
show text box(33)
wait(4)
fade screen in
resume box advance
wait for text box
if(check tag(7)) then(
variable(slot)
set variable(slot,save menu)
if(slot>=0) then(set variable(saves,saves+1))
)

play song(17)

resume obstruction
resume npcs
resume player
end
###

##############################
script, grinlowreadtile, begin
suspend player

if(heroy(0)<<50) then(
tb(6441)
)
else(
tb(6440)
)

resume player
end
###

##############################
script, grinchainfight5, begin
if (read map block(herox(0),heroy(0))<>61) then(
suspend player
set hero frame (0,0)
wait(1)
set hero frame (0,1)
wait(1)
write map block (herox(0),heroy(0),60)
set hero frame (0,1)
wait(1)
set hero frame (0,0)
wait(1)
write map block (herox(0),heroy(0),61)

if(check tag(37)) then()
else(
play song(15)
variable (i)
for (i,1,5,1) do(
wait(1)
set npc frame(npc at spot(44,18),1)
set npc frame(npc at spot(46,18),1)
set npc frame(npc at spot(45,19),1)
set npc frame(npc at spot(44,20),1)
set npc frame(npc at spot(46,20),1)
wait(1)
set npc frame(npc at spot(44,18),0)
set npc frame(npc at spot(46,18),0)
set npc frame(npc at spot(45,19),0)
set npc frame(npc at spot(44,20),0)
set npc frame(npc at spot(46,20),0)
)
tb(293)
battle flash
#set variable(battlesfought,battlesfought+1)
#fight formation(2)
set tag(37,1)
ff(590)
write pass block(45,13,1+2+4+8)
)

resume player
)
end
###

#########################
script, gahnbattle, begin
suspend player
suspend npcs
suspend obstruction
suspend npc walls

play song(58)

set variable(isrunning,false)

set hero speed(0,4)
pan camera(right,3,10)
walk hero(0,right,10)
tweak palette(-1,-1,-1)
update palette
wait for camera
pan camera(right,3,10)
tweak palette(-1,-1,-1)
update palette
wait for camera
pan camera(right,3,10)
tweak palette(-2,-2,-2)
update palette
wait for camera
pan camera(right,3,10)
tweak palette(-3,-3,-3)
update palette
wait for camera
pan camera(right,3,10)
tweak palette(-5,-5,-5)
update palette
wait for camera
pan camera(right,3,10)
tweak palette(-5,-5,-5)
update palette
wait for camera

wait for hero(0)
walk hero(0,up,3)
wait for hero(0)
set hero frame(0,0)
pdown

set npc position(19,27,165)
set npc position(20,27,166)
set npc position(9,26,166)
set npc direction(19,down)
set npc direction(20,left)
set npc position(9,right)
alter npc(19,NPCstat:picture,466)
alter npc(20,NPCstat:picture,466)
alter npc(9,NPCstat:picture,466)

#wait(20)
#reset palette
#tweak palette(-13,-13,-13)
#update palette
#wait(6)
#reset palette
#tweak palette(-7,-7,-7)
#update palette
#wait(6)
#reset palette
#tweak palette(-4,-4,-4)
#update palette
#wait(6)
#reset palette
#tweak palette(-2,-2,-2)
#update palette
#wait(6)
#reset palette
#tweak palette(-1,-1,-1)
#update palette
#wait(6)
#reset palette
#update palette

wait(30)
jig gahn2(4)
show text box(3874)
jig gahn
wait for text box
jig hero(0)
tb(3875)
jig gahn2(4)
show text box(3876)
jig gahn
wait for text box
jig gahn
tb(3877)

pan camera(up,8,1)
wait(15)
palout(15)
wait for camera
show backdrop(43)
wait(15)
palin(15)

suspend box advance
textout(1)
show text box(3878)
wait(15)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3879)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3880)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3881)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
wait(3)
palout(3)
show backdrop(44)
wait(3)
palin(3)
textout
show text box(3882)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3883)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3884)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
wait(5)
textin(1)
show backdrop(7)
show text box(3885)
wait(3)
show backdrop(44)
wait for key(usekey)
show backdrop(7)
advance text box
show text box(3886)
wait(3)
show backdrop(44)
wait for key(usekey)
stop song
palout(5)
advance text box
resume box advance
show map
camera follows hero(0)
set hero position(0,27,158)
wait(1)
pan camera(south,0,0)
set hero position(0,27,168)
set npc position(1,28,168)
set npc position(2,27,169)
set npc position(3,26,168)
loadtileset(109)
wait(1)
play song(17)
palin(15)

suspend box advance
textout
show text box(3887)
wait(30)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3888)
wait(2)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3889)
wait(2)
textin(3)
wait for key(usekey)
textout(3)
advance text box
show text box(3890)
wait(5)
textin(3)
wait for key(usekey)
textout(3)
advance text box
resume boxadvance
wait(1)

alter npc(19,NPCstat:picture,467)
alter npc(20,NPCstat:picture,467)
alter npc(9,NPCstat:picture,467)
wait(3)
textin(1)

pan camera(south,10,1)
wait for camera

wait(20)
stop song
jig gahn2(4)
show text box(3891)
alter npc(19,NPCstat:picture,466)
alter npc(20,NPCstat:picture,466)
jig gahn
wait for text box
play song(58)
show text box(3892)
jig gahn
wait for text box
jig hero(0)
tb(3893)
jig gahn2(4)
show text box(3894)
jig gahn
wait for text box
jig gahn2(4)
show text box(3895)
jig gahn
wait for text box
jig gahn2(4)
show text box(3896)
jig gahn
wait for text box
jig gahn2(4)
show text box(3897)
alter npc(19,NPCstat:picture,465)
alter npc(20,NPCstat:picture,465)
jig gahn
wait for text box
jig hero(0)
tb(3898)
wait(2)
show backdrop(7)
wait(4)
show map
loadtileset(109)
show text box(3899)
jig gahn2(4)
jig gahn
wait for text box
jig npc(1)
tb(3900)
jig gahn2(4)
show text box(3901)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(3902)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(3903)
jig gahn2(2)
jig gahn
wait for text box
jig npc(2)
tb(3904)
show text box(3905)
wait(2)
alter npc(2,NPCstat:picture,469)
set npc direction(2,right)
wait for text box
jig gahn2(4)
show text box(3906)
jig gahn2(2)
jig gahn
wait for text box
jig npc(3)
tb(3907)
tb(3908)
jig npc(3)
show text box(3909)
wait(2)
alter npc(3,NPCstat:picture,469)
set npc direction(3,up)
wait for text box
wait(3)
jig npc(1)
tb(3910)
tb(3911)
jig npc(1)
show text box(3912)
wait(2)
alter npc(1,NPCstat:picture,385)
set npc direction(1,right)
wait for text box
wait(3)
jig hero(0)
tb(3913)
tb(3914)
tb(3915)
jig hero(0)
show text box(3916)
wait(2)
set hero picture(0,469)
set hero direction(0,down)
wait for text box

play song(57)

suspend box advance
show backdrop(7)
show text box(3917)
alter npc(19,NPCstat:picture,468)
alter npc(20,NPCstat:picture,463)
set npc direction(20,down)
set npc direction(15,up)
wait(5)
show map
loadtileset(109)
wait for key(usekey)
show backdrop(7)
show text box(3918)
wait(5)
show map
loadtileset(109)
wait for key(usekey)
show backdrop(7)
show text box(3919)
wait(5)
show map
loadtileset(109)
wait for key(usekey)
advance text box
resume box advance

show backdrop(7)
wait(5)
show map
loadtileset(109)
wait(5)
show backdrop(7)
wait(5)
show map
loadtileset(109)
wait(5)
show backdrop(7)
wait(5)
show map
loadtileset(109)
wait(5)
show backdrop(7)
wait(5)
show map
loadtileset(109)
wait(5)

variable(jjj)
for(jjj,1,4,1) do(
write color (0,1,50)
write color (28,1,50)
write color (44,1,50)
write color (60,1,50)
write color (76,1,50)
write color (188,1,50)
write color (239,1,50)
write color (252,1,50)
write color (240,1,50)
update palette
wait (1)
reset palette
update palette
tweak palette (0,30,0)
update palette
wait (1)
reset palette
update palette
show backdrop (7)
wait (1)
show map
loadtileset(109)
write color (0,1,50)
write color (28,1,50)
write color (44,1,50)
write color (60,1,50)
write color (76,1,50)
write color (188,1,50)
write color (239,1,50)
write color (252,1,50)
write color (240,1,50)
update palette
wait (1)
reset palette
update palette
tweak palette (0,30,0)
update palette
wait (1)
reset palette
update palette
show backdrop (7)
wait (1)
show map
loadtileset(109)
)

fade screen out(0,63,0)
wait(1)
fade screen out(0,0,0)
wait(1)
show backdrop(0)
wait(1)
fade screen in
wait(1)
fade screen out(0,63,0)
fade screen in
wait(1)
fade screen out(0,63,0)
alter npc(19,NPCstat:picture,95)
alter npc(20,NPCstat:picture,96)
set npc direction(20,down)
set death script(150)
set party in
wait(1)

#first fight
fight formation(599)
set variable(battlesfought,battlesfought+1)

#ground breaking away animation
show backdrop(220)
wait(30)
show backdrop(46)
wait(2)
show backdrop(220)
wait(2)
show backdrop(46)
wait(2)
show backdrop(220)
wait(30)

variable(drudge)
for(drudge,1,5,1) do(
show backdrop(220)
wait(2)
show backdrop(221)
wait(2)
)

wait(30)

#second fight
#have nix
if(check tag(479)) then(
fight formation(600)
)
#don't have nix
else(
fight formation(601)
)

play song(8)

set variable(battlesfought,battlesfought+1)

#final gahn setup animation
show backdrop(221)
wait(30)
show backdrop(46)
wait(3)
show backdrop(0)
wait(3)
show backdrop(46)
wait(3)
show backdrop(222)
wait(60)
show backdrop(46)
wait(10)
show backdrop(222)
wait(10)
show backdrop(46)
wait(10)
show backdrop(222)
wait(10)
show backdrop(46)
wait(3)
show backdrop(222)
wait(3)
show backdrop(46)
wait(3)
show backdrop(222)
wait(3)

variable(ijk)
for(ijk,1,3,1) do(
show backdrop(224)
wait(2)
show backdrop(222)
wait(2)
show backdrop(224)
wait(2)
show backdrop(7)
wait(2)
show backdrop(222)
wait(2)
)
fade screen out(0,63,0)

#set hero palettes
set hero palette(find hero(0),473,insidebattle)
set hero palette(find hero(1),474,insidebattle)
set hero palette(find hero(2),475,insidebattle)
set hero palette(find hero(3),476,insidebattle)

#set true jade ultimate
write spell(find hero(0),0,21,1792+1)

#third fight
#BIG DOG WOOF WOOF
fight formation(602)
set variable(battlesfought,battlesfought+1)

play song(8)

show map
loadtileset(109)
swap by position(find hero(0),0)

#reset hero palettes
set hero palette(find hero(0),1,insidebattle)
set hero palette(find hero(1),29,insidebattle)
set hero palette(find hero(2),33,insidebattle)
set hero palette(find hero(3),65,insidebattle)

#set final true jade skill
write spell(find hero(0),0,21,2227+1)

wait(5)
show backdrop(7)
wait(3)
show map
loadtileset(109)
wait(5)
show backdrop(7)
wait(3)
show map
loadtileset(109)
wait(5)
show backdrop(7)
wait(3)
show map
loadtileset(109)
wait(5)

set npc position(19,0,0)
alter npc(20,NPCstat:picture,135)
variable(j)
for(j,1,7,1) do(
set npc frame(20,1)
wait(1)
set npc frame(20,0)
wait(1)
)
set npc position(20,0,0)

focus camera(27,171,10)
alter npc(19,NPCstat:movespeed,10)
alter npc(20,NPCstat:movespeed,10)
wait for camera
focus camera(27,174,10)
set npc position(20,27,177)
for(j,1,7,1) do(
set npc frame(20,1)
wait(1)
set npc frame(20,0)
wait(1)
)
alter npc(19,NPCstat:picture,95)
alter npc(20,NPCstat:picture,96)
set npc direction(19,down)
set npc direction(20,down)
set npc position(19,27,176)
walk npc(19,right,9)
walk npc(20,right,9)
wait for camera

set hero position(0,27,168)
set npc position(1,27,168)
set npc position(2,27,168)
set npc position(3,27,168)
set hero picture(0,230)
alter npc(1,NPCstat:picture,233)
alter npc(2,NPCstat:picture,235)
alter npc(3,NPCstat:picture,236)

walk hero(0,down,2)
wait for hero(0)
#d2

walk hero(0,down,2)
walk npc(1,down,2)
wait for hero(0)
#d4,m2

walk hero(0,down,2)
walk npc(1,down,2)
walk npc(3,down,2)
wait for hero(0)
#d6,m4,p2

walk hero(0,down,2)
walk npc(1,down,2)
walk npc(3,down,2)
walk npc(2,down,2)
wait for hero(0)
#d8,m6,p4,j2

walk hero(0,down,1)
walk npc(1,down,1)
walk npc(3,down,1)
walk npc(2,down,1)
wait for hero(0)
#d9,m7,p5,j3

walk hero(0,right,2)
walk npc(1,down,2)
walk npc(3,down,2)
walk npc(2,down,2)
wait for hero(0)
#d2,m9,p7,j5

walk hero(0,right,1)
walk npc(1,right,1)
walk npc(3,down,1)
walk npc(2,down,1)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
wait for npc(2)
set npc frame(2,0)
set npc direction(2,right)
wait for npc(3)
set npc frame(3,0)
set npc direction(3,right)

wait(10)

#here is as good as anywhere
#setting johan gauge attacks back to normal
set tag(695,0)
#HP: 276, 278, 279, 280
if(check tag(696)) then(
	set tag(696,0)
	write spell(find hero(2),0,7,276+1)
)
if(check tag(697)) then(
	set tag(697,0)
	write spell(find hero(2),0,7,278+1)
)
if(check tag(698)) then(
	set tag(698,0)
	write spell(find hero(2),0,7,279+1)
)
if(check tag(699)) then(
	set tag(699,0)
	write spell(find hero(2),0,7,280+1)
)
#SD: 282, 285, 286, 287 
if(check tag(700)) then(
	set tag(700,0)
	write spell(find hero(2),0,8,282+1)
)
if(check tag(701)) then(
	set tag(701,0)
	write spell(find hero(2),0,8,285+1)
)
if(check tag(702)) then(
	set tag(702,0)
	write spell(find hero(2),0,8,286+1)
)
if(check tag(703)) then(
	set tag(703,0)
	write spell(find hero(2),0,8,287+1)
)

set npc direction(2,down)
jig npc(2)
tb(3924)
jig npc(2)
tb(3925)
jig npc(3)
tb(3926)
wait(2)
set npc direction(1,up)
jig npc(1)
show text box(3927)
wait(3)
set hero direction(0,up)
wait(3)
set hero picture(0,469)
set hero direction(0,left)
wait for text box
wait(10)
alter npc(1,NPCstat:picture,384)
wait(15)
alter npc(1,NPCstat:picture,233)
set npc direction(1,right)
wait(5)
jig npc(1)
tb(3928)
wait(3)
set npc frame(1,1)
wait(3)
set npc frame(1,0)
tb(3929)
wait(20)
stop song
#tb(3930)
set hero speed(0,5)
alter npc(1,NPCstat:movespeed,2)
set hero picture(0,230)
walk hero(0,right,4)
walk npc(1,right,2)
set npc direction(2,right)
wait for hero(0)
set hero frame(0,0)
wait for npc(1)
set npc frame(1,0)
jig npc(1)
show text box(3931)
wait(2)
set hero direction(0,down)
wait(3)
set hero direction(0,left)
wait for text box
wait(20)
variable(d1)
variable(d2)
variable(d3)
set variable(d1,create npc(21,34,177,))
set variable(d2,create npc(21,34,178,))
set variable(d3,create npc(21,34,179,))
walk npc(d1,up,2)
walk npc(d2,up,2)
walk npc(d3,up,2)
set npc direction(d2,left)
set npc direction(d3,right)
set hero direction(0,down)
wait(3)
walk hero(0,right,2)
walk npc(1,right,1)
show text box(3932)
wait for npc(1)
set npc frame(1,0)
wait for text box
tb(3933)

play song(19)
alter npc(1,NPCstat:picture,407)
set npc direction(1,right)
wait(2)
alter npc(1,NPCstat:picture,408)
set npc direction(1,down)
wait(2)
jig npc(1)
jig npc(1)
set npc direction(1,up)
show text box(3934)
jig npc(1)
jig npc(1)
set npc frame(1,1)
wait for text box
wait(10)
palout(10)
camera follows hero(0)
set hero position(0,45,126)
wait(1)
pan camera(south,0,0)
set hero position(0,45,120)
load tileset(67)
swap out hero(1)
swap out hero(2)
swap out hero(3)
wait(9)
palin(10)
walk hero(0,down,2)
wait for hero(0)
write pass block(45,121,1+2+4+8)
set hero frame(0,0)
set hero speed(0,hspeed)

resume npc walls
resume obstruction
resume npcs
resume player
end
###

###########################
script, gahnovergame, begin

if(current map == 98) then(
swap by position(find hero(0),0)
set hero frame(0,1)
alter npc(1,NPCstat:picture,468)
set npc direction(1,up)
set npc frame(2,1)
set npc frame(3,1)
play song(19)

show map
loadtileset(109)

wait(15)
jig gahn
tb(3920)
tb(3921)
wait(5)
jig gahn
tb(3922)
jig gahn
tb(3923)

wait(5)
fade screen out(63,0,0)
game over
)

if(current map == 68) then(
swap by position(find hero(0),0)
variable(hx)
variable(hy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
put hero(0,hx,hy+10)
set hero picture(0,486)
set hero direction(0,down)
alter npc(1,NPCstat:picture,137)
play song(19)
wait(1)
palout(1)
show map
wait(1)
palin(15)

wait(15)
variable(gx)
variable(gy)
set variable(gx,npc pixel x(6))
set variable(gy,npc pixel y(6))

variable(i)
variable(randox)
variable(randoy)
for(i,1,5,1) do(
set variable(randox,random(-1,1))
set variable(randoy,random(-1,1))
put npc(5,gx+randox,gy--20+randoy)
put npc(6,gx+randox,gy+randoy)
wait(1)
)
put npc(5,gx,gy--20)
put npc(6,gx,gy)
wait(1)

variable(gg1)
variable(gg2)
alter npc(5,NPCstat:picture,475)
alter npc(6,NPCstat:picture,475)
set variable(gg1,create npc(5,(gx/20)--1,gy/20,right))
set variable(gg2,create npc(5,(gx/20)+1,gy/20,left))
set npc direction(5,up)
wait(20)

for(i,1,5,1) do(
set variable(randox,random(-1,1))
set variable(randoy,random(-1,1))
put npc(5,gx+randox,gy--20+randoy)
put npc(6,gx+randox,gy+randoy)
put npc(gg1,gx--20+randox,gy+randoy)
put npc(gg2,gx+20+randox,gy+randoy)
wait(1)
)
put npc(5,gx,gy--20)
put npc(6,gx,gy)
put npc(gg1,gx--20,gy)
put npc(gg2,gx+20,gy)
wait(10)

jig gahn
tb(6451)

wait(10)
for(i,1,5,1) do(
set variable(randox,random(-1,1))
set variable(randoy,random(-1,1))
put npc(5,gx+randox,gy--20+randoy)
put npc(6,gx+randox,gy+randoy)
put npc(gg1,gx--20+randox,gy+randoy)
put npc(gg2,gx+20+randox,gy+randoy)
wait(1)
)
put npc(5,gx,gy--20)
put npc(6,gx,gy)
put npc(gg1,gx--20,gy)
put npc(gg2,gx+20,gy)
wait(10)

jig gahn
tb(6452)

wait(15)

jig gahn
tb(6453)

wait(5)

jig gahn2(2)
tb(6454)

wait(5)
alter npc(5,NPCstat:picture,476)
alter npc(6,NPCstat:picture,476)
wait(3)
set npc frame(5,1)
set npc frame(6,1)
set npc frame(gg1,1)
set npc frame(gg2,1)
wait(15)

palout(15)
wait(15)
game over
)
end
###

############################
script, grinlowkatina1, begin
suspend player
suspend npcs
suspend obstruction

stop song

wait(10)
set hero speed(0,2)
walk hero(0,down,1)
wait for hero(0)
set hero frame(0,0)
wait(15)
set npc direction(16,right)
play song(91)
wait(20)
tb(3935)
wait(8)
alter npc(16,NPCstat:picture,470)
wait(4)
tb(3936)
wait(15)
set npc direction(16,up)
wait(8)
jig npc(16)
tb(3937)
wait(4)
jig hero(0)
tb(3938)
wait(3)
set npc direction(16,left)
wait(3)
jig npc(16)
tb(3939)
walk npc(16,left,1)
wait for npc(16)
set npc frame(16,0)
alter npc(16,NPCstat:picture,358)
set hero speed(0,hspeed)

resume obstruction
resume npcs
resume player
end
###

#############################
script, grinlowkatina2, begin
suspend player
suspend npcs
suspend obstruction
set hero direction(0,down)

stop song
show text box(3940)
wait(3)
alter npc(16,NPCstat:picture,470)
wait(3)
set hero picture(0,376)
wait for text box
wait(10)
jig npc(16)
play song(97)
tb(3941)
wait(5)
tb(3942)
wait(12)
jig npc(16)
tb(3943)
wait(5)
alter npc(16,NPCstat:picture,358)
tb(3944)
set hero speed(0,2)
wait(3)
set hero picture(0,230)
set hero direction(0,left)
wait(3)
walk hero(0,up,4)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,left)
wait(3)
jig hero(0)
tb(3945)
wait(10)
alter npc(16,NPCstat:picture,470)
wait(2)
tb(3946)
wait(5)
set npc direction(16,down)
wait(8)
set npc direction(16,right)
alter npc(16,NPCstat:picture,358)
wait(5)
jig npc(16)
tb(3947)
jig hero(0)
show text box(3948)
wait(3)
alter npc(16,NPCstat:picture,470)
wait(3)
alter npc(16,NPCstat:picture,362)
wait for text box
jig npc(16)
tb(3949)
wait(5)
jig npc(16)
tb(3950)
jig hero(0)
tb(3951)
jig npc(16)
jig npc(16)
show text box(3952)
wait(3)
alter npc(16,NPCstat:picture,358)
wait for text box
wait(15)
alter npc(16,NPCstat:picture,362)
wait(5)
jig npc(16)
tb(3953)
jig hero(0)
tb(3954)
jig npc(16)
tb(3955)
show text box(3956)
set hero speed(0,hspeed)
alter npc(16,NPCstat:display text,3957)
alter npc(16,NPCstat:whenactivated,npcwhenactivated:changedirection)
wait for text box

resume obstruction
resume npcs
resume player
end
###

##########################
script, grinlowdart, begin
suspend player
suspend npcs
suspend obstruction

stop song

jig npc(17)
tb(3958)
set hero speed(0,2)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
wait(3)
jig hero(0)
tb(3959)
wait(3)
set npc direction(17,right)
wait(2)
set npc direction(17,down)
wait(2)
play song(64)
jig npc(17)
tb(3960)
tb(3961)
wait(5)
set npc direction(17,left)
wait(5)
jig npc(17)
tb(3962)


stop song
wait(10)
palout(10)
camera follows hero(0)
teleport to map(68,21,37)
play song(79)
set hero palette(0,4)
wait(1)
pan camera(south,0,0)
alter npc(4,NPCstat:picture,104)
alter npc(1,NPCstat:picture,137)
set npc direction(1,up)
alter npc(2,NPCstat:picture,134)
set npc direction(2,down)
alter npc(3,NPCstat:picture,137)
set npc direction(3,down)
set hero picture(0,97)
set hero direction(0,left)
set npc position(2,19,38)
set npc position(4,20,38)
set npc direction(4,left)
set npc position(5,22,36)
set npc position(6,22,37)
set npc direction(5,down)
set npc direction(6,down)
set hero position(0,21,40)
set npc position(1,20,40)
set npc position(3,22,40)
wait(10)

reset palette
greyscale palette
tweak palette (-40,-40,-40)
update palette
wait (15)
reset palette
greyscale palette
tweak palette (-20,-20,-20)
update palette
wait (15)
reset palette
greyscale palette
tweak palette (-10,-10,-10)
update palette
wait (15)
reset palette
greyscale palette
tweak palette (-5,-5,-5)
update palette
wait (15)
reset palette
greyscale palette
update palette


##########################################################
wait(15)
suspend box advance
textout(1)
show text box(3963)
wait(2)
textin(2)
wait for key(usekey)
textout(2)
advance text box

jig npc(2)
#tb(412)
set npc frame(4,1)
wait(1)
show backdrop(1)
set npc frame(4,0)
alter npc(2,NPCstat:move speed,5)
wait(1)
show map
walk npc(2,left,1)
wait for npc(2)
set npc direction(2,down)
set npc frame(2,0)
#tb(413)
jig npc(2)
#tb(414)
walk npc(4,left,1)
wait for npc(4)
set npc frame(4,0)
wait(5)

variable(i)
for(i,1,4,1) do(
set npc frame(4,1)
wait(1)
show backdrop(1)
set npc frame(4,0)
set npc direction(2,left)
wait(1)
show map
wait(1)
set npc direction(2,down)
wait(2)
)

wait(10)
set npc direction(2,up)
wait(2)
alter npc(4,NPCstat:picture,133)
set npc direction(4,down)
wait(20)

show text box(3964)
wait(2)
textin(2)
wait for key(usekey)
textout(2)
advance text box
wait(20)

set npc direction(3,left)
wait(4)
set npc direction(3,down)
wait(2)
set npc direction(3,left)
wait(5)
set npc direction(3,down)
wait(1)
alter npc(3,NPCstat:picture,110)
set npc direction(3,up)
wait(2)
set npc direction(3,right)
wait(2)
alter npc(3,NPCstat:move speed,4)
walk npc(3,down,5)
alter npc(5,NPCstat:picture,95)
alter npc(6,NPCstat:picture,96)
set npc frame(5,0)
set npc frame(6,0)
wait(2)
set npc frame(5,1)
set npc frame(6,1)
set npc position(7,npcx(6),npcy(6))
alter npc(7,NPCstat:move speed,20)
wait(2)
walk npc(7,down,3)
set npc frame(5,0)
set npc frame(6,0)
wait(2)
alter npc(5,NPCstat:picture,131)
alter npc(6,NPCstat:picture,132)
set hero direction(0,right)
wait for npc(7)
tweak palette(63,63,63)
update palette
set hero picture(0,59)
set npc direction(4,right)
wait(1)
reset palette
greyscale palette
update palette
write pass block (25,40,0)
walk npc(7,right,8)
wait(10)
set hero picture(0,1)
wait for npc(7)
set npc direction(8,right)
set npc frame(8,0)
set npc position(8,herox(0),heroy(0))
wait(1)
set hero position(0,3,3)
set npc direction(8,up)
alter npc(5,NPCstat:picture,0)
alter npc(6,NPCstat:picture,135)
set npc position(9,npcx(6),npcy(6))
set npc position(5,npcx(8),npcy(8))
set npc position(6,npcx(8),npcy(8)+1)

for(i,1,5,1) do(
wait(1)
set npc frame(9,1)
set npc frame(6,0)
wait(1)
set npc frame(9,0)
set npc frame(6,1)
)

set npc position(9,0,0)
set npc direction(5,up)
set npc direction(6,up)
set npc frame(5,0)
set npc frame(6,0)
wait(1)
show backdrop(1)
alter npc(5,NPCstat:picture,95)
alter npc(6,NPCstat:picture,96)
set npc position(9,npcx(8),npcy(8)+1)
alter npc(8,NPCstat:picture,47)
alter npc(9,NPCstat:picture,47)
walk npc(8,up,2)
walk npc(9,up,2)
set npc direction(8,right)
set npc direction(9,down)
wait(1)
show map
set npc frame(5,1)
set npc frame(6,1)
wait(1)
set npc frame(5,0)
set npc frame(6,0)
wait(5)
alter npc(5,NPCstat:picture,131)
alter npc(6,NPCstat:picture,132)
wait for npc(8)
wait for npc(9)
alter npc(8,NPCstat:move speed,4)
alter npc(9,NPCstat:move speed,4)
walk npc(8,up,1)
walk npc(9,up,1)
set npc direction(8,right)
set npc direction(9,down)
wait for npc(8)
wait for npc(9)
set npc direction(4,up)
alter npc(8,NPCstat:move speed,2)
alter npc(9,NPCstat:move speed,2)
walk npc(8,up,1)
walk npc(9,up,1)
set npc direction(8,right)
set npc direction(9,down)
wait for npc(8)
wait for npc(9)
set hero picture(0,47)
set hero position(0,npcx(8),npcy(8))
set npc position(8,3,3)
set npc position(10,herox(0),heroy(0))

textout(1)
show text box(3965)
wait(15)
textin(2)
wait for key(usekey)
textout(2)
advance text box
wait(15)

set npc direction(5,left)
set npc direction(6,left)
#jig gahn
#show text box(415)
wait(2)
set npc direction(4,right)
wait(2)
set npc direction(4,down)
#wait for text box
#jig gahn
#tb(416)
#jig gahn
#tb(417)

wait(8)
set npc direction(1,right)
wait(3)
alter npc(1,NPCstat:picture,15)
set npc direction(1,up)
wait(10)
set npc direction(1,right)
wait(2)
alter npc(5,NPCstat:picture,95)
alter npc(6,NPCstat:picture,96)
walk npc(5,down,4)
walk npc(6,down,4)
wait(3)
alter npc(4,NPCstat:picture,104)
walk npc(4,down,8)
wait(10)
walk npc(1,down,1)
wait for npc(1)
wait(20)
set npc direction(1,left)
wait(2)
set npc direction(1,up)
wait(40)
set npc direction(1,right)
wait(2)
walk npc(1,down,3)
wait for npc(1)
####################################################


show text box(3966)
wait(2)
textin(2)
wait for key(usekey)
textout(2)
advance text box

show text box(3967)
wait(2)
textin(2)
wait for key(usekey)
textout(2)
advance text box

show text box(3968)
wait(2)
textin(2)
wait for key(usekey)
textout(2)
advance text box
resume box advance

palout(15)
camera follows hero(0)
teleport to map(98,27,138)
stop song
set hero palette(0,1)
wait(1)
pan camera(south,0,0)
set npc direction(17,left)
set hero picture(0,230)
set hero direction(0,up)
wait(10)
palin(10)

wait(15)
jig npc(17)
tb(3969)
play song(92)
jig hero(0)
tb(3970)
wait(3)
set npc direction(17,down)
wait(3)
jig npc(17)
tb(3971)
jig hero(0)
tb(3972)
jig npc(17)
tb(3973)
walk npc(17,down,1)
wait for npc(17)
set npc position(17,0,0)

write pass block(35,140,1+2+4+8)
add hero(15)
set hero speed(0,hspeed)
tb(6439)

resume obstruction
resume npcs
resume player
end
###

##########################
script, nojadesword, begin
pan camera(south,0,0)
suspend npc walls

wait(5)
play song(58)
jig gahn2(4)
show text box(3974)
jig gahn2(2)
jig gahn
wait for text box
jig hero(0)
tb(3975)

jig gahn2(4)
if(check tag(704)) then(show text box(3977))
else(show text box(3976))
jig gahn2(2)
jig gahn
wait for text box

variable(g1)
variable(g2)

jig gahn2(4)
alter npc(5,NPCstat:picture,479)
alter npc(6,NPCstat:picture,479)
set npc direction(5,up)
set variable(g1,create npc(5,20,36,left))
set variable(g2,create npc(5,20,37,right))
show text box(3978)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(3979)
jig gahn2(2)
jig gahn
wait for text box
jig hero(0)
tb(3980)
wait(5)
set npc position(g1,0,0)
set npc position(g2,0,0)
alter npc(5,NPCstat:picture,482)
alter npc(6,NPCstat:picture,483)
set npc direction(5,down)
wait(10)
jig gahn2(2)
show text box(3981)
jig gahn
wait for text box

jig hero(0)
tb(3982)
play song(57)
jig hero(0)
tb(3983)
variable(df)
show text box(3984)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
show text box(3985)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
show text box(3986)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
show text box(3987)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
show text box(3988)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
wait(2)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
set hero picture(0,484)
wait(7)

alter npc(5,NPCstat:picture,480)
alter npc(6,NPCstat:picture,481)
walk npc(5,up,1)
walk npc(6,up,1)
set npc direction(5,down)
set npc direction(6,down)
wait for npc(5)
wait for npc(6)
set npc frame(5,0)
set npc frame(6,0)
jig gahn2(4)
show text box(3989)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(3990)
jig gahn2(2)
jig gahn
wait for text box

walk npc(5,up,1)
walk npc(6,up,1)
set npc direction(5,down)
set npc direction(6,down)
wait for npc(5)
wait for npc(6)
set npc frame(5,0)
set npc frame(6,0)
jig gahn2(6)
show text box(3991)
jig gahn2(4)
jig gahn2(2)
wait for text box
set npc frame(5,1)
set npc frame(6,1)
wait(2)
set npc frame(5,0)
set npc frame(6,0)
wait(2)
jig gahn2(6)
show text box(3992)
jig gahn2(6)
jig gahn2(4)
wait for text box

wait(3)
show text box(3993)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
show text box(3994)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box


if(check tag(704)) then(
set npc direction(1,left)
jig npc(1)
tb(3995)
tb(3996)
show text box(3997)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
show text box(3998)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box
jig npc(1)
show text box(3999)
jig npc(1)
jig npc(1)
wait for text box
)
else(
jig gahn
tb(4000)
)


show text box(4001)
for(df,1,5,1) do(
set hero palette(0,1)
wait(1)
set hero palette(0,4)
wait(1)
)
wait for text box

suspend box advance
tweak palette(63,63,63)
update palette
show text box(4002)
wait(4)
if(check tag(704)) then(
walk npc(1,right,1)
set npc direction(1,left)
)

reset palette
update palette
if(check tag(704)) then(
wait for npc(1)
set npc frame(1,0)
)
wait for key(usekey)
reset palette
tweak palette(63,63,63)
update palette
advance text box
show text box(4003)
stop song
set hero speed(0,10)
alter npc(5,NPCstat:movespeed,2)
alter npc(6,NPCstat:movespeed,2)
wait(4)
reset palette
update palette
wait for key(usekey)
advance text box

set hero picture(0,230)
walk hero(0,up,5)
walk npc(5,up,1)
walk npc(6,up,1)
set npc direction(5,down)
set npc direction(6,down)
pan camera(up,1,2)
wait(2)
set npc direction(1,up)
wait for hero(0)

fade screen out(63,63,63)
set hero picture(0,484)
set hero direction(0,down)
alter npc(5,NPCstat:picture,477)
alter npc(6,NPCstat:picture,477)
set hero position(0,21,34)
set npc position(5,21,33)
set npc position(6,21,34)
set npc position(g1,20,33)
set npc position(g2,20,34)
set npc direction(5,up)
set npc direction(6,down)
set npc direction(g1,left)
set npc direction(g2,right)
variable(hx)
variable(hy)
#variable(cx)
#variable(cy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
#set variable(cx,camera pixel x)
#set variable(cy,camera pixel y)
put npc(5,hx,hy--30)
put npc(6,hx,hy--10)
put npc(g1,hx--20,hy--30)
put npc(g2,hx--20,hy--10)
wait(20)

###########boo, dogero shouldn't have to die! get jade sword, fool!

reset palette
tweak palette(15,15,15)
update palette
wait(5)
put npc(5,hx,hy--31)
put npc(6,hx,hy--11)
put npc(g1,hx--20,hy--31)
put npc(g2,hx--20,hy--11)
wait(5)

reset palette
tweak palette(12,12,12)
update palette
put hero(0,hx,hy--1)
wait(5)
put npc(5,hx,hy--32)
put npc(6,hx,hy--12)
put npc(g1,hx--20,hy--32)
put npc(g2,hx--20,hy--12)
wait(5)

reset palette
tweak palette(9,9,9)
update palette
put hero(0,hx,hy--2)
wait(5)
put npc(5,hx,hy--33)
put npc(6,hx,hy--13)
put npc(g1,hx--20,hy--33)
put npc(g2,hx--20,hy--13)
wait(5)

reset palette
tweak palette(6,6,6)
update palette
put hero(0,hx,hy--3)
wait(5)
put npc(5,hx,hy--34)
put npc(6,hx,hy--14)
put npc(g1,hx--20,hy--34)
put npc(g2,hx--20,hy--14)
wait(5)

reset palette
tweak palette(4,4,4)
update palette
put hero(0,hx,hy--4)
wait(5)
put npc(5,hx,hy--35)
put npc(6,hx,hy--15)
put npc(g1,hx--20,hy--35)
put npc(g2,hx--20,hy--15)
wait(5)

##########end inferior ending

fade screen out
camera follows hero(0)
teleport to map(0,0,0)
play song(17)
set hero picture(0,0)
reset palette
wait(60)
fade screen in
end
###

############################
script, nojadecredits, begin
textout(1)
show text box(6445)
wait(4)
textin(3)
wait(35)
textout(3)
advance text box

show text box(6447)
wait(10)
textin(3)
wait(65)
textout(3)
advance text box

show text box(6446)
wait(10)
textin(3)
wait(65)
textout(3)
advance text box

show text box(6448)
wait(10)
textin(3)
wait(65)
textout(3)
advance text box

show text box(6449)
wait(10)
textin(3)
wait(150)
textout(3)
advance text box

show text box(6450)
wait(10)
textin(3)
wait(50)
show back drop(7)
wait(5)
show map
wait(5)
show back drop(7)
wait(5)
show map
wait(5)
show back drop(7)
wait(5)
show map
wait(5)
fade screen out(0,63,0)
wait(10)
game over
end
###

##########################
script, finalbattle, begin
pan camera(south,0,0)
suspend npc walls

play song(58)

wait(5)
jig gahn2(4)
show text box(4004)
jig gahn2(2)
jig gahn
wait for text box
jig hero(0)
tb(4005)
jig gahn2(4)
if(check tag(704)) then(show text box(4007))
else(show text box(4006))
jig gahn2(2)
jig gahn
wait for text box

variable(g1)
variable(g2)

jig gahn2(4)
alter npc(5,NPCstat:picture,479)
alter npc(6,NPCstat:picture,479)
set npc direction(5,up)
set variable(g1,create npc(5,20,36,left))
set variable(g2,create npc(5,20,37,right))
show text box(4008)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(4009)
jig gahn2(2)
jig gahn
wait for text box
jig hero(0)
tb(4010)

alter npc(5,NPCstat:picture,480)
alter npc(6,NPCstat:picture,481)
set npc position(g1,0,0)
set npc position(g2,0,0)
walk npc(5,down,1)
walk npc(6,down,1)
wait(2)
jig gahn2(4)
show text box(4011)
jig gahn2(2)
jig gahn
wait for npc(5)
wait for npc(6)
set npc frame(5,0)
set npc frame(6,0)
alter npc(5,NPCstat:picture,482)
alter npc(6,NPCstat:picture,483)
wait for text box

jig gahn2(4)
show text box(4012)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(4013)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(4014)
jig gahn2(2)
jig gahn
wait for text box

jig hero(0)
tb(4015)

jig gahn2(2)
show text box(4016)
jig gahn
wait for text box

jig hero(0)
tb(4017)

jig gahn2(2)
show text box(4018)
jig gahn
wait for text box
jig gahn
tb(4019)

stop song
palout(2)
show backdrop(0)
wait(1)
palin(2)
play song(17)
suspend box advance
textout(1)
show text box(4020)
wait(3)
textin(2)
wait for key(usekey)
textout(2)
advance text box
show text box(4021)
wait(3)
textin(2)
wait for key(usekey)
textout(2)
advance text box
show text box(4050)
wait(3)
textin(2)
wait for key(usekey)
textout(2)
advance text box
wait(3)
tweak palette(0,63,0)
update palette
show map
alter npc(5,NPCstat:picture,478)
alter npc(6,NPCstat:picture,478)
set npc direction(5,up)
set npc position(g1,22,37)
set npc direction(g1,left)
set npc position(g2,20,38)
set npc direction(g2,right)
show text box(4022)
wait(4)
play song(57)
reset palette
update palette
resume box advance
jig gahn2(3)
jig gahn
wait for text box

wait(4)
jig hero(0)
tb(4023)
tb(4024)
wait(5)
set npc position(g1,0,0)
set npc position(g2,0,0)
alter npc(5,NPCstat:picture,482)
alter npc(6,NPCstat:picture,483)
set npc direction(5,down)
jig gahn2(4)
show text box(4025)
jig gahn2(2)
jig gahn
wait for text box

wait(5)
jig hero(0)
tb(4026)

jig gahn2(2)
show text box(4027)
jig gahn
wait for text box
set hero speed(0,5)
walk hero(0,up,1)
wait for hero(0)
set hero frame(0,0)
jig hero(0)
tb(4028)

jig gahn2(4)
show text box(4029)
jig gahn2(2)
wait for text box
jig gahn2(6)
show text box(4030)
jig gahn2(4)
jig gahn2(2)
wait for text box

wait(15)
jig hero(0)
tb(4031)
wait(2)
tb(4032)

alter npc(5,NPCstat:picture,479)
alter npc(6,NPCstat:picture,479)
set npc position(g1,20,38)
set npc direction(g1,right)
set npc direction(5,up)
jig gahn2(2)
show text box(4033)
jig gahn
wait for text box

jig hero(0)
tb(4034)

jig gahn2(4)
show text box(4035)
jig gahn2(2)
jig gahn
wait for text box

jig hero(0)
tb(4036)
jig hero(0)
tb(4037)
wait(10)
set npc position(g1,0,0)
set npc position(g2,0,0)
alter npc(5,NPCstat:picture,482)
alter npc(6,NPCstat:picture,483)
set npc direction(5,down)
wait(20)
jig hero(0)
tb(4038)

wait(15)
stop song
jig hero(0)
set hero picture(0,486)
set npc position(12,herox(0)--1,heroy(0))
walk npc(12,left,2)
wait(4)
set hero picture(0,485)
wait for npc(12)
set npc position(12,2,0)
wait(15)
jig hero(0)
fade screen out(0,63,0)
set hero picture(0,487)
set hero palette(0,120)
wait(1)
fade screen in
wait(5)
play song(65)
tb(4039)

jig gahn2(4)
show text box(4040)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(4)
show text box(4041)
jig gahn2(2)
jig gahn
wait for text box

wait(25)
show text box(4042)
variable(juggles)
for(juggles,1,5,1) do(
set hero palette(0,117)
wait(1)
set hero palette(0,120)
wait(1)
)
wait for text box
show text box(4043)
wait(2)
set hero direction(0,down)
wait for text box

wait(4)
jig gahn2(6)
show text box(4044)
jig gahn2(4)
jig gahn2(2)
jig gahn
wait for text box

suspend box advance
tweak palette(0,63,0)
update palette
show text box(4045)
wait(5)
reset palette
update palette
jig gahn2(4)
jig gahn2(2)
jig gahn
wait for key(usekey)
tweak palette(0,63,0)
update palette
advance text box
show text box(4046)
stop song
wait(5)
reset palette
update palette
jig gahn2(8)
jig gahn2(6)
jig gahn2(4)
wait for key(usekey)
show backdrop(7)
advance text box
resume box advance
wait(8)
show map
wait(8)
show backdrop(7)
wait(8)
show map
wait(8)
show backdrop(7)
wait(8)
show map
wait(20)
tweak palette(63,63,63)
update palette
wait(2)
reset palette
update palette
wait(4)
tweak palette(63,63,63)
update palette
wait(2)
reset palette
update palette
wait(15)
fade screen out(0,63,0)
set hero picture(0,11,inside battle)
swap by position(find hero(0),1)
if(check tag(38)) then(swap by position(find hero(7),2))
show backdrop(0)
wait(10)
fight formation(0)
end
###

########################
script, aftermath, begin

aftermath1
aftermath2
aftermath3
aftermath4
aftermath5

end
###
#########################
script, aftermath1, begin
swap by position(find hero(0),0)
variable(hx)
variable(hy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
put hero(0,hx,hy+10)
set hero picture(0,486)
set hero direction(0,down)
alter npc(1,NPCstat:picture,137)
variable(gg1)
variable(gg2)
alter npc(5,NPCstat:picture,475)
alter npc(6,NPCstat:picture,475)
variable(gx)
variable(gy)
set variable(gx,npc pixel x(6))
set variable(gy,npc pixel y(6))
set variable(gg1,create npc(5,(gx/20)--1,gy/20,right))
set variable(gg2,create npc(5,(gx/20)+1,gy/20,left))
set npc direction(5,up)
wait(1)
palout(1)
show map
wait(1)
palin(15)

wait(50)
jig gahn
tb(4047)
wait(10)

variable(i)
variable(randox)
variable(randoy)
for(i,1,5,1) do(
set variable(randox,random(-1,1))
set variable(randoy,random(-1,1))
put npc(5,gx+randox,gy--20+randoy)
put npc(6,gx+randox,gy+randoy)
put npc(gg1,gx--20+randox,gy+randoy)
put npc(gg2,gx+20+randox,gy+randoy)
wait(1)
)
put npc(5,gx,gy--20)
put npc(6,gx,gy)
put npc(gg1,gx--20,gy)
put npc(gg2,gx+20,gy)

wait(15)

for(i,1,10,1) do(
set variable(randox,random(-1,1))
set variable(randoy,random(-1,1))
put npc(5,gx+randox,gy--20+randoy)
put npc(6,gx+randox,gy+randoy)
put npc(gg1,gx--20+randox,gy+randoy)
put npc(gg2,gx+20+randox,gy+randoy)
wait(1)
)
put npc(5,gx,gy--20)
put npc(6,gx,gy)
put npc(gg1,gx--20,gy)
put npc(gg2,gx+20,gy)

wait(20)
jig gahn
tb(4048)
wait(10)
alter npc(5,NPCstat:picture,476)
alter npc(6,NPCstat:picture,476)
wait(3)
set npc frame(5,1)
set npc frame(6,1)
set npc frame(gg1,1)
set npc frame(gg2,1)
jig gahn
tb(4049)

wait(25)

variable(nx)
variable(ny)
if(check tag(704)) then(
set variable(nx,npc pixel x(1))
set variable(ny,npc pixel y(1))
for(i,1,5,1) do(
put npc(1,nx+random(-1,1),ny+random(-1,1))
wait(1)
)
put npc(1,nx,ny)
wait(15)
for(i,1,3,1) do(
put npc(1,nx+random(-1,1),ny+random(-1,1))
wait(1)
)
put npc(1,nx,ny)
set npc direction(1,right)
wait(4)
alter npc(1,NPCstat:picture,15)
set npc direction(1,up)
wait(20)
walk npc(1,up,1)
wait for npc(1)
set npc frame(1,0)
wait(5)
set npc direction(1,left)
wait(15)
jig npc(1)
tb(4052)
wait(10)
alter npc(1,NPCstat:picture,39)
wait(5)
set npc frame(1,1)
wait(15) 
tb(4053)
wait(5)
)

palout(10)
camera follows hero(0)
teleport to map(98,27,174)
wait(1)
pan camera(south,0,0)
set hero position(0,27,167)
load tileset(109)
set npc position(1,27,176)
set npc position(2,29,175)
set npc position(3,33,177)
alter npc(2,NPCstat:picture,404)
set npc direction(2,down)
set npc direction(3,right)
create npc(21,34,175,up)
create npc(21,34,176,left)
create npc(21,34,177,right)
alter npc(1,NPCstat:picture,382)
alter npc(1,NPCstat:movespeed,2)
set npc direction(1,right)
wait(10)
walk npc(1,right,4)
palin(10)

set npc direction(2,right)
wait for npc(1)
set npc frame(1,0)
wait(20)
set npc direction(1,down)
wait(3)
walk npc(1,left,2)
wait for npc(1)
walk npc(1,left,2)
set npc direction(2,down)
wait for npc(1)
set npc frame(1,0)
set npc direction(2,left)
wait(15)
jig npc(1)
tb(4054)
jig npc(1)
tb(4055)
jig npc(1)
tb(4056)

wait(5)
jig npc(2)
tb(4057)
wait(2)
set npc direction(1,down)
wait(2)
set npc direction(1,right)
show text box(4058)
jig npc(1)
wait for text box
wait(5)
alter npc(3,NPCstat:movespeed,2)
set npc direction(3,down)
wait(2)
walk npc(3,left,2)
show text box(4059)
wait for npc(3)
set npc frame(3,0)
wait for text box

wait(12)
set npc direction(1,down)
wait(2)
set npc direction(1,left)
wait(8)
jig npc(1)
tb(4060)
tb(4061)
wait(10)
alter npc(1,NPCstat:picture,381)
wait(15)
jig npc(1)
show text box(4062)
wait(3)
alter npc(1,NPCstat:picture,386)
set npc frame(1,1)
wait for text box

wait(20)
jig npc(3)
tb(4063)
wait(2)
tb(4064)
wait(10)
jig npc(2)
tb(4065)

wait(30)
stop song
set npc position(9,18,177)
alter npc(9,NPCstat:movespeed,2)
walk npc(9,right,6)
wait(5)
set npc frame(1,0)
wait(5)
alter npc(2,NPCstat:picture,235)
set npc direction(2,down)
wait(3)
set npc direction(2,left)
wait for npc(9)
set npc frame(9,0)
wait(3)

set npc frame(9,1)
wait(3)
set npc frame(9,0)
play song(97)
tb(4066)
alter npc(3,NPCstat:movespeed,4)
walk npc(3,left,6)
wait for npc(3)
set npc frame(3,0)
jig npc(3)
tb(4067)
wait(3)
set npc frame(9,1)
wait(3)
set npc frame(9,0)
tb(4068)
wait(10)
jig npc(9)
tb(4069)
show text box(4070)
wait(2)
alter npc(1,NPCstat:picture,233)
wait for text box
jig npc(9)
tb(4071)
wait(15)
jig npc(1)
tb(4072)
jig npc(9)
tb(4073)
wait(10)
jig npc(9)
tb(4074)
jig npc(1)
tb(4075)
wait(10)
set npc direction(2,down)
wait(2)
set npc direction(2,right)
wait(10)
jig npc(2)
tb(4076)
set npc direction(1,down)
wait(1)
set npc direction(3,down)
wait(2)
set npc direction(1,right)
wait(1)
set npc direction(3,right)
wait(7)
walk npc(3,right,3)
wait for npc(3)
set npc frame(3,0)
jig npc(3)
tb(4077)

suspend npc walls
alter npc(21,NPCstat:movespeed,1)
wait(25)
walk npc(npc at spot(34,175),down,3)
set npc direction(npc at spot(34,175),up)
walk npc(npc at spot(34,176),down,3)
set npc direction(npc at spot(34,176),left)
walk npc(npc at spot(34,177),down,3)
set npc direction(npc at spot(34,177),right)

wait(40)
set npc position(16,36,177)
alter npc(16,NPCstat:picture,362)
alter npc(16,NPCstat:movespeed,4)
walk npc(16,left,5)
wait for npc(16)
set npc frame(16,0)
jig npc(16)
tb(4078)
tb(4079)
jig npc(16)
tb(4080)

alter npc(1,NPCstat:movespeed,5)
alter npc(2,NPCstat:movespeed,5)
alter npc(3,NPCstat:movespeed,5)
alter npc(9,NPCstat:movespeed,5)
walk npc(2,down,1)
walk npc(3,up,1)
walk npc(9,up,1)
wait for npc(9)
walk npc(2,right,4)
walk npc(3,right,4)
walk npc(1,right,4)
walk npc(9,right,4)
wait for npc(9)
walk npc(2,down,1)
walk npc(3,right,1)
walk npc(1,right,1)
walk npc(9,right,1)
wait for npc(9)
walk npc(2,right,3)
walk npc(3,down,1)
walk npc(1,right,1)
walk npc(9,right,1)
wait for npc(9)
walk npc(3,right,3)
walk npc(1,down,1)
walk npc(9,right,1)
wait for npc(9)
walk npc(1,right,3)
walk npc(9,right,2)
wait for npc(9)
walk npc(9,down,1)
wait for npc(9)
walk npc(9,right,3)
wait for npc(9)
end
###
#########################
script, aftermath2, begin
variable(i)
wait(15)
alter npc(16,NPCstat:picture,355)
wait(2)
alter npc(16,NPCstat:picture,358)
wait(25)
alter npc(16,NPCstat:picture,362)
wait(5)
walk npc(16,left,10)
wait(10)
palout(10)
wait for npc(16)
camera follows hero(0)
teleport to map(68,21,37)
wait(1)
variable(gx)
variable(gy)
#variable(gg1)
#variable(gg2)
pan camera(south,0,0)
set hero position(0,21,40)
variable(hx)
variable(hy)
set variable(hx,hero pixel x(0))
set variable(hy,hero pixel y(0))
if(check tag(704)) then(
set npc position(1,22,40)
set npc direction(1,left)
)
set hero picture(0,486)
set hero direction(0,down)
put hero(0,hx,hy+6)
set npc position(5,21,37)
set npc position(6,21,38)
alter npc(5,NPCstat:picture,475)
alter npc(6,NPCstat:picture,475)
set variable(gx,npc pixel x(6))
set variable(gy,npc pixel y(6))
#set variable(gg1,create npc(5,(gx/20)--1,gy/20,right))
#set variable(gg2,create npc(5,(gx/20)+1,gy/20,left))
create npc(5,(gx/20)--1,gy/20,right)
create npc(5,(gx/20)+1,gy/20,left)
set npc direction(5,up)
alter npc(1,NPCstat:picture,39)
set npc frame(1,1)
wait(15)
palin(10)

if(check tag(704)) then(
wait(25)
tb(4081)
wait(15)
alter npc(1,NPCstat:picture,15)
set npc frame(1,0)
jig npc(1)
tb(4082)
wait(12)
for(i,1,5,1) do(
put hero(0,hx+random(-1,1),hy+6+random(-1,1))
wait(2)
)
put hero(0,hx,hy+6)
wait(10)
tb(4083)
jig npc(1)
tb(4084)
jig npc(1)
tb(4085)
wait(15)
for(i,1,5,1) do(
put hero(0,hx+random(-1,1),hy+6+random(-1,1))
wait(2)
)
put hero(0,hx,hy+6)
wait(15)
for(i,1,6,1) do(
put hero(0,hx+random(-1,1),hy+6+random(-1,1))
wait(1)
)
put hero(0,hx,hy)
set hero picture(0,488)
set hero direction(0,left)
wait(15)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
wait(3)
set hero direction(0,up)
wait(5)
tb(4086)
wait(3)
set hero direction(0,down)
for(i,1,3,1) do(
put hero(0,hx+random(-1,1),hy+random(-1,1))
wait(2)
)
put hero(0,hx,hy)
wait(3)
set hero picture(0,486)
put hero(0,hx,hy+6)
wait(30)
)
else(
wait(30)
for(i,1,5,1) do(
put hero(0,hx+random(-1,1),hy+6+random(-1,1))
wait(2)
)
put hero(0,hx,hy+6)
wait(20)
for(i,1,6,1) do(
put hero(0,hx+random(-1,1),hy+6+random(-1,1))
wait(1)
)
put hero(0,hx,hy)
set hero picture(0,488)
set hero direction(0,left)
wait(15)
set hero direction(0,down)
wait(3)
set hero direction(0,right)
wait(3)
set hero direction(0,up)
wait(20)
set hero direction(0,down)
wait(2)
set hero picture(0,486)
put hero(0,hx,hy+6)
wait(15)
)

palout(10)
camera follows hero(0)
teleport to map(98,27,126)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,28,133)
wait(10)
palin(10)

wait(15)
alter npc(9,NPCstat:movespeed,4)
set npc position(1,27,133)
set npc position(2,27,134)
set npc position(3,27,135)
set npc position(9,27,136)
walk npc(1,up,13)
wait(4)
walk npc(2,up,14)
wait(4)
walk npc(3,up,15)
wait(4)
walk npc(9,up,16)
wait for npc(9)
wait(10)

palout(2)
camera follows hero(0)
teleport to map(68,21,49)
wait(1)
pan camera(south,0,0)
set hero position(0,21,40)
if(check tag(704)) then(
set npc position(1,21,42)
set npc direction(1,down)
)
set hero position(0,21,40)
set hero picture(0,488)
set hero direction(0,left)
set npc position(5,21,37)
set npc position(6,21,38)
alter npc(5,NPCstat:picture,475)
alter npc(6,NPCstat:picture,475)
set variable(gx,npc pixel x(6))
set variable(gy,npc pixel y(6))
#set variable(gg1,create npc(5,(gx/20)--1,gy/20,right))
#set variable(gg2,create npc(5,(gx/20)+1,gy/20,left))
create npc(5,(gx/20)--1,gy/20,right)
create npc(5,(gx/20)+1,gy/20,left)
set npc direction(5,up)
write pass block(21,49,128)
write pass block(21,50,128)
wait(1)
palin(2)

set npc position(13,21,50)
set npc position(14,21,50)
set npc position(15,21,50)
set npc position(3,21,50)
wait(20)
pan camera(up,6,1)
wait(10)
walk npc(13,up,1)
wait for npc(13)
walk npc(13,up,1)
walk npc(14,up,1)
wait for npc(14)
walk npc(13,up,1)
walk npc(14,up,1)
walk npc(15,up,1)
wait for npc(15)
walk npc(13,up,2)
walk npc(14,up,2)
walk npc(15,up,2)
walk npc(3,up,2)
wait for npc(3)
walk npc(14,right,1)
walk npc(15,left,1)
walk npc(3,up,1)
set npc frame(13,0)
wait for npc(3)
walk npc(14,up,1)
walk npc(15,up,1)
walk npc(3,up,1)
wait for npc(3)
walk npc(15,up,1)
set npc frame(14,0)
set npc frame(3,0)
wait for npc(15)
set npc frame(15,0)
wait for camera
jig npc(13)
tb(4087)

variable(juggles)

if(check tag(704)) then(
walk npc(1,down,1)
wait(2)
show text box(4091)
wait for npc(1)
set npc frame(1,0)
wait for text box
jig npc(13)
tb(4092)
jig npc(1)
tb(4093)
wait(2)
set npc direction(1,right)
wait(2)
set npc direction(1,up)
)
else(
show text box(4088)
for(juggles,1,5,1) do(
set hero palette(0,117)
wait(1)
set hero palette(0,120)
wait(1))
wait for text box
walk npc(13,up,1)
wait(2)
show text box(4089)
wait for npc(13)
set npc frame(13,0)
wait for text box
wait(3)
show text box(4090)
for(juggles,1,5,1) do(
set hero palette(0,117)
wait(1)
set hero palette(0,120)
wait(1))
wait for text box
)

stop song
pan camera(up,6,4)
wait for camera
wait(15)
set hero direction(0,down)
wait(2)
set hero direction(0,right)
wait(2)
set hero direction(0,up)
wait(15)
set hero picture(0,487)
wait(10)

jig gahn
tb(4094)
jig gahn2(4)
show text box(4095)
jig gahn2(2)
jig gahn
wait for text box
jig gahn2(2)
show text box(4096)
jig gahn
wait for text box
wait(10)
jig gahn
tb(4097)
wait(10)
show text box(4098)
for(juggles,1,5,1) do(
set hero palette(0,117)
wait(1)
set hero palette(0,120)
wait(1))
wait for text box
jig npc(13)
tb(4099)

palout(3)
show backdrop(21)
wait(10)
palin(3)

play song(96)

suspend box advance
wait(10)
textout(1)
show text box(4100)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4101)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4102)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(10)
palout(3)
show backdrop(22)
wait(3)
palin(3)

wait(10)
textout(1)
show text box(4103)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4104)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(10)
palout(3)
show backdrop(23)
wait(3)
play song(65)
palin(3)

wait(3)
textout(1)
show text box(4105)
wait(2)
textin(1)
wait for key(usekey)
textout(1)
advance text box

show text box(4106)
wait(2)
textin(1)
wait for key(usekey)
textout(1)
advance text box

show text box(4107)
wait(2)
textin(1)
wait for key(usekey)
textout(1)
advance text box

palout(2)
show backdrop(24)
wait(1)
palin(2)

wait(30)

palout(1)
show backdrop(25)
wait(1)
palin(1)

wait(20)

palout(1)
show backdrop(26)
wait(1)
palin(1)

wait(10)

stop song
fade screen out(63,63,63)
show backdrop(27)
wait(1)
fade screen in

wait(75)

show backdrop(7)
wait(4)
show backdrop(28)
play song(8)

wait(50)

show backdrop(1)
wait(4)
show backdrop(29)

wait(35)

show backdrop(0)
wait(4)
show backdrop(30)

wait(40)

fade screen out
stop song
show backdrop(31)
wait(20)
fade screen in

wait(40)

palout(1)
show backdrop(32)
wait(1)
palin(1)

wait(30)

show backdrop(0)
wait(1)
show backdrop(33)

wait(20)

palout(1)
show backdrop(34)
wait(1)
palin(5)

wait(65)

textout(1)
show text box(4108)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4109)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4110)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(15)
palout(15)
show backdrop(35)
wait(15)
play song(33)
palin(15)

wait(15)
textout(1)
show text box(4111)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4112)
wait(6)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4113)
wait(15)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4114)
wait(35)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(15)
palout(15)
show backdrop(0)
wait(15)
palin(1)

textout(1)
show text box(4115)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

palout(1)
show backdrop(36)
wait(10)
palin(15)

textout(1)
show text box(4116)
wait(25)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4117)
wait(6)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(25)
show text box(7852)
wait(6)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(7853)
wait(15)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(30)
show text box(7854)
wait(6)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(60)
show text box(7855)
wait(6)
textin(4)
wait for key(usekey)

stop song
palout(15)
advance text box
show backdrop(0)
wait(20)
palin(1)
textout(1)

end
###
#########################
script, aftermath3, begin

wait(10)
palout(15)

###katina runs beneath grinlow back and forth to the protectors
###FINISH IT!
resume box advance
camera follows hero(0)
teleport to map(66,55,209)
stop song
wait(1)
set npc position(npc at spot(75,209),0,0)
set npc position(npc at spot(72,207),0,0)
set npc position(npc at spot(64,209),0,0)
set npc position(npc at spot(61,210),0,0)
set npc position(npc at spot(57,211),0,0)
set npc position(npc at spot(53,209),0,0)
pan camera(south,0,0)
set hero position(0,67,215)
variable(kat)
set variable(kat,create npc(30,60,202))
alter npc(kat,NPCstat:movespeed,4)
pan camera(right,11,2)
walk npc(kat,down,6)
show map
wait(1)
palin(6)
wait for npc(kat)
walk npc(kat,right,4)
wait for npc(kat)
walk npc(kat,down,2)
wait for npc(kat)
walk npc(kat,right,2)
wait for npc(kat)
set npc frame(kat,0)

jig npc(kat)
jig npc(kat)
show text box(4118)
wait(4)
set npc direction(15,up)
set npc direction(20,down)
wait(4)
set npc direction(17,up)
set npc direction(20,left)
set npc direction(21,left)
wait for text box
wait for camera

wait(2)
pan camera(right,8,2)
wait(2)
walk npc(kat,right,6)
wait(4)
set npc direction(15,right)
set npc direction(11,right)
set npc direction(20,down)
set npc direction(21,down)
wait(2)
set npc direction(17,right)
set npc direction(10,down)
wait(4)
set npc direction(10,right)
set npc direction(20,right)
set npc direction(21,right)
wait for npc(kat)
walk npc(kat,up,2)
wait for npc(kat)
walk npc(kat,right,2)
wait for npc(kat)
set npc frame(kat,0)
set npc direction(kat,up)

jig npc(kat)
jig npc(kat)
show text box(4119)
wait(4)
set npc direction(12,up)
set npc direction(16,left)
wait(4)
set npc direction(13,up)
set npc direction(16,down)
set npc direction(19,down)
wait for text box
wait for camera

wait for text box
wait(3)
suspend box advance
palout(3)
show backdrop(37)
wait(5)
play song(69)
palin(3)

textout(1)
show text box(4120)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4121)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4122)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4123)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4124)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4125)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4126)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4127)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4128)
wait(10)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4129)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4130)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4131)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4132)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

show text box(4133)
wait(3)
textin(3)
wait for key(usekey)
textout(3)
advance text box

wait(5)
stop song
palout(3)
show map
camera follows hero(0)
teleport to map(98,45,66)
stop song
wait(1)

#making npc statues appear
set npc frame(npc at spot(39,45),1)
set npc frame(npc at spot(41,46),1)
set npc frame(npc at spot(49,46),1)
set npc frame(npc at spot(51,45),1)
set npc frame(npc at spot(39,49),1)
set npc frame(npc at spot(41,50),1)
set npc frame(npc at spot(50,50),1)
set npc frame(npc at spot(52,49),1)
set npc frame(npc at spot(49,56),1)
set npc frame(npc at spot(38,55),1)
set npc frame(npc at spot(52,63),1)
set npc frame(npc at spot(51,66),1)
set npc frame(npc at spot(39,61),1)
set npc frame(npc at spot(37,63),1)

pan camera(south,0,0)
set hero position(0,45,60)
set hero picture(0,474)
set hero palette(0,188)
set hero speed(0,1)
alter npc(2,NPCstat:movespeed,2)
alter npc(3,NPCstat:movespeed,2)
set npc position(2,44,60)
set npc position(3,46,59)
wait(20)
palin(20)

wait(15)
walk npc(2,down,1)
wait for npc(2)
walk hero(0,down,5)
walk npc(2,down,6)
walk npc(3,down,10)
wait for npc(2)
variable(jx)
variable(jy)
set variable(jx,npc pixel x(2))
set variable(jy,npc pixel y(2))
set npc direction(2,right)
wait(4)
set npc direction(2,up)
wait(3)
put npc(2,jx,jy--2)
wait(2)
put npc(2,jx,jy)
wait(2)
put npc(2,jx,jy--2)
wait(2)
put npc(2,jx,jy)
wait(6)
set npc direction(2,right)
wait(3)
walk npc(2,down,3)
wait for npc(2)

set hero direction(0,left)
wait for hero(0)
wait(20)
set hero direction(0,right)
wait(30)

palout(10)
camera follows hero(0)
teleport to map(66,56,168)
stop song
wait(1)
pan camera(south,0,0)
set hero position(0,53,151)
alter npc(10,NPCstat:movespeed,1)
alter npc(11,NPCstat:movespeed,1)
alter npc(12,NPCstat:movespeed,1)
alter npc(13,NPCstat:movespeed,1)
alter npc(14,NPCstat:movespeed,1)
alter npc(15,NPCstat:movespeed,1)
alter npc(16,NPCstat:movespeed,1)
alter npc(17,NPCstat:movespeed,1)
alter npc(18,NPCstat:movespeed,1)
alter npc(19,NPCstat:movespeed,1)
alter npc(20,NPCstat:movespeed,1)
alter npc(21,NPCstat:movespeed,1)
alter npc(30,NPCstat:movespeed,1)
set npc position(10,54,159)
set npc position(11,57,157)
set npc position(12,55,155)
set npc position(13,58,156)
set npc position(14,53,158)
set npc position(15,59,157)
set npc position(16,56,156)
set npc position(17,54,156)
set npc position(18,57,155)
set npc position(19,57,160)
set npc position(20,55,158)
set npc position(21,58,158)
create npc(30,56,153)
wait(1)
walk npc(10,up,6)
walk npc(11,up,5)
walk npc(12,up,4)
walk npc(13,up,3)
walk npc(14,up,4)
walk npc(15,up,3)
walk npc(16,up,4)
walk npc(17,up,5)
walk npc(18,up,4)
walk npc(19,up,6)
walk npc(20,up,6)
walk npc(21,up,4)
walk npc(30,up,4)
pan camera(up,18,4)
wait(1)
palin(10)

wait for camera
pan camera(up,10,4)
palout(10)
camera follows hero(0)
teleport to map(98,45,66)
stop song
wait(1)

#making npc statues appear, again
set npc frame(npc at spot(39,45),1)
set npc frame(npc at spot(41,46),1)
set npc frame(npc at spot(49,46),1)
set npc frame(npc at spot(51,45),1)
set npc frame(npc at spot(39,49),1)
set npc frame(npc at spot(41,50),1)
set npc frame(npc at spot(50,50),1)
set npc frame(npc at spot(52,49),1)
set npc frame(npc at spot(49,56),1)
set npc frame(npc at spot(38,55),1)
set npc frame(npc at spot(52,63),1)
set npc frame(npc at spot(51,66),1)
set npc frame(npc at spot(39,61),1)
set npc frame(npc at spot(37,63),1)

pan camera(south,0,0)
set hero position(0,45,65)
wait(1)
palin(10)

wait(30)
set hero direction(0,left)
wait(4)
set hero direction(0,down)
wait(15)
set hero direction(0,up)
wait(20)

walk hero(0,down,4)
wait(15)
tweak palette (5,5,5)
update palette
wait (15)
tweak palette (10,10,10)
update palette
wait (15)
tweak palette (20,20,20)
update palette
wait (15)
tweak palette (40,40,40)
update palette
wait (15)
tweak palette (111,111,111)
update palette
wait (1)
fade screen out(63,63,63)
wait for hero(0)
wait(1)


###part where party sees all protectors and katina waiting for them beneath grinlow
###at first they are still, then they are happy happy
###EDIT: seems this shall be cut, I did insert something to a similiar effect above


fade screen out(63,63,63)
show backdrop(0)
wait(5)
fade screen in

wait(20)

palout(1)
show backdrop(38)
wait(20)
play song(34)
palin(20)

textout(1)
show text box(4134)
wait(30)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4135)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4136)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

wait(15)
palout(20)
show backdrop(39)
wait(10)
palin(20)

wait(35)

textout(1)
show text box(4137)
wait(10)
stop song
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4138)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4139)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4140)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box
end
###
#########################
script, aftermath4, begin
###begin epilogue bit#######################################################

#Johan & Mazing
palout(20)
show map
camera follows hero(0)
set hero picture(0,0)
wait(1)
teleport to map(53,44,53)
stop song
resume obstruction
#resume npcs
set npc position(npc at spot(38,51),0,0)
wait(40)
pan camera(left,10,1)
wait(1)
palin(20)
wait for camera
focus camera(30,49,1)
wait for camera
wait(10)
textout(1)
show text box(4141)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(5)
palout(5)
camera follows hero(0)
teleport to map(41,5,121)
play song(84)
suspend npcs
suspend obstruction
hero clothes
set npc position(2,6,114)
set npc direction(2,up)
pan camera(up,5,1)
wait(1)
palin(5)
textout(1)
wait for camera
wait(5)
show text box(4142)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(5)
show text box(4143)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
show text box(4144)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait for camera
wait(10)
set npc direction(13,right)
wait(5)
set npc direction(2,left)
variable(nx)
variable(ny)
variable(hx)
variable(hy)
set variable(nx, npc pixel x(13))
set variable(ny, npc pixel y(13))
set variable(hx, npc pixel x(2))
set variable(hy, npc pixel y(2))
wait(20)
put npc(2,hx--2,hy)
set npc frame(2,1)
wait(1)
put npc(13,nx+2,ny)
set npc frame(13,1)
wait(1)
put npc(2,hx--4,hy)
set npc frame(2,0)
wait(1)
put npc(13,nx+4,ny)
set npc frame(13,0)
wait(10)

#Pyrus
palout(20)
camera follows hero(0)
teleport to map(25,56,78)
stop song
hero clothes
wait(50)
pan camera(right,20,2)
wait(1)
palin(20)
wait for camera
play song(71)
wait(10)
set npc position(3,76,84)
alter npc(3,NPCstat:movespeed,1)
walk npc(3,up,12)
wait(10)
textout(1)
show text box(4145)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
show text box(4146)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(10)
show text box(4147)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(20)
show text box(4148)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(10)

#Manx and Scarf
palout(20)
camera follows hero(0)
teleport to map(83,59,71)
resume obstruction
resume npcs
wait(1)
focus camera(69,81,1)
wait(1)
wait(50)
palin(20)
wait for camera
suspend npcs
suspend obstruction
set npc position(npc at spot(61,81),0,0)

create npc(6,79,80)
walk npc(6,left,7)
wait for npc(6)
walk npc(6,down,1)
wait for npc(6)
walk npc(6,left,13)
wait(10)
create npc(4,79,80)
walk npc(4,left,7)
wait for npc(4)
set npc frame(4,0)

text out(1)
show text box(4149)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

create npc(5,79,80)
walk npc(5,left,3)
wait for npc(5)
walk npc(5,left,3)
wait(2)
set npc direction(4,down)
wait(3)
set npc direction(4,right)
wait for npc(5)
set npc frame(5,0)

show text box(4150)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(5)
variable(sx)
variable(sy)
set variable(sx, npc pixel x(4))
set variable(sy, npc pixel y(4))
put npc(4,sx,sy--3)
wait(1)
put npc(4,sx,sy)
wait(1)
put npc(4,sx,sy--3)
wait(1)
put npc(4,sx,sy)
wait(2)
set npc direction(4,down)
alter npc(4,NPCstat:movespeed,10)
alter npc(5,NPCstat:movespeed,5)
wait(2)
walk npc(4,left,15)
wait(2)
walk npc(5,left,15)
wait(5)

show text box(4151)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4152)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(10)

#Katina and Defenders
palout(20)
camera follows hero(0)
teleport to map(48,55,47)
stop song
suspend obstruction
suspend npcs
alter npc(1,NPCstat:picture,104)
alter npc(1,NPCstat:palette,104)
alter npc(2,NPCstat:picture,317)
alter npc(2,NPCstat:palette,156)
alter npc(3,NPCstat:picture,156)
alter npc(3,NPCstat:palette,108)
alter npc(6,NPCstat:picture,226)
alter npc(6,NPCstat:palette,60)
alter npc(7,NPCstat:picture,288)
alter npc(7,NPCstat:palette,212)
alter npc(8,NPCstat:picture,268)
alter npc(8,NPCstat:palette,12)
alter npc(14,NPCstat:picture,216)
alter npc(14,NPCstat:palette,52)
alter npc(1,NPCstat:movespeed,2)
alter npc(2,NPCstat:movespeed,2)
alter npc(3,NPCstat:movespeed,2)
alter npc(6,NPCstat:movespeed,2)
alter npc(7,NPCstat:movespeed,2)
alter npc(8,NPCstat:movespeed,2)
alter npc(14,NPCstat:movespeed,2)
set npc position(1,55,66)
set npc direction(1,up)
set npc position(3,55,68)
set npc direction(3,up)
if(check tag(246)) then(
	set npc position(6,53,68)
	set npc direction(6,up)
)
if(check tag(256)) then(
	set npc position(7,57,68)
	set npc direction(7,up)
)
if(check tag(313)) then(
	set npc position(8,53,69)
	set npc direction(8,up)
)
if(check tag(226)) then(
	set npc position(14,57,69)
	set npc direction(14,up)
)
variable(d1)
variable(d2)
variable(d3)
variable(d4)
variable(d5)
set variable(d1,create npc(2,54,68,up))
set variable(d2,create npc(2,56,68,up))
set variable(d3,create npc(2,54,69,up))
set variable(d4,create npc(2,55,69,up))
set variable(d5,create npc(2,56,69,up))
set npc position(npc at spot(54,45),0,0)
wait(50)
pan camera(south,20,2)
wait(1)
palin(20)
wait for camera

wait(10)
set npc direction(1,right)
wait(2)
set npc direction(1,down)
play song(91)
textout(1)
show text box(4153)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4154)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4155)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(5)
jig npc(1)
wait(5)
set npc direction(6,right)
set npc direction(d1,right)
set npc direction(3,right)
set npc direction(d2,right)
set npc direction(7,right)
set npc direction(8,right)
set npc direction(d3,right)
set npc direction(d4,right)
set npc direction(d5,right)
set npc direction(14,right)
wait(5)
set npc direction(6,down)
set npc direction(d1,down)
set npc direction(3,down)
set npc direction(d2,down)
set npc direction(7,down)
set npc direction(8,down)
set npc direction(d3,down)
set npc direction(d4,down)
set npc direction(d5,down)
set npc direction(14,down)
wait(5)
walk npc(6,down,10)
walk npc(d1,down,10)
walk npc(3,down,10)
walk npc(d2,down,10)
walk npc(7,down,10)
walk npc(8,down,10)
walk npc(d3,down,10)
walk npc(d4,down,10)
walk npc(d5,down,10)
walk npc(14,down,10)
wait(10)
walk npc(1,down,10)
wait(10)

show text box(4156)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box
wait(10)
end
###
#########################
script, aftermath5, begin
#Dart
if(check tag(199)==false) then(
palout(20)
camera follows hero(0)
teleport to map(68,21,26)
stop song
alter npc(1,NPCstat:picture,530)
alter npc(1,NPCstat:movespeed,1)
alter npc(1,NPCstat:movetype,npcmovetype:rightturns)
write pass block(21,35,1+2+4+8)
set npc position(1,21,35)
set npc direction(1,up)
resume obstruction
resume npc walls
wait(50)
resume npcs
palin(20)
wait(10)

textout(1)
show text box(4157)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4158)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

pan camera(down,10,1)
play song(17)
wait for camera
wait(10)

show text box(4159)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4160)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(15)
show text box(4161)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(10)
pan camera(down,10,1)
wait(10)
)

#Mi'la
palout(20)
suspend npcs
camera follows hero(0)
teleport to map(1,162,87)
stop song
wait(50)
pan camera(up,10,1)
wait(1)
palin(20)
wait for camera

wait(10)
textout(1)
show text box(4162)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(15)
show text box(4163)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(5)
show text box(4164)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(5)
pan camera(up,10,1)

palout(20)
camera follows hero(0)
teleport to map(7,5,263)
stop song
set npc position(1,6,252)
set npc position(2,5,252)
alter npc(1,NPCstat:picture,386)
set npc frame(1,1)
alter npc(2,NPCstat:picture,378)
alter npc(2,NPCstat:palette,3)
set npc frame(2,1)
set npc direction(2,right)
wait(30)
focus camera(5,254,1)
play song(32)
wait(1)
palin(20)

wait for camera
wait(10)
textout(1)
show text box(4165)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4166)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

show text box(4167)
wait(5)
textin(5)
wait for key(use key)
textout(5)
advance text box

wait(10)
palout(10)
show backdrop(0)
wait(10)
palin(10)

textout(1)
show text box(4168)
wait(20)
stop song
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4169)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4170)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4171)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

show text box(4172)
wait(10)
textin(5)
wait for key(usekey)
textout(5)
advance text box

wait(10)
palout(2)
show backdrop(45)
wait(2)
play song(86)
palin(2)

textout(1)
show text box(4173)
wait(15)
textin(5)
wait for key(usekey)
textout(5)
advance text box

wait(20)
palout(20)
show backdrop(0)
wait(1)
palin(1)
end
###

######################
script, bd, pic, begin
palout(1)
show backdrop(pic)
wait(5)
palin(1)
wait(25)
end
###

######################
script, credits, begin

textout(1)
wait(60)

#Soj / credits
show text box(4174)
wait(4)
textin(3)
wait(80)
textout(3)
advance text box

ftb(50,0,6455)
#show text box(6455)
#wait(3)
#textin(3)
#wait(50)
#textout(3)
#advance text box

#fyre
ftb(120,115,4175,4176)
###saving just in case
#bd(115)
#textout(1)
#show text box(4175)
#wait(10)
#textin(3)
#wait(120)
#textout(3)
#advance text box
#show text box(4176)
#wait(3)
#textin(3)
#wait(120)
#textout(3)
#advance text box

#char
ftb(120,116,4177,4178)

#SPAM man
ftb(120,117,4185,6463)

#emanuele angelino
#el barto
#fyre music
ftb(120,118,8285,7998,7999,8000)

#robert henson
#david grund jr.
#Aaron Walz
ftb(120,237,8001,8002,8003,8284)

#jazz man
#specplosive
#additional music
ftb(120,119,7837,7838,8004,8005)

#special thanks
ftb(30,0,4180)
#bd(0)
#textout(1)
#show text box(4180)
#wait(10)
#textin(3)
#wait(30)
#textout(3)
#advance text box

#fen
ftb(120,120,4181,7309)

#longe
ftb(120,234,4179,7834)

#haggard
ftb(120,121,4182,6456)

#rinku
ftb(120,122,4183,6457)

#orchard
ftb(120,127,4189,6467,6468)

#neoTA
ftb(120,123,4184,6462)

#giz
ftb(120,124,4186,6464,7310)

#hachi
ftb(120,125,4187,6465)

#mad cacti
ftb(120,236,6469,7839)

#harlock
ftb(120,126,4188,6466)

#additional thanks
stop song
ftb(30,0,7835)
play song(39)
#bd(0)
#textout(1)
#show text box(7835)
#wait(10)
#textin(3)
#wait(30)
#textout(3)
#advance text box

#playtesters
bd(128)
textout(1)
ftb(100,0,8022,0,0,0,1)
#show text box(4191)
#wait(10)
#textin(3)
#wait(100)
#textout(3)
#advance text box

#jsh
ftb(100,0,4191,0,0,0,1)

#melnazar
ftb(100,0,7836,0,0,0,1)

#no shot
ftb(100,0,4190,0,0,0,1)

#rmsephy
ftb(100,0,7311,0,0,0,1)

#royal
ftb(100,0,7879,0,0,0,1)

#catman
bd(0)
textout(1)
ftb(160,0,4192,0,0,0,1)

wait(20)
fade screen out(63,63,63)

#playtime
set variable(h1,days of play)
set variable(h2,hours of play)
set variable(h3,minutes of play)
wait(1)

if(h1 == 0) then(
	if(h2 >> 1) then(
		if(h3 >> 1) then(
		show text box(6470)
		)
		else(
		show text box(6475)
		)
	)
	else(
		if(h3 >> 1) then(
		show text box(6474)
		)
		else(
		show text box(6476)
		)
	)
)
if(h1 == 1) then(
	if(h2 >> 1) then(
		if(h3 >> 1) then(
		show text box(6477)
		)
		else(
		show text box(6479)
		)
	)
	else(
		if(h3 >> 1) then(
		show text box(6478)
		)
		else(
		show text box(6480)
		)
	)
)
if(h1 >> 0) then(
	if(h2 >> 1) then(
		if(h3 >> 1) then(
		show text box(6481)
		)
		else(
		show text box(6483)
		)
	)
	else(
		if(h3 >> 1) then(
		show text box(6482)
		)
		else(
		show text box(6484)
		)
	)
)
wait(10)
textin(1)
wait(1)
fade screen in

wait(150)
textout(5)
advance text box


#thank you for playing--jade style!
show text box(6471)
wait(35)
textin(5)
wait(70)
textout(5)
advance text box
show text box(6472)
wait(20)
textin(5)
wait(70)
textout(5)
advance text box

#final
palout(1)
show backdrop(141)
wait(40)
neopicin(15)
wait(40)
textout(1)
show text box(6473)
wait(40)
textin(10)
wait(20)
wait for key(any key)
textout(3)
advance text box
end
###

###########################
script, thelastscene, begin
palout(10)
stop song
show backdrop(40)
wait(40)
play song(33)
palin(20)

ftextout(1)
show text box(4193)
wait(40)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4194)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box

palout(5)
show backdrop(41)
wait(5)
palin(5)

ftextout(1)
show text box(4195)
wait(20)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4196)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4197)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4198)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box

palout(5)
show backdrop(42)
wait(5)
palin(5)

ftextout(1)
show text box(4199)
wait(20)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4200)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4201)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4202)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4203)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4204)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4205)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4206)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4207)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4208)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4209)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box

palout(5)
show backdrop(40)
wait(5)
palin(5)

ftextout(1)
show text box(4210)
wait(50)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4211)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4212)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4213)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4214)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
show text box(4215)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box

wait(15)
stop song
palout(20)
show backdrop(0)
wait(30)
palin(1)
fade screen out(63,63,63)
show backdrop(46)
wait(1)
fade screen in

wait(20)
play song(99)
show text box(6485)
wait(30)
wait for key(anykey)

#last bit of text (13 total)
#if saved dart
if(check tag(199)==false) then(
#wait(10)
ftextout(10)
advance text box
wait(30)
#ftextout(1)
wait(5)
show text box(7840)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7841)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7842)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7843)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7844)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(20)
show text box(7845)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(25)
show text box(7846)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(20)
show text box(7847)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7848)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(40)
show text box(7849)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7850)
wait(5)
ftextin(3)
wait for key(usekey)
ftextout(3)
advance text box
wait(5)
show text box(7851)
wait(5)
ftextin(3)
wait for key(usekey)

#secret save part
set tag(653,1)
fade screen out(63,63,63)
stop song

#turning off gahn rts messages
set tag(208,0)

#turn on rest and avis
set tag(433,0)
set tag(280,0)

#setting up dev room
teleport to map(53,51,39)
stop song
unlock hero(1)
unlock hero(2)
unlock hero(3)
#set party in
delete hero(15)
swap in hero(1)
swap in hero(2)
swap in hero(3)
swap by position(find hero(0),0)
swap by position(find hero(1),1)
swap by position(find hero(2),2)
swap by position(find hero(3),3)
camera follows hero(0)
set hero picture(find hero(0),230)
set hero palette(find hero(0),1)
set hero picture(find hero(0),32,insidebattle)
set hero palette(find hero(0),469,insidebattle)
set hero direction(0,up)
set variable(hour,noontime)
set variable(isrunning,true)
set tag(3,0)
set tag(4,1)
set tag(5,0)
set tag(6,0)
set hp
innrest
set variable(musicsave,0)

#ftextout(3)
advance text box
resume box advance
wait(10)
show backdrop(2)
wait(5)
reset palette
fade screen in
save game
)
else(fade screen out(63,63,63))

game over
end
###

#############################
script, ftextout, time, begin
set variable (txtred, read color (15,0))
set variable (txtgreen, read color (15,1))
set variable (txtblue, read color (15,2))

if (time<>0) then(
write color (15,0,txtred--5)
write color (15,1,txtgreen--5)
write color (15,2,txtblue--5)
update palette
wait (time)
write color (15,0,txtred--10)
write color (15,1,txtgreen--10)
write color (15,2,txtblue--10)
update palette
wait (time)
write color (15,0,txtred--20)
write color (15,1,txtgreen--20)
write color (15,2,txtblue--20)
update palette
wait (time)
write color (15,0,txtred--40)
write color (15,1,txtgreen--40)
write color (15,2,txtblue--40)
update palette
wait (time)
write color (15,0,txtred--111)
write color (15,1,txtgreen--111)
write color (15,2,txtblue--111)
update palette
wait (time)
)
end
###

############################
script, ftextin, time, begin
if (time<>0) then(
write color (15,0,txtred)
write color (15,1,txtgreen)
write color (15,2,txtblue)
write color (15,0,txtred--40)
write color (15,1,txtgreen--40)
write color (15,2,txtblue--40)
update palette
wait (time)
write color (15,0,txtred)
write color (15,1,txtgreen)
write color (15,2,txtblue)
write color (15,0,txtred--20)
write color (15,1,txtgreen--20)
write color (15,2,txtblue--20)
update palette
wait (time)
write color (15,0,txtred)
write color (15,1,txtgreen)
write color (15,2,txtblue)
write color (15,0,txtred--10)
write color (15,1,txtgreen--10)
write color (15,2,txtblue--10)
update palette
wait (time)
write color (15,0,txtred)
write color (15,1,txtgreen)
write color (15,2,txtblue)
write color (15,0,txtred--5)
write color (15,1,txtgreen--5)
write color (15,2,txtblue--5)
update palette
wait (time)
write color (15,0,txtred)
write color (15,1,txtgreen)
write color (15,2,txtblue)
update palette
)
end
###

##############################
script, grinzenithfinal, begin
suspend player
suspend npcs
suspend obstruction

 if (herox(0)==15) then( walk hero (0,right,1) wait for hero (0))
 if (herox(0)==27) then( walk hero (0,left,1) wait for hero (0))

stop song

pan camera (up,12,10)
walk hero (0,up,3)
set npc position(5,21,36)
set npc position(6,21,37)
alter npc(5,NPCstat:picture,482)
alter npc(6,NPCstat:picture,483)
wait for camera
wait for hero (0)

walk hero to x(0,21)
wait for hero(0)
set hero frame(0,0)
set hero direction(0,up)
set party out
swap by position(find hero(0),0)

#have Dart tag(704)
if(check tag(704)) then(
set npc position(1,herox(0),heroy(0))
walk npc(1,right,1)
wait for npc(1)
set npc frame(1,0)
set npc direction(1,up)
)

#Have jade sword?? tag(210)
if(check tag(210)) then(
finalbattle
aftermath
credits
thelastscene
)
else(
nojadesword
nojadecredits
)
end
###

#########################################################
script,ftb,time,backdrop,t1,t2,t3,t4,whichone,begin
variable(tickcount)
variable(waitero)

if(whichone==0) then(
bd(backdrop)
textout(1)
show text box(t1)
wait(10)
textin(3)

tickcount := time
waitero := 1
while(waitero==1) do(
	if(keyispressed(28),or,keyispressed(29),or,keyispressed(57),or,tickcount<<1) then(
		set variable(waitero,0)
	)
	wait(1)
	set variable(tickcount,tickcount--1)
)

textout(3)
advance text box

if(t2<>0) then(
	show text box(t2)
	wait(3)
	textin(3)

	tickcount := time
	waitero := 1
	while(waitero==1) do(
		if(keyispressed(28),or,keyispressed(29),or,keyispressed(57),or,tickcount<<1) then(
			set variable(waitero,0)
		)
		wait(1)
		set variable(tickcount,tickcount--1)
	)

	textout(3)
	advance text box
)
if(t3<>0) then(
	show text box(t3)
	wait(3)
	textin(3)

	tickcount := time
	waitero := 1
	while(waitero==1) do(
		if(keyispressed(28),or,keyispressed(29),or,keyispressed(57),or,tickcount<<1) then(
			set variable(waitero,0)
		)
		wait(1)
		set variable(tickcount,tickcount--1)
	)

	textout(3)
	advance text box
)
if(t4<>0) then(
	show text box(t4)
	wait(3)
	textin(3)

	tickcount := time
	waitero := 1
	while(waitero==1) do(
		if(keyispressed(28),or,keyispressed(29),or,keyispressed(57),or,tickcount<<1) then(
			set variable(waitero,0)
		)
		wait(1)
		set variable(tickcount,tickcount--1)
	)

	textout(3)
	advance text box
)
)
else(
	show text box(t1)
	wait(10)
	textin(3)

	tickcount := time
	waitero := 1
	while(waitero==1) do(
		if(keyispressed(28),or,keyispressed(29),or,keyispressed(57),or,tickcount<<1) then(
			set variable(waitero,0)
		)
		wait(1)
		set variable(tickcount,tickcount--1)
	)

	textout(3)
	advance text box
)
end
###

###############
script,tp,begin
reset palette
tweak palette(dunred,dungreen,dunblue)
tweak palette(dunred2,dungreen2,dunblue2)
update palette
end
###

##########################################
script,settp,dr1,dg1,db1,dr2,dg2,db2,begin
set variable(dunred,dr1)
set variable(dungreen,dg1)
set variable(dunblue,db1)
set variable(dunred2,dr2)
set variable(dungreen2,dg2)
set variable(dunblue2,db2)
end
###

##############################
script, neopicout, time, begin
if (time<>0) then(
tweak palette (-5,-5,-5)
update palette
wait (time)
tweak palette (-10,-10,-10)
update palette
wait (time)
tweak palette (-20,-20,-20)
update palette
wait (time)
tweak palette (-40,-40,-40)
update palette
wait (time)
tweak palette (-111,-111,-111)
update palette
wait (time)
)
end
###

#############################
script, neopicin, time, begin
if (time<>0) then(
reset palette
set final palette
tweak palette (-40,-40,-40)
update palette
wait (time)
reset palette
set final palette
tweak palette (-20,-20,-20)
update palette
wait (time)
reset palette
set final palette
tweak palette (-10,-10,-10)
update palette
wait (time)
reset palette
set final palette
tweak palette (-5,-5,-5)
update palette
wait (time)
reset palette
set final palette
write color(175,0,63)
write color(175,1,63)
write color(175,2,63)
update palette
)
end
###

##############################
script, setfinalpalette, begin
write color(  0, 0,  0)
write color(  0, 1,  0)
write color(  0, 2,  0)
write color(  1, 0,  0)
write color(  1, 1, 12)
write color(  1, 2, 29)
write color(  2, 0, 46)
write color(  2, 1,  0)
write color(  2, 2,  0)
write color(  3, 0, 21)
write color(  3, 1, 17)
write color(  3, 2,  0)
write color(  4, 0, 29)
write color(  4, 1,  8)
write color(  4, 2, 29)
write color(  5, 0,  8)
write color(  5, 1, 21)
write color(  5, 2, 29)
write color(  6, 0, 63)
write color(  6, 1,  0)
write color(  6, 2,  0)
write color(  7, 0, 34)
write color(  7, 1, 17)
write color(  7, 2,  0)
write color(  8, 0, 17)
write color(  8, 1, 25)
write color(  8, 2, 34)
write color(  9, 0, 21)
write color(  9, 1, 25)
write color(  9, 2, 29)
write color( 10, 0, 42)
write color( 10, 1, 21)
write color( 10, 2, 21)
write color( 11, 0, 46)
write color( 11, 1, 25)
write color( 11, 2,  0)
write color( 12, 0, 21)
write color( 12, 1, 38)
write color( 12, 2, 42)
write color( 13, 0, 46)
write color( 13, 1, 34)
write color( 13, 2,  0)
write color( 14, 0, 51)
write color( 14, 1, 29)
write color( 14, 2, 17)
write color( 15, 0, 38)
write color( 15, 1, 34)
write color( 15, 2, 34)
write color( 16, 0, 55)
write color( 16, 1, 29)
write color( 16, 2, 25)
write color( 17, 0, 55)
write color( 17, 1, 34)
write color( 17, 2, 17)
write color( 18, 0, 46)
write color( 18, 1, 38)
write color( 18, 2, 34)
write color( 19, 0, 63)
write color( 19, 1, 29)
write color( 19, 2, 34)
write color( 20, 0, 63)
write color( 20, 1, 38)
write color( 20, 2, 34)
write color( 21, 0, 63)
write color( 21, 1, 46)
write color( 21, 2,  0)
write color( 22, 0, 63)
write color( 22, 1, 46)
write color( 22, 2, 34)
write color( 23, 0, 63)
write color( 23, 1, 51)
write color( 23, 2, 34)
write color( 24, 0, 63)
write color( 24, 1, 55)
write color( 24, 2, 34)
write color( 25, 0, 63)
write color( 25, 1, 59)
write color( 25, 2, 34)
write color( 26, 0, 63)
write color( 26, 1, 63)
write color( 26, 2, 34)
write color( 27, 0,  0)
write color( 27, 1,  0)
write color( 27, 2,  0)
write color( 28, 0,  0)
write color( 28, 1,  0)
write color( 28, 2,  0)
write color( 29, 0,  0)
write color( 29, 1,  0)
write color( 29, 2,  0)
write color( 30, 0,  0)
write color( 30, 1,  0)
write color( 30, 2,  0)
write color( 31, 0,  0)
write color( 31, 1,  0)
write color( 31, 2,  0)
write color( 32, 0,  0)
write color( 32, 1,  0)
write color( 32, 2,  0)
end
###

##################################
script, actadvance, howmuch, begin
set variable(actnumber,howmuch)

variable(item2)
variable(item3)
variable(item4)
variable(item5)

variable(i)
variable(hcount)
set variable(hcount,0)
if(check tag(45)) then(set variable(hcount,1))
if(check tag(46)) then(set variable(hcount,2))
if(check tag(47)) then(set variable(hcount,3))

for(i,0,hcount,1) do(
	set variable(item2,check equipment(find hero(i),2))
	set variable(item3,check equipment(find hero(i),3))
	set variable(item4,check equipment(find hero(i),4))
	set variable(item5,check equipment(find hero(i),5))

	if(item2<>-1) then(unequip(find hero(i),2))
	if(item3<>-1) then(unequip(find hero(i),3))
	if(item4<>-1) then(unequip(find hero(i),4))
	if(item5<>-1) then(unequip(find hero(i),5))

	set hero stat(find hero(i),9,howmuch,current stat)
	set hero stat(find hero(i),9,howmuch,maximum stat)

	if(item2<>-1) then(force equip(find hero(i),2,item2))
	if(item3<>-1) then(force equip(find hero(i),3,item3))
	if(item4<>-1) then(force equip(find hero(i),4,item4))
	if(item5<>-1) then(force equip(find hero(i),5,item5))
)
end
###
